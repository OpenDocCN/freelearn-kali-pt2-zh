<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Vulnerability Analysis</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will cover the following topics:</p>
<ul>
<li><span>Installation and configuration of OpenVAS</span></li>
<li><span>A basic vulnerability scanning with OpenVAS</span></li>
<li><span>Advanced vulnerability scanning with OpenVAS</span></li>
<li><span>Installation and Configuration of Nessus</span></li>
<li><span>A basic vulnerability scanning with Nessus</span></li>
<li><span>Advanced vulnerability scanning with Nessus</span></li>
<li><span>The installation and configuration of Nexpose</span></li>
<li>Basic vulnerability scanning with Nexpose</li>
<li><span>Advanced vulnerability scanning with Nexpose</span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Introduction</h1>
                </header>
            
            <article>
                
<p>Once access to a network has been gained and the systems within that network have been identified, the next step is establishing a foothold and persistent access. There are several tools that are available to help identify and exploit systemic vulnerabilities, but we will be focusing only on three of them in this chapter:</p>
<ul>
<li>OpenVAS (<a href="http://www.openvas.org">http://www.openvas.org</a>)</li>
<li>Nessus (<a href="https://www.tenable.com/products/nessus-vulnerability-scanner">https://www.tenable.com/products/nessus-vulnerability-scanner</a>)</li>
<li>Nexpose (<a href="https://www.rapid7.com/info/nexpose-community/">https://www.rapid7.com/info/nexpose-community/</a>)</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installation and configuration of OpenVAS</h1>
                </header>
            
            <article>
                
<p>Since the default Kali Linux media does not include OpenVAS with the initial installation, we will need to perform a full, fresh installation. This is done from the console or over a remote connection.</p>
<p>OpenVAS is an open source vulnerability management platform that was created as a fork of the venerable Nessus platform when Tenable Network Security moved Nessus to a closed source (initially named GNessUs). Over time, the OpenVAS framework became part of the Greenbone Network's commercial vulnerability management solution. Greenbone continues to contribute to OpenVAS, ensuring that it stays up to date and relevant.</p>
<p>Considering that OpenVAS is accessible through a web browser as well as the command line, it is a very powerful tool that can be leveraged either locally through the command line or a browser, or it can be put in place in a central location and used by other devices on the network.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In order to be able to complete this section, you will need this:</p>
<ul>
<li>Console access to your Kali Linux system</li>
<li>Internet access to download and install OpenVAS application</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We will perform the steps necessary to install OpenVAS on Kali:</p>
<ol>
<li>If you have not fully updated your Kali Linux installation, you will want to do so now. From the root shell, run the following command. If there are many updates, this may take a while, but be patient. Once the update process is complete, reboot the system, login, and open a root shell again:</li>
</ol>
<pre style="padding-left: 60px"><strong>apt-get update &amp;&amp; apt-get dist-upgrade -y</strong></pre>
<ol start="2">
<li>From the root shell, use <kbd>apt-get</kbd> to download and install OpenVAS: </li>
</ol>
<pre style="padding-left: 60px"><strong>apt-get install openvas</strong></pre>
<ol start="3">
<li>Once the installation is complete, run the following from the root shell to kick off the setup process. Due to the amount of data needed, it is likely this will take a while even over a fast connection, so be prepared to wait:</li>
</ol>
<pre style="padding-left: 60px"><strong>openvas-setup</strong></pre>
<ol start="4">
<li>At the end of this process, you will see the admin password displayed. Write this down so that you are able to log into the OpenVAS portal.</li>
</ol>
<div class="packt_tip">In the event where you forget this password, it can be reset from the command line using the following:<br/>
<strong><kbd>openvasmd --user=admin --new-password=[your password here]</kbd></strong></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">A basic vulnerability scanning with OpenVAS</h1>
                </header>
            
            <article>
                
<p>Once installed, OpenVAS provides a centralized platform that can be used from any browser-based system or from the command line. Because OpenVAS is a security analysis tool, it will be looking at the systems in this environment to identify services and vulnerabilities, so ensure that you are prepared for potential impacts. Even the most careful and the least impact scans can potentially affect services.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In order to be able to complete this section, you will need the following steps completed:</p>
<ul>
<li>OpenVAS successfully installed and configured on your Kali Linux system</li>
<li>Access to the Kali system, either from the desktop or a browser</li>
<li>Network access to the systems that were configured as part of the lab discussion in the earlier sections</li>
<li>You will need to confirm the IP address of your lab network and be able to ping hosts on it</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We will perform a basic vulnerability scan using OpenVAS:</p>
<ol>
<li>Connect to the OpenVAS service on the Kali Linux system by opening a browser and navigating to <kbd>https://[your Kali IP]:9392</kbd>; accept the certificate security warning, and create an exception for the invalid certificate.</li>
<li>To prepare a more permanent implementation, create a new user that is unique to your use. From the dashboard, navigate to <span class="packt_screen">Administration</span> | <span class="packt_screen">Users</span>. You will see the list of configured users (in this case, since this is a default installation, there should only be <span class="packt_screen">Admin</span>). Under <span class="packt_screen">Actions</span> for the user admin, click on <span class="packt_screen">Clone</span>.</li>
<li>Once cloned, you will be taken to the new account overview page. Click on the <span class="packt_screen">Edit User</span> option in the upper-left part to edit the details for this user. You will be able to set the username, as well as permissions. Give the new user an appropriate name and reset the password to something you will remember in the future exercises.</li>
</ol>
<div class="packt_tip">In larger environments where LDAP is available, you can also connect OpenVAS to these repositories to leverage a centralized account management. To enable this, navigate to <span class="packt_screen">Administration</span> | <span class="packt_screen">LDAP</span> and configure the connection information that is necessary to connect to these repositories.</div>
<ol start="4">
<li>Once connected to the OpenVAS system, click on the <span class="packt_screen">Scans</span> | <span class="packt_screen">Tasks</span> link from the top menu bar. Once the page loads, you should be immediately presented with an initial scan wizard. This will help you kick off the very first scan you will run, which we will run against our first Windows 7 host.</li>
<li>With the <span class="packt_screen">Task Wizard</span> window open, enter the IP address of your lab network. In this case, add <kbd>192.168.56.0/24</kbd> into the textbox, and initiate the scan by clicking on <span class="packt_screen">Start Scanning</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/9fdd93ba-838a-42dc-8a6b-0f9b19cde87d.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Task Wizard to initial a scan</div>
<ol start="6">
<li>After the scan is initiated, you will see a list of tasks, one of which is the scan we just created:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="266" width="555" class="image-border" src="assets/106911fc-311a-4833-9113-7cb7ed363710.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">List of running tasks</div>
<ol start="7">
<li>While the scan is running, you should familiarize yourself with the action icons available, as they can be used to archive task configurations to move to other systems, clone to create a copy, and so on.</li>
<li>Once the scan is completed, you should see a change in the dashboard view to something that looks similar to the following:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="268" width="528" class="image-border" src="assets/6efd23cd-a1ac-436e-b76a-ac9554462f0c.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Task dashboard after initial scan</div>
<ol start="9">
<li>Click on the date of the scan to see the results of the scan:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="147" width="705" class="image-border" src="assets/d1f8a5a2-7b4b-4e00-a2c7-9122ed5c65d5.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Scan result report</div>
<ol start="10">
<li>There are some important things to note in the initial report. First, you will see that OpenVAS is only showing you three of the identified 15 vulnerabilities. While this may seem unusual, it is necessary to understand how OpenVAS displays its results through the default filter. The field named <span><strong>Quality of Detection</strong> (</span><strong>QoD</strong>) stands for an indication of how trustworthy the results of a particular scan maybe. To demonstrate this fact, click on the vulnerability with the highest QoD: </li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img class="image-border" src="assets/ca574069-de4a-4620-8d6c-eec721396615.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span><span>Vulnerability details</span></span></div>
<ol start="11">
<li><span>As you can see, the QoD for this check is 95%, meaning that the ability to determine a host's exposure to this vulnerability is quite high. In looking through the details of the check, you can also see that this is a potentially damaging vulnerability—this vulnerability requires a vendor-supplied fix, has a very wide distribution of affected platforms, and the result of a successful exploitation results in</span> <strong>remote code execution</strong> <span>(</span><strong>RCE</strong><span>). The combination of these factors results in the severity to be calculated as a 9.3 out of 10 (HIGH).</span></li>
</ol>
<div class="packt_infobox">This particular vulnerability was used by the WannaCry ransomware campaign that occurred in May 2017. Additional fields of interest are the manner in which the vulnerability was detected, and the information necessary to get more detailed information, including vendor-specific patch information as well as CVE/BID/CERT information.</div>
<ol start="12">
<li>Using the information contained in this report will help to determine the system's level of risk to some known vulnerabilities and insecure configurations. If you would like more detail, such as identified vulnerabilities that are below the default QoD of 70%, you may customize the filter in the upper portion of the report screen:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/b973dc02-feb1-4ee9-9954-82972c0df860.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Customize filtered view</div>
<ol start="13">
<li>At the far right in the <span class="packt_screen">Actions</span> column, you can see some very useful options. The <span class="packt_screen">Add Note</span> allows you to add additional narrative to the reports to add context, document additional or relevant findings, and so on. The <span class="packt_screen">Add Override</span> option allows you to override a particular finding, with fields for where this is permitted, which hosts, duration of the override, and the new severity (overrides are frequently used to designate a false positive severity):</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="397" width="643" class="alignnone size-full wp-image-1438 image-border" src="assets/4c6b16ca-7a31-4bf5-980d-b8b52f74be3d.png"/></div>
<div class="packt_infobox">Each report contains documented vulnerabilities that can be used in conjunction with other tools (such as Metasploit) to successfully gain access to a target system. This information must be treated with care. Ensure that the installation of OpenVAS is secured, and that the service is not left running when not in immediate use.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced vulnerability scanning with OpenVAS</h1>
                </header>
            
            <article>
                
<p>Vulnerability identification through unauthenticated network scanning is a good way to start gathering intelligence on a network, but a powerful component of this is the ability to perform more frequent, targeted scans, and this can include credentials that allow for the successful authentication to a target system for deeper level evaluations.</p>
<p>Features that make OpenVAS more powerful include highly configurable scan configurations, scheduled tasks, automated reporting, and alerting.</p>
<p>Aside from the default scan configurations that are present in the OpenVAS dashboard, it also contains some very flexible options, including scheduled scans and customized scan types. We will be looking at customized scan configurations.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In order to complete this section, you will need the following:</p>
<ul>
<li>OpenVAS successfully installed and configured on your Kali Linux system</li>
<li>Access to the Kali system, either from the desktop or a browser</li>
<li>Network access to the systems that were configured as part of the lab discussion in earlier sections.</li>
<li>You will need to confirm the IP address of the desktop <kbd>target1.kalicookbook.local</kbd><br/></li>
<li>Successfully ping <kbd>target1.kalicookbook.local</kbd> from the Kali Linux system</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p><span>Let's begin our advanced scanning techniques using OpenVAS:</span></p>
<ol>
<li>To prepare to configure more in-depth scans, we will start with adding credentials we may be aware of. When credentials are known, we will be able to do much deeper levels of evaluation. Navigate to <span class="packt_screen">Configuration</span> | <span class="packt_screen">Credentials</span>. In the upper-left part, click on the <span class="packt_screen">New Credential</span> icon to bring up the <span class="packt_screen">New Credential</span> dialog box. Configure as follows, using a domain user from your lab domain:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="263" width="648" class="alignnone size-full wp-image-1437 image-border" src="assets/24756421-48f8-4382-b793-cb5d99353c65.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">New Credential dialog</div>
<div class="packt_tip">As new accounts are discovered, they should be added to this section to not only be used for authentication but also identification of all places where they are used – a password reuse is very common.</div>
<ol start="2">
<li>The next section we will configure will be the selection of targets. Navigate to <span class="packt_screen">Configuration</span> | <span class="packt_screen">Targets</span>. On this page, you will see some existing target sets, including the automatically generated ones used in the quick start wizard. Click on the <span class="packt_screen">New Target</span> icon to create a new one. Use the following configuration:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="333" width="545" class="alignnone size-full wp-image-1436 image-border" src="assets/737f55c8-d5fa-4bf8-bcaf-ebafd1905f7e.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Configure New Target</div>
<ol start="3">
<li>Now that the target environment and known credentials are configured, we will take a look at the actual scan configuration. Navigate to <span class="packt_screen">Configuration</span> | <span class="packt_screen">Scan Configs</span>. The following scans are typical for a fresh installation:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="394" width="783" class="alignnone size-full wp-image-1435 image-border" src="assets/3388367c-11f1-4171-9c90-8fc47ed19dd5.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">List of scan configurations</div>
<ol start="4">
<li>One thing you will notice is that scans can have the same number of NVT's, but have a higher or lower likelihood of causing services to stop. Also, scans can reference and leverage data from previous runs. To get a better idea, find the full and fast scan configuration, and click on <span class="packt_screen">Clone</span> under the <span class="packt_screen">Actions</span> column. When the new configuration is presented, click on the <span class="packt_screen">Edit</span> icon, and give the scan a more meaningful name. Review the settings to get a better understanding of how the scan is configured:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="289" width="472" class="alignnone size-full wp-image-1434 image-border" src="assets/f40060f8-ee1d-4581-a40b-107bbb82cb63.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Scan configuration</div>
<div class="packt_infobox">The Fast and Full Scan is the configuration we used for our scan in the previous section. Despite how quickly the scan runs, it contains a lot of NVTs, demonstrating the speed of OpenVAS.</div>
<ol start="5">
<li><span>We will now put these three components – target, credentials, and a scan configuration together to create a task. Navigate to</span> <span class="packt_screen">Scans</span><span> |</span> <span class="packt_screen">Tasks</span><span>, and click on the</span> <span class="packt_screen">New Task</span> <span>icon. Once opened, enter the following information:</span></li>
</ol>
<ul>
<li style="list-style-type: none">
<ul>
<li>Name: Scan for vulnerabilities</li>
<li>Scan targets: Internal network</li>
<li>Click on the star at the end of the schedule line, and create a new schedule</li>
<li>Scan config: Kali Cookbook</li>
<li>Leave all other options default, then click on<span> </span><span class="packt_screen">Save</span></li>
</ul>
</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="assets/0ca2e83e-90d7-40f4-8f64-64f38d7931cd.png"/></div>
<ol start="6">
<li class="mce-root">From this point forward, a weekly, deep vulnerability scan will be run, and a report will be generated for review. Multiple scheduled runs can be configured as necessary, with email notifications sent at their completion.</li>
</ol>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installation and Configuration of Nessus</h1>
                </header>
            
            <article>
                
<p>Nessus is one of the most widely used penetration testing platforms in the industry It used to come pre-installed in Kali up until recent releases. It is sold as a commercial product by Tenable, but we will be using the home edition, which will allow us to perform scanning on a limited number of IPs and gain the knowledge we need to use the tool fully. </p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Kali Linux is running and you are logged in as root</li>
<li>Validate the internet connectivity</li>
<li>Ensure you have recently done the updates and upgrades to Kali</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p><span>We will perform Nessus setup and initial configuration:</span></p>
<ol>
<li>We must first register for an account by going to the following website <a href="https://www.tenable.com/products/nessus-home">https://www.tenable.com/products/nessus-home</a> and register for an activation code:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="594" width="1024" class="alignnone size-full wp-image-1477 image-border" src="assets/d76cda76-62c2-4619-a369-8592844fd8b9.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Tenable registration website</div>
<ol start="2">
<li>Once you register you will be shown a <span class="packt_screen">Download</span> link - select it:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="449" width="645" class="alignnone size-full wp-image-1478 image-border" src="assets/647e9d13-86e4-44d5-8336-096aa18967cf.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Tenable nessus download screen</div>
<ol start="3">
<li>Select the appropriate download Linux for your Kali distribution in our case we will be downloading the 64 bit version:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="361" width="499" class="alignnone size-full wp-image-1479 image-border" src="assets/d160f9e6-6a59-450e-9991-4443bbb7addb.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Tenable Nessus OS screen selection</div>
<ol start="4">
<li>On the subscription agreement screen check the box to accept the terms of service and click <span class="packt_screen">Download</span>. Then click <span class="packt_screen">Save File</span>:</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img height="125" width="281" class="alignnone size-full wp-image-1480 image-border" src="assets/848927c1-eff7-4a32-a6ac-2a78ea5dd864.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus file download screen</div>
<ol start="5">
<li>Open a terminal window and enter the following commands:</li>
</ol>
<pre style="padding-left: 60px"><strong>cd ~/Downloads &lt;enter&gt;</strong><br/><strong>dpkg -i Nessus-6.11.1-debian6_amd64.deb &lt;enter&gt;</strong><br/><strong>service nessusd start &lt;enter&gt;</strong></pre>
<ol start="6">
<li>Launch your web browser by clicking the Firefox icon: <img height="34" width="31" src="assets/fdc356e3-473b-4cfe-a6ad-9bdc2eb622b0.png"/></li>
<li>Open the following page: <kbd>https://localhost:8834</kbd><span>. You will be brought to a screen saying where</span> your connection is not secure. <span>Click</span> on <span class="packt_screen">Advanced</span>, <span>select</span> A<span class="packt_screen">dd Exception...</span>, <span>and select</span> <span class="packt_screen">Confirm Security Exception</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="776" width="958" class="alignnone size-full wp-image-1492 image-border" src="assets/fe99ebd3-c451-4a31-b1ba-0f557e1c143e.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Firefox - certificate warning screen</div>
<ol start="8">
<li>From the welcome to Nessus screen, click on <span class="packt_screen">Continue</span>.</li>
<li>You will be asked to create a local account. For our purposes, we will use the username of the admin, s<span>elect and use a good password, and select</span> <span class="packt_screen">Continue</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="743" width="1024" class="alignnone size-full wp-image-1493 image-border" src="assets/90e32ec0-32e7-4f01-92aa-ca257746ca38.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - account setup screen</div>
<ol start="10">
<li>Check your email and enter your <span class="packt_screen">Activation Code</span> <span>and select</span> <span class="packt_screen">Continue</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="251" width="472" class="image-border" src="assets/24076d32-22dd-4818-b164-cfdccde1f396.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - registration screen</div>
<ol start="11">
<li>You will be brought to a Nessus splash screen, and it will begin downloading and initializing other setup functions. </li>
</ol>
<div class="packt_tip"><span>This process will take several minutes to perform so please be </span>patient. While you are waiting for the initialization process to complete, you can go ahead and create a bookmark for Nessus.</div>
<ol start="12">
<li>You will now be brought to the main login screen; enter the username and password previously created and select <span class="packt_screen">Sign In</span>.</li>
<li>Let's validate that Nessus is up to date - from the main screen, select the <span class="packt_screen">Gear</span> icon and click on it.</li>
<li>From the <span class="packt_screen">Scanners</span> <span>menu, select</span> <span class="packt_screen">Software Update</span> <span>and click</span> on <span class="packt_screen">Manual Software Update</span>.</li>
</ol>
<ol start="15">
<li>From the <span class="packt_screen">Manual Software Update</span> <span>screen, select</span> <span class="packt_screen">Update all components</span> <span>and click on <span class="packt_screen">Continue</span></span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="400" width="603" class="alignnone size-full wp-image-904 image-border" src="assets/b19dd406-dce5-408d-83b9-3a55586c8446.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - manual software update screen</div>
<div class="packt_figref packt_infobox">Wait a couple of minutes because when the updates complete, the interface may restart and you may be brought back to a login screen. </div>
<ol start="16">
<li>Ensure <span class="packt_screen">Automatic Updates</span> is enabled, specify <span class="packt_screen">Update Frequency</span>, and click on <span class="packt_screen">Save</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="335" width="511" class="alignnone size-full wp-image-905 image-border" src="assets/37e04685-bac1-4d05-ab46-b02d6bce7043.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - automatic updates screen</div>
<div class="packt_figref packt_tip">To save resources when you are not using Nessus, you can stop the service by closing the browser and selecting <span class="packt_screen">Applications</span> | <span class="packt_screen">Vulnerability Analysis</span> | <span class="packt_screen">Nessus stop</span>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">A basic vulnerability scanning with Nessus</h1>
                </header>
            
            <article>
                
<p>We will perform some basic vulnerability scans against our network to see if they have any known issues or weaknesses with Nessus.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Kali Linux is running and you are logged in as root</li>
<li>Start the Metasploitable virtual machine</li>
<li>Ensure you have completed the setup of Nessus, Nessus is started, and you are at the main screen after logging in</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We will now perform our vulnerability scan using Nessus:</p>
<ol>
<li>Although we already have our targets from previous exercises, we will perform a basic host discovery to start. Select <span class="packt_screen">New Scan</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="28" width="120" class="image-border" src="assets/b0ae0832-5ff8-4578-9e4e-44f283cd6548.png"/></div>
<ol start="2">
<li>From the <span class="packt_screen">Scanner Templates</span> screen, select <span class="packt_screen">Host Discovery</span>.</li>
<li>In the <span class="packt_screen">Name</span> <span>field, add a descriptive name and specify your targets. In this case, we are going to specify our test network of</span> <kbd>192.168.56.0/24</kbd> <span>and select</span> <span class="packt_screen">Save</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="347" width="529" class="alignnone size-full wp-image-906 image-border" src="assets/ea1d2bf7-eb1e-4637-a811-3ec9ab86803f.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - host discovery screen</div>
<ol start="4">
<li>From the <span class="packt_screen">My Scans</span> screen, select the newly created scan and press the launch button on the right. The scan will take a couple of minutes to perform. While it is running, you will see a green circular icon.</li>
</ol>
<div class="packt_tip">While this scan is running, you can create other scans and start them as well. So, you don't have to wait for a scan to finish to move on.</div>
<ol start="5">
<li>Once the scan is complete, you will see a check mark in the scan screen, and you can click on it to review the results. From our results, you will see that a number of hosts are responding:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="333" width="616" class="alignnone size-full wp-image-907 image-border" src="assets/ba3e1287-44bd-42e0-8650-72c358140318.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - host discovery results</div>
<ol start="6">
<li>To perform a basic scan against our Metasploitable VM at <kbd>192.168.56.101</kbd>, we will select <span class="packt_screen">Scans</span> from the top menu, <span class="packt_screen">New Scan</span>, and select <span class="packt_screen">Basic Network Scan</span>.</li>
</ol>
<ol start="7">
<li>In the <span class="packt_screen">Name</span> field, add a descriptive name; and for targets, use the IP of your Metasploitable machine. Click on <span class="packt_screen">Save</span>, <span>then launch the scan:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="440" width="671" class="alignnone size-full wp-image-908 image-border" src="assets/23bed7d7-0edc-4c30-9e78-465b5c925945.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - basic network scan</div>
<ol start="8">
<li>This scan will take several minutes to complete, but once done, we can select the scan to view the results. You will notice we have discovered several vulnerabilities:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="360" width="668" class="alignnone size-full wp-image-909 image-border" src="assets/05d673f3-9464-447b-b1f9-baeb176fc12a.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - basic network scan results</div>
<ol start="9">
<li>To take a closer look, select <span class="packt_screen">Vulnerabilities</span> at the top. From here, you will have a more detailed view of the vulnerabilities in the order of severity. Scroll through the list and take a look at all the data presented:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="449" width="687" class="alignnone size-full wp-image-910 image-border" src="assets/3d2409cc-dfde-4657-a322-ecb84f75ce7a.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - basic scan results - vulnerabilities list</div>
<ol start="10">
<li>Let's click on the VNC server vulnerability to get some <span>more </span>specific information about that vulnerability. This provides us with a lot of information that we can use later to gain remote access to the host:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="432" width="663" class="alignnone size-full wp-image-911 image-border" src="assets/608eb18b-09de-455e-872e-3eda971f6199.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - VNC vulnerability details</div>
<div class="packt_tip">Take some time to go through several of the vulnerabilities, and explore the information provided. Also, try running scans against other devices you have authorization to do so. These could be devices and computers on your personal network or other test hosts you may have installed.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced vulnerability scanning with Nessus</h1>
                </header>
            
            <article>
                
<p>We will now create a more in-depth scan where we will modify some of the parameters of a scan to include other, more targeted testing using Nessus. What we would hope to see is better and more complete results of the target host in question. This will give you a base level of understanding to customize your scans.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Kali Linux is running and you are logged in as root</li>
<li>Start the Metasploitable virtual machine</li>
<li>Ensure you have completed the setup of Nessus, Nessus is started, and you are at the main screen after logging in</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p><span>Let's begin our advanced scanning techniques using Nessus:</span></p>
<ol>
<li>To perform a more advanced scan with Nessus, we will explore several options available to us. Select <span class="packt_screen">Scans</span> from the top. Select <span class="packt_screen">New Scan</span> | <span class="packt_screen">Advanced Scan</span>.<strong> </strong>From our <span class="packt_screen">General</span> screen, add a descriptive name; and target your Metasploitable VM's IP address.</li>
<li>Spend a minute to scroll through the <span class="packt_screen">Basic</span> <span>options on the left. We can perform scheduled scans. We can also provide notifications when the scan is done.</span></li>
<li>Select <span class="packt_screen">Discovery</span> |<strong> </strong><span class="packt_screen">Host Discovery</span>; <span>look through the options available. You will note that we can turn on various discovery methods including scanning for network printers. </span></li>
</ol>
<div class="packt_tip">Since we already know the specific host that we want to scan, we need not select any other options under host discovery. However, if you are doing the subnet scan, these options are useful.</div>
<ol start="4">
<li>Select <span class="packt_screen">Discovery</span> | <span class="packt_screen">Port Scanning</span>, and modify the following options based on the following screenshot:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="532" width="660" class="alignnone size-full wp-image-912 image-border" src="assets/1191e4a2-b720-44c8-9b92-d7974def93f4.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - advanced settings</div>
<ol start="5">
<li>Select <span class="packt_screen">Assesment</span> | <span class="packt_screen">General.</span> Check <span class="packt_screen">Perform thorough tests</span>.</li>
<li>Select <span class="packt_screen">Assesment</span> | <span class="packt_screen">Brute Force</span>.<span> Check both</span> <span class="packt_screen">Oracle Database Tests</span> <span>and</span> <span class="packt_screen">Hydra</span>.</li>
</ol>
<div class="packt_tip">You can add login and password files to target possible or well-known usernames and passwords.</div>
<ol start="7">
<li>Select <span class="packt_screen">Assesment</span> | <span class="packt_screen">Web Applications.</span> Check <span class="packt_screen">Follow dynamically generated pages</span>.</li>
<li>Under <span class="packt_screen">Application Test Settings</span>, <span>match the following options:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="522" width="659" class="alignnone size-full wp-image-913 image-border" src="assets/d71ada90-7fbe-4bd5-8aa3-a155662395dd.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - advanced settings</div>
<ol start="9">
<li>Select <span class="packt_screen">Save</span> at the bottom and launch the scan. This scan will take a long time to complete (about 2 hours). However, once completed, let's review the following result. We will see that we have found incremental information and vulnerabilities regarding the host in question:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="496" width="624" class="alignnone size-full wp-image-914 image-border" src="assets/553507c5-7abe-4dbd-a58d-d6185f381d31.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Nessus - scan results screen</div>
<ol start="10">
<li>Clicking on the results, you will see that we significantly increased the number of high-level vulnerabilities. This again is all useful information that we can use as we move forward to exploiting our targets. </li>
</ol>
<div class="packt_tip packt_infobox">Remember to save and log all the information so that you can use this information as we move forward.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">The installation and configuration of Nexpose</h1>
                </header>
            
            <article>
                
<p>Nexpose is a commercial product by Rapid7. Recently, it appears that it was renamed to InsightVM; and there was an attempt to eliminate the community edition of Nexpose. However, Rapid7 has reconsidered and made the community edition available once again with a 1 year license key.</p>
<p><span>We will install the community edition of Nexpose here.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Take a snapshot of your VM first</li>
<li>Kali Linux is running and you are logged in as root</li>
<li>Disconnect the host-only network and use the NAT network only</li>
</ul>
<div class="packt_tip">The Nexpose installation and operation can be confused with multiple interfaces and multiple connections. For this and all recipes that involve Nexpose we will be doing everything on the NAT network. After you are done with the recipes involving Nexpose, you may want to revert back to a snapshot taken just before installation.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>We will now install and configure Nexpose on our Kali machine:</p>
<ol>
<li>First, we must register on Rapid7's site, obtain a license key, and download the code. Open Firefox by clicking on the icon. <img src="assets/2b7c9b23-3942-40c4-aae5-b4f6cc84aef6.png"/></li>
</ol>
<ol start="2">
<li>Go to the following site, <a href="https://www.rapid7.com/info/nexpose-community/">https://www.rapid7.com/info/nexpose-community/</a><span> and register with your information. You will receive an email within a few minutes with your license key, as well as being able to download the appropriate software. Save the file in the <kbd>Downloads</kbd> directory:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="372" width="560" class="alignnone size-full wp-image-915 image-border" src="assets/22991b1d-f9b2-4d50-8dee-769f1da719e6.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose registration website</div>
<ol start="3">
<li>Now, let's prepare to install Nexpose by opening a terminal window and entering the following commands: <img src="assets/b5782523-62b1-41b9-98ff-c8f56f42b9a7.png"/></li>
</ol>
<pre style="padding-left: 60px"><strong>cd &lt;enter&gt;</strong><br/><strong>cd Downloads &lt;enter&gt;</strong><br/><strong>chmod 770 Rapid7Setup-Linux64.bin &lt;enter&gt;</strong><br/><strong>./Rapid7Setup-linux64.bin &lt;enter&gt;</strong></pre>
<ol start="4">
<li>Once you are presented with the welcome screen, click on <span class="packt_screen">Next</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="402" width="481" class="alignnone size-full wp-image-916 image-border" src="assets/35c1b473-be12-441e-9d33-1383d4285ab4.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose installer screen</div>
<ol start="5">
<li>Select the radio button labeled <span class="packt_screen">Security Console with local Scan Engine</span>. Accept the default destination directory and click on <span class="packt_screen">Next</span>.<strong> </strong>If you receive an error related to insufficient disk space, just click on <span class="packt_screen">Continue</span>.</li>
</ol>
<ol start="6">
<li>On the system settings screen, click on <span class="packt_screen">Next</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="473" width="568" class="alignnone size-full wp-image-917 image-border" src="assets/c52d56da-acf1-4f88-a730-b19fa6ac1806.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose installer screen - settings compare</div>
<ol start="7">
<li class="mce-root">Enter your information on the account details screen, and click on <span class="packt_screen">Next</span>:</li>
</ol>
<div style="color: black;font-size: 1em" class="CDPAlignCenter CDPAlign"><img height="470" width="564" class="alignnone size-full wp-image-918 image-border" src="assets/1168a8bc-84ae-4653-8dea-cdce44f857bf.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose installer screen - user details</div>
<ol start="8">
<li>On the next screen, select <span class="packt_screen">Initialize and start after installation</span> and click on <span class="packt_screen">Next</span>. It will then go through the installation process and when complete you will be presented with the following screen:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="414" width="496" class="alignnone size-full wp-image-919 image-border" src="assets/4395dbfc-23a4-4589-b98f-f8ed22fddf6e.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose installer screen - complete</div>
<ol start="9">
<li>Click on <span class="packt_screen">F</span><span class="packt_screen">inish</span> to close it out. </li>
</ol>
<div class="packt_tip">As it states, it can take several minutes to initialize and start. My recommendation is to let it sit for 30 minutes, and then reboot the VM. Once the VM comes backup, log in and give it a few minutes before attempting to go to the website.</div>
<ol start="10">
<li>Open Firefox by clicking on the icon, <img src="assets/2b7c9b23-3942-40c4-aae5-b4f6cc84aef6.png"/>  and enter the following address in the address bar: <kbd>https://localhost:3780</kbd>. If you are presented with a security screen, click on <span class="packt_screen">Advanced</span> and select <span class="packt_screen">Add Exception</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="453" width="618" class="alignnone size-full wp-image-920 image-border" src="assets/3af8700c-cbe1-4a6f-b05c-fac2935f0ae8.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Firefox security screen</div>
<ol start="11">
<li>Click on <span class="packt_screen">Confirm Security Exception</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="366" width="420" class="alignnone size-full wp-image-921 image-border" src="assets/3a2d364b-4ea8-4df1-9f22-169a24e5b00e.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Firefox security exception screen</div>
<ol start="12">
<li>Once Nexpose has finished installing, you will be brought to the login screen. Use the credentials you provided to log on:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="289" width="259" class="alignnone size-full wp-image-922 image-border" src="assets/88b2844c-b02a-4f05-9f58-cac8de072c1d.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose login screen</div>
<ol start="13">
<li>Almost immediately, you will be brought to the screen asking you to enter your product key. Retrieve the email that was sent containing it. Enter the key and click on <span class="packt_screen">ACTIVATE WITH KEY</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="180" width="387" class="alignnone size-full wp-image-923 image-border" src="assets/ab73c658-540b-4257-b455-824c87a6237c.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose enter product key screen</div>
<ol start="14">
<li>Once the activation is successful, you will receive a confirmation screen:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="79" width="253" class="alignnone size-full wp-image-924 image-border" src="assets/1f18ed4e-e98b-4874-b78d-2083978c54b3.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose activation success screen</div>
<ol start="15">
<li>For now, let's click on the intro screen, and select <span class="packt_screen">Dismiss</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="336" width="401" class="alignnone size-full wp-image-925 image-border" src="assets/e173baf0-f843-46bb-bb0d-4e7858850cdd.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Welcome to the Nexpose screen</div>
<ol start="16">
<li>The updates will automatically install after the startup.</li>
</ol>
<div class="packt_infobox">We suggest moving directly into the next recipe, <em>Basic vulnerability scanning with Nexpose</em>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Basic vulnerability scanning with Nexpose</h1>
                </header>
            
            <article>
                
<p>Now we will use Nexpose to scan our NAT network to give us information regarding vulnerable devices and services. The community edition of Nexpose is limited to 32 IP addresses but otherwise is fully functional.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Kali Linux is running and you are logged in as root</li>
<li>Disconnect the host-only network, and use the NAT network on all VMs</li>
<li>Start Metasploitable and your Windows XP machine with the NAT network connected</li>
</ul>
<div class="packt_tip"><span>The Nexpose installation and operation can be confused with multiple interfaces and multiple connections. </span>For this and all recipes that involve Nexpose we will be doing everything on the NAT network. After you are done with the recipes involving Nexpose, you may want to revert back to a snapshot taken just before installation.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>Using Nexpose we will now perform a basic vulnerability scan:</p>
<ol>
<li>Open Firefox by clicking on the icon <img src="assets/7a8cc37d-b035-4433-8fca-323742eefb24.png"/> and browse to <kbd>https://localhost:3780</kbd>.</li>
<li>Log in with the credentials you used earlier.</li>
<li>Click on the <span class="packt_screen">Assets</span> button on the left and click on <span class="packt_screen">CREATE SITE</span>.</li>
</ol>
<ol start="4">
<li>Name your site as you wish; in my case, it is <kbd>Lab</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="419" width="685" class="alignnone size-full wp-image-926 image-border" src="assets/31b6d1b8-5a05-4e07-8ec1-ada758e05578.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose site creation</div>
<ol start="5">
<li>Next, click on <span class="packt_screen">ASSETS</span> at the top; and add your machines IP addresses into the network; in my case, the Metasploitable VM is <kbd>10.0.2.5</kbd> and the Windows XP VM is <kbd>10.0.2.6</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="381" width="622" class="alignnone size-full wp-image-929 image-border" src="assets/9439df38-9966-4d1a-85f4-79ce4258d824.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose asset screen</div>
<ol start="6">
<li>Now, click on <span class="packt_screen">TEMPLATES</span>,<strong> </strong>and you will notice a variety of scanning templates that you can use. We are going to use the default, which is <span class="packt_screen">Full audit without Web Spider</span>. Take a minute to read through the scanning templates available:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="398" width="649" class="alignnone size-full wp-image-930 image-border" src="assets/9eeaf3fa-c6e0-4682-854b-12451a987eba.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose template screen</div>
<ol start="7">
<li>Now, select <span class="packt_screen">SAVE &amp; SCAN</span> from the top right, when asked to validate, feel free to check <span class="packt_screen">Don't show this alert again</span>,<strong> </strong>and select the <span class="packt_screen">SAVE &amp; SCAN</span> button:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="366" width="593" class="alignnone size-full wp-image-931 image-border" src="assets/2e3818dd-1713-4dc5-b088-2f2994a33c30.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose site save and scan confirmation screen</div>
<ol start="8">
<li>You can monitor the scan progress and watch for <span class="packt_screen">Completed Successfully</span> in the <span class="packt_screen">Scan Status</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="412" width="672" class="alignnone size-full wp-image-932 image-border" src="assets/86373070-6326-4a88-a17a-c6cc1e72d3f9.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose scan status screen</div>
<ol start="9">
<li>If you scroll down, you will see the identified hosts, IP addresses, operating system, and most importantly, a count of vulnerabilities:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="400" width="652" class="alignnone size-full wp-image-933 image-border" src="assets/a05f8365-2082-492a-8c00-a648b10ac62a.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose device list</div>
<ol start="10">
<li>Let's click on the Metasploitable machine and see what information has been collected. You will notice various pieces of information as well as <span class="packt_screen">Risk Score</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="375" width="613" class="alignnone size-full wp-image-934 image-border" src="assets/f58aaf6f-d742-4aa5-b9ce-d623b96cc838.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose host detail information</div>
<ol start="11">
<li>Continue to scroll down; and you will see a list of vulnerabilities, services, installed software, fingerprints, and users:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="398" width="650" class="alignnone size-full wp-image-935 image-border" src="assets/9eb6fec7-f841-4aed-b797-087f56f067d4.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose host vulnerability information</div>
<ol start="12">
<li>Click on one of the vulnerabilities to gather more information about it:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="405" width="662" class="alignnone size-full wp-image-936 image-border" src="assets/543b55de-10be-429f-bc3b-553290e3f4ab.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose host vulnerability detail information</div>
<ol start="13">
<li>Scroll down the list; and you will see information on the remediation steps, which can provide you crucial information on how to exploit the vulnerability.</li>
<li>Continue to explore the interface, and when done, return to the home screen by clicking on the home button on the left. <img style="font-size: 1em" height="31" width="32" class="alignnone size-full wp-image-803" src="assets/53d7fde5-56b7-491d-9408-65e22817da9b.png"/></li>
</ol>
<div class="packt_infobox"><span>We suggest moving directly into the next r</span>ecipe, Advanced vulnerability scanning with Nexpose.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Advanced vulnerability scanning with Nexpose</h1>
                </header>
            
            <article>
                
<p>Now, we will use Nexpose to perform a more advanced and in-depth scan of our NAT network. We will use Nexpose in a more aggressive fashion against our target machines.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Let's ensure the following prerequisites:</p>
<ul>
<li>Kali Linux is running and you are logged in as root</li>
<li>Disconnect the host-only network, and use the NAT network on all VMs</li>
<li>Start Metasploitable and your Windows XP machine with the NAT network connected</li>
</ul>
<div class="packt_tip"><span>The Nexpose installation and operation can be confused with multiple interfaces and multiple connections. </span>For this and all recipes that involve Nexpose we will be doing everything on the NAT network. After you are done with the recipes involving Nexpose, you may want to revert back to a snapshot taken just before installation.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>Let's begin our advanced scanning techniques using Nexpose:</p>
<ol>
<li>Open Firefox by clicking on the icon <img src="assets/0d204cbb-0e2e-4240-b6bb-cb1da8686f5f.png"/> and browse to <kbd>https://localhost:3780</kbd>.</li>
<li>Log in with the credentials you used earlier.</li>
<li>Scroll down to the <span class="packt_screen">SITES</span> section, and click on the <span class="packt_screen">Lab</span> s<span>ite.</span></li>
<li>Click on <span class="packt_screen">TEMPLATES</span> <span>at the top; and scroll down to select the radio button for</span> <span class="packt_screen">Penetration Test</span><span>. Then, click</span> on <span class="packt_screen">SAVE &amp; SCAN</span> <span>at the top:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="404" width="660" class="alignnone size-full wp-image-939 image-border" src="assets/122d45c8-adad-452f-b536-5e0408f8c8e5.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose site template screen</div>
<ol start="5">
<li>Once the scan is complete, you will notice that we have found a larger number of vulnerabilities than what the original scan produced. Before we continue, we are going to add some additional information to our site and scan again.</li>
<li>Return to the home screen by clicking on the home button on the left. <img style="font-size: 1em" height="31" width="32" class="alignnone size-full wp-image-803 image-border" src="assets/17510e71-d105-4cf5-9396-99107d9ea965.png"/></li>
<li>Scroll down to the <span class="packt_screen">SITES</span> section, and click on the <span class="packt_screen">Lab</span><span> site.</span></li>
</ol>
<ol start="8">
<li>Now, click on <span class="packt_screen">AUTHENTICATION</span> <span>at the top. On the left, select</span> <span class="packt_screen">ADD CREDENTIALS</span><strong> </strong><span>and enter</span> <kbd>msfadmin</kbd> <span>for the name; and click</span> on <span class="packt_screen">CREATE</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="348" width="566" class="alignnone size-full wp-image-940 image-border" src="assets/8517be39-8d14-4fb9-b243-8dc6353fd79d.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose add credential screen</div>
<ol start="9">
<li>Now, select <span class="packt_screen">ACCOUNT</span> on the left and add the following information:</li>
</ol>
<ul>
<li style="list-style-type: none">
<ul>
<li><span class="packt_screen">Service</span>: <span class="packt_screen">Secure Shell (SSH)</span></li>
<li><span class="packt_screen">Credential Management</span>: <span class="packt_screen">Nexpose</span></li>
<li><span class="packt_screen">User Name</span>: <kbd>msfadmin</kbd></li>
<li><span class="packt_screen">Password</span>: <kbd>msfadmin</kbd></li>
<li><span class="packt_screen">Confirm Password</span>: <kbd>msfadmin</kbd></li>
<li><span class="packt_screen">Permission Elevation Type</span>: <kbd>sudo</kbd></li>
<li><span class="packt_screen">Permission Elevation User</span>: <kbd><kbd>msfadmin</kbd></kbd></li>
<li><span class="packt_screen">Permission Elevation Password</span>: <kbd>msfadmin</kbd></li>
<li><span class="packt_screen">Confirm Permission Elevation Password</span>: <kbd>msfadmin</kbd></li>
</ul>
</li>
</ul>
<div class="CDPAlignCenter CDPAlign"><img height="398" width="652" class="alignnone size-full wp-image-941 image-border" src="assets/fd6c16cd-b179-4fd3-85a7-0895043804ad.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose account information</div>
<ol start="10">
<li>Now, select <span><span class="packt_screen">CREATE</span></span>.</li>
</ol>
<ol start="11">
<li>Select <span class="packt_screen">TEMPLATES</span> at the top, select <span class="packt_screen">Exhaustive</span>,<strong> </strong><span>and select</span> <span class="packt_screen">SAVE &amp; SCAN</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="428" width="698" class="alignnone size-full wp-image-942 image-border" src="assets/73b0da1b-84f8-443f-9fb5-e3ec2672f990.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign"><span>The </span>Nexpose templates screen</div>
<div class="packt_infobox">This scan can take some time, so please be patient.</div>
<ol start="12">
<li>Once the scan is complete, scroll down to <span class="packt_screen">COMPLETED ASSETS</span>, and click on the Metasploitable machine.</li>
</ol>
<ol start="13">
<li>You can now scroll down to <span class="packt_screen">VULNERABILITIES</span>,<strong> </strong><span>and again see a larger list of vulnerabilities. Spend some time scrolling through the interface and looking at the vulnerabilities found:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img height="480" width="638" class="alignnone size-full wp-image-943 image-border" src="assets/d97163d8-92c6-4b37-b6ff-1c9de31e9ba3.png"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">The Nexpose host vulnerability information</div>


            </article>

            
        </section>
    </body></html>