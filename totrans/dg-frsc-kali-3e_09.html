<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer164">
<h1 class="chapter-number" id="_idParaDest-95"><a id="_idTextAnchor120"/>7</h1>
<h1 id="_idParaDest-96"><a id="_idTextAnchor121"/>Incident Response, Data Acquisitions, and DFIR Frameworks</h1>
<p>Sometimes, it’s difficult to ascertain exactly what qualifies as evidence, especially at the very start of an investigation when all the facts on what occurred may not have yet been collected or stated. As in any investigation, we should be aware of and follow the guidelines, practices, and procedures for acquiring evidence in such a way that it is not tampered with or, in a worst-case <span class="No-Break">scenario, lost.</span></p>
<p>At the scene of a crime, let’s say a shooting, there are specific items that may immediately qualify as evidence. The physical evidence is easily collected, put into evidence bags, labeled, and then shipped off to the labs and secure storage areas for safekeeping. This evidence may include spent bullet casings, perhaps a gun, fingerprints, and blood samples. Let’s not forget witness statements and <strong class="bold">Closed Circuit Television</strong> (<strong class="bold">CCTV</strong>) footage too. It’s also of interest to consider the individuals from law enforcement agencies that would be at the scene and the order in which they may have arrived. Seems <span class="No-Break">simple enough.</span></p>
<p>However, when a breach or crime involving a computer or smart device is reported, collecting the evidence is sometimes not as simple, as there are many factors to consider before labeling any items <span class="No-Break">as evidence.</span></p>
<p>For example, if a desktop was involved in the act, do we take the tower alone, or do we also seize the monitor, keyboard, mouse, and speakers? What about the other peripherals such as printers and scanners? Are there any additional fixed or removable storage media at the scene, and do we also <span class="No-Break">seize them?</span></p>
<p>This chapter answers all these questions and provides guidelines and best practices for incident response, evidence acquisition, and other topics, including <span class="No-Break">the following:</span></p>
<ul>
<li>Evidence <span class="No-Break">acquisition procedures</span></li>
<li>Incident response and <span class="No-Break">first responders</span></li>
<li>Evidence collection <span class="No-Break">and documentation</span></li>
<li>Live versus <span class="No-Break">post-mortem acquisition</span></li>
<li>The <strong class="bold">Chain of </strong><span class="No-Break"><strong class="bold">Custody</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">CoC</strong></span><span class="No-Break">)</span></li>
<li>The importance of <span class="No-Break">write blockers</span></li>
<li>Data imaging and maintaining <span class="No-Break">evidence integrity</span></li>
<li>Data acquisition best practices, guidelines, and <span class="No-Break">DFIR frameworks</span></li>
</ul>
<h1 id="_idParaDest-97"><a id="_idTextAnchor122"/>Evidence acquisition procedures</h1>
<p>As we covered in<a id="_idIndexMarker585"/> the last chapter, data can be stored on both fixed and removable storage media. However, data can easily be deleted or completely lost depending on a multitude of factors that must be considered if we are to ensure the preservation of data. It might even be argued that there are more threats to digital storage than paper-based storage. The following lists detail some comparisons of threats <span class="No-Break">to both.</span></p>
<p>Threats to paper-based <a id="_idIndexMarker586"/>storage include <span class="No-Break">the following:</span></p>
<ul>
<li><span class="No-Break">Water</span></li>
<li>Fire and <span class="No-Break">humidity bugs</span></li>
<li><span class="No-Break">Age</span></li>
<li>Natural disasters—floods, earthquakes, tornadoes, hurricanes, <span class="No-Break">and more</span></li>
<li>Human-error <span class="No-Break">and negligence</span></li>
</ul>
<p>Threats to data <a id="_idIndexMarker587"/>on storage media include <span class="No-Break">the followin<a id="_idTextAnchor123"/>g:</span></p>
<ul>
<li>Human-error <span class="No-Break">and negligence</span></li>
<li>Magnetism and <span class="No-Break">electromagnetic fields</span></li>
<li>Water <span class="No-Break">and condensation</span></li>
<li><span class="No-Break">Heat dust</span></li>
<li><span class="No-Break">Impact Voltage</span></li>
<li><span class="No-Break">Static electricity</span></li>
<li>Natural disasters—floods, earthquakes, tornadoes, hurricanes, <span class="No-Break">and more</span></li>
</ul>
<p>So, when exactly does data become evidence? Specific data might have a value that is relative to an investigation when considering the events that transpired. This should be considered when <a id="_idIndexMarker588"/>performing DFIR as the scope might then extend beyond just devices and storage media, as we will discuss further in <span class="No-Break">this chapter.</span></p>
<p>Let’s move on to incident response and the technical roles assumed by <span class="No-Break">first responders.</span></p>
<h1 id="_idParaDest-98"><a id="_idTextAnchor124"/>Incident response and first responders</h1>
<p>Preserving<a id="_idIndexMarker589"/> evidence <a id="_idIndexMarker590"/>does not begin only at the acquisition of data, but as early on as the physical viewing of the suspect device. There should be some structured response to the suspected crime or breach in the same manner as a crime reported to the police. In the same way, a person makes a call to the emergency services who then dispatch the police, fire services, ambulance personnel, and other first responders who might then escalate the issue to the FBI or other agencies. There should also be a similar chain of command when dealing with reports that require <span class="No-Break">digital investigation.</span></p>
<p>When a breach or crime is discovered or suspected, there should be a dedicated first responder who is alerted and called to the scene. Usually, this person has some knowledge or understanding of the workings of devices, networks, and even of the IT infrastructure in the organization <span class="No-Break">if applicable.</span></p>
<p>First responder personnel can include <span class="No-Break">the following:</span></p>
<ul>
<li>HelpDesk and <span class="No-Break">IT technicians</span></li>
<li><span class="No-Break">Systems administrators</span></li>
<li><span class="No-Break">Network administrators</span></li>
<li><span class="No-Break">Security administrators</span></li>
<li>IT managers <span class="No-Break">and directors</span></li>
</ul>
<p>While the individuals in the preceding roles might not be trained or skilled in digital forensics or digital investigations, they will be responsible for securing the scene and ensuring that the data, peripherals, equipment, and storage are not used, tampered with, removed, or compromised by <span class="No-Break">unauthorized individuals.</span></p>
<p>The duties of first responders include <span class="No-Break">the following:</span></p>
<ul>
<li>Being the first to respond to the scene (as the name suggests) and making an <span class="No-Break">initial assessment</span></li>
<li>Documenting the scene and room fully in a circular fashion using the center of the room as a <span class="No-Break">focal point</span></li>
<li>Securing the scene by not allowing unauthorized users or suspects, access to the devices or area, and especially to volatile data and <span class="No-Break">storage media</span></li>
<li>Preserving <a id="_idIndexMarker591"/>and<a id="_idIndexMarker592"/> packaging evidence for transportation, ensuring the use of the<strong class="bold"> </strong>CoC forms that allow for tracing the exchange of evidence <span class="No-Break">between persons</span></li>
</ul>
<p>Now, let’s look at examples of evidence, its collection, <span class="No-Break">and documentation.</span></p>
<h1 id="_idParaDest-99"><a id="_idTextAnchor125"/>Evidence collection and documentation</h1>
<p>The documentation <a id="_idIndexMarker593"/>of the scene should also be performed by the first responders to aid in investigations. The documentation of the scene should include photographs, video, voice recording, and manual documentation of <span class="No-Break">the following:</span></p>
<ul>
<li>The room that the device is located in (desk, ceiling, entrance/exit, windows, lighting, electrical outlets, and <span class="No-Break">data drops)</span></li>
<li>State of the device (on, off, power <span class="No-Break">light blinking)</span></li>
<li>Screen contents, if the device is on (operating system, running programs, date and time, wired and/or wireless <span class="No-Break">network connectivity)</span></li>
<li>Books, notes, or pieces <span class="No-Break">of paper</span></li>
<li>Connected and <span class="No-Break">disconnected cables</span></li>
<li>Peripherals such as printers, scanners, and external drives in close proximity (whether connected <span class="No-Break">or not)</span></li>
</ul>
<p>Once the scene has been secured and documented by the first responders, the forensic investigator should also be alerted and called in to further examine and assess <span class="No-Break">the situation.</span></p>
<p>If the first responder has been trained in evidence collection and preservation, they can also begin the process<a id="_idIndexMarker594"/> of acquiring what can be considered <span class="No-Break">physical evidence.</span></p>
<p>Examples of physical<a id="_idIndexMarker595"/> evidence include <span class="No-Break">the following:</span></p>
<ul>
<li>Desktops and <span class="No-Break">computer towers</span></li>
<li><span class="No-Break">Laptops</span></li>
<li><span class="No-Break">Tablets</span></li>
<li><span class="No-Break">Smartphones</span></li>
<li><span class="No-Break">IoT devices</span></li>
<li>General <span class="No-Break">smart devices</span></li>
<li>Fixed and removable <span class="No-Break">storage media:</span><ul><li><span class="No-Break">Hard drives</span></li><li><span class="No-Break">Optical media</span></li><li><span class="No-Break">Tape storage</span></li><li><span class="No-Break">Memory cards</span></li><li><span class="No-Break">Card readers</span></li><li><span class="No-Break">Adapters</span></li><li><span class="No-Break">Docking stations</span></li><li><span class="No-Break">Printers</span></li><li><span class="No-Break">Scanners</span></li><li><span class="No-Break">Mobile phones</span></li><li> <span class="No-Break">iPods</span></li></ul></li>
</ul>
<p>Media and MP3 players and other devices that might have been used in carrying out the breach. Routers and switches might also contain evidence such as connectivity logs, source, and destination addresses, and even <span class="No-Break">visited websites.</span></p>
<ul>
<li>Cables <span class="No-Break">and chargers</span></li>
</ul>
<p>Here’s a budget but portable and very well-organized screwdriver kit that I keep in my DFIR first responder toolkit. It has all the attachments for opening desktops, laptops, and tablets, and also for removing and even opening removable storage media such as hard disk drives, optical <a id="_idIndexMarker596"/>drives, and even floppy drives <span class="No-Break">if encountered:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer156">
<img alt="Figure 7.1 – Toolkit with various tips for opening devices and drives" height="778" src="image/Figure_7.01_B19441.jpg" width="583"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.1 – Toolkit with various tips for opening devices and drives</p>
<h2 id="_idParaDest-100"><a id="_idTextAnchor126"/>Physical acquisition tools</h2>
<p>Apart from <a id="_idIndexMarker597"/>your <a id="_idIndexMarker598"/>toolkit such as the one shown earlier, what other tools would we need for the forensic acquisition and extraction of digital evidence? Remember when we covered the different types of storage media back in <a href="B19441_06.xhtml#_idTextAnchor093"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Understanding File Systems and Storage</em>? We saw that many of them had their own connectors of <span class="No-Break">various sizes.</span></p>
<p>Here’s a list of just some of the equipment required when performing <span class="No-Break">evidence acquisitions:</span></p>
<ul>
<li>Write blockers (these can be hardware- <span class="No-Break">and/or software-based)</span></li>
<li>Card readers (preferably <span class="No-Break">USB 3)</span></li>
<li>Various adapters (USB to SATA and EIDE, USB to various types of USB, and VGA <span class="No-Break">to HDMI)</span></li>
<li>Device cables such as power, SATA, EIDE, HDMI, <span class="No-Break">and VGA</span></li>
<li>Networking cables straight-through, crossover, <span class="No-Break">and console</span></li>
</ul>
<p>The following <a id="_idIndexMarker599"/>photograph shows a collection of various<a id="_idIndexMarker600"/> USB adapters, all costing under $10, and they are all available <span class="No-Break">on Amazon:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer157">
<img alt="Figure 7.2 – Various USB adapters" height="575" src="image/Figure_7.02_B19441.jpg" width="788"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.2 – Various USB adapters</p>
<p>For laptop drives, I also <a id="_idIndexMarker601"/>use a <strong class="bold">Serial Advanced Technology Attachment </strong>(<strong class="bold">SATA</strong>) to USB 3.0 adapter, as shown in the following photograph. This device is also self-powered and comes with a removable power adapter so that it can be used to power full-sized hard drives, DVDs, and Blu-ray drives with <span class="No-Break">SATA connectors:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer158">
<img alt="Figure 7.3 – USB 3.0 to SATA self-powered adapter for both 2.5-inch and 3.5-inch drives" height="593" src="image/Figure_7.03_B19441.jpg" width="524"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.3 – USB 3.0 to SATA self-powered adapter for both 2.5-inch and 3.5-inch drives</p>
<p>For connecting to <a id="_idIndexMarker602"/>routers and switches, console <a id="_idIndexMarker603"/>cables and serial to USB cables can also be included in your kit, like the ones <span class="No-Break">shown here:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer159">
<img alt="Figure 7.4 – Serial to JJ-45 (left) and Serial to USB (right) cables" height="825" src="image/Figure_7.04_B19441_.jpg" width="681"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.4 – Serial to JJ-45 (left) and Serial to USB (right) cables</p>
<p>All mobile devices including phones and tablets can also connect to laptops and desktops via USB ports. The following photograph shows an OTG cable, which can connect a USB device to phones or tablets with <span class="No-Break">OTG capabilities:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer160">
<img alt="Figure 7.5 – OTG (on-the-go) cable" height="654" src="image/Figure_7.05_B19441.jpg" width="1066"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.5 – OTG (on-the-go) cable</p>
<p>Here is a list of <a id="_idIndexMarker604"/>guidelines for physical collection <a id="_idIndexMarker605"/><span class="No-Break">and preservation:</span></p>
<ul>
<li>Label all cables <span class="No-Break">and connectors</span></li>
<li>Use labeled evidence collection bags <span class="No-Break">as needed</span></li>
<li>Special stronghold bags might have to be used when storing devices with wireless and radio capabilities, preventing communication with <span class="No-Break">other devices</span></li>
<li>Store sensitive equipment such as hard drives and flash drives in anti-static bags and <span class="No-Break">protective casings</span></li>
<li>Label containers used for storage <span class="No-Break">during transportation</span></li>
<li>Maintain the CoC forms when passing evidence from one person/handler to another (discussed later in <span class="No-Break">this chapter)</span></li>
</ul>
<p>Now, let’s move on to understanding the order of volatility when collecting evidence and also comparing live versus <span class="No-Break">post-mortem acquisitions.</span></p>
<h1 id="_idParaDest-101"><a id="_idTextAnchor127"/>Live versus post-mortem acquisition</h1>
<p>In this section, we’ll look<a id="_idIndexMarker606"/> at the different<a id="_idIndexMarker607"/> procedures for live and post-mortem evidence acquisition. However, before we begin,  first, we must understand the <strong class="bold">o</strong><strong class="bold">rder </strong><span class="No-Break"><strong class="bold">of volatility</strong></span><span class="No-Break">.</span></p>
<h2 id="_idParaDest-102"><a id="_idTextAnchor128"/>Order of volatility</h2>
<p>When collecting evidence, we<a id="_idIndexMarker608"/> should keep in mind the volatility of data. As mentioned earlier in this chapter, data can be easily lost or destroyed. As such, when collecting data, a well-documented and common best practice is to collect evidence in the order of most volatile to the least volatile <span class="No-Break">if possible.</span></p>
<p>The <strong class="bold">Scientific Working Group on Digital Evidence</strong> (<strong class="bold">SWGDE</strong>) capture live systems <a id="_idIndexMarker609"/>document and lists the order of volatility from most to least volatile and crucial, <span class="No-Break">as follows:</span></p>
<ul>
<li><span class="No-Break">RAM</span></li>
<li><span class="No-Break">Running processes</span></li>
<li>Active <span class="No-Break">network connections</span></li>
<li><span class="No-Break">System settings</span></li>
<li><span class="No-Break">Storage media</span></li>
</ul>
<h2 id="_idParaDest-103"><a id="_idTextAnchor129"/>Powered-on versus powered-off device acquisition</h2>
<p>When<a id="_idIndexMarker610"/> investigating<a id="_idIndexMarker611"/> devices that are powered on and powered off, special consideration must be given to the volatility of data. Booting, rebooting, or shut<a id="_idTextAnchor130"/>ting down a device can cause data to be written to the hard drive or even lost within RAM<a id="_idTextAnchor131"/> and the <span class="No-Break">paging file.</span></p>
<h3>Powered-on devices</h3>
<p>When investigating a <a id="_idIndexMarker612"/>powered-on device, the following precautions should <span class="No-Break">be taken:</span></p>
<ul>
<li>Move the mouse or glide your fingers across the touchpad if you suspect the device might be in a <em class="italic">sleep</em> state. Do not click on the buttons as this might open or close programs <span class="No-Break">and processes.</span></li>
<li>Photograph and record the screen and all visible programs, data, time, and <span class="No-Break">desktop items.</span></li>
<li>Unplug the power cord on desktops and remove the battery, if possible, <span class="No-Break">on portables.</span></li>
</ul>
<p>It is of utmost importance that data stored in RAM and paging files be collected with as little modification to the data as possible. More on this will be covered in <a href="B19441_08.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>,  <em class="italic">Evidence Acquisition Tools</em>, using imaging tools such as FTK Imager and Belkasoft <span class="No-Break">RAM Capturer.</span></p>
<p>There are quite a few reasons for imaging and acquiring RAM. As mentioned in the previous chapter, data that might have been encrypted by the user could be stored in an unencrypted state of RAM. Logged-in users, opened programs, accessed files, and running processes can all be extracted and analyzed if the RAM and paging files <span class="No-Break">are analyzed.</span></p>
<p>However, if the device is switched off or rebooted, this data and evidence can easily <span class="No-Break">be lost.</span></p>
<p>For powered-on <a id="_idIndexMarker613"/>portable and powered-on devices, the battery should be removed, if possible. However, some devices might not have a removable battery. In these cases, the power button should be held down for 30 to 40 seconds, which forces the device to <span class="No-Break">power off.</span></p>
<h3>Powered-off devices</h3>
<p>Powered-off devices<a id="_idIndexMarker614"/> should never be turned on unless done so by the forensic investigator. Special steps must be taken to ensure that existing data is not erased and that new data is <span class="No-Break">not written.</span></p>
<p>Often, devices can seem as if they are off, but they can be in a sleep or hibernate state. As a simple test, the mouse can be moved and monitors (if any) can be switched on to determine whether they are in fact in either of those states. Even if they are in an off state, you should still photograph the screen <span class="No-Break">and ports.</span></p>
<p>When investigating portable and mobile devices in an already off state, it is suggested that the battery is removed (if possible) and placed in an evidence bag to ensure that there will be no accidental way to turn the device on once unplugged. According <span class="No-Break">to the</span></p>
<p><strong class="bold">NIST.SP.800-101r1—Guidelines on Mobile Forensics</strong>, it should be<a id="_idTextAnchor132"/> noted that removing the battery can alter contents in volatile memory, even when in an <span class="No-Break">off state.</span></p>
<p>Now that we understand the importance of taking note of the state of the device from which evidence must <a id="_idIndexMarker615"/>be acquired, let’s look at the CoC form, which adds another layer of <span class="No-Break">evidence integrity.</span></p>
<h1 id="_idParaDest-104"><a id="_idTextAnchor133"/>The CoC</h1>
<p>The <strong class="bold">CoC</strong> is a form that<a id="_idIndexMarker616"/> legally ensures the integrity of evidence as it is exchanged between individuals, and so it also provides a level of accountability as personal identification is required when completing the forms. This form gives an exact log and account of the transportation and exchange between parties, from a collection at the scene to a presentation in <span class="No-Break">a court.</span></p>
<p> Some of the <a id="_idIndexMarker617"/>typical fields on the CoC form are listed <span class="No-Break">as follows:</span></p>
<ul>
<li><span class="No-Break">Case number</span></li>
<li>Victim and <span class="No-Break">suspect names</span></li>
<li>Date and <span class="No-Break">time seized:</span><ul><li>Location <span class="No-Break">when seized</span></li><li><span class="No-Break">Item number</span></li><li>Description <span class="No-Break">of item</span></li><li>Signatures and IDs of individuals releasing and receiving <span class="No-Break">the evidence</span></li></ul></li>
<li>Authorization <span class="No-Break">for disposal</span></li>
<li>Witness to the destruction <span class="No-Break">of evidence</span></li>
<li>Release (of evidence) to the <span class="No-Break">lawful owner</span></li>
</ul>
<p>The sample CoC form can be downloaded directly <a id="_idIndexMarker618"/>from<a id="_idIndexMarker619"/> the <strong class="bold">National Institute of Standards and </strong><span class="No-Break"><strong class="bold">Technology</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">NIST</strong></span><span class="No-Break">):</span></p>
<p><a href="https://www.nist.gov/document/sample-chain-custody-formdocx"><span class="No-Break">https://www.nist.gov/document/sample-chain-custody-formdocx</span></a></p>
<p>I urge you to download<a id="_idIndexMarker620"/> the preceding form as you might need it when working on DFIR investigations. Now, let’s look at the importance of write blockers when acquiring data to preserve the integrity of <span class="No-Break">the evidence.</span></p>
<h1 id="_idParaDest-105"><a id="_idTextAnchor134"/>The importance of write blockers</h1>
<p>Once our physical evidence<a id="_idIndexMarker621"/> has been properly documented and <a id="_idIndexMarker622"/>collected, we can begin the forensic acquisition of digital evidence. I’ll mention this a couple of times to drive the point home, but the original evidence should only be used to create forensic copies or images, which will be discussed later in this chapter and again in <span class="No-Break">other chapters.</span></p>
<p>Examination and analysis should only be performed on forensic copies/images of the data and <em class="italic">not</em> on the original data or evidence, as working on original evidence can, and usually will, modify the contents of the medium. For instance, booting a seized laptop into its native operating system will allow data to be written to the hard drive and may also erase and modify contents contained in the RAM and <span class="No-Break">paging file.</span></p>
<p>To prevent this from happening, the use of a write blocker must be employed. Write blockers, as the name suggests, prevent data from being written to the evidence media. Write blockers can be found in both hardware and software types. If a hardware write blocker is not available, software versions are readily available as standalone features in forensic operating systems including C.A.I.N.E, as mentioned in <a href="B19441_02.xhtml#_idTextAnchor024"><span class="No-Break"><em class="italic">Chapter 2</em></span></a>, <em class="italic">Introduction to Digital Forensics</em>, and also as a part of some commercial and open-source tools such as EnCase <span class="No-Break">and Autopsy.</span></p>
<p>Again, it is of high importance that a write blocker is used in investigations to protect and preserve the original evidence from being modified. The following photograph shows a cheap and efficient portable SATA and IDE adapter with write-blocking switches, used in drive acquisition <span class="No-Break">and recovery:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer161">
<img alt="Figure 7.6 – USB to SATA and IDE write-blocker device" height="859" src="image/Figure_7.06_B19441_.jpg" width="1017"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.6 – USB to SATA and IDE write-blocker device</p>
<p>Now that we are familiar with the purpose and importance of write blockers, let’s learn about data<a id="_idIndexMarker623"/> imaging <a id="_idIndexMarker624"/>and evidence <span class="No-Break">integrity algorithms.</span></p>
<h1 id="_idParaDest-106"><a id="_idTextAnchor135"/>Data imaging and maintaining evidence integrity</h1>
<p><strong class="bold">Imaging</strong> refers to<a id="_idIndexMarker625"/> the exact<a id="_idIndexMarker626"/> copying of data either as a file, folder, partition, or entire storage media or drive. When doing a regular copy of files and folders, not all files may be copied based on their attributes being set to the system or even hidden. To prevent files from being left out, we perform a special type of copy where every bit is copied or imaged exactly as it is on the current medium as if taking a picture or snapshot of <span class="No-Break">the data.</span></p>
<p>Creating a copy of each bit<a id="_idIndexMarker627"/> of data exactly as is, is referred to as a <strong class="bold">physical or forensic image</strong>. Performing a <strong class="bold">bitstream copy</strong> ensures the integrity of the <a id="_idIndexMarker628"/>copy. To further prove this, hashing of the original evidence and the physical image is calculated and compared (which we will delve into shortly). If the forensic copy is off by even one bit of data, the hash values created by the respective algorithms will be <span class="No-Break">quite different.</span></p>
<p class="callout-heading"> Tip</p>
<p class="callout">The original evidence should only be handled by qualified and authorized professionals and should also only be used to create forensically sound physical images. The original evid<a id="_idTextAnchor136"/>ence should otherwise never be used as this compromises evidence integrity and <span class="No-Break">the investigation.</span></p>
<h2 id="_idParaDest-107"><a id="_idTextAnchor137"/>Message Digest (MD5) hash</h2>
<p>Hash values are <a id="_idIndexMarker629"/>produced by specific algorithms and are used to verify the integrity of the evidence by proving that the data was not modified. Hash values can be thought of as digital fingerprints in that they are unique and play a major role in the identification of evidence and <span class="No-Break">physical images.</span></p>
<p>One such algorithm, although older and now mainly used to verify the authenticity of downloads from the internet, is the <strong class="bold">Message Digest</strong> (<strong class="bold">MD5</strong>) cryptographic hashing algorithm, which produces a 128-bit hexadecimal <span class="No-Break">output value.</span></p>
<p>For a working example, let’s open a browser and head over <span class="No-Break">to </span><a href="http://passwordsgenerator.net/md5-hash-generator/"><span class="No-Break">http://passwordsgenerator.net/md5-hash-generator/</span></a><span class="No-Break">.</span></p>
<p>This site creates hashes of words and sentences as strings. For this example, I’ve entered the <strong class="source-inline">Digital Forensics with Kali Linux</strong> string without the parentheses. The MD5 value automatically calculated was displayed as <strong class="bold">7E9506C4D9DD85220FB3DF671F09DA35</strong>, as shown in the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer162">
<img alt="Figure 7.7 – MD5 hash generator results" height="357" src="image/Figure_7.07_B19441.jpg" width="750"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.7 – MD5 hash generator results</p>
<p>By removing <strong class="source-inline">K</strong> from <strong class="source-inline">Kali</strong>, from the same string that now reads <strong class="source-inline">Digital Forensics with ali Linux</strong>, the MD5 now reads <strong class="bold">7A4C7AA85B114E91F247779D6A0B3022</strong>, as shown in the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer163">
<img alt="Figure 7.8 – Edited MD5 generator results" height="332" src="image/Figure_7.08_B19441.jpg" width="749"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.8 – Edited MD5 generator results</p>
<p>As a quick comparison, we can see that just removing <strong class="source-inline">K</strong> from <strong class="source-inline">Kali</strong> yields a noticeably <span class="No-Break">different result:</span></p>
<ul>
<li><strong class="source-inline">Digital Forensics with </strong><span class="No-Break"><strong class="source-inline">Kali Linux</strong></span><span class="No-Break">:</span></li>
</ul>
<p><span class="No-Break"><strong class="bold">7E9506C4D9DD85220FB3DF671F09DA35</strong></span></p>
<ul>
<li><strong class="source-inline">Digital Forensics with </strong><span class="No-Break"><strong class="source-inline">ali Linux</strong></span><span class="No-Break">:</span></li>
</ul>
<p><span class="No-Break"><strong class="bold">7A4C7AA85B114E91F247779D6A0B3022</strong></span></p>
<p>I encourage you<a id="_idIndexMarker630"/> to try it yourself and perhaps <a id="_idTextAnchor138"/>add a comma or period to the s<a id="_idTextAnchor139"/>tring to further compare <span class="No-Break">hash values.</span></p>
<h2 id="_idParaDest-108"><a id="_idTextAnchor140"/>Secure Hashing Algorithm (SHA)</h2>
<p>Another cryptographic<a id="_idIndexMarker631"/> hash algorithm commonly used in forensics and used in the next chapter is <strong class="bold">Secure Hashing Algorithm-1</strong> (<strong class="bold">SHA1</strong>). SHA1 is more secure than MD5 as it produces a 160-bit output instead of a 128-bit output as with MD5. Due to known collision attacks against both MD5 and SHA-1, the safer and more robust option for hashing is <a id="_idIndexMarker632"/><span class="No-Break">now </span><span class="No-Break"><strong class="bold">SHA-2</strong></span><span class="No-Break">.</span></p>
<p>SHA-2 is a group of hashes and not just one, as with SHA-1, with the most common bit-length being SHA-256, which produces a 256-bit output. Alternate bit-length algorithms of SHA-2 are SHA-224, SHA-384, <span class="No-Break">and SHA-512.</span></p>
<p>The stronger the cryptographic algorithm used, the less chance of it being attacked or compromised. This means that the integrity of the evidence and physical images created remain intact, which will prove useful in forensic cases and <span class="No-Break">expert testimony.</span></p>
<p>More on creating<a id="_idIndexMarker633"/> hashes will be demonstrated in <a href="B19441_08.xhtml#_idTextAnchor147"><span class="No-Break"><em class="italic">Chapter 8</em></span></a>, <em class="italic">Evidence </em><span class="No-Break"><em class="italic">Acquisition Tools.</em></span></p>
<p>Now, let’s move on to best practices and frameworks for data acquisition <span class="No-Break">and DFIR.</span></p>
<h1 id="_idParaDest-109"><a id="_idTextAnchor141"/>Data acquisition best practices and DFIR frameworks</h1>
<p>So far, we’ve<a id="_idIndexMarker634"/> covered a <a id="_idIndexMarker635"/>general overview of the DFIR procedures when collecting and preserving evidence. There are several official documents that I highly recommend you read and become familiar with, as they all give good details and guidelines on the documentation of the scene, evidence collection, and <span class="No-Break">data acquisition.</span></p>
<p>The SWGDE has several best practice guidelines on forensic acquisition, evidence collection, forensic examination, and more. These very useful documents should be downloaded and kept as part of your DFIR playbook as they are concise and summarize all the necessary steps, which can act as a checklist for DFIR investigations. All documents can be found in the SWGDE’s Forensic Publications section at  <a href="https://www.swgde.org/documents/published-by-committee/forensics">https://www.swgde.org/documents/published-by-committee/forensics</a>, but for the purposes of this chapter, I recommend, at the very least, downloading and reading the following two best practices guidelines on evidence collection and <span class="No-Break">forensic acquisitions.</span></p>
<p>The first paper details best practices when collecting digital evidence and the second details best practices when performing data acquisitions <span class="No-Break">from computers:</span></p>
<ul>
<li> 2018-07-11 SWGDE Best Practices for Digital Evidence <span class="No-Break">Collection: </span><a href="https://drive.google.com/file/d/1ScBeRvYikHvu6qtE_Lj3JtbOl94a5FDr/view?usp=sharing"><span class="No-Break">https://drive.google.com/file/d/1ScBeRvYikHvu6qtE_Lj3JtbOl94a5FDr/view?usp=sharing</span></a></li>
<li>2018-04-25 SWGDE Best Practices for Computer Forensic <span class="No-Break">Acquisitions: </span><a href="https://drive.google.com/file/d/1ScBeRvYikHvu6qtE_Lj3JtbOl94a5FDr/view?usp=sharing"><span class="No-Break">https://drive.google.com/file/d/1ScBeRvYikHvu6qtE_Lj3JtbOl94a5FDr/view?usp=sharing</span></a></li>
</ul>
<p>The <em class="italic">SWGDE Capture of Live Systems document, version 2.0</em>, was released in September 2014. Although quite short and not as detailed, it is still applicable to forensic investigations involving live (powered-on) systems. This document provides guidelines when investigating live systems, including the order of volatility, memory forensics including <a id="_idIndexMarker636"/>paging file forensics, and live physical and <a id="_idIndexMarker637"/><span class="No-Break">filesystem acquisition.</span></p>
<p>This document is only six pages long and can be downloaded from <span class="No-Break">here: </span><a href="https://drive.google.com/file/d/10MJ9EJAkj6i6Xqpf3IcFb4dDPNUZ2ymH/view"><span class="No-Break">https://drive.google.com/file/d/10MJ9EJAkj6i6Xqpf3IcFb4dDPNUZ2ymH/view</span></a></p>
<h2 id="_idParaDest-110"><a id="_idTextAnchor142"/>DFIR frameworks</h2>
<p>The practice guides <a id="_idIndexMarker638"/>mentioned earlier can be used in conjunction with one or more frameworks. Whatever the task, the goals should remain the same with the integrity of evidence always preserved throughout the entire DFIR processes of evidence collection, examination, analysis, <span class="No-Break">and reporting.</span></p>
<p>Although not free, there is an ISO/IEC publication called the <em class="italic">ISO/IEC 27037:2021 Information technology — Security techniques — Guidelines for identification, collection, acquisition, and preservation of digital evidence</em>, which serves as an excellent source of information for best practices on DFIR. A preview of the document can be found <span class="No-Break">at </span><a href="https://www.iso.org/obp/ui/#iso:std:iso-iec:27037:ed-1:v1:en"><span class="No-Break">https://www.iso.org/obp/ui/#iso:std:iso-iec:27037:ed-1:v1:en</span></a><span class="No-Break">.</span></p>
<p>The <strong class="bold">National Institute of Science and Technology</strong> (<strong class="bold">NIST</strong>) <a id="_idTextAnchor143"/>also has an older publication called the <em class="italic">NIST Special Publication (SP) 800-86 Guide to Integrating Forensic Techniques into Incident Response</em>, which contains 121 pages of very useful information about various types of technologies and data identification, acquisition, and examination. The full document can be freely downloaded <span class="No-Break">at </span><a href="https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-86.pdf"><span class="No-Break">https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-86.pdf</span></a><span class="No-Break">.</span></p>
<p>Another useful publication is the <em class="italic">NIST Special Publication (SP) 800-61 Revision 2 Computer Security Incident Handling Guide</em>, which specifically focuses on incidents and the appropriate responses to them. This document ca<a id="_idTextAnchor144"/>n be viewed and downloaded in its entirety <span class="No-Break">at </span><a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf"><span class="No-Break">https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-61r2.pdf</span></a><span class="No-Break">.</span></p>
<p>Additionally, the <em class="italic">NIST</em> <em class="italic">Guidelines on Mobile Device Forensics</em> is another very useful document that applies specifically to mobile devices. Revision one of this document, released in 2014, goes into detail about the aspects of mobile forensics investigations. Its content includes <span class="No-Break">the following:</span></p>
<ul>
<li>Mobile and <span class="No-Break">cellular characteristics</span></li>
<li>Evaluation and documentation of <span class="No-Break">the scene</span></li>
<li>Device isolation <span class="No-Break">and packaging</span></li>
<li>Device and <span class="No-Break">memory acquisition</span></li>
<li>Examination, analysis, <span class="No-Break">and reporting</span></li>
</ul>
<p>The full document can be <span class="No-Break">downloaded from:</span></p>
<p><a href="http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-101r1.pdf"><span class="No-Break">http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-101r1.pdf</span></a></p>
<p>In relation to investigating <a id="_idIndexMarker639"/>cyber-attacks, reference should be made to the D4I – Digital forensics framework for reviewing and investigating cyber-attacks as a proposed framework. It also references the Cyber Kill Chain and its associated phases with cyber-attacks. You can find the 8-page <span class="No-Break">document at:</span></p>
<p><a href="https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=929147"><span class="No-Break">https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=929147</span></a></p>
<p>Over the past two decades, there have been significant changes in technology and IT. Added to what we traditionally think of as Information Technology, there is now <strong class="bold">Operational Technology</strong> (<strong class="bold">OT</strong>). OT <a id="_idIndexMarker640"/>mainly deals with devices and machinery traditionally found in the manufacturing and utility sectors, which may be logically managed by IT processes. A good example is <strong class="bold">SCADA</strong> (short for <strong class="bold">Supervisory Control and Data Acquisition</strong>) systems, which are commonly used <a id="_idIndexMarker641"/>by gas and utility companies to monitor operational equipment. Disruption to these services could affect millions of persons and businesses, and formal incident response procedures should be implemented to ensure business continuity and disaster recovery. NIST has recently published the <em class="italic">NISTIR 8428 Digital Forensics and Incident Response (DFIR) Framework for Operational Technology (OT) (June 2022)</em> as a framework to address these issues, and it covers a very detailed OT DFIR process on asset identification, remote data collection, process monitoring, field analysis, and more. The full document is available for <span class="No-Break">download at:</span></p>
<p><span class="No-Break">https://nvlpubs.nist.gov/nistpubs/ir/2022/NIST.IR.8428.pdf</span><span class="No-Break">.</span></p>
<p>I hope this section<a id="_idIndexMarker642"/> was informative, and I encourage you to download and keep these documents within a folder or perhaps even print and bind them to have as reference materials or an entire <span class="No-Break">DFIR playbook.</span></p>
<h1 id="_idParaDest-111"><a id="_idTextAnchor145"/>Summary</h1>
<p>If there was only one thing that I’d like you to take away from this chapter, it would be to remember that the original evidence, particularly hard drives, storage media, and RAM images, should only be used to create forensically-sound bitstream copies. The original evidence is never to be <span class="No-Break">worked on.</span></p>
<p>To recap, when a breach is reported, there should be an established first responder who, as per protocol, performs the tasks of documenting and securing the scene as well as collecting and preserving the evidence. The first responder should have a toolkit with various tools and items for the acquisition of evidence, and when handing over the evidence to other parties, ensure that the CoC <span class="No-Break">is maintained.</span></p>
<p>Additionally, we looked at the various procedures and best practices when investigating devices that are powered on and powered off, and we discussed the importance of using a write blocker to prevent the original evidence from being tampered with and then using a hashing tool for integrity verification purposes. Finally, I’ve left you with some very useful DFIR frameworks, which, when combined with the SWGDE guidelines, make for an impressive <span class="No-Break">DFIR playbook.</span></p>
<p>You’ve come this far, and I know it must have been a bit of an information overload, but now we can get to the practical section of this book where we can begin our investigation using digital forensics tools in Kali Linux. <span class="No-Break">Let’s go!</span></p>
</div>
<div>
<div id="_idContainer165">
</div>
</div>
</div></body></html>