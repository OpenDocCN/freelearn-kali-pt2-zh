<html><head></head><body>
  <div id="_idContainer213" class="Basic-Text-Frame">
    <h1 class="chapterNumber">5</h1>
    <h1 id="_idParaDest-136" class="chapterTitle">Advanced Social Engineering and Physical Security</h1>
    <p class="normal">Social engineering is a method of manipulating humans to extract information or perform malicious activity by interacting with them. It is the most effective attack that has made many great organizations succumb to security incidents. Attackers may choose single or multiple ways to target individuals by exploiting human psychology, which can effectively trick a human into providing physical access to a system. It is the single most successful attack vector used during red teaming exercises, penetration testing, or in an actual attack. The success of a social engineering attack relies on two key factors:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">The knowledge that is gained during the reconnaissance phase. The attacker must know the names and usernames associated with the target; more importantly, the attacker must understand the concerns of the users on the network.</li>
      <li class="numberedList">Understanding how to apply this knowledge to convince potential targets to activate the attack by impersonating an authority, talking to them over the phone, inquiring about them, encouraging them to click links, or executing a program. In recent years, the following two tactics have been the most successful:<ul>
          <li class="bulletList">If the targeted company has recently finished their yearend appraisal, every employee in the company would be very much focused on receiving their updated salary package from the Human Resources department. Therefore, emails or documents with titles associated with that subject will likely be opened by the targeted individuals.</li>
          <li class="bulletList">If the targeted company had acquired or merged with another, the type of social engineering attack would be whaling, targeting C-level managers and other high-profile individuals in both companies. The main principle behind this type of attack is that more privileges the user has, the more access the attackers can gain.</li>
        </ul>
      </li>
    </ol>
    <p class="normal">Kali Linux provides several tools and frameworks that have an increased chance of success if social engineering is used as a pretext to influence victims to open files or execute certain operations. The examples include file-based executables, created by the Metasploit framework, and using file-less techniques, such as PowerShell scripts using Empire 3.</p>
    <p class="normal">In this chapter, we will explore some <strong class="keyWord">Tactics, Techniques, and Procedures</strong> (<strong class="keyWord">TTPs</strong>) and take a deep dive into utilizing the <strong class="keyWord">Social Engineering Toolkit</strong> (also known as <strong class="keyWord">SET</strong> and <strong class="keyWord">SEToolkit</strong>) and <strong class="keyWord">Gophish</strong>. The techniques used in employing these tools will serve as the model for using social engineering to deploy attacks from other tools.</p>
    <p class="normal">By the end of this chapter, you will have learned the following concepts and methods:</p>
    <ul>
      <li class="bulletList">The different social engineering attack methods that can be engaged by attackers</li>
      <li class="bulletList">How to perform physical attacks at the console</li>
      <li class="bulletList">Creating rogue physical devices using microcontrollers and USBs</li>
      <li class="bulletList">Harvesting or collecting usernames and passwords using the credential harvester attack</li>
      <li class="bulletList">Launching the Tabnabbing and Web Jacking attack</li>
      <li class="bulletList">Employing the Multi-Attack web method</li>
      <li class="bulletList">Using PowerShell’s alphanumeric shellcode injection attack</li>
      <li class="bulletList">How to set up Gophish on Kali Linux</li>
      <li class="bulletList">Launching an email phishing campaign</li>
    </ul>
    <p class="normal">To support SET’s social engineering attacks, the following general implementation practices will also be described:</p>
    <ul>
      <li class="bulletList">Hiding malicious executables and obfuscating the attacker’s URL</li>
      <li class="bulletList">Escalating an attack using DNS redirection</li>
      <li class="bulletList">Gaining access to the system and network through a USB</li>
    </ul>
    <h1 id="_idParaDest-137" class="heading-1">Command methodology and TTPs</h1>
    <p class="normal">As an attack route supporting the cyber kill chain methodology, social engineering focuses on <a id="_idIndexMarker521"/>the different aspects of an attack that take advantage <a id="_idIndexMarker522"/>of a person’s trust and innate helpfulness, to deceive and manipulate them into compromising a network and its resources.</p>
    <p class="normal"><em class="italic">Figure 5.1</em> depicts the different types of attack methods that attackers can engage in to harvest information and/or gain access.</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.1: Different types of social engineering tactics</p>
    <p class="normal">From the previous editions of this book, we have now reclassified social engineering tactics into two main categories: one that involves technology, and another that includes people-specific techniques. The following sections will provide a briefing on the two categories; later on, we will explore computer-based attacks, especially physical attacks and email phishing using Kali Linux.</p>
    <h2 id="_idParaDest-138" class="heading-2">Technology</h2>
    <p class="normal">As technology has evolved from traditional PCs to laptops and mobile phones, so have social engineering techniques. In this section, we will discuss the computer- and mobile-based attacks that can be performed using Kali Linux.</p>
    <h3 id="_idParaDest-139" class="heading-3">Computer-based</h3>
    <p class="normal">Attacks that <a id="_idIndexMarker523"/>utilize computers to perform social engineering are subdivided into the following types. All of these are best utilized only when all passive and active reconnaissance information is utilized to the maximum:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Email phishing</strong>: Attacks <a id="_idIndexMarker524"/>that utilize the email medium to harvest information or exploit a known software vulnerability in the victim’s system are referred to as email phishing.</li>
      <li class="bulletList"><strong class="keyWord">Baiting/Quid Pro Quo</strong>: This is a technique that is used to embed a known vulnerability <a id="_idIndexMarker525"/>and create a backdoor, achieved by utilizing USB sticks and CDs. Baiting has more of a focus on exploiting the human curiosity factor through the use of physical media. Attackers can create a Trojan that will provide backdoor access to the system, either by utilizing the autorun feature, or when a user clicks to open the files inside the drive. Quid Pro Quo is similar to Baiting, but in this case, the victim gets something in exchange for the Trojan.</li>
      <li class="bulletList"><strong class="keyWord">Wi-Fi phishing</strong>: Penetration testers can utilize this technique to harvest usernames <a id="_idIndexMarker526"/>and passwords by setting up a fake Wi-Fi network, similar to the targeted company. For example, the attackers could target a company by setting the SSID in their Wi-Fi to the exact same (or something similar) to a company’s, allowing users to connect without any password to the fake wireless router. We will explore more about these attacks in <em class="chapterRef">Chapter 6</em>, <em class="italic">Wireless and Bluetooth Attacks</em>. </li>
    </ul>
    <h3 id="_idParaDest-140" class="heading-3">Mobile-based</h3>
    <p class="normal">Mobile-based attacks <a id="_idIndexMarker527"/>have become an easy way to capture confidential information or try to collect other important details that might serve for the goal of penetration testing or a <strong class="keyWord">Red Team Exercise</strong> (<strong class="keyWord">RTE</strong>). We will discuss the two most commonly <a id="_idIndexMarker528"/>used mobile-based attacks that are deployed by attackers:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">SMSishing</strong>: Attackers <a id="_idIndexMarker529"/>perform phishing using <strong class="keyWord">Short Message Service</strong> (<strong class="keyWord">SMS</strong>) by sending links or drafting a message that <a id="_idIndexMarker530"/>allows the user to click on a link or reply to the text. Penetration testers can also utilize publicly offered services, such as <a href="https://www.spoofmytextmessage.com/free"><span class="url">https://www.spoofmytextmessage.com/free</span></a>.</li>
      <li class="bulletList"><strong class="keyWord">Quick Response Code</strong> (<strong class="keyWord">QR code</strong>)<strong class="keyWord">: </strong>During a red team exercise, QR codes are also <a id="_idIndexMarker531"/>the most effective way to deliver a payload to an isolated area. Similar to spamming, QR codes with a message of winning bounty or with the latest news (like free Covid-19 vaccine registration) can be printed and posted in places where most people visit, for example, cafeterias, smoking zones, toilets, and other rush areas.</li>
    </ul>
    <h2 id="_idParaDest-141" class="heading-2">People-based</h2>
    <p class="normal">People-based <a id="_idIndexMarker532"/>attacks are the most effective type of attack during a red team exercise or penetration test. These attacks are focused on the behavior of people in a given situation. The following sections explain the different types of attack that can be performed by focusing on people’s weaknesses and the different tactics used to exploit them.</p>
    <h3 id="_idParaDest-142" class="heading-3">Physical attacks</h3>
    <p class="normal">Physical attacks <a id="_idIndexMarker533"/>typically involve the physical <a id="_idIndexMarker534"/>existence of an attacker, who then performs a social engineering attack. The following are the two types of physical attacks that are engaged during an <strong class="keyWord">RTE</strong> or penetration test:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Impersonation or pretexting</strong>: This involves the testers creating a script and impersonating <a id="_idIndexMarker535"/>an important person to harvest information from a targeted set of staff. We recently performed a social engineering attack with the goal of identifying the username and password of a domain user through a physical social engineering exercise. The scenario involves an attacker talking to the victim and impersonating the internal IT helpdesk, <em class="italic">“Dear Mr. X, I am Mr. Y from the internal IT department. It has been noted that your system has been disconnected from the network for a period of 20 days. It is recommended to install the latest system updates due to the latest ransomware attack. Do you mind providing the laptop along with your username and password?”</em> That <a id="_idIndexMarker536"/>resulted in the user providing the login details and, as a bonus, passing on the laptop to the attacker. The attacker’s next move is to plant a backdoor into the system to maintain persistent access.</li>
      <li class="bulletList"><strong class="keyWord">Attacks at the console</strong>: These involve all attacks that involve physical access to the <a id="_idIndexMarker537"/>system, such as changing the password of an administrator user, planting a keylogger, extracting stored browser passwords, or the installation of backdoor.</li>
    </ul>
    <h3 id="_idParaDest-143" class="heading-3">Voice-based</h3>
    <p class="normal">Any attack <a id="_idIndexMarker538"/>that involves a voice message <a id="_idIndexMarker539"/>and tricks the user into performing an action on a computer or leaking sensitive information is referred to as voice-based social engineering.</p>
    <p class="normal"><strong class="keyWord">Vishing</strong> is the <a id="_idIndexMarker540"/>art of utilizing a recorded voice message or an individual calling the victim to extract information from a targeted victim or group of victims. Typically, vishing involves a trustable script, for example, if <em class="italic">Company X</em> announces a new joint venture with <em class="italic">Company Y</em>, the staff will be curious about the future of both companies. This allows the attackers to call the victim directly with a pre-defined script, as follows:</p>
<blockquote class="packt_quote">
    <p class="quote">“Hello, I am Mr. X calling from Company Y. We have now been announced as partaking in a joint venture, so technically we are all on the same team. Can you please let me know where your data centers are located, and provide me with list of mission-critical servers? If you are not the right person, can you point me to the right one? Many thanks, Mr. X”.</p></blockquote>
    <p class="normal">Very well-done vishing can lead attackers not only to gain access to confidential information <a id="_idIndexMarker541"/>but also remain stealthy <a id="_idIndexMarker542"/>and avoid unwanted attention. Let us discuss the next important attack, gaining access to physical devices.</p>
    <h1 id="_idParaDest-144" class="heading-1">Physical attacks at the console</h1>
    <p class="normal">In this <a id="_idIndexMarker543"/>section, we will explore different types of attack that are typically performed on a system where physical access is possible.</p>
    <h2 id="_idParaDest-145" class="heading-2">samdump2 and chntpw</h2>
    <p class="normal">One of the most popular ways to dump password hashes is to utilize <code class="inlineCode">samdump2</code>. This can be done <a id="_idIndexMarker544"/>by turning on the power of the acquired <a id="_idIndexMarker545"/>system and <a id="_idIndexMarker546"/>then booting it through our Kali USB stick by making <a id="_idIndexMarker547"/>the required changes in the BIOS (say, in Lenovo, one can press <em class="keystroke">F12</em> to bring up the boot menu and select the USB):</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Once the system is booted through Kali, by default the local hard drive must be mounted as a media drive (assuming the media drive is not encrypted with BitLocker or something similar), as shown in <em class="italic">Figure 5.2</em>:<figure class="mediaobject"><img src="../Images/B17765_05_02.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.2: All mounted disks on Kali Linux</p>
      </li>
      <li class="numberedList">If the <a id="_idIndexMarker548"/>drive is not mounted by default, the <a id="_idIndexMarker549"/>attackers can <a id="_idIndexMarker550"/>manually mount <a id="_idIndexMarker551"/>the drive by running the following commands:
        <pre class="programlisting con"><code class="hljs-con">mkdir /mnt/target1
mount /dev/sda2 /mnt/target1
</code></pre>
      </li>
      <li class="numberedList">Once the system is mounted, navigate to the mounted folder (in our case, it is <code class="inlineCode">/media/root/&lt;ID&gt;/Windows/System32/Config</code>), and run <code class="inlineCode">samdump2 SYSTEM SAM</code>, as shown in <em class="italic">Figure 5.3</em>. The <code class="inlineCode">SYSTEM</code> and <code class="inlineCode">SAM</code> files should display all the users on the system drive, along with their password hashes, which will then be used to crack the password offline using the <code class="inlineCode">John</code> (John the Ripper) or <code class="inlineCode">hashcat</code> tools.<figure class="mediaobject"><img src="../Images/B17765_05_03.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.3: Output of samdump2 with the password hashes</p>
        <p class="normal">Using the <a id="_idIndexMarker552"/>same access, attackers <a id="_idIndexMarker553"/>can also remove the password <a id="_idIndexMarker554"/>of a user from the system. <code class="inlineCode">chntpw</code> is a Kali Linux tool that <a id="_idIndexMarker555"/>can be used to edit the Windows registry, reset a user’s password, and promote a user to as an administrator, as well as several other useful options. Using <code class="inlineCode">chntpw</code> is a great way to reset a Windows password, or otherwise gain access to a Windows machine when the password is unknown.</p>
        <p class="normal"><code class="inlineCode">chntpw</code> is a utility to view information and change user passwords in Windows NT/2000, XP, Vista, 7, 8.1, 10, and other Windows servers with the ability to boot the device with an external drive.</p>
      </li>
      <li class="numberedList">The SAM user database file is usually located at <code class="inlineCode">\WINDOWS\system32\config\SAM</code> on the Windows filesystem. Navigate to folder, as shown in <em class="italic">Figure 5.4</em>:<figure class="mediaobject"><img src="../Images/B17765_05_04.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.4: All the files from Windows system32 config folder </p>
      </li>
      <li class="numberedList">Run <code class="inlineCode">chntpw SAM</code>; the <a id="_idIndexMarker556"/>password is stored in the <code class="inlineCode">SAM</code> file in Windows. <strong class="keyWord">Security Accounts Manager</strong> (<strong class="keyWord">SAM</strong>) is a database <a id="_idIndexMarker557"/>file in Windows XP, Windows Vista, and Windows 7 that <a id="_idIndexMarker558"/>stores users’ passwords.</li>
    </ol>
    <p class="normal">The SAM <a id="_idIndexMarker559"/>file can be used to authenticate local <a id="_idIndexMarker560"/>and remote users. Usually, the <code class="inlineCode">SAM</code> file is located in <code class="inlineCode">C/Windows/system32/config/SAM</code>:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Enter<code class="inlineCode"> chntpw -i SAM</code> in the Kali Linux terminal from <code class="inlineCode">/media/root/&lt;ID&gt;/Windows/System32/Config</code></li>
      <li class="numberedList">Select <code class="inlineCode">1 – edit user data and passwords</code></li>
      <li class="numberedList">Enter the <code class="inlineCode">RID</code> of the user, in this case <code class="inlineCode">03ef</code>, as shown in <em class="italic">Figure 5.5</em>:<figure class="mediaobject"><img src="../Images/B17765_05_05.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.5: Interactive terminal using chntpw to edit SAM file</p>
      </li>
    </ol>
    <p class="normal">Select <code class="inlineCode">1 – clear (blank) user password</code>, and <a id="_idIndexMarker561"/>then enter <code class="inlineCode">q</code> to complete <a id="_idIndexMarker562"/>the task. Enter <code class="inlineCode">y</code> for <code class="inlineCode">write hive</code> <code class="inlineCode">files</code>. Finally, you <a id="_idIndexMarker563"/>should be able to get a confirmation <a id="_idIndexMarker564"/>like this: <code class="inlineCode">&lt;SAM&gt; - OK</code>. <em class="italic">Figure 5.6</em> shows the edited SAM file contents:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.6: Final SAM file edit confirmation that our password was set to blank</p>
    <p class="normal">In Windows 10, a reboot of the system will contain <code class="inlineCode">hyberfile.sys</code>, which will not allow the attackers <a id="_idIndexMarker565"/>to mount the system drive. To mount the <a id="_idIndexMarker566"/>system drive and gain access to the drive, use <code class="inlineCode">mount -t ntfs-3g -ro remove_hiberfile /dev/sda2 /mnt/folder</code>. Note that some systems with <a id="_idIndexMarker567"/>endpoint encryption tools such as BitLocker or <a id="_idIndexMarker568"/>any other vendor may not be able to boot after this file is deleted.</p>
    <p class="normal">Other bypassing tools include Kon-boot, which is another forensics utility that utilizes a similar feature to <code class="inlineCode">chntpw</code>. Kon-boot only affects the administrator account and doesn’t remove the administrator’s password; it just lets you log in without a password, and on the next normal system reboot, the original administrator’s password is in place, intact.</p>
    <p class="normal">This tool can be downloaded from this website: <a href="https://www.piotrbania.com/all/kon-boot/"><span class="url">https://www.piotrbania.com/all/kon-boot/</span></a>.</p>
    <h2 id="_idParaDest-146" class="heading-2">Sticky Keys</h2>
    <p class="normal">In this section, we will explore how to utilize physical access to the console of a Windows computer <a id="_idIndexMarker569"/>that is unlocked or without a password. Attackers can exploit <a id="_idIndexMarker570"/>the feature of Microsoft Windows Sticky Keys to plant a backdoor in a fraction of a second; however, the caveat is that you will need to have administrator privileges to place the executable. But when the system is booted through Kali Linux, the attackers can place the files without any restrictions.</p>
    <p class="normal">The following is a list of Windows utilities that can be utilized by attackers to replace utility executables with <code class="inlineCode">cmd.exe</code> or <code class="inlineCode">powershell.exe</code>:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">sethc.exe</code></li>
      <li class="bulletList"><code class="inlineCode">utilman.exe</code></li>
      <li class="bulletList"><code class="inlineCode">osk.exe</code></li>
      <li class="bulletList"><code class="inlineCode">narrator.exe</code></li>
      <li class="bulletList"><code class="inlineCode">magnify.exe</code></li>
      <li class="bulletList"><code class="inlineCode">displayswitch.exe</code></li>
    </ul>
    <p class="normal">The following steps are involved in replacing <code class="inlineCode">sethc.exe</code> with <code class="inlineCode">cmd.exe</code>:</p>
    <pre class="programlisting con"><code class="hljs-con">cd /media/root/&lt;ID&gt;/Windows/System32/
cp cmd.exe /home/kali/Desktop
mv /home/kali/Desktop/cmd.exe /home/kali/Desktop/sethc.exe
rm sethc.exe
mv /home/kali/Desktop/sethc.exe .
</code></pre>
    <p class="normal"><em class="italic">Figure 5.7</em> shows the backdoor of <code class="inlineCode">cmd.exe</code>, when we hit the <em class="keystroke">Shift</em> key five times to invoke <code class="inlineCode">sethc.exe</code>. However, Command Prompt will appear as we replaced the <code class="inlineCode">cmd.exe</code> with <code class="inlineCode">sethc.exe</code>.</p>
    <figure class="mediaobject"> <img src="../Images/B17765_05_07.png" alt="A picture containing text, electronics, computer, computer  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 5.7: Backdoor display of Sticky Keys (sethc.exe) running Command Prompt (cmd.exe)</p>
    <p class="normal">We have <a id="_idIndexMarker571"/>explored how to clear a Windows 10 local <a id="_idIndexMarker572"/>user’s password and also set a backdoor through legitimate Windows programs.</p>
    <h1 id="_idParaDest-147" class="heading-1">Creating a rogue physical device</h1>
    <p class="normal">Kali also facilitates attacks where the intruder has direct physical access to systems and the network. This can <a id="_idIndexMarker573"/>be a risky attack, as the intruder may be spotted by an observant human or caught on a surveillance device. However, the rewards can be significant because the intruder can compromise specific systems that have valuable data.</p>
    <p class="normal">Physical access is usually a direct result of social engineering, especially when impersonation is used. Common impersonations include the following:</p>
    <ul>
      <li class="bulletList">A person who claims to be from the help desk or IT support and just needs to quickly interrupt the victim by installing a system upgrade.</li>
      <li class="bulletList">A vendor who drops by to talk to a client, and then excuses himself to talk to someone else or visit a restroom.</li>
      <li class="bulletList">A delivery person dropping off a package. Attackers can buy a delivery uniform online; however, since most people assume that anyone who is dressed all in brown and pushing a handcart filled with boxes is a UPS delivery person, uniforms are rarely a necessity for social engineering!</li>
      <li class="bulletList">Trade persons wearing work clothes, carrying a work order that they have printed out, are usually allowed access to wiring closets and other areas, especially when they claim to be present at the request of the building manager.</li>
      <li class="bulletList">Dress in an expensive suit, carry a clipboard, and walk fast; employees will assume that you’re an unknown manager. When conducting this type of penetration, we usually inform people that we are auditors, and our inspections are rarely questioned.</li>
    </ul>
    <p class="normal">The goal of hostile <a id="_idIndexMarker574"/>physical access is to rapidly compromise selected systems; this is usually accomplished by installing a backdoor or similar device on the target. One of the classic attacks is to place a USB key (in the form of keyboard/mouse) in a system and let the system install it using the AutoPlay option; however, many organizations disable AutoPlay across the network.</p>
    <p class="normal">Attackers can also create poisoned bait traps: mobile devices that contain files with names that invite a person to click on the file and examine its contents. Some examples include the following:</p>
    <ul>
      <li class="bulletList">USB keys with labels such as “Employee Salaries”, “Medical Insurance Updates”, or “Covid-19 exit strategy”.</li>
      <li class="bulletList">Metasploit allows an attacker to bind a payload, such as a reverse shell, to an executable, such as a screensaver. The attacker can create a screensaver using publicly available corporate images, and mail USBs to employees with the new endorsed screensaver. When the user installs the program, the backdoor is also installed and it connects to the attacker.</li>
      <li class="bulletList">If you know that employees have attended a recent conference, attackers can impersonate a vendor who was present and send the target a letter insinuating that it is a follow-up from the vendor show. A typical message will be, <em class="italic">“If you missed our product demonstration and one-year free trial, please review the slideshow on the attached USB key by clicking on start.exe.”</em></li>
    </ul>
    <h2 id="_idParaDest-148" class="heading-2">Microcomputer or USB-based attack agents</h2>
    <p class="normal">We have noticed a significant increase in using microcomputers and USB-based devices in RTE/penetration testing. These are mainly used due to their compactness; they can be hidden <a id="_idIndexMarker575"/>anywhere on the network and also can run <a id="_idIndexMarker576"/>almost anything that a full-fledged laptop can. In this section, we will explore the most commonly used devices, the Raspberry Pi and MalDuino USB.</p>
    <h3 id="_idParaDest-149" class="heading-3">The Raspberry Pi</h3>
    <p class="normal">The Raspberry Pi is a <a id="_idIndexMarker577"/>microcomputer; it measures approximately 8.5 cm by 5.5 cm but manages to pack 2-8 GB RAM, two USB 2.0 or two USB 3.0 ports, and an Ethernet port supported by a Broadcom chip, using a 64-bit quad-core CPU, running at 1.5GHz, with the support of Wi-Fi and Bluetooth. It doesn’t include a hard drive but uses an SD card for data storage. As shown in <em class="italic">Figure 5.8</em>, the Raspberry Pi is approximately pocket sized; it is easy to hide on a network (behind workstations or servers, placed inside server cabinets, or hidden beneath floor panels in a data center).</p>
    <figure class="mediaobject"> <img src="../Images/B17765_05_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.8: Photo of assembled Raspberry Pi 4 </p>
    <p class="normal">To configure a <a id="_idIndexMarker578"/>Raspberry Pi as an attack vector, the following items are required:</p>
    <ul>
      <li class="bulletList">A Raspberry Pi Model B, or newer versions</li>
      <li class="bulletList">An HDMI cable</li>
      <li class="bulletList">A micro-USB cable and charging block</li>
      <li class="bulletList">An Ethernet cable or mini-wireless adapter</li>
      <li class="bulletList">An SD card, Class 10, at least 16 GB in size</li>
    </ul>
    <p class="normal">Together, all these supplies are typically available online for a total of less than $100. The following <a id="_idIndexMarker579"/>are the steps to configure the <a id="_idIndexMarker580"/>Raspberry Pi with latest version of Kali Linux:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">To configure the Raspberry Pi, download the latest version of the Kali Linux ARM edition <a id="_idIndexMarker581"/>from <a href="https://www.kali.org/get-kali/#kali-arm"><span class="url">https://www.kali.org/get-kali/#kali-arm</span></a>. Extract it from the source archive. If you are configuring from a Windows-based desktop, then we would utilize the same Rufus utility as utilized in <em class="chapterRef">Chapter 1</em>, <em class="italic">Goal-Based Penetration Testing</em>, to make a bootable Kali USB stick.</li>
      <li class="numberedList">Using a card reader, connect the SD card to the Windows-based computer and open the Rufus utility. Select the ARM version of Kali, <code class="inlineCode">kali-custom-rpi.img</code>, which was downloaded and extracted previously, and write it to the SD card. Separate instructions for flashing the SD card from Mac or Linux systems are available on the Kali website: <a href="https://www.kali.org/docs/usb/live-usb-install-with-mac/"><span class="url">https://www.kali.org/docs/usb/live-usb-install-with-mac/</span></a>.</li>
      <li class="numberedList">Insert the <a id="_idIndexMarker582"/>newly flashed SD card <a id="_idIndexMarker583"/>into the Raspberry Pi and connect the Ethernet cable or wireless adapter to the Windows workstation, the HDMI cable to a monitor, and the micro-USB power cable to a power supply, a keyboard, and a mouse. Once supplied with power, it will boot directly into Kali Linux. The Raspberry Pi relies on external power, and there is no separate on/off switch; however, Kali can still be shut down from the command line by running <code class="inlineCode">halt</code> in the terminal. Once Kali is installed, ensure that it is up to date using the <code class="inlineCode">apt update</code> command.</li>
      <li class="numberedList">Make sure the SSH host keys are changed as soon as possible, as all Raspberry Pi images have the same keys. Use the following commands in the Kali Linux terminal:
        <pre class="programlisting con"><code class="hljs-con">sudo rm /etc/ssh/ssh_host_*
sudo dpkg-reconfigure openssh-server
sudo service ssh restart
</code></pre>
        <p class="normal">At the same time, make sure the default username and password are changed by running <code class="inlineCode">sudo passwd kali</code> in the terminal.</p>
      </li>
      <li class="numberedList">Configure the Raspberry Pi to connect back to the attacker’s computer (using a static IP address or using DynDNS) at regular intervals using a <code class="inlineCode">cron</code> job. An attacker must then physically access the target’s premises and connect the Raspberry Pi to the network. Most networks automatically assign devices a DHCP address and have limited defences against this type of attack.</li>
      <li class="numberedList">Once the Raspberry Pi connects back to the attacker’s IP address, the attacker can run reconnaissance and exploit applications against the victim’s internal network from a remote location, using SSH to issue commands.</li>
    </ol>
    <p class="normal">If a wireless <a id="_idIndexMarker584"/>adapter is connected, such as <a id="_idIndexMarker585"/>EW-7811Un V2, the 150 Mbps wireless 802.11b/g/n Nano USB adapter, the attacker can connect wirelessly or use the Pi to launch wireless attacks.</p>
    <h3 id="_idParaDest-150" class="heading-3">MalDuino: the BadUSB</h3>
    <p class="normal">MalDuino is an <a id="_idIndexMarker586"/>Arduino-powered USB that can be used by attackers during an RTE/penetration testing activity. This device has a keyboard injection capability and runs the commands within a fraction of a second. These devices are extremely useful during physical security with access to the organization’s building. Often, people inside the organization rarely lock their computer, assuming the physical access restrictions are safeguards and no one would do anything. Even if attackers gain access physically to the system, staff can arguably say “we have no USB policy;” well, it’s a good point. But disabling a USB does not disable USB-based keyboards—when attackers plug in MalDuino, it acts as a keyboard, typing commands exactly how a human being would run a specified payload and execute it.</p>
    <p class="normal">There are two flavors of MalDuino: Elite and Lite. The difference is that Elite provides an SD card option <a id="_idIndexMarker587"/>for you to dump around 16 different payloads with the <a id="_idIndexMarker588"/>hardware switches on the device, so that you don’t need to reconfigure the entire device. With MalDuino Lite, you have to configure the device every time you change the payload.</p>
    <p class="normal">The board supports the Ducky Script templates, making it easy to build custom scripts. <em class="italic">Figure 5.9</em> depicts the MalDuino Elite hardware:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.9: MalDuino as USB</p>
    <p class="normal">Instructions on how to set up the board can be found at <a href="https://malduino.com/wiki/doku.php?id=setup:elite"><span class="url">https://malduino.com/wiki/doku.php?id=setup:elite</span></a>.</p>
    <p class="normal">We will focus on <a id="_idIndexMarker589"/>setting up an Empire PowerShell script for the board by following these steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Generate the PowerShell payload in Empire (refer to <em class="chapterRef">Chapter 10</em>,<em class="italic"> Exploitation</em>).</li>
      <li class="numberedList">Ensure the listeners are up and listening for any connections.</li>
      <li class="numberedList">Convert the PowerShell launcher into strings; since MalDuino has a buffer size of 256 bytes, the payloads must be fragmented. This can be achieved by visiting <a href="https://malduino.com/converter/"><span class="url">https://malduino.com/converter/</span></a>.</li>
      <li class="numberedList">Once the strings are converted, it should look something like that shown in <em class="italic">Figure 5.10</em>:<figure class="mediaobject"><img src="../Images/B17765_05_10.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.10: Organizing the strings to match the limit of 254 characters per line</p>
      </li>
      <li class="numberedList">The next step is to build the payload into a script, as shown in <em class="italic">Figure 5.11</em>:<figure class="mediaobject"><img src="../Images/B17765_05_11.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.11: Loading the payload into MalDuino </p>
      </li>
      <li class="numberedList">The final <a id="_idIndexMarker590"/>action is to plug the device into the victim machine; you should now be able to see an agent reporting back, as shown in <em class="italic">Figure 5.12</em>:<figure class="mediaobject"><img src="../Images/B17765_05_12.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.12: Successful connection from MalDuino to our Empire listener</p>
      </li>
    </ol>
    <p class="normal">We have learned <a id="_idIndexMarker591"/>how to utilize the purpose-built MalDuino USB to launch a reverse shell to the attackers. One other scenario that attackers can utilize is dropping these devices in target locations, such as a cafeteria, or even courier these to the company CEO’s personal assistant with a high-alert message from a court or regulatory authority; the curiosity or the fear of the victim gets the job done for the attackers.</p>
    <h1 id="_idParaDest-151" class="heading-1">The Social Engineering Toolkit (SET)</h1>
    <p class="normal">SET was created and written by David Kennedy (<code class="inlineCode">@ReL1K</code>), founder of trustedsec, and it is maintained <a id="_idIndexMarker592"/>by an active group of collaborators (<code class="inlineCode">www.social-engineer.org</code>). It is an open-source Python-driven framework that is specifically designed to facilitate social engineering attacks.</p>
    <p class="normal">The tool was designed with the objective of achieving security by training. A significant advantage of SET is its interconnectivity with the Metasploit framework, which provides the payloads needed for exploitation, the encryption to bypass antivirus software, and the listener module, which connects to the compromised system when it sends a shell back to the attacker.</p>
    <p class="normal">To open SET in a Kali distribution, go to <code class="inlineCode">Applications | Social Engineering Tools | social engineering toolkit</code>, or enter <code class="inlineCode">sudo setoolkit</code> at a shell prompt. You will be presented with the main menu, as shown in <em class="italic">Figure 5.13</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.13: Startup screen on SET </p>
    <p class="normal">If you <a id="_idIndexMarker593"/>select <code class="inlineCode">1) Social-Engineering Attacks</code>, you will be presented with the following submenu, shown in <em class="italic">Figure 5.14</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.14: Social engineering attack main menu</p>
    <p class="normal">The attacking <a id="_idIndexMarker594"/>menu options are as follows:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1"><strong class="keyWord">Spear-Phishing Attack Vectors</strong>: This module allows an attacker to create email messages and templates and send them to targeted victims with attached exploits.</li>
      <li class="numberedList"><strong class="keyWord">Website Attack Vectors</strong>: One of the comprehensive modes that allow attackers to utilize multiple sub-modules to perform a variety of web attacks—we will explore some modules in the coming sections.</li>
      <li class="numberedList"><strong class="keyWord">Infectious Media Generator</strong>: This creates an <code class="inlineCode">autorun.inf</code> file and Metasploit payload. Once burned or copied to a USB device or physical media (CD or DVD), and inserted into the target system, it will trigger autorun (if autorun is enabled) and compromise the system.</li>
      <li class="numberedList"><strong class="keyWord">Create a Payload and Listener</strong>: This module is a rapid menu-driven method of creating a Metasploit payload. The attacker must use a separate social engineering attack to convince the target to launch it.</li>
      <li class="numberedList"><strong class="keyWord">Mass Mailer Attack</strong>: To be able to send mass emails using <code class="inlineCode">Sendmail</code> and spoof the sender’s identity.</li>
      <li class="numberedList"><strong class="keyWord">Arduino-Based Attack Vector</strong>: This programs Arduino-based devices, such as the Teensy (<a href="https://www.pjrc.com/teensy/"><span class="url">https://www.pjrc.com/teensy/</span></a>). Because these devices register as a USB keyboard when connected to a physical Windows system, they can bypass security based on disabling autorun or other endpoint protection.</li>
      <li class="numberedList"><strong class="keyWord">Wireless Access Point Attack Vector</strong>: This will create a fake wireless access point and <a id="_idIndexMarker595"/>DHCP server on the attacker’s system, and redirect all DNS queries to the attacker. The attacker can then launch various attacks, such as the Java applet or a credential harvester attack.</li>
      <li class="numberedList"><strong class="keyWord">QRCode Generator Attack Vector</strong>: This creates a QR code with a defined URL associated with an attack.</li>
      <li class="numberedList"><strong class="keyWord">PowerShell Attack Vectors</strong>: This allows the attacker to create attacks that rely on PowerShell, a command-line shell and scripting language available on versions of Windows from Vista onwards.</li>
      <li class="numberedList"><strong class="keyWord">Third Party Modules</strong>: This <a id="_idIndexMarker596"/>allows the attacker to use the <strong class="keyWord">Remote Administration Tool Tommy Edition</strong> (<strong class="keyWord">RATTE</strong>) and Google analytics attack by Zonksec. RATTE is a part of the Java applet attack; it is a text menu-driven remote access tool and can work as an isolated payload.</li>
    </ol>
    <p class="normal">SET also provides <a id="_idIndexMarker597"/>a menu item for <strong class="keyWord">fast-track penetration testing</strong>, which gives rapid access to some specialized tools that support brute-force identification and password cracking of SQL databases, as well as some customized exploits that are based on Python, SCCM attack vectors, Dell computer DRAC/chassis exploitation, user enumeration, and PsExec PowerShell injection.</p>
    <p class="normal">The menu also gives options for updating the SET and updating the configuration. However, these additional options should be avoided, as they are not fully supported by Kali, and may cause conflicts with dependencies.</p>
    <h2 id="_idParaDest-152" class="heading-2">Social-engineering attacks</h2>
    <p class="normal">The latest version of the social engineering toolkit has removed the Spoof SMS and Full-screen <a id="_idIndexMarker598"/>attack modules. The following <a id="_idIndexMarker599"/>is a brief explanation of the social engineering attacks.</p>
    <p class="normal"><code class="inlineCode">The Spear-Phishing Attack Vector</code> allows an attacker to create email messages and send them to targeted victims with attached exploits. <code class="inlineCode">Website Attack Vectors</code> utilize multiple <a id="_idIndexMarker600"/>web-based attacks, including the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1"><strong class="keyWord">Java applet attack method</strong>: This spoofs a Java certificate and delivers a Metasploit-based payload. This is one of the most successful attacks, and it is effective against Windows, Linux, and macOS targets.</li>
      <li class="numberedList"><strong class="keyWord">Metasploit browser exploit method</strong>: This delivers a Metasploit payload using an iFrame attack.</li>
      <li class="numberedList"><strong class="keyWord">Credential harvester attack method</strong>: This clones a website and automatically rewrites the <code class="inlineCode">POST</code> parameters to allow an attacker to intercept and harvest user credentials; it then redirects the victim back to the original site when harvesting is completed.</li>
      <li class="numberedList"><strong class="keyWord">Tabnabbing attack method</strong>: This replaces information on an inactive browser tab with a cloned page that links back to the attacker. When the victim logs in, the credentials are sent to the attacker.</li>
      <li class="numberedList"><strong class="keyWord">Web jacking attack method</strong>: This utilizes iFrame replacements to make the highlighted URL link appear legitimate; however, when it is clicked, a window pops up and the legitimate link is then replaced with a malicious link.</li>
      <li class="numberedList"><strong class="keyWord">Multi-attack web method</strong>: This allows an attacker to select some or all of the several attacks that can be launched at once, including the following:<ul>
          <li class="bulletList">Java applet attack method</li>
          <li class="bulletList">Metasploit browser exploit method</li>
          <li class="bulletList">Credential harvester attack method</li>
          <li class="bulletList">Tabnabbing attack method</li>
          <li class="bulletList">Web Jacking attack method</li>
        </ul>
      </li>
      <li class="numberedList"><strong class="keyWord">HTA attack method</strong>: This is when an attacker presents a fake website that will automatically download HTML applications in <code class="inlineCode">.HTA</code> format.</li>
    </ol>
    <p class="normal">As an initial example of SET’s strengths, we will see how it can be used to gain a remote shell: a connection made from the compromised system back to the attacker’s system.</p>
    <div class="note">
      <p class="normal">Testers performing <a id="_idIndexMarker601"/>a Tabnabbing attack might encounter the following error message: <code class="inlineCode">[!] Something went wrong, printing the error: module 'urllib' has no attribute 'urlopen'</code>. This is a known issue with the current version. However, an alternative method is to select the multi-attack web attack method and then perform the Tabnabbing attack.</p>
    </div>
    <h2 id="_idParaDest-153" class="heading-2">Credential harvester web attack method</h2>
    <p class="normal">Credentials, generally the username and password, give a person access to networks, computing <a id="_idIndexMarker602"/>systems, and data more generally. An attacker can use this information indirectly (by logging on to the victim’s Gmail account and sending emails to facilitate an attack against the victim’s trusted connections, say), or directly against the user’s account. This attack is particularly relevant given the extensive reuse of credentials; users typically reuse passwords in multiple places.</p>
    <p class="normal">Particularly prized are the credentials of a person with privileged access, such as a system or database administrator, which can give an attacker access to multiple accounts and data repositories.</p>
    <p class="normal">The SET’s credential harvesting attack uses a cloned site to collect credentials. To launch this attack, select <code class="inlineCode">2) Website Attack Vectors</code> from the main menu, then <code class="inlineCode">3) Credential Harvester Attack Method</code>, and then select <code class="inlineCode">2) Site Cloner</code>. </p>
    <p class="normal">For this example, we will follow the menu selections to clone a website, such as Facebook, as shown in <em class="italic">Figure 5.15</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.15: Cloning Facebook to our Kali Linux using the credential harvester</p>
    <p class="normal">Again, the <a id="_idIndexMarker603"/>attacker’s IP address must be sent to the intended target. When the target clicks on the link or enters the IP address, they will be presented with a cloned page that resembles the regular login page for Facebook, as shown in <em class="italic">Figure 5.16</em>, and they will be prompted to enter their username and password:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.16: Hosting facebook.com on our local Kali Linux</p>
    <p class="normal">Once this <a id="_idIndexMarker604"/>is done, the users will be redirected to the regular Facebook site, where they will be logged in to their account. In the background, their access credentials will be collected and forwarded to the attacker. The attacker will see the following entry, shown in <em class="italic">Figure 5.17</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.17: Successful capture of the username and password field from our hosted local facebook.com</p>
    <p class="normal">When the <a id="_idIndexMarker605"/>attacker has finished collecting credentials, entering <em class="keystroke">Ctrl</em> + <em class="keystroke">C</em> will generate two reports in the <code class="inlineCode">/SET/reports</code> directory in XML and HTML formats.</p>
    <p class="normal">Note that the address in the URL bar is not the valid address for Facebook; most users will recognize that something is wrong if they can see the address. A successful exploit requires the attacker to prepare the victim with a suitable pretext, or story, to make the victim accept the unusual URL. For example, send an email to a targeted group of non-technical managers to announce that a local Facebook site is now being hosted by IT to reduce delays in the email system.</p>
    <p class="normal">The credential harvesting attack is an excellent tool for assessing the security of a corporate network. To be effective, the organization must first train all the employees on how to recognize and respond to a phishing attack. Approximately two weeks later, send a corporate-wide email that contains some obvious mistakes (incorrect name of the corporate CEO or an address block that contains the wrong address) and a link to a program that harvests credentials. Calculate the percentage of recipients who responded <a id="_idIndexMarker606"/>with their credentials, and then tailor the training program to reduce this percentage.</p>
    <h2 id="_idParaDest-154" class="heading-2">Multi-attack web attack method</h2>
    <p class="normal">The Hail Mary attack for website attack vectors is a multi-attack web method that allows the attacker <a id="_idIndexMarker607"/>to implement several different attacks at one time, should they choose to. By default, all attacks are disabled, and the attacker chooses the ones to run against the victim. To launch this attack, select <code class="inlineCode">2) Website Attack Vectors</code> from the main menu, then select <code class="inlineCode">6) Multi-Attack Web Method</code>, and then select <code class="inlineCode">2) Site Cloner</code>, as shown in <em class="italic">Figure 5.18</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.18: Multi-attack web attack vectors menu</p>
    <p class="normal">You can either select<code class="inlineCode"> 6. Use them all – A.K.A 'Tactical Nuke'</code> or enter the attack you want to perform by entering the right number; for <code class="inlineCode">Web Jacking Attack Method</code>, for example, enter <code class="inlineCode">5</code>.</p>
    <p class="normal">This is an <a id="_idIndexMarker608"/>effective option if you are unsure as to which attacks will be effective against a target organization; select one employee, determine the successful attack(s), and then reuse them against the other employees.</p>
    <h2 id="_idParaDest-155" class="heading-2">HTA web attack method</h2>
    <p class="normal">This type of attack is a simple HTML application that can provide full access to the remote attacker. The usual file extension of an HTA is <code class="inlineCode">.hta</code>. An HTA is treated like any executable <a id="_idIndexMarker609"/>file with the extension <code class="inlineCode">.exe</code>. When executed via <code class="inlineCode">mshta.exe</code> (or when the file icon is double-clicked), it runs immediately. When executed remotely via the browser, the user is asked once, before the HTA is downloaded, whether or not to save and run the application; if saved, it can simply be run on demand after that.</p>
    <p class="normal">An attacker can create a malicious application for Windows using web technologies. To launch an HTA attack using social engineering toolkit, select <code class="inlineCode">1) Social-Engineering Attacks</code> from the main menu. Then, select <code class="inlineCode">2) Website Attack Vectors</code> from the next menu, and select <code class="inlineCode">7) HTA Attack Method</code>, followed by <code class="inlineCode">2) Site Cloner,</code> to clone any website. In this case, we will clone <code class="inlineCode">facebook.com</code>, as shown in <em class="italic">Figure 5.19</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_19.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.19: Successful setup of an HTA attack web attack by cloning facebook.com</p>
    <p class="normal">Attackers will <a id="_idIndexMarker610"/>now send the server with the fake <code class="inlineCode">facebook.com</code> site to the victim users to phish for information; <em class="italic">Figure 5.20</em> depicts what a victim would see:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_20.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.20: Victim’s screen, which pops up with the delivery of HTA payload to the endpoint</p>
    <p class="normal">If the victim <a id="_idIndexMarker611"/>user runs the HTA file locally on the system, an additional pop-up from Internet Explorer security will open up the reverse connection to the attackers, as shown in <em class="italic">Figure 5.21</em>. SET should automatically set up with a listener from Metasploit:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.21: Successful payload execution leading to Metasploit reverse shell of the victim</p>
    <h2 id="_idParaDest-156" class="heading-2">Using the PowerShell alphanumeric shellcode injection attack</h2>
    <p class="normal">SET also incorporates more effective attacks based on PowerShell, which is available on all Microsoft <a id="_idIndexMarker612"/>operating systems after the release of Microsoft Windows Vista. Because PowerShell shellcode can easily be injected into the target’s physical memory, attacks using this vector do not trigger antivirus alarms.</p>
    <p class="normal">To launch a PowerShell injection attack using SET, select <code class="inlineCode">1) Social-Engineering Attacks</code> from the main menu. Then select <code class="inlineCode">9) PowerShell Attack Vectors</code> from the next menu. This will give the attacker four options for attack types; for this example, select <code class="inlineCode">1</code> to invoke the PowerShell alphanumeric shellcode injector. This will set the attack parameters and prompt the attacker to enter the IP address for the payload listener, which will usually be the IP address of the attacker. When this has been entered, the program will create the exploit code and start a local listener.</p>
    <p class="normal">The PowerShell shellcode that launches the attack is stored at <code class="inlineCode">/root/.set/reports/ powershell/x86_powershell_injection.txt</code>. The social engineering aspect of the attack occurs when the attacker convinces the intended victim to copy the contents of <code class="inlineCode">x86_powershell_injection.txt</code> into a PowerShell prompt, as shown in <em class="italic">Figure 5.22</em>, and execute the code:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_22.png" alt=""/></figure>
    <figure class="mediaobject">Figure 5.22: PowerShell payload in the /root/.set/reports/powershell folder</figure>
    <p class="normal">As shown in <em class="italic">Figure 5.23</em>, execution of the shellcode did not trigger an antivirus alarm on the target system. Instead, when the code was executed, it opened a Meterpreter session on the attacking system and allowed the attacker to gain an interactive shell with the remote system:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_23.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.23: Confirmation of Metasploit reverse shell from the victim to our listener on SET</p>
    <p class="normal">Once the <a id="_idIndexMarker613"/>remote system access is gained, the attackers should create a backdoor, which we will explore in <em class="chapterRef">Chapter 13</em>, <em class="italic">Command and Control</em>. We have now explored the important techniques that can be used by attackers during a social engineering exercise using SET.</p>
    <h1 id="_idParaDest-157" class="heading-1">Hiding executables and obfuscating the attacker’s URL</h1>
    <p class="normal">As shown in the previous examples, there are two keys to successfully launching a social engineering <a id="_idIndexMarker614"/>attack. The first is to obtain the information needed to make it work: usernames, business information, and supporting details about networks, systems, and applications. The majority of the effort, however, is focused on the second aspect: crafting the attack to entice the target into opening an executable or clicking on a link.</p>
    <p class="normal">Several attacks produce modules that require the victim to execute them in order for the attack to succeed. Unfortunately, users are increasingly wary about executing unknown software. There <a id="_idIndexMarker615"/>are, however, some ways to increase the possibility of successful attack execution, including the following:</p>
    <ul>
      <li class="bulletList">Launch an attack from a system that is known and trusted by the intended victim or spoof the source of the attack. If the attack appears to originate from the help desk or IT support and claims to be an urgent software update, it will likely be executed:<ul>
          <li class="bulletList">Rename the executable to something that resembles the trusted software, such as <code class="inlineCode">Java Update</code>.</li>
          <li class="bulletList">Embed the malicious payload into a benign file, such as a PDF file, using an attack, such as Metasploit’s <code class="inlineCode">adobe_pdf_embedded_exe_nojs</code> attack.</li>
          <li class="bulletList">Executables can also be bound to Microsoft Office files, MSI install files, or BAT files configured to run silently on the desktop.</li>
          <li class="bulletList">Have the user click on a link that downloads the malicious executable.</li>
        </ul>
      </li>
      <li class="bulletList">Since the SET uses the attacker’s URL as the destination for its attacks, a key success factor is to ensure that the attacker’s URL is believable to the victim. There are several techniques used to accomplish this, including the following: <ul>
          <li class="bulletList">Shorten the URL using a service, such as <a href="https://goo.gl/"><span class="url">https://goo.gl/</span></a>or <a href="http://tinyurl.com"><span class="url">tinyurl.com</span></a>. These shortened URLs are common among social media platforms, such as Twitter, and victims rarely use precautions when clicking on such links.</li>
          <li class="bulletList">Enter the link on a social media site, such as Facebook or LinkedIn; the site will create its own link to replace yours, with an image of the destination page. Then, remove the link that you entered, leaving behind the new social media link.</li>
          <li class="bulletList">Create a fake web page on LinkedIn or Facebook; as the attacker, you control the content, and can create a compelling story to drive members to click on links or download executables. A well-executed page will not only target employees, but also vendors, partners, and their clients, maximizing the success of a social engineering attack.</li>
        </ul>
      </li>
    </ul>
    <h1 id="_idParaDest-158" class="heading-1">Escalating an attack using DNS redirection</h1>
    <p class="normal">If an attacker or penetration tester has compromised a host on the internal network, they can <a id="_idIndexMarker616"/>escalate the attack using DNS redirection. This is generally considered to be a horizontal attack (it compromises persons of <a id="_idIndexMarker617"/>roughly the same access privileges); however, it can also escalate vertically if the credentials from privileged persons are captured. In this example, we will use bettercap (to be explored in more detail in <em class="chapterRef">Chapter 11</em>, <em class="italic">Action on the Objective and Lateral Movement</em>) as a sniffer, interceptor, and logger for switched LANs. It facilitates man-in-the-middle attacks, but we will use it to launch a DNS-redirection attack to divert users to sites used for our social engineering attacks.</p>
    <p class="normal">To start the attack, we need to install bettercap, which is not installed by default in the latest version of Kali. This can be achieved by running <code class="inlineCode">sudo apt install bettercap</code>. We should be able to activate any module that is required; for example, we will now try the DNS spoof attack module on the target by creating a file called <code class="inlineCode">dns.conf</code> with the IP and domain details, as shown in <em class="italic">Figure 5.24</em>. This will enable any request made to <code class="inlineCode">microsoft.com</code> on the network to be forwarded to the attacker’s IP, in this example <code class="inlineCode">192.168.0.103</code>.</p>
    <p class="normal">Let’s run the default Apache server on our Kali Linux by activating the service by running <code class="inlineCode">sudo systemctl start apache2.service,</code> run bettercap by entering<code class="inlineCode"> sudo bettercap </code>in the terminal, load our DNS configuration with <code class="inlineCode">set dns.spoof.hosts dns.conf</code>, and then turn on DNS spoofing by running <code class="inlineCode">dns.spoof on</code> in the bettercap terminal:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_24.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.24: Configuring bettercap to sniff the network</p>
    <p class="normal">To ensure <a id="_idIndexMarker618"/>that all the targets on the network <a id="_idIndexMarker619"/>are poised first, testers need to enable network sniffing and ARP spoofing modules by typing <code class="inlineCode">net.sniff on</code> and <code class="inlineCode">arp.spoof on</code> in the bettercap terminal. Successful DNS redirection will be captured in the bettercap terminal, as shown in <em class="italic">Figure 5.25</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.25: Successful redirection of DNS Microsoft.com to the attacker’s IP</p>
    <p class="normal">When the victims on the network visit <code class="inlineCode">microsoft.com</code>, they will be sent to the Apache service that is hosted on the attacker’s IP. Attackers can choose to clone the <code class="inlineCode">microsoft.com</code> and host it on their Apache server. This attack is more successful in an internal infrastructure where there is no additional DNS security protection. Most companies have DNS protection on their external infrastructure, such as Cloudflare, AWS Shield, and Akamai.</p>
    <h2 id="_idParaDest-159" class="heading-2">Spear phishing attack</h2>
    <p class="normal">Phishing is an email fraud attack carried out against a large number of victims, such as a list of <a id="_idIndexMarker620"/>known American internet users. The targets are generally not connected, and the email does not attempt to appeal to any specific individual.</p>
    <p class="normal">Instead, it contains an item of general interest (for example, <em class="italic">Click here to get COVID-19 vaccination</em>) and a malicious link or attachment. The attacker plays the odds that at least some people will click on the attachment to initiate the attack.</p>
    <p class="normal">On the other hand, spear phishing is a highly specific form of phishing attack; by crafting the email message in a particular way, the attacker hopes to attract the attention of a specific audience. For example, if the attacker knows that the sales department uses a particular application to manage its customer relationships, they may spoof an email pretending that it is from the application’s vendor with a subject line of <code class="inlineCode">Emergency fix for &lt;application&gt; - Click link to download.</code></p>
    <p class="normal">The following steps are involved in successfully launching a spear phishing attack:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Before launching the attack, ensure that <code class="inlineCode">sendmail</code> is installed on Kali (<code class="inlineCode">sudo apt-get install sendmail</code>) and change from <code class="inlineCode">SENDMAIL=OFF</code> to <code class="inlineCode">SENDMAIL=ON</code> inside the <code class="inlineCode">set.config</code> file located in <code class="inlineCode">/etc/setoolkit/</code>.<div class="note">
          <p class="normal">If testers receive any error messages related to <code class="inlineCode">broken package exim*</code>, you should run <code class="inlineCode">sudo apt-get purge exim4-base exim4-config</code> and then run <code class="inlineCode">sudo apt-get install sendmail</code>.</p>
        </div>
      </li>
      <li class="numberedList">To perform the attack, launch SET and then select <code class="inlineCode">Social Engineering Attacks</code> from the main menu, and then select <code class="inlineCode">Spear-Phishing Attack Vectors</code> from the submenu. This will launch the start options for the attack, as shown in <em class="italic">Figure 5.26</em>:<figure class="mediaobject"><img src="../Images/B17765_05_26.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.26: Spear phishing main menu</p>
      </li>
      <li class="numberedList">Select <code class="inlineCode">1</code> to perform <a id="_idIndexMarker621"/>a mass email attack; you will then be presented with a list of attack payloads, as shown in <em class="italic">Figure 5.27</em>:<figure class="mediaobject"><img src="../Images/B17765_05_27.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.27: List of available exploits within the spear phishing module</p>
      </li>
      <li class="numberedList">The attacker <a id="_idIndexMarker622"/>can select any available payload, according to the attacker’s knowledge of available targets gained during the reconnaissance phase. In this example, we will take the <code class="inlineCode">7) Adobe Flash Player "Button" Remote Code Execution</code> option.<p class="normal">When you select <code class="inlineCode">7</code>, you will be prompted to select the payloads, as shown in <em class="italic">Figure 5.28</em>. We have utilized Windows Meterpreter reverse shell HTTPS for this example:</p>
        <figure class="mediaobject"><img src="../Images/B17765_05_28.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.28: Supported payloads within the framework</p>
        <p class="normal">Once the <a id="_idIndexMarker623"/>payload and exploit are ready from the SET console, attackers will get the confirmation shown in <em class="italic">Figure 5.29</em>:</p>
        <figure class="mediaobject"><img src="../Images/B17765_05_29.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.29: Creating a PDF file with the Adobe exploit </p>
      </li>
      <li class="numberedList">Now, you will be able to rename the file by selecting option <code class="inlineCode">2. Rename the file, I want to be cool</code>. </li>
      <li class="numberedList">Once you rename the file, you will be provided with two options to select, either <code class="inlineCode">E-mail Attack Single Email Address</code> or <code class="inlineCode">E-mail Attack Mass Mailer</code>.</li>
      <li class="numberedList">Attackers <a id="_idIndexMarker624"/>can choose the mass mailer or individually target a weaker victim, depending on their preference. If we use a single email address, SET provides further templates that can be utilized by the attackers, as shown in <em class="italic">Figure 5.30</em>:<figure class="mediaobject"><img src="../Images/B17765_05_30.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.30: Available pre-defined templates for a single email address as the target</p>
      </li>
      <li class="numberedList">After you select the phishing template, you will be offered the option of using your own Gmail account to launch the attack (<code class="inlineCode">1</code>) or using your own server or open relay (<code class="inlineCode">2</code>). If you use a Gmail account, it is likely that the attack will fail; Gmail inspects outgoing emails for malicious files and is very effective at identifying payloads produced by SET and the Metasploit framework. If you have to send a payload using Gmail, use Veil 3.1 to encode it first.</li>
    </ol>
    <p class="normal">It is recommended <a id="_idIndexMarker625"/>that you use the <code class="inlineCode">sendmail</code> option to send executable files; it allows you to spoof the source of the email to make it appear as though it originated from a trusted source. To ensure that an email is effective, the attacker should take note of the following points:</p>
    <ul>
      <li class="bulletList">The content should provide an inducement (the new server will be faster, have improved antivirus) and a stick (changes you will have to make before you can access your email). Most people respond to immediate calls for action, particularly when it affects them.</li>
      <li class="bulletList">In the sample given previously, the attached document is titled <code class="inlineCode">template.pdf</code>. In a real-world scenario, this would be changed to <code class="inlineCode">instructions.pdf</code>.</li>
      <li class="bulletList">Ensure that your spelling and grammar are correct, and the tone of the message matches the content.</li>
      <li class="bulletList">The title of the individual sending the email should match the content.</li>
      <li class="bulletList">If the target organization is small, you may have to spoof the name of a real individual and send the email to a small group that would not normally interact with that person.</li>
      <li class="bulletList">Include a phone number; it makes the email look more official, and there are various ways to use commercial voice over IP solutions to obtain a short-term phone number with a local area code.</li>
    </ul>
    <p class="normal">Once the attack email is sent to the target, successful activation (the recipient launches the executable) will create a reverse Meterpreter tunnel to the attacker’s system. The attacker will then be able to control the compromised system.</p>
    <h2 id="_idParaDest-160" class="heading-2">Email phishing using Gophish</h2>
    <p class="normal">Gophish is a fully integrated open-source phishing framework and also has commercial support. The <a id="_idIndexMarker626"/>framework makes it easy for any type of <a id="_idIndexMarker627"/>user to quickly create a phishing campaign and deploy a sophisticated phishing simulation or perform a real attack within a few minutes. Unlike SET, Gophish is not preinstalled on Kali Linux. In this section, we will explore how to set up the environment:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Download the right release, according to your system configuration, by visiting <a href="https://github.com/gophish/gophish/releases"><span class="url">https://github.com/gophish/gophish/releases</span></a>. In this book, we will utilize the gophish-v0.11.1 64-bit Linux version.</li>
      <li class="numberedList">Once the app is download to Kali Linux, we will unzip the folder and configure the <code class="inlineCode">config.json</code> file with the right information; attackers can choose to utilize any custom database, such as MySQL, MSSQL, and so on. We will use <code class="inlineCode">sqlite3</code>; an explicit IP address must be declared in <code class="inlineCode">listen_url</code> if testers prefer to share the same resource over the LAN, as shown in <em class="italic">Figure 5.31</em>. It is set to <code class="inlineCode">0.0.0.0</code> to listen on all Ethernet adapters. <p class="normal">By default, it will be exposed only to the localhost:</p>
        <figure class="mediaobject"><img src="../Images/B17765_05_31.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.31: Changing the Gophish configuration files and setting the listen URL to 0.0.0.0:3333</p>
      </li>
      <li class="numberedList">The next <a id="_idIndexMarker628"/>step is to change the file permission <a id="_idIndexMarker629"/>to execute by running <code class="inlineCode">chmod +x gophish</code> in the Kali Linux terminal. Finally, run the application by typing <code class="inlineCode">sudo ./gophish</code> from the same folder, which should bring up the Gophish web application portal on port <code class="inlineCode">3333</code> by default, with a self-signed SSL certificate. To avoid the default credentials for the application, the latest version of Gophish generates a temporary password for the <code class="inlineCode">admin</code> user during the initial startup script, as shown in <em class="italic">Figure 5.32</em>:<figure class="mediaobject"><img src="../Images/B17765_05_32.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.32: Auto generated admin user password when Gophish is launched</p>
      </li>
      <li class="numberedList">You should <a id="_idIndexMarker630"/>now be able to access the <a id="_idIndexMarker631"/>application by visiting <code class="inlineCode">https://yourIP:3333</code>; you should now be able to log in with the user <code class="inlineCode">admin</code> and the password captured from the previous step. This should force the testers to reset their initial password, as shown in <em class="italic">Figure 5.33</em>:<figure class="mediaobject"><img src="../Images/B17765_05_33.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.33: Forced password reset screen of Gophish after successful login for user admin</p>
      </li>
    </ol>
    <div class="note">
      <p class="normal">Testers will receive a certificate error in the browser when it is hosted internally with the Gophish self-signed certificates.</p>
    </div>
    <h1 id="_idParaDest-161" class="heading-1">Launching a phishing attack using Gophish</h1>
    <p class="normal">There are <a id="_idIndexMarker632"/>prerequisites that need to be set up <a id="_idIndexMarker633"/>in Gophish before launching a phishing campaign. They can be broadly divided into several important steps to do before launching a successful campaign:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1"><strong class="keyWord">Templates</strong>: Templates are a very crucial part of phishing; you must be able to create your own templates based on your game plan. The most commonly used templates are Office365, Webmail, and internal Facebook and Gmail logins. Some of the templates can be found at <a href="https://github.com/PacktPublishing/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E/tree/main/Chapter%2005"><span class="url">https://github.com/PacktPublishing/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E/tree/main/Chapter%2005</span></a>. <p class="normal">The following simple steps are involved in creating the templates: while in the Templates section, click on <strong class="screenText">New Template</strong>, enter details in the <strong class="screenText">Name</strong> and <strong class="screenText">Subject </strong>fields, click on HTML, copy the raw HTML contents from the templates, paste them in the editor, and click on <strong class="screenText">Save Template</strong>.</p>
      </li>
      <li class="numberedList"><strong class="keyWord">Landing Pages</strong>: The effectiveness of the phishing campaign will always relate to how you redirect the victims to a legitimate website using the landing pages.<p class="normal">Similar to the steps under Templates, navigate to Landing Page on the left menu, click on <strong class="screenText">New page,</strong> enter the <strong class="screenText">Name</strong>, and copy and paste the template—you may also directly import a site. Finally, click on <strong class="screenText">Save Page</strong>.</p>
      </li>
      <li class="numberedList"><strong class="keyWord">Sending Profiles</strong>: A profile is the place where you will have all the SMTP details and sender details; Gophish allows attackers to have multiple profiles defined, along with custom email headers.<p class="normal">To create a profile, click on <strong class="screenText">Send Profile</strong>, <strong class="screenText">New Profile</strong>, and enter the <strong class="screenText">Name</strong> and <strong class="screenText">Interface type</strong>; by default, it should be <strong class="screenText">SMTP</strong>. Enter the <strong class="screenText">From</strong> section with an Email ID of your choosing. <strong class="screenText">Host </strong>is the SMTP server—attackers can choose their own or use an existing service, such as AWS. In our case, we will use <code class="inlineCode">smtp.gmail.com:465</code> and enter the <strong class="screenText">username</strong> and <strong class="screenText">password</strong>. Most anti-phishing solutions block emails based on the header information. Therefore, try using the <strong class="screenText">Email headers</strong> <code class="inlineCode">Microsoft Office Outlook XX</code> or <code class="inlineCode">Outlook Express for Macintosh</code>. If all the settings are working, you can click <a id="_idIndexMarker634"/>on <strong class="screenText">Send Test Email</strong>. A successful <a id="_idIndexMarker635"/>test email should look similar to the one shown in <em class="italic">Figure 5.34</em>. Finally, click on <strong class="screenText">Save Profile</strong>:</p>
        <figure class="mediaobject"><img src="../Images/B17765_05_34.png" alt=""/></figure>
        <p class="packt_figref">Figure 5.34: Default email from Gophish</p>
        <div class="note">
          <p class="normal">Testers using the Gmail services must ensure that <strong class="screenText">Less secure App access </strong>is turned on to allow the third-party application to use the services. This can be achieved by visiting <a href="https://myaccount.google.com/lesssecureapps?pli=1"><span class="url">https://myaccount.google.com/lesssecureapps?pli=1</span></a> and turning on <strong class="screenText">Allow less secure apps</strong>.</p>
        </div>
      </li>
      <li class="numberedList"><strong class="keyWord">Users and groups</strong>: Upload single or multiple targeted victims’ email IDs with their first and last names. Gophish allows testers to create groups and import them in CSV format.<p class="normal">Navigate to <strong class="screenText">Users &amp; Groups</strong> from the menu, click on <strong class="screenText">New Group</strong>, and either import a CSV-formatted file or manually enter the first name, last name, email ID, and position. Click on <strong class="screenText">Add </strong>and then click on <strong class="screenText">Save Changes</strong>.</p>
      </li>
      <li class="numberedList"><strong class="keyWord">Account Management</strong>: A single instance can spin multiple phishing campaigns; hence individual users can have their own account to the portal.</li>
      <li class="numberedList"><strong class="keyWord">Webhook</strong>: A webhook is simply a web callback or HTTP push <strong class="keyWord">Application Programming Interface</strong> (<strong class="keyWord">API</strong>). This option allows the testers to implement a webhook, which can help push the results directly to any third-party API.</li>
    </ol>
    <p class="normal">Once we <a id="_idIndexMarker636"/>have all the templates, landing pages, users, and <a id="_idIndexMarker637"/>sending profiles set, we are now set to launch the campaign by clicking on the <strong class="screenText">Campaigns </strong>from the menu. Then click on <strong class="screenText">New Campaign</strong> and enter the <strong class="screenText">Name</strong> of the campaign. Select the <strong class="screenText">Email template</strong>, <strong class="screenText">Landing Page</strong>, and provide the <strong class="screenText">URL</strong> of the host/IP that will serve the phishing pages; typically, this would be the same Kali Linux IP address as where Gophish is running. Select <strong class="screenText">Launch date</strong> or schedule the date and time, select the <strong class="screenText">Sending profile</strong> that was created, select the <strong class="screenText">Groups</strong>, as shown in <em class="italic">Figure 5.35</em>, and finally click <strong class="screenText">Launch Campaign</strong>. We can select the date and time when the phishing will start and the group of target victims. Gophish also provides an option to test an email to see whether it was blocked or delivered straight to the target’s inbox, depending on the templates selected:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_35.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.35: Launching an email campaign on specific targets</p>
    <p class="normal">Once the <a id="_idIndexMarker638"/>campaign is successfully launched, the victim <a id="_idIndexMarker639"/>should receive an email based on the templates that were chosen during the campaign selection. An email with the <code class="inlineCode">Microsoft Teams Unread messages</code> template would look similar to that shown in <em class="italic">Figure 5.36</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_36.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.36: Sample phishing email that uses the Microsoft Teams Unread template</p>
    <p class="normal">When the <a id="_idIndexMarker640"/>target user clicks on any link in the email, they <a id="_idIndexMarker641"/>will be taken to the Landing Page along with the Unique RID number that is generated by Gophish to the target user. A sample Office 365 landing page should be seen, as shown in <em class="italic">Figure 5.37</em>: </p>
    <figure class="mediaobject"><img src="../Images/B17765_05_37.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.37: Sample Office 365 landing page when the victim clicks on the link </p>
    <p class="normal">The same landing page can also be hooked with a BeEF framework to hijack browsers to take advantage of the users’ current browser sessions; however, we will explore the details of BeEF in <em class="chapterRef">Chapter 7</em>, <em class="italic">Exploiting Web-Based Applications</em>.</p>
    <p class="normal">Finally, the <a id="_idIndexMarker642"/>testers can track all the emails <a id="_idIndexMarker643"/>sent, opened, clicked, and submitted per campaign launched, as shown in <em class="italic">Figure 5.38</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_38.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.38: Gophish dashboard</p>
    <p class="normal">The <strong class="screenText">Email Reported </strong>option includes the users who spotted the phishing emails and reported them as suspicious. Typically, an internal IT security team member can use this output to evaluate their users’ cyber-security awareness.</p>
    <p class="normal">We now have explored how to download, install, and run Gophish, along with launching an email phishing campaign.</p>
    <h1 id="_idParaDest-162" class="heading-1">Using bulk transfer as phishing to deliver payloads</h1>
    <p class="normal">Attackers <a id="_idIndexMarker644"/>can also utilize bulk file transfer software, such as Smash, Hightail, Terashare, WeTransfer, SendSpace, and DropSend. Let’s take a simple scenario: assume we have targeted two people, a finance administrator and a CEO. Attackers can simply send files between these two victims, visiting one of the bulk transfer websites, such as <code class="inlineCode">sendspace.com</code>, and upload a malicious file, while setting the sender as <code class="inlineCode">Financeadmin@targetcompany.com</code>, and <code class="inlineCode">ceo@targetcompany.com</code> as the receiver. Once the file is uploaded, both parties will receive the emails with the file link; in this case, <code class="inlineCode">ceo@targetcompany.com</code> will receive an email stating <a id="_idIndexMarker645"/>that the file was sent successfully, and <code class="inlineCode">Financeadmin@cyberhia.com</code> will receive something similar, as shown in <em class="italic">Figure 5.39</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_05_39.png" alt=""/></figure>
    <p class="packt_figref">Figure 5.39: Sendspace bulk transfer emails</p>
    <p class="normal">Most of the time, these bulk transfers are not on the blocked list in a corporate environment (if one is blocked, attackers can switch to another), so they provide direct access to internal staff and create an effective message, and an undetectable payload will provide a better success rate, without revealing the identity of the attackers.</p>
    <h1 id="_idParaDest-163" class="heading-1">Summary</h1>
    <p class="normal">Social engineering is a method of hacking humans, taking advantage of a person’s inherent trust and helpfulness to attack a network and its devices. In this chapter, we examined how social engineering can be used to facilitate attacks designed to capture credentials, activate malicious software, or assist in launching further attacks. Most of the attacks rely on SET and Gophish; however, Kali has several other applications that can be improved using a social engineering methodology. We explored how new bulk transfer companies can potentially be utilized to spread the payload without having to use any email services to perform phishing. We also examined how physical access, usually in conjunction with social engineering, can be used to place hostile devices on a target network.</p>
    <p class="normal">In the next chapter, we will examine how to conduct reconnaissance against wireless networks and attack open networks, as well as networks that are protected with encryption schemes based on WPA2. We will also examine general weaknesses in wireless and Bluetooth protocols that render them vulnerable to denial-of-service attacks, along with impersonation attacks.</p>
  </div>
</body></html>