<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Attacking the Client"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Attacking the Client</h1></div></div></div><div class="blockquote"><table border="0" cellpadding="0" cellspacing="0" class="blockquote" summary="Block quote" width="100%"><tr><td valign="top"> </td><td valign="top"><p><span class="emphasis"><em>"Security is just as strong as the weakest link."</em></span></p></td><td valign="top"> </td></tr><tr><td valign="top"> </td><td align="right" colspan="2" style="text-align: center" valign="top">--<span class="attribution"><span class="emphasis"><em>Famous Quote in Information Security Domain</em></span></span></td></tr></table></div><p>
<span class="emphasis"><em>Most penetration testers seem to give all their attention to the WLAN infrastructure and don't give the wireless client even a fraction of that. However, it is interesting to note that a hacker can gain access to the authorized network by compromising a wireless client as well.</em></span>
</p><p>
<span class="emphasis"><em>In this chapter, we will shift our focus from the WLAN infrastructure to the wireless client. The client can be either a connected or isolated unassociated client. We will take a look at the various attacks that can be used to target the client.</em></span>
</p><p>We will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Honeypot and Misassociation attacks</li><li class="listitem" style="list-style-type: disc">The Caffe Latte attack</li><li class="listitem" style="list-style-type: disc">Deauthentication and disassociation attacks</li><li class="listitem" style="list-style-type: disc">The Hirte attack</li><li class="listitem" style="list-style-type: disc">AP-less WPA-Personal cracking</li></ul></div><div class="section" title="Honeypot and Misassociation attacks"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec61"/>Honeypot and Misassociation attacks</h1></div></div></div><p>Normally, when a<a class="indexterm" id="id186"/> wireless client such as a laptop is turned on, it will probe for networks it has previously connected to. These<a class="indexterm" id="id187"/> networks are stored in a list called the <span class="strong"><strong>Preferred Network List</strong></span> (<span class="strong"><strong>PNL</strong></span>) on Windows-based systems. Also, along with<a class="indexterm" id="id188"/> this list, the wireless client will display any networks available in its range.</p><p>A hacker may do one or more of the following things:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Silently monitor the probes and bring up a fake access point with the same ESSID the client is searching for. This will cause the client to connect to the hacker machine, thinking it is the legitimate network.</li><li class="listitem" style="list-style-type: disc">Create fake<a class="indexterm" id="id189"/> access points with the same ESSID as neighboring ones to persuade the user to connect to him. Such attacks are very easy to conduct in coffee shops and airports where a user might be looking to connect to a Wi-Fi connection.</li><li class="listitem" style="list-style-type: disc">Use recorded information to learn about the victim's movements and habits, as we show in detail in a later chapter.</li></ul></div><p>These attacks are <a class="indexterm" id="id190"/>called <span class="strong"><strong>Honeypot attacks</strong></span>, because the hacker's access point is misassociated with the legitimate one.</p><p>In the next exercise, we will carry out both these attacks in our lab.</p></div></div>
<div class="section" title="Time for action &#x2013; orchestrating a Misassociation attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec62"/>Time for action – orchestrating a Misassociation attack</h1></div></div></div><p>Follow these<a class="indexterm" id="id191"/> instructions to get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the previous labs, we used a client that had connected to the <code class="literal">Wireless Lab</code> access point. Let's switch on the client but not the actual <code class="literal">Wireless Lab</code> access point. Let's now run <code class="literal">airodump-ng wlan0mon</code> and check the output. You will very soon find the client to be in the <code class="literal">not associated</code> mode and probing for <code class="literal">Wireless Lab</code> and other SSIDs in its stored profile:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_01.jpg"/></div></li><li class="listitem">To understand<a class="indexterm" id="id192"/> what is happening, let's run Wireshark and start sniffing on the <code class="literal">wlan0mon</code> interface. As expected, you might see a lot of packets that are not relevant to our analysis. Apply a Wireshark filter to only display Probe Request packets from the client MAC you are using. The filter should be <code class="literal">wlan.addr==&lt;your mac&gt; &amp;&amp; wlan.fc.subtype==0x04)</code>:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_02.jpg"/></div></li><li class="listitem">You should<a class="indexterm" id="id193"/> now see Probe Request packets only from the client for the previously identified SSIDs.</li><li class="listitem">Let's now start a fake access point for the network <code class="literal">Wireless Lab</code> on the hacker machine using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>airbase-ng -a &lt;MAC&gt; --essid "Wireless Lab" -c &lt;channel&gt; wlan0mon</strong></span>
</pre></div><div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_03.jpg"/></div></li><li class="listitem">Within a minute or so, the client should connect to us automatically. This shows how easy it is to have unassociated clients:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_04.jpg"/></div></li><li class="listitem">Now, we will try<a class="indexterm" id="id194"/> it in competition with another router. We will create a fake access point <code class="literal">Wireless Lab</code> in the presence of the legitimate one. Let's turn our access point on to ensure that <code class="literal">Wireless Lab</code> is available to the client. For this experiment, we have set the access point channel to <code class="literal">13</code>. Let the client connect to the access point. We can verify this from <code class="literal">airodump-ng</code>, as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_05.jpg"/></div></li><li class="listitem">Now, let's bring up our fake access point with the SSID <code class="literal">Wireless Lab</code>:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_06.jpg"/></div></li><li class="listitem">Notice<a class="indexterm" id="id195"/> that the client is still connected to <code class="literal">Wireless Lab</code>, the legitimate access point:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_07.jpg"/></div></li><li class="listitem">We will now send broadcast deauthentication messages to the client on behalf of the legitimate access point to break their connection:<div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_08.jpg"/></div></li></ol></div><p>Assuming the signa<a class="indexterm" id="id196"/>l strength of our fake access point <code class="literal">Wireless Lab</code> is stronger than the legitimate one to the client, it connects to our fake access point instead of the legitimate access point.</p><p>We can verify this by looking at the <code class="literal">airbase-ng</code> output to see the new association of the client with our fake access point:</p><div class="mediaobject"><img alt="Time for action – orchestrating a Misassociation attack" src="graphics/B09903_06_09.jpg"/></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec56"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We just created a Honeypot using the probed list from the client and using the same ESSID as that of neighboring access points. In the first case, the client automatically connected to us, as it was searching for the network. In the latter case, as we were closer to the client than the real access point, our signal strength was higher, and the client connected to us.</p></div><div class="section" title="Have a go hero – forcing a client to connect to the Honeypot"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec57"/>Have a go hero – forcing a client to connect to the Honeypot</h2></div></div></div><p>In the previous exercise, what <a class="indexterm" id="id197"/>do we do if the client does not automatically connect to us? We would have to send a deauthentication packet to break the legitimate client-access point connection and then, if our signal strength is higher, the client will connect to our spoofed access point. Try this out by connecting a client to a legitimate access point, and then force them to connect to your Honeypot.</p></div></div>
<div class="section" title="The Caffe Latte attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec63"/>The Caffe Latte attack</h1></div></div></div><p>In the Honeypot attack, we<a class="indexterm" id="id198"/> noticed that clients will continuously probe for SSIDs they have connected to previously. If the client had connected to an access point using WEP, operating systems such as Windows cache and store the WEP key. The next time the client connects to the same access point, the Windows wireless configuration manager automatically uses the stored key.</p><p>The <span class="strong"><strong>Caffe Latte attack</strong></span> was invented by Vivek, one of the authors of this book, and was demonstrated in Toorcon 9, San Diego, USA. The Caffe Latte attack is a WEP attack that allows a hacker to retrieve the WEP key of the authorized network, using just the client. The attack does not require the client to be anywhere close to the authorized WEP network. It can crack the WEP key using just the isolated client.</p><p>In the next exercise, we will retrieve the WEP key of a network from a client using the Caffe Latte attack.</p></div>
<div class="section" title="Time for action &#x2013; conducting the Caffe Latte attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec64"/>Time for action –  conducting the Caffe Latte attack</h1></div></div></div><p>Follow these instructions to<a class="indexterm" id="id199"/> get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's first set up our legitimate access point with WEP for the network <code class="literal">Wireless Lab</code> with the <code class="literal">ABCDEFABCDEFABCDEF12</code> key in hex:<div class="mediaobject"><img alt="Time for action – conducting the Caffe Latte attack" src="graphics/B09903_06_10.jpg"/></div><p>Let's connect our<a class="indexterm" id="id200"/> client to it and verify that the connection is successful using <code class="literal">airodump-ng</code>, as shown in the following screenshot:</p><div class="mediaobject"><img alt="Time for action – conducting the Caffe Latte attack" src="graphics/B09903_06_11.jpg"/></div></li><li class="listitem">Let's unplug the access point and ensure that the client is in the unassociated stage and searches for the WEP network <code class="literal">Wireless Lab</code>.</li><li class="listitem">Now, we use <code class="literal">airbase-ng</code> to bring up an access point with <code class="literal">Wireless Lab</code> as the SSID, with the <a class="indexterm" id="id201"/>parameters <code class="literal">airbase-ng -a &lt;AP MAC&gt; --essid &lt;AP SSID&gt; -L -W 1 -c &lt;channel&gt; wlan0mon</code>, as shown here:<div class="mediaobject"><img alt="Time for action – conducting the Caffe Latte attack" src="graphics/B09903_06_12.jpg"/></div></li><li class="listitem">As soon as the client connects to this access point, <code class="literal">airbase-ng</code> starts the Caffe Latte attack, as shown here:<div class="mediaobject"><img alt="Time for action – conducting the Caffe Latte attack" src="graphics/B09903_06_13.jpg"/></div></li><li class="listitem">We now start <code class="literal">airodump-ng</code> to collect the data packets from this access point only, as we did before in the WEP cracking scenario <code class="literal">airodump-ng wlan0mon -c &lt;AP channel&gt; --essid &lt;AP SSID&gt; -w &lt;prefix&gt;</code>:<div class="mediaobject"><img alt="Time for action – conducting the Caffe Latte attack" src="graphics/B09903_06_14.jpg"/></div></li><li class="listitem">We also start <code class="literal">aircrack-ng</code> as in the WEP-cracking exercise we did before to begin the cracking<a class="indexterm" id="id202"/> process. The command line will be <code class="literal">aircrack-ng filename</code>, where the filename is the name of the file created by <code class="literal">airodump-ng</code>.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec58"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We were successful in retrieving the WEP key from just the wireless client without requiring an actual access point to be used or present in the vicinity. This is the power of the Caffe Latte attack.</p><p>In basic terms, a WEP access point doesn't need to prove to a client that it knows the WEP key in order to receive encrypted traffic. The first piece of traffic that will always be sent to a router upon connecting to a new network will be an ARP request to ask for an IP.</p><p>The attack works by bit flipping and replaying ARP packets sent by the wireless client post association with the fake access point created by us. These bit flipped ARP request packets cause more ARP response packets to be sent by the wireless client.</p><p>Bit-flipping takes an encrypted value and alters it to create a different encrypted value. In this circumstance, we can take an encrypted ARP request and create an ARP response with a high degree of accuracy. Once we send back a valid ARP response, we can replay this value over and over again to generate the traffic we need to decrypt the WEP key.</p><p>Note that all these packets are encrypted using the WEP key stored on the client. Once we are able to gather a large number of these data packets, <code class="literal">aircrack-ng</code> is able to recover the WEP key easily.</p></div><div class="section" title="Have a go hero – practise makes you perfect!"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec59"/>Have a go hero – practise makes you perfect!</h2></div></div></div><p>Try changing the WEP key and<a class="indexterm" id="id203"/> repeat the attack. This is a difficult attack and requires some practice to orchestrate successfully. It would also be a good idea to use Wireshark and examine the traffic on the wireless network.</p></div></div>
<div class="section" title="Deauthentication and disassociation attacks"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec65"/>Deauthentication and disassociation attacks</h1></div></div></div><p>We have seen <a class="indexterm" id="id204"/>deauthentication attacks in previous chapters as well in the context of the access point. In this chapter, we will explore this attack in the context of the client.</p><p>In the next lab, we will<a class="indexterm" id="id205"/> send deauthentication packets to just the client and break an established connection between the access point and the client.</p></div>
<div class="section" title="Time for action &#x2013; deauthenticating the client"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec66"/>Time for action – deauthenticating the client</h1></div></div></div><p>Follow these instructions<a class="indexterm" id="id206"/> to get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's first bring our access point <code class="literal">Wireless Lab</code> online again. Let's keep it running on WEP to prove that, even with encryption enabled, it is possible to attack the access point and client connection. Let's verify that the access point is up using <code class="literal">airodump-ng</code>:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_15.jpg"/></div></li><li class="listitem">Let's connect our client to this access point and verify it with <code class="literal">airodump-ng</code>:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_16.jpg"/></div></li><li class="listitem">We will now run <code class="literal">aireplay-ng</code> to target the access point connection:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_17.jpg"/></div></li><li class="listitem">The client gets<a class="indexterm" id="id207"/> disconnected and tries to reconnect to the access point. We can verify this using Wireshark, just as we did earlier:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_18.jpg"/></div></li><li class="listitem">We have<a class="indexterm" id="id208"/> now seen that, even in the presence of WEP encryption, it is possible to deauthenticate a client and disconnect it. The same is valid even in the presence of WPA/WPA2. Let's now set our access point to WPA encryption and verify it:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_19.jpg"/></div></li><li class="listitem">Let's connect our client to the access point and ensure that it is connected:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_20.jpg"/></div></li><li class="listitem">Let's now run <code class="literal">aireplay-ng</code> to disconnect the client from the access point:<div class="mediaobject"><img alt="Time for action – deauthenticating the client" src="graphics/B09903_06_21.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec60"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We just learnt how to<a class="indexterm" id="id209"/> disconnect a wireless client selectively from an access point using deauthentication frames even in the presence of encryption schemas such as WEP/WPA/WPA2. This was done by sending a deauthentication packet to just the access point-client pair, instead of sending a broadcast deauthentication to the entire network.</p></div><div class="section" title="Have a go hero – dissociation attack on the client"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec61"/>Have a go hero – dissociation attack on the client</h2></div></div></div><p>In the previous<a class="indexterm" id="id210"/> exercise, we used a deauthentication attack to break the connection. Try using a disassociation packet to break the established connection between a client and an access point.</p></div></div>
<div class="section" title="The Hirte attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec67"/>The Hirte attack</h1></div></div></div><p>We've already seen how to<a class="indexterm" id="id211"/> conduct the Caffe Latte attack. The Hirte attack extends the Caffe Latte attack using fragmentation techniques and allows almost any packet to be used.</p><p>More information on the<a class="indexterm" id="id212"/> Hirte attack is available on the Aircrack-ng website at <a class="ulink" href="http://www.aircrack-ng.org/doku.php?id=hirte">http://www.aircrack-ng.org/doku.php?id=hirte</a>.</p><p>We will now use <code class="literal">aircrack-ng</code> to conduct a Hirte attack on the same client.</p></div>
<div class="section" title="Time for action &#x2013; cracking WEP with the Hirte attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec68"/>Time for action – cracking WEP with the Hirte attack</h1></div></div></div><p>Follow these<a class="indexterm" id="id213"/> instructions to get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Create a WEP access point exactly as in the Caffe Latte attack using the <code class="literal">airbase-ng</code> tool. The only additional option is the <code class="literal">-N</code> option instead of the <code class="literal">-L</code> option to launch the Hirte attack:<div class="mediaobject"><img alt="Time for action – cracking WEP with the Hirte attack" src="graphics/B09903_06_22.jpg"/></div></li><li class="listitem">Start <code class="literal">airodump-ng</code> in a separate window to capture packets for the <code class="literal">Wireless Lab</code> Honeypot:<div class="mediaobject"><img alt="Time for action – cracking WEP with the Hirte attack" src="graphics/B09903_06_23.jpg"/></div></li><li class="listitem">Now, <code class="literal">airodump-ng</code> will start <a class="indexterm" id="id214"/>monitoring this network and storing the packets in the <code class="literal">Hirte-01.cap</code> file:<div class="mediaobject"><img alt="Time for action – cracking WEP with the Hirte attack" src="graphics/B09903_06_24.jpg"/></div></li><li class="listitem">Once the roaming client connects to our Honeypot AP, the Hirte attack is automatically launched by <code class="literal">airbase-ng</code>:<div class="mediaobject"><img alt="Time for action – cracking WEP with the Hirte attack" src="graphics/B09903_06_25.jpg"/></div></li><li class="listitem">We start <code class="literal">aircrack-ng</code> as in the case of the Caffe Latte attack and eventually, the key will be cracked.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec62"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We launched the Hirte<a class="indexterm" id="id215"/> attack against a WEP client that was isolated and away from the authorized network. We cracked the key exactly the same way as in the Caffe Latte attack case.</p></div><div class="section" title="Have a go hero – practise, practise, practise"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec63"/>Have a go hero – practise, practise, practise</h2></div></div></div><p>We recommend setting different WEP keys on the client and trying this exercise a couple of times to gain confidence. You may notice many times that you may have to reconnect the client to get it to work.</p></div></div>
<div class="section" title="AP-less WPA-Personal cracking"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec69"/>AP-less WPA-Personal cracking</h1></div></div></div><p>In <a class="link" href="ch04.html" title="Chapter 4. WLAN Encryption Flaws">Chapter 4</a>, <span class="emphasis"><em>WLAN Encryption Flaws</em></span>, we saw how to crack WPA/WPA2 PSK using <code class="literal">aircrack-ng</code>. The basic idea was to capture a four-way WPA handshake and then launch a dictionary attack.</p><p>The million-dollar<a class="indexterm" id="id216"/> question is: would it be possible to crack WPA-Personal with just the client? No, access point!</p><p>Let's revisit the WPA cracking exercise to jog our memory:</p><div class="mediaobject"><img alt="AP-less WPA-Personal cracking" src="graphics/B09903_06_26.jpg"/></div><p>To crack WPA, we<a class="indexterm" id="id217"/> need the following four parameters from the four-way<a class="indexterm" id="id218"/> handshake—<span class="strong"><strong>Authenticator Nounce</strong></span> (<span class="strong"><strong>ANonce</strong></span>), <span class="strong"><strong>Supplicant Nounce</strong></span> (<span class="strong"><strong>SNonce</strong></span>), Authenticator MAC, and Supplicant MAC. Now, the<a class="indexterm" id="id219"/> interesting thing is that we do not need all of the four packets in the handshake to extract this information. We can get this information with four packets; packets 1 and 2 or just packets 2 and 3.</p><p>In order to crack WPA-PSK, we will bring up a WPA-PSK Honeypot and, when the client connects to us, only <span class="strong"><strong>Message 1</strong></span> and <span class="strong"><strong>Message 2</strong></span> will come through. As we do not know the passphrase, we cannot send <span class="strong"><strong>Message 3</strong></span>. However, <span class="strong"><strong>Message 1</strong></span> and <span class="strong"><strong>Message 2</strong></span> contain all the information required to begin the key cracking process:</p><div class="mediaobject"><img alt="AP-less WPA-Personal cracking" src="graphics/B09903_06_27.jpg"/></div></div>
<div class="section" title="Time for action &#x2013; AP-less WPA cracking"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec70"/>Time for action – AP-less WPA cracking</h1></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We will set up a <a class="indexterm" id="id220"/>WPA-PSK Honeypot with the ESSID <code class="literal">Wireless Lab</code>. The <code class="literal">-z 2</code> option creates a WPA-PSK access point, which uses TKIP:<div class="mediaobject"><img alt="Time for action – AP-less WPA cracking" src="graphics/B09903_06_28.jpg"/></div></li><li class="listitem">Let's also start <code class="literal">airodump-ng</code> to capture packets from this network:<div class="mediaobject"><img alt="Time for action – AP-less WPA cracking" src="graphics/B09903_06_29.jpg"/></div></li><li class="listitem">Now, when our<a class="indexterm" id="id221"/> roaming client connects to this access point, it starts the handshake but fails to complete it after <span class="strong"><strong>Message 2</strong></span>, as discussed previously; however, the data required to crack the handshake has been captured.</li><li class="listitem">We run the <code class="literal">airodump-ng</code> capture file through <code class="literal">aircrack-ng</code> with the same dictionary file as before; eventually, the passphrase is cracked as before.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec64"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We were able to crack the WPA key with just the client. This was possible because, even with just the first two <a class="indexterm" id="id222"/>packets, we have all the information required to launch a dictionary attack on the handshake.</p></div><div class="section" title="Have a go hero – AP-less WPA cracking"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec65"/>Have a go hero – AP-less WPA cracking</h2></div></div></div><p>We recommend setting different WEP keys on the client and trying this exercise a couple of times to gain confidence. You may notice many times that you have to reconnect the client to get it to work.</p></div><div class="section" title="Pop quiz – attacking the client"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec66"/>Pop quiz – attacking the client</h2></div></div></div><p>Q1. What encryption key can the Caffe Latte attack recover?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">None</li><li class="listitem">WEP</li><li class="listitem">WPA</li><li class="listitem">WPA2</li></ol></div><p>Q2. What would a Honeypot access point typically use?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">No Encryption, Open Authentication</li><li class="listitem">No Encryption, Shared Authentication</li><li class="listitem">WEP Encryption, Open Authentication</li><li class="listitem">None of the above</li></ol></div><p>Q3. Which one of the following is a DoS Attack?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Misassociation attacks</li><li class="listitem">Deauthentication attacks</li><li class="listitem">Disassociation attacks</li><li class="listitem">Both 2 and 3</li></ol></div><p>Q4. What does the Caffe Latte attack require?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">That the wireless client be in radio range of the access point</li><li class="listitem">That the client contains a cached and stored WEP key</li><li class="listitem">WEP encryption with at least 128-bit encryption</li><li class="listitem">Both 1 and 3</li></ol></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec71"/>Summary</h1></div></div></div><p>In this chapter, we learned that even the wireless client is susceptible to attacks. These include the Honeypot and other Misassociation attacks; Caffe Latte attack, to retrieve the key from the wireless client, deauthentication and disassociation attacks causing a Denial of Service, Hirte attack as an alternative to retrieve the WEP key from a roaming client, and, finally, cracking the WPA-Personal passphrase with just the client. </p><p>In the next chapter, we will use what we've learned so far to conduct various advanced wireless attacks on both the client and infrastructure side. So, quickly flip the page to the next chapter!</p></div></body></html>