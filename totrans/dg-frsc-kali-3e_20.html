<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer436">
<h1 class="chapter-number" id="_idParaDest-187"><a id="_idTextAnchor251"/>15</h1>
<h1 id="_idParaDest-188"><a id="_idTextAnchor252"/>Packet Capture Analysis with Xplico</h1>
<p>In this chapter, we’ll look into Xplico, which is an <a id="_idIndexMarker1167"/>automated <strong class="bold">Network Forensic Analysis Tool</strong> (<strong class="bold">NFAT</strong>). Xplico <a id="_idIndexMarker1168"/>can be found in Kali Linux; however, I’ve found that within the last few releases (2019–2022), there are issues when trying to run Xplico, possibly due to upgrades within <span class="No-Break">Kali itself.</span></p>
<p>Although I will explain how to start Xplico in Kali Linux for those who may have the good fortune of running it without issues, we will be using Xplico within a virtual machine running DEFT Linux 8.1, for those of us who may have difficulties running Xplico within <span class="No-Break">Kali itself.</span></p>
<p>We will be covering the following main topics in <span class="No-Break">this chapter:</span></p>
<ul>
<li>Installing Xplico in <span class="No-Break">Kali Linux</span></li>
<li>Installing DEFT Linux 8.1 <span class="No-Break">in VirtualBox</span></li>
<li>Downloading sample <span class="No-Break">analysis files</span></li>
<li>Starting Xplico in <span class="No-Break">DEFT Linux</span></li>
<li>Using Xplico to automatically analyze web, email, and <span class="No-Break">voice traffic</span></li>
</ul>
<h1 id="_idParaDest-189"><a id="_idTextAnchor253"/>Installing Xplico in Kali Linux</h1>
<p>Follow <a id="_idIndexMarker1169"/>these steps to install Xplico in <span class="No-Break">Kali Linux:</span></p>
<ol>
<li>If Xplico does not come <a id="_idIndexMarker1170"/>with the version of Kali Linux you are currently using, you can first update Kali Linux and install the Kali forensics repository by typing the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo apt update &amp;&amp; sudo install kali-linux-forensics</strong></pre></li>
<li>Next, update your Kali by typing the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo apt update</strong></pre></li>
<li>Once Kali has updated, install Xplico in Kali by typing the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo apt-get install xplico</strong></pre></li>
<li>Press <em class="italic">Y</em> when <a id="_idIndexMarker1171"/>prompted to click on <strong class="bold">Yes</strong> and download <a id="_idIndexMarker1172"/>and install the <span class="No-Break">necessary files.</span></li>
</ol>
<p>Then, we need to start the Apache and <span class="No-Break">Xplico services.</span></p>
<ol>
<li value="5">Start the <strong class="source-inline">apache2</strong> service by typing the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo apache2 start</strong></pre></li>
<li>Start the Xplico service by typing the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo xplico start</strong></pre></li>
<li>To run Xplico with full administrative privileges as the root user, type the <span class="No-Break">following command:</span><pre class="console">
<strong class="bold">sudo /etc/init.d/xplico start</strong></pre></li>
<li>Type <strong class="source-inline">Xplico</strong> in the search bar and click on the first <span class="No-Break">Xplico option:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer401">
<img alt="Figure 15.1 – Xplico options within the search menu" height="235" src="image/Figure_15.01_B19441.jpg" width="206"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.1 – Xplico options within the search menu</p>
<ol>
<li value="9">The Xplico interface will open in a browser. You can also do this manually by entering <strong class="source-inline">http://localhost:9876/</strong> in the<a id="_idIndexMarker1173"/> browser <a id="_idIndexMarker1174"/>of <span class="No-Break">your choice.</span></li>
</ol>
<p>If the preceding steps do not work, you can use Xplico in DEFT Linux, which we will cover in the <span class="No-Break">next section.</span></p>
<h1 id="_idParaDest-190"><a id="_idTextAnchor254"/>Installing DEFT Linux 8.1 in VirtualBox</h1>
<p>Installing DEFT Linux <a id="_idIndexMarker1175"/>is very simple and only takes <a id="_idIndexMarker1176"/>a few minutes. We’ll have Xplico up and running in no time. For those of you who were able to start Xplico in Kali Linux, you can skip this process and go straight to the <em class="italic">Downloading sample analysis files</em> section, where we will download and begin analyzing our sample files <span class="No-Break">using Xplico.</span></p>
<p>To those of you opting to install DEFT so you are able to use Xplico, let’s get to it without <span class="No-Break">further delay:</span></p>
<ol>
<li value="1">DEFT is very user-friendly and based on a lightweight version of Ubuntu called Lubuntu. You can download the DEFT Linux ISO image file <span class="No-Break">at </span><a href="https://archive.org/details/deft-8.2"><span class="No-Break">https://archive.org/details/deft-8.2</span></a><span class="No-Break">.</span></li>
<li>Once downloaded, open VirtualBox and click on the <strong class="bold">New</strong> option to create a new virtual machine, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer402">
<img alt="Figure 15.2 – The New option in VirtualBox" height="58" src="image/Figure_15.02_B19441.jpg" width="195"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.2 – The New option in VirtualBox</p>
<ol>
<li value="3">Enter the details in the relevant fields, as shown in the <span class="No-Break">following screenshot:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer403">
<img alt="Figure 15.3 – New virtual machine details" height="354" src="image/Figure_15.03_B19441.jpg" width="442"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.3 – New virtual machine details</p>
<p>I’ve <a id="_idIndexMarker1177"/>allocated<a id="_idIndexMarker1178"/> 6 GB of memory for the <span class="No-Break">DEFT VM.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer404">
<img alt="Figure 15.4 – VirtualBox memory allocation" height="348" src="image/Figure_15.04_B19441.jpg" width="441"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.4 – VirtualBox memory allocation</p>
<ol>
<li value="4">For the <strong class="bold">Hard Disk</strong> selection, choose the <strong class="bold">Create virtual hard disk now</strong> option and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break">.</span></li>
<li>For the <strong class="bold">Hard disk file</strong> type selection, choose the <strong class="bold">VDI</strong> (<strong class="bold">VirtualBox Disk Image</strong>) option and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Next</strong></span><span class="No-Break">.</span></li>
<li>For the <strong class="bold">Storage on physical hard disk</strong> selection, choose the <strong class="bold">Dynamically allocated</strong> option, click on <strong class="bold">Next</strong>, and then click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break">.</span></li>
<li>Next, click <a id="_idIndexMarker1179"/>on the <strong class="bold">DEFT Linux</strong> entry in<a id="_idIndexMarker1180"/> the VirtualBox manager window and click on the green <span class="No-Break"><strong class="bold">Start</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer405">
<img alt="Figure 15.5 – DEFT details in the VirtualBox manager window" height="233" src="image/Figure_15.05_B19441.jpg" width="234"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.5 – DEFT details in the VirtualBox manager window</p>
<ol>
<li value="8">Next, we select the DEFT ISO image by clicking on the yellow folder icon in the bottom-right corner of the <strong class="bold">Select start-up </strong><span class="No-Break"><strong class="bold">disk</strong></span><span class="No-Break"> window.</span></li>
</ol>
<p class="callout-heading">Note</p>
<p class="callout">Don’t click on <strong class="bold">Start</strong> <span class="No-Break">just yet.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer406">
<img alt="Figure 15.6 – Virtual optical disk file selection" height="98" src="image/Figure_15.06_B19441.jpg" width="511"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.6 – Virtual optical disk file selection</p>
<ol>
<li value="9">Then, click <a id="_idIndexMarker1181"/>on the blue <span class="No-Break"><strong class="bold">Add</strong></span><span class="No-Break"> button.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer407">
<img alt="Figure 15.7 – Optical disk selection" height="181" src="image/Figure_15.07_B19441.jpg" width="215"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.7 – Optical disk selection</p>
<ol>
<li value="10">Now, browse<a id="_idIndexMarker1182"/> to the folder where you downloaded the <strong class="source-inline">deft-8.2.iso</strong> file, click on the file, and then click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Open</strong></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer408">
<img alt="Figure 15.8 – Selecting the DEFT.iso file" height="355" src="image/Figure_15.08_B19441.jpg" width="531"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.8 – Selecting the DEFT.iso file</p>
<p>You <a id="_idIndexMarker1183"/>should now see <strong class="source-inline">deft-8.2.iso</strong> listed in<a id="_idIndexMarker1184"/> the disk <span class="No-Break">selector window.</span></p>
<ol>
<li value="11">Click on <strong class="source-inline">deft-8.2.iso</strong> and then click on the <span class="No-Break"><strong class="bold">Choose</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer409">
<img alt="Figure 15.9 – Selecting the optical disk" height="285" src="image/Figure_15.09_B19441.jpg" width="453"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.9 – Selecting the optical disk</p>
<ol>
<li value="12">Once chosen, you <a id="_idIndexMarker1185"/>should now see the <strong class="source-inline">deft-8.2.iso</strong> file<a id="_idIndexMarker1186"/> as the entry in the <strong class="bold">Select start-up disk</strong> window. You can now click on the <strong class="bold">Start</strong> button to start DEFT <span class="No-Break">Linux 8.2.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer410">
<img alt="Figure 15.10 – The Select start-up disk selection window" height="319" src="image/Figure_15.10_B19441.jpg" width="337"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.10 – The Select start-up disk selection window</p>
<ol>
<li value="13">Once all <a id="_idIndexMarker1187"/>the <a id="_idIndexMarker1188"/>preceding steps have been completed, you will now be presented with the DEFT Linux start-up screen. Select the <strong class="bold">DEFT Linux 8 Live</strong> option and <span class="No-Break">press </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer411">
<img alt="Figure 15.11 – The DEFT Linux splash screen" height="529" src="image/Figure_15.11_B19441.jpg" width="641"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.11 – The DEFT Linux splash screen</p>
<p>After all the <a id="_idIndexMarker1189"/>processes have loaded, you<a id="_idIndexMarker1190"/> will now have access to the DEFT Linux desktop, as <span class="No-Break">shown here.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer412">
<img alt="Figure 15.12 – The DEFT Linux desktop interface" height="676" src="image/Figure_15.12_B19441.jpg" width="801"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.12 – The DEFT Linux desktop interface</p>
<p>Hopefully, you’ve<a id="_idIndexMarker1191"/> arrived here without any issues. Before <a id="_idIndexMarker1192"/>proceeding with our analysis, let’s now download our sample files <span class="No-Break">for analysis.</span></p>
<h2 id="_idParaDest-191"><a id="_idTextAnchor255"/>Downloading sample analysis files</h2>
<p>Let’s now <a id="_idIndexMarker1193"/>download three sample files for automated analysis in Xplico. We will be downloading three sample packet capture (<strong class="source-inline">.pcap</strong>) files for analysis. All three files and many others are available at <a href="https://wiki.wireshark.org/SampleCaptures">https://wiki.wireshark.org/SampleCaptures</a>; however, you can click on the following direct links to download the three<a id="_idIndexMarker1194"/> required packet capture <span class="No-Break">files now:</span></p>
<ul>
<li><span class="No-Break">http_with_jpegs.cap.gz: https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/http_with_jpegs.cap.gz</span></li>
<li><span class="No-Break"><strong class="source-inline">smtp.pcap</strong></span><span class="No-Break">: </span><a href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/smtp.pcap"><span class="No-Break">https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/smtp.pcap</span></a></li>
<li><span class="No-Break"><strong class="source-inline">nb6-telephone.pcap</strong></span><span class="No-Break">: </span><a href="https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/nb6-telephone.pcap"><span class="No-Break">https://wiki.wireshark.org/uploads/__moin_import__/attachments/SampleCaptures/nb6-telephone.pcap</span></a></li>
</ul>
<p>Now that we have all our sample files downloaded and ready to use, let’s finally <span class="No-Break">start Xplico.</span></p>
<h1 id="_idParaDest-192"><a id="_idTextAnchor256"/>Starting Xplico in DEFT Linux</h1>
<p>We already <a id="_idIndexMarker1195"/>learned how to start Xplico in Kali Linux at the beginning of the chapter, so let’s now do <a id="_idIndexMarker1196"/>the same for <span class="No-Break">DEFT Linux:</span></p>
<ol>
<li value="1">In your DEFT Linux VM, click on the DEFT menu button at the bottom-left corner of the DEFT desktop, which looks like the letter <strong class="bold">d</strong> next to a <span class="No-Break">black eightball.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer413">
<img alt="Figure 15.13 – The DEFT Linux menu button" height="676" src="image/Figure_15.13_B19441.jpg" width="801"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.13 – The DEFT Linux menu button</p>
<p>The DEFT menu <span class="No-Break">will open.</span></p>
<ol>
<li value="2">Click on the <strong class="bold">Service</strong> option and then click on the <strong class="bold">Apache start</strong> button. A Terminal will open and the service will <span class="No-Break">be started.</span></li>
<li>Next, go <a id="_idIndexMarker1197"/>back to the <strong class="bold">Service</strong> option and click on the <strong class="bold">Xplico Start</strong> button. A Terminal will open and start the <span class="No-Break">Xplico service.</span></li>
<li>Finally, we <a id="_idIndexMarker1198"/>can start Xplico by clicking on the <strong class="bold">DEFT</strong> menu button/icon, navigating upward to the <strong class="bold">DEFT</strong> menu, going across to the <strong class="bold">Network Forensics</strong> menu, and then selecting <strong class="bold">Xplico</strong>, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer414">
<img alt="Figure 15.14 – Starting Xplico in DEFT" height="409" src="image/Figure_15.14_B19441.jpg" width="570"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.14 – Starting Xplico in DEFT</p>
<ol>
<li value="5">Xplico will now open in the default browser, and it can also be accessed by typing <strong class="source-inline">localhost:9876</strong> in the<a id="_idIndexMarker1199"/> <span class="No-Break">URL bar.</span></li>
</ol>
<p class="callout-heading">Important note</p>
<p class="callout">The username and password are both <strong class="source-inline">xplico</strong> (<span class="No-Break">all lowercase).</span></p>
<div>
<div class="IMG---Figure" id="_idContainer415">
<img alt="Figure 15.15 – The Xplico interface login" height="322" src="image/Figure_15.15_B19441.jpg" width="873"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.15 – The Xplico interface login</p>
<p>Now that we’re<a id="_idIndexMarker1200"/> logged into Xplico, let’s start creating a case and session <span class="No-Break">to analyze.</span></p>
<h1 id="_idParaDest-193"><a id="_idTextAnchor257"/>Using Xplico to automatically analyze web, email, and voice traffic</h1>
<p>Once we <a id="_idIndexMarker1201"/>have Xplico up and running in either Kali Linux or DEFT Linux, we can begin creating and analyzing our <strong class="source-inline">.pcap</strong> files. Xplico has a very intuitive user interface and also allows for case management of individual cases and sessions. We must first create a case and session before the <strong class="source-inline">.pcap</strong> file is uploaded and analyzed automatically <span class="No-Break">for us:</span></p>
<ol>
<li value="1">To create a new case, click on the <strong class="bold">New Case</strong> option to the left of the <span class="No-Break">Xplico window.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer416">
<img alt="Figure 15.16 – The New Case option in Xplico" height="103" src="image/Figure_15.16_B19441.jpg" width="95"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.16 – The New Case option in Xplico</p>
<ol>
<li value="2">Next, give <a id="_idIndexMarker1202"/>your case a name. I’ve named my case <strong class="source-inline">CFSI-HTTP-2023</strong>, as in this case, we will be analyzing the HTTP <strong class="source-inline">.pcap</strong> file we <span class="No-Break">previously downloaded:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer417">
<img alt="Figure 15.17 – Case name creation" height="257" src="image/Figure_15.17_B19441.jpg" width="519"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.17 – Case name creation</p>
<ol>
<li value="3">Click on <strong class="bold">Create</strong> to continue and then click on the created case name to proceed. As shown here, the case name is listed <span class="No-Break">as </span><span class="No-Break"><strong class="bold">CFSIHTTP2023</strong></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer418">
<img alt="Figure 15.18 – Case lists" height="168" src="image/Figure_15.18_B19441.jpg" width="492"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.18 – Case lists</p>
<ol>
<li value="4">Now<a id="_idIndexMarker1203"/> that a new case has been created, we must create a new session. Click on the <strong class="bold">New Session</strong> button in the left-hand menu in Xplico, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer419">
<img alt="Figure 15.19 – New Session in Xplico" height="176" src="image/Figure_15.19_B19441.jpg" width="151"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.19 – New Session in Xplico</p>
<ol>
<li value="5">Give your session a different name than the case name and then click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer420">
<img alt="Figure 15.20 – Case session creation" height="178" src="image/Figure_15.20_B19441.jpg" width="379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.20 – Case session creation</p>
<ol>
<li value="6">Once the <a id="_idIndexMarker1204"/>case session has been created, click on the session name, listed in red text. As shown here, my session is listed <span class="No-Break">as </span><span class="No-Break"><strong class="bold">CFSIHTTPAnalysis</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer421">
<img alt="Figure 15.21 – Case session details" height="138" src="image/Figure_15.21_B19441.jpg" width="441"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.21 – Case session details</p>
<p>This will bring us to our main Xplico window, where we can upload our files <span class="No-Break">for analysis.</span></p>
<p class="callout-heading">Note</p>
<p class="callout">For each downloaded <strong class="source-inline">.pcap</strong> sample file, you will need to create a new case. Feel free to review this section as needed when creating new cases <span class="No-Break">and sessions.</span></p>
<p>Once our case has been created, we can move on to the actual packet analysis <span class="No-Break">using Xplico.</span></p>
<h2 id="_idParaDest-194"><a id="_idTextAnchor258"/>Automated web traffic analysis</h2>
<p>In this section, we <a id="_idIndexMarker1205"/>will use Xplico to<a id="_idIndexMarker1206"/> perform automated web traffic and <span class="No-Break">HTTP analysis:</span></p>
<ol>
<li value="1">Let’s continue our <strong class="bold">CFSIHTTPAnalysis</strong> session. For this session, we will be analyzing the <strong class="source-inline">http_witp_jpegs.pcap</strong> file, which is contained within the <strong class="source-inline">http_witp_jpegs.gz</strong> file that we downloaded. To extract the <strong class="source-inline">.pcap</strong> file, right-click on the downloaded <strong class="source-inline">http_witp_jpegs.gz</strong> file and click on <span class="No-Break"><strong class="bold">Extract Here</strong></span><span class="No-Break">.</span></li>
</ol>
<p>Once extracted, you will now see the <strong class="source-inline">http_witp_jpegs.pcap</strong> file listed with the other downloaded files, as <span class="No-Break">shown here.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer422">
<img alt="Figure 15.22 – All downloaded and extracted sample files" height="262" src="image/Figure_15.22_B19441.jpg" width="304"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.22 – All downloaded and extracted sample files</p>
<ol>
<li value="2">Let’s now return to the Xplico web interface within our browser and click on the <strong class="bold">Browse…</strong> button in the <strong class="bold">Pcap set</strong> section, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer423">
<img alt="Figure 15.23 – The Pcap set section in Xplico" height="404" src="image/Figure_15.23_B19441.jpg" width="799"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.23 – The Pcap set section in Xplico</p>
<ol>
<li value="3">Go to <strong class="source-inline">http_witp_jpegs.pcap</strong> and click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Open</strong></span><span class="No-Break">.</span></li>
<li>Then, click <a id="_idIndexMarker1207"/>on the <strong class="bold">Upload</strong> button<a id="_idIndexMarker1208"/> in the <strong class="bold">Pcap set</strong> section to upload the file for analysis. The file may take a couple of seconds to upload, which will be displayed as a message in red text, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer424">
<img alt="Figure 15.24 – Pcap file decoding" height="191" src="image/Figure_15.24_B19441.jpg" width="540"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.24 – Pcap file decoding</p>
<p>Once the file has been decoded and analyzed, you will see the words <strong class="bold">DECODING COMPLETED</strong> in the <strong class="bold">Session Data</strong> area of Xplico, as <span class="No-Break">shown here.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer425">
<img alt="Figure 15.25 – Decoding completed" height="190" src="image/Figure_15.25_B19441.jpg" width="443"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.25 – Decoding completed</p>
<p class="callout-heading">Important note</p>
<p class="callout">This process to upload and decode a file must also be done for each <strong class="source-inline">.pcap</strong> file. Feel free to return to this section <span class="No-Break">as needed.</span></p>
<ol>
<li value="5">To <a id="_idIndexMarker1209"/>analyze <a id="_idIndexMarker1210"/>our uploaded files, we will utilize the menu on the left side, which allows<a id="_idIndexMarker1211"/> us to inspect web, mail, <strong class="bold">VoIP</strong> (<strong class="bold">Voice over Internet Protocol</strong>), and <span class="No-Break">other artifacts.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer426">
<img alt="Figure 15.26 – The Xplico Analysis menu bar" height="208" src="image/Figure_15.26_B19441.jpg" width="91"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.26 – The Xplico Analysis menu bar</p>
<ol>
<li value="6">Let’s start our analysis by clicking on the <strong class="bold">Web</strong> menu and clicking on the <strong class="bold">Site </strong>option. Xplico has <a id="_idIndexMarker1212"/>displayed a list of websites visited. We can also click on each website to <span class="No-Break">visit them.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer427">
<img alt="Figure 15.27 – Websites decoded by Xplico" height="202" src="image/Figure_15.27_B19441.jpg" width="742"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.27 – Websites decoded by Xplico</p>
<ol>
<li value="7">Let’s also <a id="_idIndexMarker1213"/>click on the <strong class="bold">Images</strong> option on the side menu. We can see that Xplico has decoded and processed four images for us, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer428">
<img alt="Figure 15.28 – Decoded images" height="261" src="image/Figure_15.28_B19441.jpg" width="590"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.28 – Decoded images</p>
<p>Now that we <a id="_idIndexMarker1214"/>know how to perform<a id="_idIndexMarker1215"/> automated HTTP analysis and find various web artifacts, including images that were viewed and downloaded over the web, let’s move on to some automated SMPT and email analysis <span class="No-Break">using Xplico.</span></p>
<h2 id="_idParaDest-195"><a id="_idTextAnchor259"/>Automated SMTP traffic analysis</h2>
<p>Let’s create a<a id="_idIndexMarker1216"/> new case to perform <strong class="bold">Simple Mail Transfer Protocol</strong> (<strong class="bold">SMTP</strong>) analysis. SMTP is used to send emails, and <a id="_idIndexMarker1217"/>analysis of SMTP traffic can reveal the sender, recipient, and other details of an email, including attachments. So, let’s get started with the new case creation and SMTP <span class="No-Break">traffic analysis:</span></p>
<ol>
<li value="1">For this exercise, I’ve repeated the preceding steps to create a new case and session. Details of the case are <span class="No-Break">as follows:</span><ul><li>Case <span class="No-Break">name: </span><span class="No-Break"><strong class="source-inline">CFSI-SMTP-2023</strong></span></li><li>External reference: <span class="No-Break"><strong class="source-inline">SMTP analysis</strong></span></li><li>Session name: <strong class="source-inline">CFSI SMTP </strong><span class="No-Break"><strong class="source-inline">Analysis 2023</strong></span></li></ul></li>
<li>Once our <a id="_idIndexMarker1218"/>case and session have been created, click on the session <span class="No-Break">to continue.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer429">
<img alt="Figure 15.29 – The SMTP session" height="138" src="image/Figure_15.29_B19441.jpg" width="416"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.29 – The SMTP session</p>
<ol>
<li value="3">We can now browse the <strong class="source-inline">smtp.pcap</strong> file and upload it for processing, decoding, and analysis. You will again be notified when decoding has been completed, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer430">
<img alt="Figure 15.30 – Decoding complete" height="144" src="image/Figure_15.30_B19441.jpg" width="331"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.30 – Decoding complete</p>
<ol>
<li value="4">Let’s click on the <strong class="bold">Email</strong> option under the <strong class="bold">Mail</strong> menu in the sidebar to reveal what has been decoded <span class="No-Break">by Xplico.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer431">
<img alt="Figure 15.31 – The decoded email" height="78" src="image/Figure_15.31_B19441.jpg" width="769"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.31 – The decoded email</p>
<p>In the preceding screen, we can see that Xplico decoded an email from <strong class="source-inline">gurupartap@patriots.in</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">raj_deo2002in@yahoo.com</strong></span><span class="No-Break">.</span></p>
<ol>
<li value="5">If we click <a id="_idIndexMarker1219"/>on the word <strong class="bold">SMTP</strong>, as shown in <span class="No-Break"><em class="italic">Figure 15</em></span><em class="italic">.31</em>, we can view the contents<a id="_idIndexMarker1220"/> of the email, as shown in <span class="No-Break"><em class="italic">Figure 15</em></span><span class="No-Break"><em class="italic">.32</em></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer432">
<img alt="Figure 15.32 – Contents of the decoded email" height="257" src="image/Figure_15.32_B19441.jpg" width="443"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.32 – Contents of the decoded email</p>
<p>Let’s move on to another analysis <span class="No-Break">exercise now.</span></p>
<h2 id="_idParaDest-196"><a id="_idTextAnchor260"/>Automated VoIP traffic analysis</h2>
<p>Xplico <a id="_idIndexMarker1221"/>can also<a id="_idIndexMarker1222"/> decode VoIP traffic if captured and saved in a <strong class="source-inline">.pcap</strong> file. Follow these steps for <span class="No-Break">this analysis:</span></p>
<ol>
<li value="1">Let’s again create a new case and <span class="No-Break">session first.</span></li>
</ol>
<p>Here are the case and <span class="No-Break">session details:</span></p>
<ul>
<li>Case <span class="No-Break">name: </span><span class="No-Break"><strong class="source-inline">CFSI-Voice-2023</strong></span></li>
<li>External reference: <strong class="source-inline">CFSI </strong><span class="No-Break"><strong class="source-inline">Voice Analysis</strong></span></li>
<li>Session <span class="No-Break">name: </span><span class="No-Break"><strong class="source-inline">CFSIVoice2023</strong></span></li>
</ul>
<ol>
<li value="2">Once our <a id="_idIndexMarker1223"/>case and session have been created, we can then navigate to and upload the <strong class="source-inline">nb6-telephone.pcap</strong> file that we <span class="No-Break">downloaded earlier.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer433">
<img alt="Figure 15.33 – The decoded VoIP file" height="141" src="image/Figure_15.33_B19441.jpg" width="327"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.33 – The decoded VoIP file</p>
<ol>
<li value="3">Let’s see <a id="_idIndexMarker1224"/>what was revealed by Xplico by clicking on the <strong class="bold">Sip</strong> option in the <strong class="bold">Voip</strong> <span class="No-Break">menu bar.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer434">
<img alt="Figure 15.34 – The decoded VoIP traffic" height="128" src="image/Figure_15.34_B19441.jpg" width="667"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.34 – The decoded VoIP traffic</p>
<ol>
<li value="4">As shown previously, Xplico has automatically decoded a captured VoIP conversation. You can also click on the call duration to play back the conversation, as shown in the <span class="No-Break">following screenshot.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer435">
<img alt="Figure 15.35 – The decoded VoIP call" height="251" src="image/Figure_15.35_B19441.jpg" width="562"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.35 – The decoded VoIP call</p>
<p>You<a id="_idIndexMarker1225"/> may <a id="_idIndexMarker1226"/>need to install plugins to listen to the audio file. You will be prompted to install the relevant plugins automatically, as shown in <span class="No-Break"><em class="italic">Figure 15</em></span><span class="No-Break"><em class="italic">.35</em></span><span class="No-Break">.</span></p>
<h1 id="_idParaDest-197"><a id="_idTextAnchor261"/>Summary</h1>
<p>In this chapter, we learned how to use Xplico in both Kali Linux and DEFT Linux, which we installed separately in VirtualBox. DEFT can be a great substitute for those who may have encountered issues when installing Xplico in Kali, and it also offers many other tools that you can explore if you so wish. We learned that a new case and session must be created for each packet capture (<strong class="source-inline">.pcap</strong>) file analysis, and that Xplico does automatic decoding and analysis of <strong class="source-inline">.pcap</strong> files to reveal artifacts that are useful to our DFIR investigations. Lastly, we learned how to use Xplico to find useful artifacts such as visited websites, viewed and downloaded images, emails, and VoIP conversations. I hope you enjoyed using this automated tool. We will next look at other NFAT tools in our last chapter. See you in the <span class="No-Break">next chapter.</span></p>
</div>
</div></body></html>