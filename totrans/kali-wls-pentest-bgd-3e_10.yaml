- en: Chapter 10. WLAN Penetration Testing Methodology
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '|   | *"The proof is in the pudding."* |   |'
  prefs: []
  type: TYPE_TB
- en: '|   | --*Popular saying* |'
  prefs: []
  type: TYPE_TB
- en: '*This chapter will lay out the steps that go in to taking the techniques taught
    in the previous chapters and turning them into a full wireless penetration test.*'
  prefs: []
  type: TYPE_NORMAL
- en: Wireless penetration testing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To perform a wireless penetration test, it is important to follow a defined
    methodology. Simply firing up the `airbase` or `airodump` command and hoping for
    the best will not satisfy the goals of a test. When working as a penetration tester,
    you must ensure that you adhere to the standards of the organization you're working
    for, and if they don't have any, then you should hold yourself to the highest
    standards.
  prefs: []
  type: TYPE_NORMAL
- en: 'Broadly, we can break up a wireless penetration testing exercise into the following
    phases:'
  prefs: []
  type: TYPE_NORMAL
- en: Planning phase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Discovery phase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Attack phase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Reporting phase
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will now look at each of these phases separately.
  prefs: []
  type: TYPE_NORMAL
- en: Planning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this phase, we must understand the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Scope of the assessment**: The penetration tester should work with the client
    to define a scope that is achievable and will also provide the greatest amount
    of insight into the security of a network. Typically, the following information
    is gathered:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Location of the penetration test.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Total coverage area of the premises.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Approximate number of access points and wireless clients deployed.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Which wireless networks are included in the assessment?
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Is exploitation in scope?
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Are attacks against users in scope?
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Is denial of service in scope?
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Effort estimation**: Based on the scope defined, the tester will then have
    to estimate how much time is required. Bear in mind that rescoping may occur following
    this estimate, as organizations may have limited resources available in terms
    of both time and money.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Legality**: Prior to performing a test, the client must give consent. This
    should explain the testing to be covered and clearly define the level of indemnity,
    insurance, and the limitations of the scope. If you are unsure, you will need
    to speak to a professional in these areas. Most organizations will have their
    own versions that will likely also incorporate a **Non-Disclosure Agreement**
    (**NDA**).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Once all of the preceding requirements are in place, we are ready to go!
  prefs: []
  type: TYPE_NORMAL
- en: Discovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this phase, the aim is to identify and apply characteristics to the wireless
    devices and wireless networks within the scope.
  prefs: []
  type: TYPE_NORMAL
- en: 'All the techniques to perform these have been laid out in the previous chapters
    but, in brief, the aim is to:'
  prefs: []
  type: TYPE_NORMAL
- en: Enumerate visible and hidden wireless networks in the area
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enumerate devices in the area, along with those connected to the targeted networks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Map the range of the networks, where they are reachable from and whether there
    are places a malicious individual could operate from to perform an attack, for
    example, a cafe
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'All of this information should be recorded. If the test is limited to the performance
    of reconnaissance only, the test will end here, and the tester will attempt to
    draw conclusions based on this information. Some statements that would be useful
    to a client are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: The number of devices that have associations with open networks and the corporate
    network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The number of devices that have networks that can be linked to locations through
    solutions such as WiGLE
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The existence of weak encryption
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The networks are too restrictive and block standard users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Attack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once reconnaissance has been performed, exploitation must be performed for proof
    of concept. If the attack is being performed as part of a red team or wider assessment,
    then exploitation should be performed to gain access to the network as surreptitiously
    as possible.
  prefs: []
  type: TYPE_NORMAL
- en: 'In our attacking phase, we will explore the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Cracking the encryption
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Attacking the infrastructure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compromising clients
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding vulnerable clients
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding unauthorized clients
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cracking the encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The first step is to retrieve the keys for any vulnerable networks identified.
    If networks with WEP exist, perform the WEP-cracking methods explained in [Chapter
    4](ch04.html "Chapter 4. WLAN Encryption Flaws"), *WLAN Encryption Flaws*. Regardless
    of whether you can crack it or not though, the presence of WEP is still considered
    a vulnerability. If WPA2-secured systems are present, you have two choices. If
    aiming to be stealthy, arrive on-site at times when individuals are likely to
    be authenticating or re-authenticating. These times are likely to be:'
  prefs: []
  type: TYPE_NORMAL
- en: Start of the day
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lunch time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: End of the day
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At this time, set up your WPA key retrieval setup as shown in [Chapter 4](ch04.html
    "Chapter 4. WLAN Encryption Flaws"), *WLAN Encryption Flaws*. Alternatively, perform
    the deauthentication attack, as shown in [Chapter 6](ch06.html "Chapter 6. Attacking
    the Client"), *Attacking the Client*.
  prefs: []
  type: TYPE_NORMAL
- en: This is noisier and more likely to be detected in a mature organization.
  prefs: []
  type: TYPE_NORMAL
- en: If WPA-Enterprise is in place, bear in mind you will have to use the information
    gathered from the reconnaissance to target the correct network and set up your
    dummy Enterprise setup as shown in the *Attacking PEAP* section in [Chapter 9](ch09.html
    "Chapter 9. Attacking WPA-Enterprise and RADIUS"), *Attacking WPA-Enterprise and
    RADIUS*.
  prefs: []
  type: TYPE_NORMAL
- en: You can attempt to break all passphrases but bear in mind that some will be
    unbreakable. Following the performance of the test, check with the wireless administrator
    for the passphrase in use. Check to see whether it is a secure passphrase and
    that you, as a tester, did not experience a tool failure or were merely unlucky.
  prefs: []
  type: TYPE_NORMAL
- en: Attacking infrastructure
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'If network access is gained through cracking the encryption, perform a standard
    network penetration test if allowed in scope. The following should be performed
    as a minimum:'
  prefs: []
  type: TYPE_NORMAL
- en: A port scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying which services are running
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enumerating any open services, such as unauthenticated FTP, SMB, or HTTP
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Exploiting any vulnerable services identified
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compromising clients
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: After enumerating and testing all wireless systems, there are various types
    of engagements that would suit performing attacks against clients.
  prefs: []
  type: TYPE_NORMAL
- en: If necessary, after establishing which clients are vulnerable to KARMA attacks,
    create a Honeypot to force them to connect with the methods laid out in the *Attacking
    PEAP* section in [Chapter 9](ch09.html "Chapter 9. Attacking WPA-Enterprise and
    RADIUS"), *Attacking WPA-Enterprise and RADIUS*. There are various useful pieces
    of information that can be gathered through this method, but ensure that the collected
    data serves a purpose and is stored, transmitted, and used in an ethical and safe
    manner.
  prefs: []
  type: TYPE_NORMAL
- en: Reporting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Finally, at the end of testing, it is necessary to report your findings to
    the client. It''s important to ensure that the report matches the quality of your
    testing. As the client will only see the report, you have to give it as much love
    and attention as you do to your testing. The following is a guideline to the layout
    of the report:'
  prefs: []
  type: TYPE_NORMAL
- en: Management summary
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Technical summary
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Findings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Vulnerability description
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Severity
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Affected devices
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerability type—software/hardware/configuration
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Remediation
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Appendices
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The **management summar**y should be aimed at talking to a senior nontechnical
    audience with a focus on the effects and mitigations required at a high level.
    Avoid language that is too technical and ensure that the root causes are covered.
  prefs: []
  type: TYPE_NORMAL
- en: The **technical summary** should be a midpoint between the management summary
    and findings list. It should be aimed at a developer or a technical lead with
    a focus on how to fix the issues and broad solutions that could be implemented.
  prefs: []
  type: TYPE_NORMAL
- en: The findings list should describe each vulnerability at a low level, explaining
    the methods to identify, and replicate, and vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: Appendices should contain any extra information that would be too long to describe
    in a short description. This is where any screenshots, proof-of-concept code,
    or stolen data should be presented.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we discussed a methodology for performing a range of wireless
    tests and referred to the relevant chapters for each step. We also listed methods
    for reporting vulnerabilities and techniques for making technical data presentable.
    In the next and final chapter, we will cover new techniques developed since the
    initial publication of this book, WPS, and probe monitoring for surveillance.
  prefs: []
  type: TYPE_NORMAL
