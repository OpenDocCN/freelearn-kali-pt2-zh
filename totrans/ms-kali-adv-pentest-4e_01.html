<html><head></head><body>
  <div id="_idContainer065" class="Basic-Text-Frame">
    <h1 class="chapterNumber">1</h1>
    <h1 id="_idParaDest-13" class="chapterTitle">Goal-Based Penetration Testing</h1>
    <p class="normal">The COVID-19 pandemic has changed the way the world operates. Organizations of all sizes have transformed themselves from having none or partial remote working to all of their employees adopting this style. With the <em class="italic">new normal</em>, accessible and remote technology has become very important for work and in peoples’ personal lives. We can certainly call this a <em class="italic">virtual world</em>, where confidential activities that used to happen in closed rooms now happen over the internet. This has significantly increased the number of cyber threats at least five-fold. Threat actors utilize this digital transformation to exploit the mistakes made by users and companies as their entry point for financial gain, generating reputational damage, or whatever else their goal may be. This occurs in the form of ransomware, phishing, and data breaches.</p>
    <p class="normal">To understand the current and future ways of working, let us start by exploring the different objectives or goals of threat actors. In this chapter, we will discuss the different types of threat actors and the importance of goal-based penetration testing with a set of objectives; we investigate misconceptions and how a typical vulnerability scan, penetration testing, and red team exercise can fail without the importance of a goal. This chapter also provides an overview of security testing and setting up a verification lab, focusing on the customization of Kali to support some advanced aspects of penetration testing. By the end of this chapter, you will have covered the following:</p>
    <ul>
      <li class="bulletList">The different types of threat actors</li>
      <li class="bulletList">An overview of security testing</li>
      <li class="bulletList">Misconceptions of vulnerability scanning, penetration testing, and red team exercises</li>
      <li class="bulletList">The history and purpose of Kali Linux</li>
      <li class="bulletList">Updating and organizing Kali</li>
      <li class="bulletList">Installing Kali on various services (Amazon Web Services/Google Cloud Platform/Android)</li>
      <li class="bulletList">Setting up defined targets</li>
      <li class="bulletList">Building a verification lab</li>
    </ul>
    <p class="normal">Let us begin with the types of threat actors that exploit technological infrastructure.</p>
    <h1 id="_idParaDest-14" class="heading-1">Different types of threat actors </h1>
    <p class="normal">A threat actor is nothing but an entity or individual who is responsible for an event or incident that <a id="_idIndexMarker000"/>impacts another entity. It is important that we understand the different types of threat actors and their common motivations, which will help us throughout this book to understand different perspectives. <em class="italic">Table 1.1</em> provides the common threat actors, their motives, and typical goals.</p>
    <table id="table001" class="table-container">
      <tbody>
        <tr>
          <th class="table-head">
            <p class="normal"><strong class="keyWord">Threat Actor</strong></p>
          </th>
          <th class="table-head">
            <p class="normal"><strong class="keyWord">Common Motivation</strong></p>
          </th>
          <th class="table-head">
            <p class="normal"><strong class="keyWord">Goal(s)</strong></p>
          </th>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">State- or government-sponsored actors</p>
          </td>
          <td class="table-cell">
            <p class="normal">Military, political, and technological agendas</p>
          </td>
          <td class="table-cell">
            <p class="normal">Cyber espionage, data theft, or any other activity that interests a nation for its economic benefits</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Organized crime or cybercriminals </p>
          </td>
          <td class="table-cell">
            <p class="normal">Financial gain and profit</p>
          </td>
          <td class="table-cell">
            <p class="normal">Money and valuable data</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Hacktivists/cyber extremists</p>
          </td>
          <td class="table-cell">
            <p class="normal">Motivational overlaps</p>
          </td>
          <td class="table-cell">
            <p class="normal">Focus on exposing secrets and disrupting services/organizations that they think are not good for society (hacktivists); focus on causing harm and destruction to further their cause (extremists)</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Insiders</p>
          </td>
          <td class="table-cell">
            <p class="normal">Revenge</p>
          </td>
          <td class="table-cell">
            <p class="normal">Money or data ransom or creating revenue loss</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 1.1: Various threat actors and their motivations</p>
    <p class="normal">We have now summarized the four major threat actors and their motivations that we can use during goal-based penetration testing and red team exercises to simulate real threat scenarios. </p>
    <h1 id="_idParaDest-15" class="heading-1">Conceptual overview of security testing</h1>
    <p class="normal">Now that we <a id="_idIndexMarker001"/>understand the different threat actors; let’s go ahead and understand <em class="italic">what the organizations are trying to protect and from whom?</em> If you asked 100 security consultants the question, <em class="italic">what is security testing?</em>, it is very likely that you would receive 100 different responses. </p>
    <p class="normal">In its simplest form, security testing is a process to determine that any information asset or system is protected and its functionality is maintained as intended.</p>
    <h1 id="_idParaDest-16" class="heading-1">Common pitfalls of vulnerability assessments, penetration testing, and red team exercises</h1>
    <p class="normal">In this section, we will discuss some misconceptions and limitations regarding traditional/classical <a id="_idIndexMarker002"/>vulnerability scanning, penetration <a id="_idIndexMarker003"/>testing, and red team exercises. Let us now <a id="_idIndexMarker004"/>understand the actual meaning of these three topics in simple terms and their limitations:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Vulnerability Assessment</strong> <strong class="keyWord">(VA)</strong>: The process of identifying vulnerabilities or security <a id="_idIndexMarker005"/>loopholes in a system or network through a vulnerability scanner. One of the misconceptions about VA is that it will let you find all of the known vulnerabilities; well, that’s not true. Limitations with VA include that only potential vulnerabilities are found, and it depends purely on the type of scanner that you utilize. It might also include a number of false positives and, to the business owner, there is no clear indication as to which ones do not pose a relevant risk and which one will be initially utilized by the attackers to gain access. The biggest pitfall of VA is false negatives, meaning the scanner did not find an issue that the system or application has. </li>
      <li class="bulletList"><strong class="keyWord">Penetration testing</strong> <strong class="keyWord">(pentesting)</strong>: The process of safely simulating the hacking <a id="_idIndexMarker006"/>scenarios by exploiting vulnerabilities without much impact on the existing network or business. There is also a lower number of false positives since testers will try to validate the vulnerabilities and also attempt to exploit them. A limitation with pentesting is that it uses only currently known, publicly available exploits; mostly, these are a focus for project testing. We often hear from pentesters <a id="_idIndexMarker007"/>during an assessment, <em class="italic">Yay! Got Root—</em>but we never hear the question, <em class="italic">what can you do with it?</em> This could be due to various reasons such as project limitations, including the reporting of high-risk issues immediately to the client, or the client only being interested in one segment of the network and only wanting that part tested.<div class="note">
          <p class="normal">One of the misconceptions about the pentest is that it provides the attacker with a full view of the network, and you are safe once penetration testing has been performed. This is not the case when attackers have found a vulnerability in the business process of your secure application.</p>
        </div>
      </li>
    </ul>
    <ul>
      <li class="bulletList"><strong class="keyWord">Red Team Exercise</strong> <strong class="keyWord">(RTE)</strong>: A focused process of evaluating the effectiveness of an organization <a id="_idIndexMarker008"/>to defend against cyber threats and improve its security by any possible means; during an RTE, we can discover multiple ways of achieving project objectives/scenarios and goals, such as complete coverage of activities with the defined project goal, including phishing (enticing a victim to enter sensitive information or download malicious content through emails), vishing (enticing a victim to provide or do some actions with malicious intent through phone calls), “WhatsApping” (engaging a victim through WhatsApp messenger with malicious intent), wireless, disk drops (USB and SSD), and physical penetration testing. The limitations with RTEs are time-bound, pre-defined scenarios and an assumed rather than real environment. Often, the RTE is run with a fully monitored mode for every technique, and tactics are executed according to the procedure, but this isn’t the case when a real attacker wants to achieve an objective.</li>
    </ul>
    <p class="normal"><em class="italic">Figure 1.1</em> showcases the difference between all three activities in terms of the length and breadth of their focus:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.1: The three methods of assessing the vulnerability of systems and the breadth and depth to which they are successful</p>
    <p class="normal">Often, all three different testing <a id="_idIndexMarker009"/>methodologies refer to the term <em class="italic">hack</em> or<em class="italic"> compromise</em>. We will <a id="_idIndexMarker010"/>hack your network and show you where your weaknesses are; but wait, does the client or business owner understand the difference between these terms? How do we measure it? What are the criteria? And when do we know that the hack or compromise is complete? All the questions point to only one thing: what the purpose of the testing is, and what the primary goal in mind is.</p>
    <h1 id="_idParaDest-17" class="heading-1">Objective-based penetration testing</h1>
    <p class="normal">The primary <a id="_idIndexMarker011"/>goal of a pentest/RTE is to determine the real risk, differentiating the risk rating from the scanner and giving a business a risk value for each asset, along with the risk to the brand image of the organization. It’s not about how much risk they have; rather, how much they are exposed and how easy it is to exploit this exposure. </p>
    <p class="normal">A threat that has been found does not really constitute a risk and need not be demonstrated; for <a id="_idIndexMarker012"/>example, <strong class="keyWord">Cross-Site Scripting</strong> (<strong class="keyWord">XSS</strong>) is a script injection vulnerability that can steal users’ credentials. If a client running a trading company had a brochure website that provides static content to their customers was vulnerable to XSS, it may not have a significant impact on the business. In this case, a client might <a id="_idIndexMarker013"/>accept the risk and put in a mitigation plan using a <strong class="keyWord">Web Application Firewall</strong> <strong class="keyWord">(WAF)</strong> to prevent the XSS attacks. If the same vulnerability was identified on their main trading website, however, then it would be a significant issue in need of rectification as soon as possible since the company will be at risk of losing the trust of customers through attackers stealing their credentials.</p>
    <p class="normal">Objective-based <a id="_idIndexMarker014"/>penetration testing is time-based, depending on the specific problem that an organization faces. An example of an objective is: <em class="italic">We are most worried about our data being stolen and the regulatory fines incurred as a consequence of these breaches</em>. So, the objective now is to compromise the data either by exploiting a system flaw or by manipulating the employees through phishing; sometimes it will be a surprise to see some of their data is already available on the dark web. Every <a id="_idIndexMarker015"/>objective comes with its own <strong class="keyWord">Tactics, Techniques, and Procedures </strong>(<strong class="keyWord">TTP</strong>) that will support the primary goal of the penetration test activity. We will be exploring all of these different methodologies throughout this book using Kali Linux 2021.4.</p>
    <h1 id="_idParaDest-18" class="heading-1">The testing methodology</h1>
    <p class="normal">Methodologies rarely consider why a penetration test is being undertaken or which data is critical to the business <a id="_idIndexMarker016"/>and needs to be protected. In the absence of this vital first step, penetration tests lose their focus.</p>
    <p class="normal">Many penetration testers are reluctant to follow a defined methodology, fearing that it will hinder their creativity in exploiting a security weakness on the network or application. Penetration testing fails to reflect the actual activities of a malicious attacker. Frequently, the client wants to see whether you can gain administrative access to a particular system (that is, <em class="italic">Can you root the box?</em>). However, the attacker may be focused on copying critical data in a manner that does not require root access or cause a denial of service. </p>
    <p class="normal">To address the limitations inherent in formal testing methodologies, they must be integrated in a framework that views the network from the perspective of an attacker, known <a id="_idIndexMarker017"/>as the <strong class="keyWord">cyber</strong> <strong class="keyWord">kill chain</strong>.</p>
    <p class="normal">In 2009, Mike Cloppert of Lockheed Martin CERT introduced the concept that is now known as the cyber kill chain. This includes the steps taken by an adversary when they are attacking a network. It does not always proceed in a linear flow, as some steps may occur in parallel. Multiple attacks may be launched over time at the same target, and overlapping stages may occur.</p>
    <p class="normal">In this book, we have modified Cloppert’s cyber kill chain to more accurately reflect how attackers apply these steps when exploiting networks, applications, and data services. <em class="italic">Figure 1.2</em> shows a typical cyber kill chain of an attacker:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.2: The typical cyber kill chain an attacker may follow</p>
    <p class="normal">A typical cyber kill chain of an attacker can be described as follows:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Explore or reconnaissance phase</strong>: The adage, <em class="italic">reconnaissance time is never wasted time</em>, adopted <a id="_idIndexMarker018"/>by most military organizations, acknowledges that it is better to learn as much as possible about an enemy before engaging them. For the same reason, attackers will conduct extensive reconnaissance of a target before attacking. In fact, it is estimated that at least 70 percent of the effort of a penetration test or an attack is spent conducting reconnaissance! Generally, they will employ two types of reconnaissance: <ul>
          <li class="bulletList"><strong class="keyWord">Passive</strong>: There is <a id="_idIndexMarker019"/>no direct interaction with the target in a hostile manner. For example, the attacker will review publicly available website(s), assess online media (especially social media sites), and attempt to determine the <strong class="keyWord">attack surface </strong>of the target. One particular task will be to generate a list of past and current employee names, or even an investigation into the breached databases that are publicly available. <p class="normal">These names will form the basis of attempts to use brute force in guessing passwords. They will also be used in social engineering attacks. This type of reconnaissance is difficult, if not impossible, to distinguish from the behavior of regular users.</p>
          </li>
          <li class="bulletList"><strong class="keyWord">Active</strong>: This can <a id="_idIndexMarker020"/>be detected by the target, but it can be difficult to distinguish it from the rest of the activity that most online organizations encounter from regular traffic. Activities occurring during active reconnaissance include physical visits to target premises, port scanning, and remote vulnerability scanning.</li>
        </ul>
      </li>
      <li class="bulletList"><strong class="keyWord">Delivery phase</strong>: Delivery is the selection and development of the weapon that will <a id="_idIndexMarker021"/>be used to complete the exploit during the attack. The exact weapon chosen will depend on the attacker’s intent as well as the route of delivery (for example, across the network, via a wireless connection, or through a web-based service). The impact of the delivery phase will be examined in detail in the second half of this book.</li>
      <li class="bulletList"><strong class="keyWord">Exploit or compromise phase</strong>: This is the point when a particular exploit is successfully <a id="_idIndexMarker022"/>applied, allowing attackers to gain a foothold in the objective system. The compromise may have occurred in a single phase (for example, a known operating system vulnerability was exploited using a buffer overflow), or it may have been a multiphase compromise (for example, if an attacker could search and download the data from the internet from sources such as <a href="https://haveibeenpwned.com"><span class="url">https://haveibeenpwned.com</span></a> or similar; these sites typically include breached data, including usernames, passwords, phone numbers, and email addresses, that will allow them to easily create a dictionary of passwords to attempt to <a id="_idIndexMarker023"/>access the <strong class="keyWord">Software as a Service</strong> <strong class="keyWord">(SaaS)</strong> applications, such as Microsoft Office 365 or Outlook Web, attempt to log in to a corporate VPN directly, or use email addresses to perform <a id="_idIndexMarker024"/>targeted email phishing techniques. The attacker could even send an SMS with malicious links to deliver a payload). Multiphase attacks are the norm when a malicious attacker targets a specific enterprise.</li>
      <li class="bulletList"><strong class="keyWord">Achieve phase – Action on the Objective</strong>: This is frequently, and incorrectly, referred to as the exfiltration phase because there is a focus on perceiving attacks solely <a id="_idIndexMarker025"/>as a route to steal sensitive data (such as login information, personal information, and financial information). It is in fact common for an attacker to have a different objective; for example, an attacker may wish to drop a ransomware package on their competitors to drive customers to their own business. Therefore, this phase must focus on the many possible actions of an attacker. One of the most common exploitation activities occurs when the attackers attempt to improve their access privileges to the highest possible level (vertical escalation) and to compromise as many accounts as possible (horizontal escalation).</li>
      <li class="bulletList"><strong class="keyWord">Achieve phase – Persistence</strong>: If there is value in compromising a network or system, then that value can likely be increased if there is persistent access. This allows attackers to maintain communications with a compromised system. From a defender’s point of view, this is the part of the cyber kill chain that is usually the easiest to detect.</li>
    </ul>
    <p class="normal">Cyber kill chains <a id="_idIndexMarker026"/>are merely metamodels of an attacker’s behavior when they attempt to compromise a network or a particular data system. As a metamodel, it can incorporate any proprietary or commercial penetration testing methodology. Unlike the methodologies, however, it ensures a strategic-level focus on how an attacker approaches the network. This focus on the attacker’s activities will guide the layout and content of this book.</p>
    <h1 id="_idParaDest-19" class="heading-1">Introduction to Kali Linux features</h1>
    <p class="normal"><strong class="keyWord">Kali Linux</strong> (<strong class="keyWord">Kali</strong>) is the <a id="_idIndexMarker027"/>successor to the BackTrack penetration testing platform <a id="_idIndexMarker028"/>that is generally regarded as the de facto standard package of tools used to facilitate penetration testing to secure data and voice networks. It was developed by Mati Aharoni and Devon Kearns of Offensive Security. This distribution is mainly meant for penetration testing and digital forensics. </p>
    <p class="normal">In <strong class="keyWord">2021, </strong>Kali had four updates. The latest rolling version was released on December 9, 2021 with kernel 5.14.0 and the Xfce 4.16.3 desktop environment. Additionally, there was a minor update on December 23, 2021 with version Kali 2021.4a.</p>
    <p class="normal">Some features of <a id="_idIndexMarker029"/>this latest version of Kali include the following:</p>
    <p class="normal">Over 500 advanced penetration testing, data forensics, and defensive tools. The majority of the older pre-installed tools are eliminated and replaced by similar tools. They provide extensive wireless support with multiple hardware and kernel patches to permit the packet injection required by some wireless attacks. <em class="italic">Table 1.2</em> provides a breakdown of the tools with respect to their specific task as of December 2021:</p>
    <table id="table002" class="table-container">
      <tbody>
        <tr>
          <th class="table-head">
            <p class="normal"><strong class="keyWord">Tool Sections</strong></p>
          </th>
          <th class="table-head">
            <p class="normal"><strong class="keyWord">No. of Tools</strong></p>
          </th>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Information Gathering</p>
          </td>
          <td class="table-cell">
            <p class="normal">67</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Vulnerability Analysis</p>
          </td>
          <td class="table-cell">
            <p class="normal">27</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Wireless Attacks</p>
          </td>
          <td class="table-cell">
            <p class="normal">54</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Web Applications</p>
          </td>
          <td class="table-cell">
            <p class="normal">43</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Exploitation Tools</p>
          </td>
          <td class="table-cell">
            <p class="normal">21</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Forensics Tools</p>
          </td>
          <td class="table-cell">
            <p class="normal">23</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Sniffing &amp; Spoofing</p>
          </td>
          <td class="table-cell">
            <p class="normal">33</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Password Attacks</p>
          </td>
          <td class="table-cell">
            <p class="normal">39</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Maintaining Access</p>
          </td>
          <td class="table-cell">
            <p class="normal">17</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Reverse Engineering</p>
          </td>
          <td class="table-cell">
            <p class="normal">11</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Hardware Hacking</p>
          </td>
          <td class="table-cell">
            <p class="normal">6</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Reporting Tools</p>
          </td>
          <td class="table-cell">
            <p class="normal">10</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 1.2: The number of tools available, listed with respect to the specific tasks for which they are used</p>
    <p class="normal">Some of the key <a id="_idIndexMarker030"/>features of Kali Linux 2021.4 include:</p>
    <ul>
      <li class="bulletList">Support for multiple desktop environments such as KDE, GNOME3, Xfce, MATE, e17, lxde, and i3wm.021.</li>
      <li class="bulletList">By default, Kali Linux has Debian-compliant tools that are synchronized with the Debian repositories at least four times daily, making it easier to update packages and apply security fixes.</li>
      <li class="bulletList">There are secure development environments and GPG-signed packages and repositories.</li>
      <li class="bulletList">There is <a id="_idIndexMarker031"/>support for ISO customization, allowing users to build their own versions of customized Kali with a limited set of tools to make it lightweight. The bootstrap function also performs enterprise-wide network installs that can be automated using pre-seed files.</li>
      <li class="bulletList">Since ARM-based systems have become more prevalent and less expensive, support for <strong class="keyWord">ARMEL</strong> and <strong class="keyWord">ARMHF</strong> in Kali Linux can be installed on devices such as rk3306 mk/ss808, Raspberry Pi, ODROID U2/X2, Samsung Chromebook, EfikaMX, Beaglebone Black, CuBox, and Galaxy Note 10.1.</li>
      <li class="bulletList">Kali remains a free open-source project. Most importantly, it is well supported by an active online community.</li>
    </ul>
    <h2 id="_idParaDest-20" class="heading-2">The role of Kali in red team tactics</h2>
    <p class="normal">While pentesters <a id="_idIndexMarker032"/>might prefer any type of <a id="_idIndexMarker033"/>operating system to perform their desired activity, usage of Kali Linux saves significant time and prevents the need to search for packages that aren’t typically available in other operating systems. Some of the advantages that are not noticed with Kali Linux during a red team exercise include the following:</p>
    <ul>
      <li class="bulletList">One single source to attack various platforms.</li>
      <li class="bulletList">It’s quick to add sources and install packages and supporting libraries (especially those that are not available for Windows).</li>
      <li class="bulletList">It’s even possible to install RPM packages with the usage of alien.</li>
    </ul>
    <p class="normal">The purpose of Kali Linux is to secure network, cloud, and application infrastructure and bundle all of the tools to provide a single platform for penetration testers and forensic analysts. </p>
    <h1 id="_idParaDest-21" class="heading-1">Installing and updating Kali Linux</h1>
    <p class="normal">In the previous <a id="_idIndexMarker034"/>editions of this book, we focused on the installation <a id="_idIndexMarker035"/>of Kali Linux to VMware Player, VirtualBox, AWS, and the Raspberry Pi using the Docker appliance. In this section, we will touch base on installing Kali Linux on these same platforms, along with Google Cloud Platform, and a non-rooted Android phone. </p>
    <h2 id="_idParaDest-22" class="heading-2">Using as a portable device</h2>
    <p class="normal">It is fairly simple to install Kali Linux onto a portable device. In some situations, clients do not <a id="_idIndexMarker036"/>permit the use of an external laptop inside a <a id="_idIndexMarker037"/>secure facility. In those cases, typically, a testing laptop is provided by the client to the pentesters to perform the scan. Running Kali Linux from <a id="_idIndexMarker038"/>a portable device has more advantages during a pentest or RTE:</p>
    <ul>
      <li class="bulletList">It can fit inside a pocket, in the case of a USB drive or mobile device.</li>
      <li class="bulletList">It can be run live without making any changes to the host operating system.</li>
      <li class="bulletList">You can customize the build of Kali Linux and even make the storage persistent.</li>
    </ul>
    <p class="normal">There are three simple steps to make a USB drive into a portable form of Kali from a Windows PC:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Download the official Kali Linux image from:<a href="http://docs.kali.org/introduction/download-official-kali-linux-images"><span class="url">http://docs.kali.org/introduction/download-official-kali-linux-images</span></a></li>
      <li class="numberedList">We will be using the Rufus open-source utility to create a bootable disk. Rufus helps to create and format bootable drives. Download the latest Rufus from <a href="https://github.com/pbatard/rufus/releases/"><span class="url">https://github.com/pbatard/rufus/releases/</span></a></li>
      <li class="numberedList">Open the Rufus executable as an administrator. Plug the USB drive into an available USB port. Browse to the location where you have downloaded your image. You should see what is shown in <em class="italic">Figure 1.3</em>. Select the right drive name and then click <strong class="screenText">Start</strong>:<figure class="mediaobject"><img src="../Images/B17765_01_03.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.3: Running Rufus to write Kali Linux to an external disk </p>
      </li>
    </ol>
    <p class="normal">Once complete, close <a id="_idIndexMarker039"/>the Rufus application and safely remove <a id="_idIndexMarker040"/>the USB drive. Kali Linux is now ready as a portable device to be plugged into any laptop and be booted up. If you plan to store information while booted on a live disk, ensure you select <strong class="screenText">Persistence partition size</strong> to have a minimum of 4 GB; then select <strong class="screenText">Live USB persistence</strong> while booting Kali Linux on the portable device. If your host operating system is Linux, this can be achieved by two standard commands:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo fdisk -l
</code></pre>
    <p class="normal">This will <a id="_idIndexMarker041"/>display all of the disks mounted on the drive. The <code class="inlineCode">dd</code> command-line <a id="_idIndexMarker042"/>utility does the convert and copy:</p>
    <pre class="programlisting con"><code class="hljs-con">dd if=kali linux.iso of=/dev/nameofthedrive bs=512k
</code></pre>
    <p class="normal"><code class="inlineCode">if</code> is used for the input file, <code class="inlineCode">of</code> is for the output file, and <code class="inlineCode">bs</code> is for the block size.</p>
    <h2 id="_idParaDest-23" class="heading-2">Installing Kali on a Raspberry Pi 4</h2>
    <p class="normal">A Raspberry Pi is a single-board device that is compact in nature and can run just like a fully loaded <a id="_idIndexMarker043"/>computer with minimal functionalities. These devices are extremely useful during RTE and penetration testing activities <a id="_idIndexMarker044"/>while on site. The base of the operating system is loaded from an SD card, just like a hard drive for normal computers.</p>
    <p class="normal">You can perform the same steps as those outlined in the previous section on a high-speed SD card that can be plugged into a Raspberry Pi. We are then ready to use the system without any issues. If the installation is successful, the following screen must be present when Kali Linux is booted from a Raspberry Pi. A Raspberry Pi 4 has been used in this demonstration and accessed the Pi’s operating system using a monitor:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_04.png" alt="A picture containing text, monitor, electronics, display  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.4: Successful installation of Kali Linux on a Raspberry Pi 4</p>
    <h2 id="_idParaDest-24" class="heading-2">Installing Kali on a VM</h2>
    <p class="normal">In the <a id="_idIndexMarker045"/>previous editions, we discussed how to install Kali <a id="_idIndexMarker046"/>to different hypervisors. We will do the same here, and take a very quick detour on how to install Kali on such devices. </p>
    <h3 id="_idParaDest-25" class="heading-3">VMware Workstation Player</h3>
    <p class="normal">VMware Workstation Player, formerly known as VMware Player, is free for personal use and is also <a id="_idIndexMarker047"/>a commercial product for business use from VMware as a desktop application that allows a VM to be run inside your host operating system. This application can be downloaded from <a href="https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html"><span class="url">https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html</span></a></p>
    <p class="normal">We will be using version 16.1. Once the installer is downloaded, go ahead and install the VMware Player accordingly, based on your host operating system. If the installation is complete, you should see a screen similar to that displayed in <em class="italic">Figure 1.5</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_05.png" alt="Graphical user interface, application, Word  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.5: Successful installation of VMware Workstation Player</p>
    <p class="normal">The next <a id="_idIndexMarker048"/>step in order to install Kali Linux on VMware is to click on <strong class="screenText">Create a New Virtual Machine</strong> and select <strong class="screenText">Installer disc image file (iso)</strong>. Browse to your ISO file that was downloaded and then click <strong class="screenText">Next</strong>. You can now enter a name of your choice (for example, <code class="inlineCode">HackBox</code>) and select the <strong class="screenText">Custom Location </strong>where you would like to store your VMware image. Click <strong class="screenText">Next </strong>and specify the disk capacity. It is recommended that a minimum of 2 GB RAM is used, and 15 GB of disk space is needed to run Kali. Click <strong class="screenText">Next </strong>until you finish.</p>
    <p class="normal">Another <a id="_idIndexMarker049"/>method is to directly download the VMware image:</p>
    <p class="normal"><a href="https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/"><span class="url">https://www.offensive-security.com/kali-linux-vm-vmware-virtualbox-image-download/</span></a></p>
    <p class="normal">Open the <code class="inlineCode">.vmx</code> file and select <strong class="screenText">I copied it</strong>. That should boot up the fully loaded Kali Linux in VMware. You can either choose to install Kali Linux as the host operating system or run it as a live image. Once all of the installation steps are complete, you are ready to launch <a id="_idIndexMarker050"/>Kali Linux from VMware without any problems. <em class="italic">Figure 1.6</em> shows the screen that should be seen:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_06.png" alt="A computer screen capture  Description automatically generated with low confidence"/></figure>
    <p class="packt_figref">Figure 1.6: Once Kali Linux has been successfully installed on VMware, this display is shown</p>
    <h3 id="_idParaDest-26" class="heading-3">VirtualBox</h3>
    <p class="normal">Similar to <a id="_idIndexMarker051"/>VMware workstation player, VirtualBox is a hypervisor that is completely open-source <a id="_idIndexMarker052"/>and a free desktop application from which you can run any VM from the host operating system. This application can be downloaded from <a href="https://www.virtualbox.org/wiki/Downloads"><span class="url">https://www.virtualbox.org/wiki/Downloads</span></a>.</p>
    <p class="normal">We will now go ahead and install Kali on VirtualBox. Similar to VMware, we will just execute the downloaded executable until we have a successful installation of Oracle VirtualBox, as shown in <em class="italic">Figure 1.7</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_07.png" alt="Graphical user interface, text, application, email  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.7: Screen displayed upon the successful installation of VM VirtualBox</p>
    <p class="normal">During installation, it is recommended that you set the RAM to at least 1 or 2 GB, and that you create the virtual hard drive with a minimum of 15 GB so that no performance issues are encountered. After the final step, you should be able to load Kali Linux in VirtualBox, as shown in <em class="italic">Figure 1.8</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.8: Kali Linux, as it displays in VM VirtualBox</p>
    <p class="normal">After this <a id="_idIndexMarker053"/>has been completed, we are now ready to use Kali Linux through VirtualBox. However, we will be exploring the different network options in a further section, <em class="italic">LAB network</em>. </p>
    <h2 id="_idParaDest-27" class="heading-2">Installing to a Docker appliance</h2>
    <p class="normal">Docker is an <a id="_idIndexMarker054"/>open-source project that is designed to automate the deployment of software containers <a id="_idIndexMarker055"/>and applications instantly. Docker also provides the additional abstraction and automation layer of operating system-level virtualization on Linux or Windows.</p>
    <p class="normal">Docker is <a id="_idIndexMarker056"/>available for Windows, Mac, Linux, and AWS. For Windows, Docker can be downloaded from <a href="https://www.docker.com/get-started"><span class="url">https://www.docker.com/get-started</span></a>.</p>
    <p class="normal">After the Docker installation, it should be fairly simple to run Kali Linux using the following commands:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo docker pull kalilinux/kali-rolling
sudo docker run -t -i kalilinux/kali-linux-docker /bin/bash 
</code></pre>
    <p class="normal">These can be executed in the Command Prompt (Windows) or Terminal (Linux or Mac) to confirm that the installation has been successful.</p>
    <p class="normal">We should be able to run Kali Linux directly from Docker, as shown in <em class="italic">Figure 1.9</em>. Also note that Docker utilizes container-based technology, which runs its own processes that are isolated from the rest of the operating system, and it shares the host OS kernel. While the <a id="_idIndexMarker057"/>VirtualBox environment is not container-based technology, it virtualizes the hardware and shares the hardware resource from the physical host: </p>
    <figure class="mediaobject"><img src="../Images/B17765_01_09.png" alt="Graphical user interface  Description automatically generated with medium confidence"/></figure>
    <figure class="mediaobject">Figure 1.9: Successful installation of Kali Linux using Docker</figure>
    <p class="normal">Once the Kali Linux Docker image download is complete, you can run the Docker image by running <code class="inlineCode">docker run --tty --interactive kalilinux/kali-rolling /bin/bash</code> in Command Prompt or Terminal. You should be able to see the same as what is shown in <em class="italic">Figure 1.10</em>: </p>
    <figure class="mediaobject"><img src="../Images/B17765_01_10.png" alt="A screenshot of a computer  Description automatically generated with medium confidence"/></figure>
    <p class="packt_figref">Figure 1.10: Successful running of Kali Linux from Docker</p>
    <p class="normal">If Windows 10 is your base operating system, ensure that VT-X is enabled on your system BIOS, along with <strong class="screenText">Hyper-V</strong>. Note that enabling <strong class="screenText">Hyper-V</strong> will disable VirtualBox, as shown in <em class="italic">Figure 1.11</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.11: An alert that will be shown when installing Docker</p>
    <div class="note">
      <p class="normal">Readers should be aware that the following sections involve the usage of commercial services, such as AWS and Google Cloud Platform, that might incur charges while utilizing the services. It is always recommended that readers completely delete or terminate the instances having finished their testing.</p>
    </div>
    <h2 id="_idParaDest-28" class="heading-2">Kali on AWS Cloud</h2>
    <p class="normal"><strong class="keyWord">Amazon Web Services</strong> <strong class="keyWord">(AWS)</strong> provides <a id="_idIndexMarker058"/>Kali Linux as part <a id="_idIndexMarker059"/>of <strong class="keyWord">Amazon Machine Interface</strong> (<strong class="keyWord">AMI</strong>) and <strong class="keyWord">SaaS.</strong> Nowadays, <a id="_idIndexMarker060"/>the majority of the security testing companies <a id="_idIndexMarker061"/>utilize AWS to conduct penetration testing and more efficient <a id="_idIndexMarker062"/>phishing attacks. In this section, we will go through the steps to bring up Kali Linux on AWS.</p>
    <p class="normal">First, you will need to have a valid AWS account. You can sign up by visiting the following URL: <a href="https://console.aws.amazon.com/console/home "><span class="url">https://console.aws.amazon.com/console/home</span></a></p>
    <p class="normal">When logging in to the AWS account, we should be able to see all of the AWS services. Search for Kali Linux, and the following should be displayed, as shown in <em class="italic">Figure 1.12</em>. </p>
    <p class="normal">The page can also be accessed using the following link: <a href="https://aws.amazon.com/marketplace/pp/prodview-fznsw3f7mq7to"><span class="url">https://aws.amazon.com/marketplace/pp/prodview-fznsw3f7mq7to</span></a>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_12.png" alt="Graphical user interface, text, website  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.12: Pre-configured Kali Linux in the AWS Marketplace</p>
    <p class="normal">The open-source <a id="_idIndexMarker063"/>community has made it very simple to <a id="_idIndexMarker064"/>directly launch a pre-configured Kali Linux 2021.4 instance from the AWS Marketplace. The following will take us to a direct launch of <a id="_idIndexMarker065"/>Kali Linux within a few minutes: <a href="https://aws.amazon.com/marketplace/pp/prodview-fznsw3f7mq7to"><span class="url">https://aws.amazon.com/marketplace/pp/prodview-fznsw3f7mq7to</span></a>.</p>
    <p class="normal">Follow the instructions; you should then be able to launch the Kali instance by selecting <strong class="screenText">Continue to Subscribe</strong>. This should take you to the login page of AWS if not logged in. Click on <strong class="screenText">Continue to Configuration</strong>, continue to click on <strong class="screenText">Continue to Launch</strong>, and you should arrive at the screen shown in <em class="italic">Figure 1.13</em>. From <strong class="screenText">Choose Action</strong>, select the option <strong class="screenText">Launch through EC2</strong>, also shown in <em class="italic">Figure 1.13</em>; finally, click <strong class="screenText">Launch</strong>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.13: Selecting a method to launch Kali Linux through EC2</p>
    <p class="normal">The next <a id="_idIndexMarker066"/>screen will allow you to choose the <strong class="screenText">Instance type</strong>; select<strong class="screenText"> t2.micro (Free tier eligible)</strong> and click on <strong class="screenText">Review and Launch</strong> . Finally, you <a id="_idIndexMarker067"/>should arrive at<strong class="screenText"> Review Instance Launch</strong>; click on<strong class="screenText"> Launch</strong>. This should take us to a screen where a new key pair can be created, as shown in<em class="italic"> Figure 1.14</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.14: Creating a new key pair to connect to AWS instances</p>
    <p class="normal">As usual, to use <a id="_idIndexMarker068"/>any AWS VM, you must create your <a id="_idIndexMarker069"/>own key pair in order to ensure the security of the environment. You should then be able to log in by entering the following command from your command shell. In order to use the private key to log in without the password, Amazon enforces the file permission to be tunneled. We will use the following commands to connect to the Kali Linux instance from Terminal:</p>
    <pre class="programlisting con"><code class="hljs-con">chmod 400 privatekey.pem
ssh -i privatekey.pem kali@PublicIPofAWS
</code></pre>
    <p class="normal">All Windows users can utilize Windows PowerShell to connect to the instance by running:</p>
    <pre class="programlisting con"><code class="hljs-con">ssh -i privatekey.pem kali@PublicIPofAWS 
</code></pre>
    <p class="normal"><em class="italic">Figure 1.15 </em>depicts the successful usage of Kali on AWS:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.15: Successful connection to a Kali Linux instance in AWS</p>
    <div class="note">
      <p class="normal">All of the terms and conditions must be met in order to utilize AWS to perform penetration testing. Legal terms and conditions must be met before launching any attacks from the cloud host.</p>
    </div>
    <h2 id="_idParaDest-29" class="heading-2">Kali on Google Cloud Platform (GCP)</h2>
    <p class="normal">There <a id="_idIndexMarker070"/>is no version of Kali Linux already <a id="_idIndexMarker071"/>available within the Google Cloud Marketplace, unlike AWS. Hence, we will take a different approach to launching Kali Linux on the GCP. Following the same instructions that we used to install Kali in VirtualBox, also use in this instance 12 GB of hard disk space along with 2 GB of RAM. We will utilize our local image to upload to a Google bucket and Compute Engine to run this instance. Before that, we must ensure that once our installation is complete and we log into Kali Linux and start the SSH service to make it persistent, the following commands are run in the Kali Linux VM terminal:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo systemctl start ssh
sudo update-rc.d -f ssh enable 2 3 4 5
sudo reboot
</code></pre>
    <p class="normal">For some <a id="_idIndexMarker072"/>reason, GCP does not <a id="_idIndexMarker073"/>deploy VirtualBox images with the floppy disk enabled, hence we are going to remove the floppy disk by selecting Kali and navigating to <strong class="screenText">Settings</strong>, then <strong class="screenText">System</strong>,<strong class="screenText"> </strong>and unselecting <strong class="screenText">Floppy</strong> from <strong class="screenText">Boot Order</strong>, as shown in <em class="italic">Figure 1.16</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.16: With the floppy disk enabled under the Boot Order option, GCP does not deploy VirtualBox images</p>
    <p class="normal">The next important step involves ensuring that our image is picking up GCP’s network in gathering the DHCP, and getting a public IP address; it is important that we change the network settings by selecting Kali and navigating to <strong class="screenText">Settings</strong>, then <strong class="screenText">Network</strong>, and clicking on <strong class="screenText">Advanced</strong> to change the <strong class="screenText">Adapter Type</strong> to <strong class="screenText">Paravirtualized Network</strong>, as shown in <em class="italic">Figure 1.17</em>: </p>
    <figure class="mediaobject"><img src="../Images/B17765_01_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.17: Selecting the Paravirtualized Network in VirtualBox</p>
    <p class="normal">It is <a id="_idIndexMarker074"/>also recommended to remove <a id="_idIndexMarker075"/>the audio feature to avoid any compatibility issues; select Kali and navigate to <strong class="screenText">Settings</strong>, <strong class="screenText">Audio</strong>, and uncheck <strong class="screenText">Enable Audio</strong>, as shown in <em class="italic">Figure 1.18</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.18: With the Enable Audio option selected under the Audio section, GCP may not work properly</p>
    <p class="normal">Now we must <a id="_idIndexMarker076"/>convert the <strong class="keyWord">Virtual Disk Image </strong>(<strong class="keyWord">VDI</strong>) into RAW format and apply the naming convention of <code class="inlineCode">disk.raw</code> that can then be utilized by Google’s imaging automation software. </p>
    <p class="normal">We will utilize the generic and open-source machine emulator and virtualizer (QEMU) as the tool to convert either VDI or VMDK files to RAW. In the <a id="_idIndexMarker077"/>following steps, we covert the VDI format (similar steps apply for VMDK files): </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Navigate to the VirtualBox location where you have saved the disk images.</li>
      <li class="numberedList">Ensure qemu-img is installed on the native system:<ul>
          <li class="bulletList">This can be installed in Windows by downloading the application from <a href="https://www.qemu.org/download/#windows"><span class="url">https://www.qemu.org/download/#windows</span></a></li>
          <li class="bulletList">This can be installed in Linux or macOS systems by running the commands <code class="inlineCode">sudo apt install qemu-img</code> or <code class="inlineCode">brew install qemu-img</code></li>
        </ul>
      </li>
      <li class="numberedList">To convert the image, the following command can be run from the respective Terminal or Command Prompt:
        <pre class="programlisting con"><code class="hljs-con">qemu-img convert –f vdi –O raw nameofthevm.vdi disk.raw 
</code></pre>
      </li>
      <li class="numberedList">Once the <code class="inlineCode">disk.raw</code> file is created, to reduce the upload size, we will compress the raw disk into the <code class="inlineCode">tar.gz</code> format. However, it is better to use <code class="inlineCode">gtar</code> since Google relies heavily on this utility. For Windows users, these are not natively installed, but the utility can be directly downloaded from <a href="http://gnuwin32.sourceforge.net/packages/gtar.htm"><span class="url">http://gnuwin32.sourceforge.net/packages/gtar.htm</span></a>.<p class="normal">You can create the final GCP-compliant image by running the command <code class="inlineCode">gtar –cSzf kali.tar.gz disk.raw</code> on Linux and macOS systems or <code class="inlineCode">tar –zcvf kali.tar.gz disk.raw</code> on Windows.</p>
      </li>
    </ol>
    <p class="normal">We now have our own image ready to be uploaded to GCP. Create a GCP account or use an existing one to log in to the service. Similar to Microsoft, GCP also provides a free credit option for the user to experience their cloud computing services. The following steps <a id="_idIndexMarker078"/>are involved in launching <a id="_idIndexMarker079"/>Kali Linux on GCP:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Log in to <a href="https://console.cloud.google.com/"><span class="url">https://console.cloud.google.com/</span></a>.</li>
      <li class="numberedList">Navigate to <strong class="screenText">Cloud Storage</strong> and select <strong class="screenText">Brower</strong>, and click <strong class="screenText">Create a Bucket</strong>.</li>
      <li class="numberedList">Choose a name for the bucket in compliance with GCP’s policy (no capital letters allowed); in our case, we created the bucket name <code class="inlineCode">mastering-kali-linux-edition4</code>.</li>
      <li class="numberedList">Click on <strong class="screenText">Upload Files </strong>and select our compressed <code class="inlineCode">kali.tar.gz</code> image that we just created. Once <a id="_idIndexMarker080"/>the upload <a id="_idIndexMarker081"/>is complete, you should be able to see the same screen displayed in <em class="italic">Figure 1.19</em>: <figure class="mediaobject"><img src="../Images/B17765_01_19.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.19: After uploading the compressed image to GCP, this screen will be displayed</p>
      </li>
      <li class="numberedList">Go back to the <strong class="screenText">Home </strong>page and select <strong class="screenText">Compute Engine</strong>; select <strong class="screenText">Images </strong>under the storage<strong class="screenText"> </strong>and then click on <strong class="screenText">Create Image</strong> and enter a name for the image, in this case, we entered <code class="inlineCode">gcp-kali</code>. </li>
      <li class="numberedList">Once the name has been entered, for the source, select <strong class="screenText">cloud storage file</strong>, click on <strong class="screenText">Bucket</strong>, and then select our compressed gz image (<code class="inlineCode">kali.tar.gz</code>).</li>
      <li class="numberedList">You can select any region that you want to run in; we selected the default for demonstration purposes. Click <strong class="screenText">Create</strong>, which should bring you to the screen displayed in <em class="italic">Figure 1.20</em>; if you do not see this, then click on <strong class="screenText">REFRESH</strong> on the same screen:<figure class="mediaobject"><img src="../Images/B17765_01_20.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.20: The newly created gcp-kali image displaying in the GCP images</p>
      </li>
      <li class="numberedList">Once <a id="_idIndexMarker082"/>the image is created, click <a id="_idIndexMarker083"/>on <strong class="screenText">Actions </strong>and <strong class="screenText">Create instance</strong>, as shown in <em class="italic">Figure 1.21</em>:<figure class="mediaobject"><img src="../Images/B17765_01_21.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.21: Successful creation of our gcp-kali image that is ready to run as an instance</p>
      </li>
      <li class="numberedList">This should take us to the VM instance screen to feed the Kali Linux instance information, as shown in <em class="italic">Figure 1.22</em>: <figure class="mediaobject"><img src="../Images/B17765_01_22.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.22: Entering our gcp-kali instance details and selecting the required resources to run it</p>
      </li>
      <li class="numberedList">We can now select the CPU (Core Processing Unit) platform and GPU (Graphics Processing Unit); we will select <code class="inlineCode">E2 medium</code>, which will provide two virtual cores of vCPU and 4 GB RAM. Our image includes the storage that we selected during the VM creation (12 GB). </li>
      <li class="numberedList">Finally, ensure <a id="_idIndexMarker084"/>that the boot <a id="_idIndexMarker085"/>disk remains as it is—no changes are required—and finally click <strong class="screenText">Create</strong>. This should bring us to the final screen with both the internal and public IP addresses, as shown in <em class="italic">Figure 1.23</em>:<figure class="mediaobject"><img src="../Images/B17765_01_23.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.23: Successful installation of Kali Linux as an instance in GCP, with an internal and external IP</p>
      </li>
      <li class="numberedList">We now have successfully created and run an instance of Kali Linux on the GCP, and we can now log in to the public IP with the username and password that we created during the initial creation, as shown in <em class="italic">Figure 1.24</em>:<figure class="mediaobject"><img src="../Images/B17765_01_24.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.24: Successfully connecting to the Kali Linux instance in GCP externally</p>
      </li>
    </ol>
    <h1 id="_idParaDest-30" class="heading-1">Kali on Android (non-rooted phones)</h1>
    <p class="normal">With the <a id="_idIndexMarker086"/>support of ARM images, it is <a id="_idIndexMarker087"/>possible to directly download the Nethunter images from the Kali website; however, in this section we will try a different approach, running Kali on any Android device that is configured to a high enough standard.</p>
    <p class="normal">We will utilize two applications from the trusted Google Play Store:</p>
    <ul>
      <li class="bulletList">UserLAnd: This is <a id="_idIndexMarker088"/>an open-source app that allows you to run several Linux operating systems on Android devices. This can be downloaded <a id="_idIndexMarker089"/>to the device through the Play Store by visiting <a href="https://play.google.com/store/apps/details?id=tech.ula&amp;hl=en_GB&amp;gl=US"><span class="url">https://play.google.com/store/apps/details?id=tech.ula&amp;hl=en_GB&amp;gl=US</span></a>.</li>
      <li class="bulletList">ConnectBot: A powerful <a id="_idIndexMarker090"/>open-source SSH client, it can manage simultaneous SSH sessions, create secure tunnels, and copy/paste between other applications. This application can also be downloaded directly through the Play <a id="_idIndexMarker091"/>Store or by visiting <a href="https://play.google.com/store/apps/details?id=org.connectbot&amp;hl=en_GB&amp;gl=US"><span class="url">https://play.google.com/store/apps/details?id=org.connectbot&amp;hl=en_GB&amp;gl=US</span></a>.</li>
    </ul>
    <p class="normal">Once you <a id="_idIndexMarker092"/>have downloaded UserLAnd, you <a id="_idIndexMarker093"/>should see the same as that shown in <em class="italic">Figure 1.25</em>; select <strong class="screenText">Kali</strong>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.25: Selecting Kali Linux in the UserLAnd mobile application</p>
    <p class="normal">The application should ask for your username, password, and VNC password for Kali to log in. Once the action is completed, there should be a pop-up asking you to select a connection bot, as shown in <em class="italic">Figure 1.26</em>: </p>
    <figure class="mediaobject"><img src="../Images/B17765_01_26.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.26: After the Kali Linux image is downloaded, you will be provided with the two options; select ConnectBot</p>
    <p class="normal">We now <a id="_idIndexMarker094"/>have a lightweight version <a id="_idIndexMarker095"/>of Kali Linux (you may have to install the tools as and when required; as an example, you may install routersploit by running <code class="inlineCode">sudo apt-get update &amp;&amp; apt install routersploit</code> to gather information about the router that the mobile device is connected to) on our handheld Android device; part of the interface is shown in <em class="italic">Figure 1.27</em>: </p>
    <figure class="mediaobject"><img src="../Images/B17765_01_27.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.27: Successful installation of Kali Linux on an Android device</p>
    <p class="normal">We have now seen how Kali Linux is installed and run on an Android device without having <a id="_idIndexMarker096"/>to root the device. The <a id="_idIndexMarker097"/>version of Kali Linux on the device operates in its own sandbox; therefore, there will be no restrictions on us performing penetration testing from the device.</p>
    <h1 id="_idParaDest-31" class="heading-1">Organizing Kali Linux</h1>
    <p class="normal">Installation is <a id="_idIndexMarker098"/>just the beginning; organizing Kali Linux is a very important next step. In this section, we will explore the different ways in which our Kali Linux can be organized through customization.</p>
    <h2 id="_idParaDest-32" class="heading-2">Configuring and customizing Kali Linux</h2>
    <p class="normal">Kali is a framework that is used to perform penetration testing. The tester, however, should never <a id="_idIndexMarker099"/>feel tied to the tools that have been installed by default, or by <a id="_idIndexMarker100"/>the look and feel of the Kali desktop. By customizing Kali, a tester can increase the security of client data that is being collected and make it easier to perform a penetration test. Common customization options that can be <a id="_idIndexMarker101"/>made in Kali include the following:</p>
    <ul>
      <li class="bulletList">Resetting the Kali password </li>
      <li class="bulletList">Adding a non-root user</li>
      <li class="bulletList">Configuring network services and secure communications</li>
      <li class="bulletList">Adjusting network proxy settings</li>
      <li class="bulletList">Accessing the secure shell</li>
      <li class="bulletList">Speeding up Kali operations</li>
      <li class="bulletList">Sharing folders with Microsoft Windows</li>
      <li class="bulletList">Creating encrypted folders</li>
    </ul>
    <p class="normal">Let us now take a further look at these options.</p>
    <h2 id="_idParaDest-33" class="heading-2">Resetting the default password</h2>
    <p class="normal">If you <a id="_idIndexMarker102"/>downloaded the preconfigured VMware or VirtualBox image, the default username and password to access Kali Linux is <code class="inlineCode">kali</code>. It is recommended to change the default password; to do so, run the following command in the Kali Linux terminal:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo passwd kali
</code></pre>
    <p class="normal">You will <a id="_idIndexMarker103"/>then be prompted to enter a new password, and then to confirm it.</p>
    <h2 id="_idParaDest-34" class="heading-2">Configuring network services and secure communications</h2>
    <p class="normal">The first step to ensure that we are able to access the internal network is to make sure that it <a id="_idIndexMarker104"/>has connectivity to either a wired or wireless <a id="_idIndexMarker105"/>network to support updates <a id="_idIndexMarker106"/>and communications. You may need to obtain an IP address through <strong class="keyWord">Dynamic Host Configuration Protocol</strong> <strong class="keyWord">(DHCP)</strong> by appending a network configuration file and adding an Ethernet adapter to it, in the form of the following commands from the Kali Linux terminal:</p>
    <pre class="programlisting con"><code class="hljs-con"># sudo nano /etc/network/interfaces
iface eth0 inet dhcp
</code></pre>
    <p class="normal">Once the network configuration file is appended, you should be able to bring up the <code class="inlineCode">ifup</code> script to automatically assign the IP address, as displayed in <em class="italic">Figure 1.28</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_28.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.28: Successful assignment of an IP address through DHCP using the ifup script</p>
    <p class="normal">In the case of a static IP, you can append the same network configuration file with the following lines and quickly set up a static IP to your version of Kali Linux:</p>
    <pre class="programlisting con"><code class="hljs-con"># nano /etc/network/interfaces
iface eth0 inet static
address &lt;your address&gt;
netmask &lt;subnet mask&gt;
broadcast &lt;broadcast mask&gt;
gateway &lt;default gateway&gt;
# nano /etc/resolv.conf
nameserver &lt;your DNS ip&gt; or &lt;Google DNS (8.8.8.8)&gt;
</code></pre>
    <p class="normal">By default, Kali starts with the DHCP service enabled. Doing so announces the new IP address <a id="_idIndexMarker107"/>to the network, which may alert administrators <a id="_idIndexMarker108"/>to the presence of the tester. For some test cases, this may not be an issue, and it may be advantageous to have certain services start automatically during boot-up. This can be achieved by entering the following commands:</p>
    <pre class="programlisting con"><code class="hljs-con">update-rc.d networking defaults
/etc/init.d/networking restart
</code></pre>
    <p class="normal">Kali installs with network services that can be started or stopped as required, including DHCP, HTTP, SSH, TFTP, and the VNC server. These services are usually invoked from the command line; however, some are accessible from the Kali menu.</p>
    <h2 id="_idParaDest-35" class="heading-2">Adjusting network proxy settings</h2>
    <p class="normal">Users located <a id="_idIndexMarker109"/>behind an authenticated or unauthenticated proxy connection must modify the<code class="inlineCode"> bash.bashrc</code> and <code class="inlineCode">apt.conf</code> files. Both files are located in the <code class="inlineCode">/etc/</code> directory. Edit the <code class="inlineCode">bash.bashrc </code>file, as the following shows, using a text editor to add the following lines to the bottom of the <code class="inlineCode">bash.bashrc</code> file:</p>
    <pre class="programlisting con"><code class="hljs-con">export ftp_proxy=ftp://username:password@proxyIP:port
export http_proxy=http://username:password@proxyIP:port
export https_proxy=https://username:password@proxyIP:port
export socks_proxy="https://username:password@proxyIP:port"
</code></pre>
    <p class="normal">Replace <code class="inlineCode">proxyIP </code>and <code class="inlineCode">port</code> with your proxy IP address and port number, respectively, and replace the <code class="inlineCode">username</code> and <code class="inlineCode">password</code> with your authentication username and password. If <a id="_idIndexMarker110"/>there’s no need to authenticate, write only the part following the <code class="inlineCode">@</code> symbol. Save and close the file.</p>
    <h2 id="_idParaDest-36" class="heading-2">Accessing the secure shell remotely</h2>
    <p class="normal">To minimize detection by a target network during testing, Kali does not enable any external <a id="_idIndexMarker111"/>listening network services. Some services, such as SSH, are already installed. However, they must be enabled prior to use. Kali comes preconfigured with default SSH keys. Before starting the SSH service, it is a good idea to disable the default keys and generate a unique keyset for use, as the following code shows. Move the default SSH keys to a backup folder, and then generate a new SSH keyset using the following command:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo dpkg-reconfigure openssh-server
</code></pre>
    <p class="normal">To confirm the SSH service is running, you can verify this by using the command <code class="inlineCode">sudo service ssh status</code>.</p>
    <p class="normal">Note that with the default configuration of SSH, root login will be disabled. If you require access with the root account, you may have to edit <code class="inlineCode">/etc/ssh/sshd_config</code> and set <code class="inlineCode">PermitRootLogin</code> to <code class="inlineCode">yes</code>, save, and then exit. Finally, from any system on the same network, you should be able to access the SSH service and utilize Kali Linux. In this example, we use PuTTY, which is a free and portable SSH client for Windows. Now you should be able to access Kali Linux from another machine, accept the SSH certificate, and enter your credentials.</p>
    <h2 id="_idParaDest-37" class="heading-2">Speeding up Kali operations</h2>
    <p class="normal">Several tools <a id="_idIndexMarker112"/>can be used to optimize and speed up Kali operations:</p>
    <ul>
      <li class="bulletList">When using a VM, install its software drive package, either Guest Additions (VirtualBox) or VMware Tools (VMware).
    <div class="packt_tip">
      <p class="normal">We have to ensure that we run <code class="inlineCode">apt-get update</code> before the installation.</p>
    </div>
      </li>
    </ul>
    <ul>
      <li class="bulletList">When creating a VM, select a fixed disk size instead of one that is dynamically allocated. It is faster to add files to a fixed disk, and there is less file fragmentation.</li>
      <li class="bulletList">By default, Kali does not show all applications that are present in the startup menu. Each application that is installed during the boot-up process slows the system <a id="_idIndexMarker113"/>data and may impact memory usage and system performance. This can be performed by the following commands in the terminal:<ul>
          <li class="bulletList">To list all the startup services at bootup, type <code class="inlineCode">sudo systemctl list-unit-files --type=service</code> in the terminal and you can choose to disable the unwanted services by running <code class="inlineCode">sudo systemctl disable --now &lt;nameoftheservice&gt;</code></li>
          <li class="bulletList">Finally, you can list the enabled services by running <code class="inlineCode">sudo systemctl list-unit-files --type=service --state=enabled --all</code> in the terminal</li>
        </ul>
      </li>
    </ul>
    <h2 id="_idParaDest-38" class="heading-2">Sharing folders with the host operating system</h2>
    <p class="normal">The Kali toolset has the flexibility to share results with applications residing on different operating <a id="_idIndexMarker114"/>systems, especially Microsoft Windows. The most effective way to share data is to create a folder that is accessible from the host operating system as well as the Kali Linux VM guest. When data is placed in a shared folder from either the host or the VM, it is immediately available via the shared folder to all systems that access that shared folder. To create a shared folder, perform the following steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Create a folder on the host operating system. In this example, it will be called <code class="inlineCode">kali_Share</code>.</li>
      <li class="numberedList">Right-click on the folder and select the <strong class="screenText">Sharing </strong>tab. From this menu, select <strong class="screenText">Share</strong>.</li>
      <li class="numberedList">Ensure that the file is shared with <strong class="screenText">Everyone</strong> and that <strong class="screenText">Permission Level </strong>for this share is set to <strong class="screenText">Read/Write</strong>.</li>
      <li class="numberedList">If you haven’t already done so, install the VMware tools/Virtual Box Guest additions onto Kali Linux, respectively. </li>
      <li class="numberedList">When the installation is complete, go to the VMware player menu and select <strong class="screenText">Manage</strong> and click on <strong class="screenText">Virtual Machine Settings</strong>. Find the menu that enables <strong class="screenText">Shared Folders</strong> and select <strong class="screenText">Always Enabled</strong>. </li>
      <li class="numberedList">In the <a id="_idIndexMarker115"/>case of Oracle VirtualBox, select the VM and go to <strong class="screenText">Settings </strong>and select <strong class="screenText">Shared Folders</strong>, as shown in <em class="italic">Figure 1.29</em>:<figure class="mediaobject"><img src="../Images/B17765_01_29.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.29: Mounting a shared drive from the original operating system to the guest operating system</p>
        <div class="note">
          <p class="normal">Please note that older versions of VMware Player use a different menu.</p>
        </div>
      </li>
      <li class="numberedList">Now the folder should be automatically mounted to the <code class="inlineCode">/media/</code> folder, as shown in <em class="italic">Figure 1.30</em>:<figure class="mediaobject"><img src="../Images/B17765_01_30.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.30: Successful mounting of the shared drive to the Kali Linux VM</p>
      </li>
      <li class="numberedList">Everything <a id="_idIndexMarker116"/>placed in the folder will be accessible in the folder of the same name on the host operating system, and vice versa.</li>
    </ol>
    <p class="normal">The shared folder, which will contain sensitive data from a penetration test, must be encrypted to protect the client’s network and reduce the tester’s liability should the data ever be lost or stolen.</p>
    <h2 id="_idParaDest-39" class="heading-2">Using Bash scripts to customize Kali</h2>
    <p class="normal">Typically, to <a id="_idIndexMarker117"/>maintain system and software development, command-line interfaces were developed as multiple shells in Linux, namely, <code class="inlineCode">sh</code>, <code class="inlineCode">bash</code>, <code class="inlineCode">csh</code>, <code class="inlineCode">tcsh</code>, and <code class="inlineCode">ksh</code>.</p>
    <p class="normal">We can utilize the following Bash scripts to customize Kali Linux depending upon the goal of our penetration testing: <a href="https://github.com/PacktPublishing/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E"><span class="url">https://github.com/PacktPublishing/Mastering-Kali-Linux-for-Advanced-Penetration-Testing-4E</span></a>.</p>
    <h1 id="_idParaDest-40" class="heading-1">Building a verification lab</h1>
    <p class="normal">As a penetration <a id="_idIndexMarker118"/>tester, it is recommended to set up your own verification lab to test any kind of vulnerabilities and have the right proof of concept before emulating the same conditions on a live environment.</p>
    <h2 id="_idParaDest-41" class="heading-2">Installing defined targets</h2>
    <p class="normal">In order to <a id="_idIndexMarker119"/>practice the art of exploitation, it is always recommended to make use of well-known vulnerable software. In this section, we will be installing Metasploitable3, which has both Windows and Linux versions; Mutillidae, which is a PHP framework web application; and we will also utilize CloudGoat, an AWS deployment tool designed to deploy vulnerable AWS instances.</p>
    <h3 id="_idParaDest-42" class="heading-3">Lab Network</h3>
    <p class="normal">We need to <a id="_idIndexMarker120"/>ensure that we create a separate <a id="_idIndexMarker121"/>network that can be accessed only by testers—hence, we are going to create a NAT network within VirtualBox by running the following command from the Command Prompt or Terminal, respective of the directory; for Windows, it is <code class="inlineCode">C:\Program Files\Oracle\VirtualBox\</code>:</p>
    <pre class="programlisting con"><code class="hljs-con">VBoxManage natnetwork add --netname InsideNetwork --network "10.10.10.0/24" –-enable --dhcp on
</code></pre>
    <p class="normal">Note that this is a single line of code.</p>
    <h3 id="_idParaDest-43" class="heading-3">Active Directory and Domain Controller</h3>
    <p class="normal">In the <a id="_idIndexMarker122"/>previous edition, we discussed <a id="_idIndexMarker123"/>how to set up the Active Directory <a id="_idIndexMarker124"/>on Windows 2008 R2; in this section, we will upgrade <a id="_idIndexMarker125"/>our test lab and install Active Directory on Windows Server 2016 Datacenter. Once the ISO from Microsoft (<a href="https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016-essentials"><span class="url">https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016-essentials</span></a>) is downloaded and the operating system on VMware Workstation Player or VirtualBox is installed, you should be able to perform the following steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Ensure the Network adapter is connected to the right network. Select the virtual machine and click <strong class="screenText">Settings</strong>. Then, from the menu, click on <strong class="screenText">Network</strong>, ensure that <strong class="screenText">Enable network adapter</strong> is checked and that <strong class="screenText">Attached to </strong>is selected as <strong class="screenText">NAT network</strong>, and that the name is <strong class="screenText">InsideNetwork </strong>(or the name you used to create the lab network). Additionally, click on <strong class="screenText">Advanced</strong> and select <strong class="screenText">Allow All </strong>under <strong class="screenText">Promiscuous mode</strong> (this mode will allow all traffic between the VMs).</li>
      <li class="numberedList">Upon successfully logging into the Windows server, set a static IP to this server by running the following in the command line:
        <pre class="programlisting con"><code class="hljs-con">netsh interface ip set address "ethernet" static 10.10.10.100 255.255.255.0 10.10.10.1
</code></pre>
      </li>
      <li class="numberedList">From <strong class="screenText">Server Manager</strong>, click on <strong class="screenText">Add roles and features</strong>.</li>
      <li class="numberedList">Select <strong class="screenText">Role-based or Features-based installation</strong> from the <strong class="screenText">Installation Type </strong><code class="inlineCode">screen</code> and click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">By default, the same server will be selected from <strong class="screenText">Select a server from the server pool</strong>; click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">From the <strong class="screenText">Server Roles </strong>page, place a checkmark in the checkbox next to <strong class="screenText">Active Directory Domain Services</strong>. Additional roles, services, or features are also required to install Domain Services: click <strong class="screenText">Add Features </strong>and click<strong class="screenText"> Next</strong>.</li>
      <li class="numberedList">Select <a id="_idIndexMarker126"/>optional features to install <a id="_idIndexMarker127"/>during the AD DS installation by placing a check in the box next to any desired features, and then click on <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">That should take us to the confirmation screen with all the selected features and services; click on <strong class="screenText">Install </strong>and, when the installation is complete, click on <strong class="screenText">Close</strong>.</li>
      <li class="numberedList">Select <strong class="screenText">AD DS</strong>; it should come up with a warning stating: <code class="inlineCode">Configuration required for active directory domain service</code>. Now click on <strong class="screenText">More</strong> for post-deployment configuration, which should bring us to <em class="italic">Figure 1.31</em>:<figure class="mediaobject"><img src="../Images/B17765_01_31.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.31: Promoting the server to a domain controller</p>
      </li>
      <li class="numberedList">Click on <strong class="screenText">Promote this server to a domain controller</strong>.</li>
      <li class="numberedList">Select <strong class="screenText">Add a new Forest </strong>and enter the <strong class="keyWord">Fully Qualified Domain Name</strong> (<strong class="keyWord">FQDN</strong>). In this example, we will create a new FQDN called <code class="inlineCode">mastering.kali.fourthedition</code>. Then click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">On the next screen, for both <strong class="screenText">Forest functional level</strong> and <strong class="screenText">Domain functional level</strong>, select <strong class="screenText">Windows Server 2016</strong> and type the password for <strong class="keyWord">Directory Services Restore Mode</strong> (<strong class="keyWord">DSRM</strong>); click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">Do not select the DNS delegation—directly click on <strong class="screenText">Next</strong>, where it should pick up the NetBIOS domain name as <strong class="screenText">MASTERING</strong>. Click <strong class="screenText">Next</strong>.</li>
      <li class="numberedList">Select the <a id="_idIndexMarker128"/>locations for the <a id="_idIndexMarker129"/>database, log files, and SYSVOL for Active Directory, and finally, you should be presented with a review screen, as shown in <em class="italic">Figure 1.32</em>; click <strong class="screenText">Next</strong>:<figure class="mediaobject"><img src="../Images/B17765_01_32.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.32: Final stage of installation of Active Directory server on Windows Server 2016</p>
      </li>
      <li class="numberedList">All the prerequisites must be met. Ignore the warnings; after this, click on <strong class="screenText">Install</strong>.</li>
      <li class="numberedList">On the <strong class="screenText">Confirm installation selections </strong>screen, review the installation and then click <strong class="screenText">Install</strong>. Doing so should reboot the system and a new Active Directory server with a domain controller should have been established.</li>
    </ol>
    <p class="normal">To create <a id="_idIndexMarker130"/>a normal user on the domain, run <a id="_idIndexMarker131"/>the following command in the command line on the domain controller:</p>
    <pre class="programlisting con"><code class="hljs-con">net user normaluser Passw0rd12 /add /domain
</code></pre>
    <p class="normal">To create a domain administrator account, the following commands will create such a user and add it to the <code class="inlineCode">domain admins</code> group:</p>
    <pre class="programlisting con"><code class="hljs-con">net user admin Passw0rd123 /add /domain
net group "domain admins" admin /add /domain
</code></pre>
    <p class="normal">To validate whether these users have been created, you can use the domain controller by simply running <code class="inlineCode">net user</code> from the command line; you should be able to see all the local users on the server.</p>
    <p class="normal">We will also be creating an additional user for the new exchange server by running the following commands on our domain controller:</p>
    <pre class="programlisting con"><code class="hljs-con">net user exchangeadmin Passw0rd123 /add /domain
net group "domain admins" exchangeadmin /add /domain
net group "Schema admins" exchangeadmin /add /domain
net group "Enterprise admins" exchangeadmin /add /domain
</code></pre>
    <h3 id="_idParaDest-44" class="heading-3">Installing Microsoft Exchange Server 2016 </h3>
    <p class="normal">In <a id="_idIndexMarker132"/>this section, we <a id="_idIndexMarker133"/>will set up a completely new Windows Server 2016 and install the Microsoft Exchange service on it. This is to explore some of the Exchange Server 2021 vulnerabilities that we will explore in later chapters. </p>
    <p class="normal">We will utilize the same Windows 2016 ISO that we downloaded for the Active Directory installation and create a brand new server. Once the Windows Server is installed and booted up, the first step is to make sure that this server can now be communicated to the DNS service of the Domain Controller; hence, set up a static IP and DNS by running the following commands or manually by editing the Ethernet adapter settings (<a href="https://www.server-world.info/en/note?os=Windows_Server_2016&amp;p=initial_conf&amp;f=4"><span class="url">https://www.server-world.info/en/note?os=Windows_Server_2016&amp;p=initial_conf&amp;f=4</span></a>):</p>
    <pre class="programlisting con"><code class="hljs-con">netsh interface ip set address "ethernet" static 10.10.10.5 255.255.255.0 10.10.10.1
netsh interface ip add dns "Ethernet" 10.10.10.100
</code></pre>
    <p class="normal">The next <a id="_idIndexMarker134"/>step is to set up Exchange Server to the domain. This can be achieved by doing the following:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Go to <strong class="screenText">System Properties</strong>. Press <em class="keystroke">Windows Key</em> + <em class="keystroke">R</em><strong class="screenText"> </strong>and type <code class="inlineCode">sysdm.cpl</code>; click on <strong class="screenText">Change</strong>, which should bring up the new screen of <strong class="screenText">Computer Name/Domain Changes</strong>.</li>
      <li class="numberedList">Change the computer name from the default to <strong class="screenText">ExchangeServer</strong> and click on <strong class="screenText">Domain</strong>; type <code class="inlineCode">Mastering.kali.fourthedition</code>, and if there is no problem with the network, then you should get a prompt asking you to enter your username and password. </li>
      <li class="numberedList">Enter the username as previously created, called <code class="inlineCode">exchangeadmin</code>, with the password; you should now see the screen shown in <em class="italic">Figure 1.33</em>, showing that it was successfully attached to the domain.</li>
      <li class="numberedList">The final step is to restart the computer for the change in computer name that the domain should now reflect to take place:<figure class="mediaobject"><img src="../Images/B17765_01_33.png" alt="Graphical user interface, application  Description automatically generated"/></figure>
        <p class="packt_figref">Figure 1.33: Successfully adding the exchange server to the Active Directory domain</p>
      </li>
    </ol>
    <p class="normal">The following <a id="_idIndexMarker135"/>steps will promote our normal Windows Server 2016 to an Exchange Server:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Download the Microsoft Exchange Server 2016 image from <a href="https://www.microsoft.com/en-us/download/details.aspx?id=57827"><span class="url">https://www.microsoft.com/en-us/download/details.aspx?id=57827</span></a>.</li>
      <li class="numberedList">Mount the ISO file to VirtualBox as a drive by navigating to <strong class="screenText">Settings</strong>, <strong class="screenText">Storage</strong>, and <strong class="screenText">Select the Optical Drive</strong>, and add the exchange server ISO file. </li>
      <li class="numberedList">Before beginning the installation, we will install some prerequisites, which can be directly installed from PowerShell (run as administrator), as the following shows:
        <pre class="programlisting con"><code class="hljs-con">PS &gt; Install-WindowsFeature NET-Framework-45-Features, RPC-over-HTTP-proxy, RSAT-Clustering, RSAT-Clustering-CmdInterface, RSAT-Clustering-Mgmt, RSAT-Clustering-PowerShell, Web-Mgmt-Console,
WAS-Process-Model, Web-Asp-Net45, Web-Basic-Auth, Web-Client-Auth, Web-Digest-Auth, Web-Dir-Browsing, Web-Dyn-Compression, Web-Http-Errors, Web-Http-Logging, Web-Http-Redirect, Web-Http-Tracing, Web-ISAPI-Ext, Web-ISAPI-Filter, Web-Lgcy-Mgmt-Console, Web-Metabase, Web-Mgmt-Console, Web-Mgmt-Service, Web-Net-Ext45, Web-Request-Monitor, Web-Server, Web-Stat-Compression, Web-Static-Content, Web-Windows-Auth, Web-WMI, Windows-Identity-Foundation, RSAT-ADDS
</code></pre>
      </li>
      <li class="numberedList">Besides <a id="_idIndexMarker136"/>these packages, you will also need to download Unified Communications Managed API 4.0 Runtime from <a href="http://www.microsoft.com/en-us/download/details.aspx?id=34992"><span class="url">http://www.microsoft.com/en-us/download/details.aspx?id=34992</span></a> and install it.</li>
      <li class="numberedList">Once all <a id="_idIndexMarker137"/>the prerequisites are completed, locate the drive by typing <code class="inlineCode">d:</code> in the command line; then type <code class="inlineCode">setup /PrepareSchema /IAcceptExchangeServerLicenseTerms</code>. If no error occurs, then you should see the same screen as displayed in <em class="italic">Figure 1.34</em>:<figure class="mediaobject"><img src="../Images/B17765_01_34.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.34: Prerequisite checks to install Exchange Server</p>
      </li>
      <li class="numberedList">Once all the prerequisite analysis has been completed, we can now move on to the next step by preparing our Active Directory by running the following command:
        <pre class="programlisting con"><code class="hljs-con"> setup /Preparedomain /IAcceptExchangeServerLicenseTerms
</code></pre>
      </li>
      <li class="numberedList">As a final step, we will now install the <code class="inlineCode">Mailbox</code> role on our exchange server by running the following command:
        <pre class="programlisting con"><code class="hljs-con">setup /Mode:Install /Role:Mailbox /IAcceptExchangeServerLicenseTerms
</code></pre>
      </li>
      <li class="numberedList">This will <a id="_idIndexMarker138"/>lead to the successful installation of the required Exchange Server components and packages as shown in <em class="italic">Figure 1.35</em>:<figure class="mediaobject"><img src="../Images/B17765_01_35.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.35: Installation of Exchange Server tools and their configuration</p>
      </li>
      <li class="numberedList">It may take some time, depending on the system performance. Once everything is complete, we should now have Outlook web access enabled on the Exchange Server on port <code class="inlineCode">443</code>, as shown in <em class="italic">Figure 1.36</em>:<figure class="mediaobject"><img src="../Images/B17765_01_36.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.36: Successful installation of Exchange Server, accessed at https://localhost/owa/</p>
      </li>
    </ol>
    <h3 id="_idParaDest-45" class="heading-3">Metasploitable3</h3>
    <p class="normal">Metasploitable3 is an <a id="_idIndexMarker139"/>indubitably vulnerable Virtual Machine (VM) that <a id="_idIndexMarker140"/>is intended to be tested for multiple exploits using Metasploit. It is released under a BSD-style license. We will be utilizing two VMs, one VM running an obsolete Windows 2008 server and another running a Linux server Ubuntu 14.04, to practice within our lab network. You can achieve this setup by first installing the Vagrant application. </p>
    <p class="normal">Vagrant is an <a id="_idIndexMarker141"/>open-source tool that is predominantly used for building and <a id="_idIndexMarker142"/>managing virtual machine environments. You can download this tool from <a href="https://www.vagrantup.com/downloads"><span class="url">https://www.vagrantup.com/downloads</span></a> for your hosting operating system. Once the application is successfully installed, install the required plugins, <code class="inlineCode">vagrant-reload</code> and <code class="inlineCode">vagrant-vbguest</code>, by running the following commands in the Terminal or Command Prompt:</p>
    <pre class="programlisting con"><code class="hljs-con">Vagrant plugin install vagrant-reload
Vagrant plugin install vagrant-vbguest
</code></pre>
    <p class="normal">We are now ready to download the Metasploitable3 virtual machines to our local system. We will use the <code class="inlineCode">vagrant box add</code> command along with the repository to download the virtual machines; these are hosted on <code class="inlineCode">vagrantcloud.com</code>: </p>
    <pre class="programlisting con"><code class="hljs-con">vagrant box add rapid7/metasploitable3-win2k8 
vagrant box add rapid7/metasploitable3-ub1404
</code></pre>
    <p class="normal">Running the <a id="_idIndexMarker143"/>preceding commands should provide you with the options <a id="_idIndexMarker144"/>to download using different providers, as shown in the following <em class="italic">Figure 1.37</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_37.png" alt="A screenshot of a computer  Description automatically generated with medium confidence"/></figure>
    <p class="packt_figref">Figure 1.37: Downloading Metasploitable3 via vagrant</p>
    <p class="normal">These virtual machines are downloaded to the <code class="inlineCode">/home/username/.vagrant.d/boxes/</code> or <code class="inlineCode">c:\users\username\.vagrant.d\boxes\</code> folder. Check these folders to verify the download: </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Change your folder to the respective location by running cd <code class="inlineCode">C:\Users\user\.vagrant.d\boxes or cd /home/username/.vagrant.d/boxes/</code></li>
      <li class="numberedList">We can list the downloaded boxes that are installed on our device by running <code class="inlineCode">vagrant box list.</code> </li>
      <li class="numberedList">To run these machines, we need to initialize them by running <code class="inlineCode">vagrant init metasploitable3-win2k8</code>. This command creates the required Vagrant configuration file named <code class="inlineCode">Vagrantfile</code>, which includes all the virtual machine settings. Run <code class="inlineCode">vagrant init metasploitable3-ub1404 </code>from a different folder to avoid the <code class="inlineCode">Vagrantfile already exists</code> error message.</li>
      <li class="numberedList">Finally, we will bring the virtual machine up by running <code class="inlineCode">vagrant up</code>. You should see the virtual machine up. Pentesters will receive the warning <code class="inlineCode">default: Warning: Authentication failure. Retrying</code>, which is due to the insecure private <a id="_idIndexMarker145"/>key used for the SSH access between the VM and <a id="_idIndexMarker146"/>Vagrant. You should see the screen shown in <em class="italic">Figure 1.38</em> upon successfully starting the Metasploitable3 windows server:<figure class="mediaobject"><img src="../Images/B17765_01_38.png" alt="Graphical user interface, text  Description automatically generated"/></figure>
        <p class="packt_figref">Figure 1.38: VirtualBox running metasploitable 3</p>
      </li>
      <li class="numberedList">Validate the systems that are currently initialized by running vagrant <code class="inlineCode">global-status</code>.</li>
      <li class="numberedList">The next important steps are to change the network settings of these VMs to connect them to our lab network. Select the virtual machine and click <strong class="screenText">Settings</strong>. Within the <strong class="screenText">General </strong>tab, change the <strong class="screenText">Name</strong> of the VM to your desired name and, from the menu, click on <strong class="screenText">Network</strong>. Ensure <strong class="screenText">Enable network adapter</strong> is checked and <strong class="screenText">Attached to </strong>is selected as <strong class="screenText">NAT network</strong> and the name is <strong class="screenText">InsideNetwork.</strong></li>
    </ol>
    <p class="normal">We have successfully deployed the vulnerable Metasploitable3 VMs in our VirtualBox environment, which we will be utilizing to conduct more advanced exploitations in the coming sections. </p>
    <h3 id="_idParaDest-46" class="heading-3">Mutillidae</h3>
    <p class="normal">Mutillidae is an <a id="_idIndexMarker147"/>open-source insecure web <a id="_idIndexMarker148"/>application designed for penetration testers to practice all of the web app-specific vulnerability exploitation. XAMPP is another such free and open-source cross-platform web server solution stack package that can be used, developed by Apache Friends.</p>
    <p class="normal">We will <a id="_idIndexMarker149"/>now install Mutillidae <a id="_idIndexMarker150"/>on our newly installed Microsoft Windows Server 2016 (domain controller) server to host it:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">You can either download XAMPP directly from <a href="https://www.apachefriends.org/download.html"><span class="url">https://www.apachefriends.org/download.html</span></a> or run the following command in PowerShell:
        <pre class="programlisting con"><code class="hljs-con">wget https://downloadsapachefriends.global.ssl.fastly.net/7.3.28/xampp-windows-x64-7.3.28-1-VC15-installer.exe?from_af=true -OutFile XAMPP-Installer.exe 
</code></pre>
        <div class="packt_tip">
          <p class="normal">In case of any SSL/TLS errors while running <code class="inlineCode">wget</code> in PowerShell, ensure you run the following command within PowerShell: <code class="inlineCode">[Net.ServicePointManager]::SecurityProtocol=[Net.SecurityProtocolType]::Tls12</code> to ensure that TLS1.2 is supported by the Windows Server. </p>
        </div>
      </li>
      <li class="numberedList">We will utilize XAMPP for Windows version 7.1.30. Once the application installation is complete, ensure you enable Apache and MySQLas services by clicking on the tick<strong class="screenText"> </strong>box under <strong class="screenText">Service </strong>within the XAMPP control panel, as shown in <em class="italic">Figure 1.39</em>:<figure class="mediaobject"><img src="../Images/B17765_01_39.png" alt="Graphical user interface  Description automatically generated"/></figure>
        <p class="packt_figref">Figure 1.39: XAMMP Control Panel showing Apache and MySQL running</p>
      </li>
      <li class="numberedList">You can <a id="_idIndexMarker151"/>download the latest version of Mutillidae directly from <a href="https://github.com/webpwnized/mutillidae"><span class="url">https://github.com/webpwnized/mutillidae</span></a> or by running the following command in PowerShell:
        <pre class="programlisting con"><code class="hljs-con"> wget https://github.com/webpwnized/mutillidae/archive/refs/heads/master.zip -OutFile mutillidae.zip 
</code></pre>
      </li>
      <li class="numberedList">Unzip <a id="_idIndexMarker152"/>the file and <a id="_idIndexMarker153"/>copy the folder to <code class="inlineCode">C:\yourxampplocation\htdocs\&lt;mutillidae&gt;</code>.</li>
      <li class="numberedList">Open the <code class="inlineCode">.htacess</code> file inside the <code class="inlineCode">Mutillidae</code> folder and add <code class="inlineCode">Allow from 10.10.10.0/24</code> under and the IP range are allowed. </li>
      <li class="numberedList">Start the Apache and MySQL services by clicking on the <strong class="screenText">Start</strong> button under <strong class="screenText">Actions </strong>within XAMPP Control Panel. You should see the web application successfully deployed on your Windows Server, and it can be accessed by visiting <code class="inlineCode">http://10.10.10.100/mutillidae/</code>.</li>
      <li class="numberedList">You will receive the database error messages relating to root access denial on MySQL. Open the XAMPP control panel, ensure that the MySQL service is up and <a id="_idIndexMarker154"/>running, and <a id="_idIndexMarker155"/>click on <strong class="screenText">Shell</strong> and run the following steps to reset the root password, as depicted in <em class="italic">Figure 1.40</em>:
        <pre class="programlisting con"><code class="hljs-con">mysql –u root
use mysql
SET PASSWORD FOR root@localhost = PASSWORD('mutillidae')
Flush privileges 
</code></pre>
        <figure class="mediaobject"><img src="../Images/B17765_01_40.png" alt="Text  Description automatically generated"/></figure>
        <p class="packt_figref">Figure 1.40: Running the Shell from XAMPP and setting the MySQL password for the root user</p>
      </li>
      <li class="numberedList">The <a id="_idIndexMarker156"/>final successful deployment <a id="_idIndexMarker157"/>of the vulnerable web application will lead to the screen shown in <em class="italic">Figure 1.41</em>:<figure class="mediaobject"><img src="../Images/B17765_01_41.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.41: Successfully accessing Mutillidae on Kali Linux within the same lab network</p>
      </li>
    </ol>
    <div class="packt_tip">
      <p class="normal">In case of error messages saying that the database is offline or something similar, you have to select <strong class="screenText">Try to setup/reset the DB </strong>for Mutillidae. If you encounter any other error messages of missing files – ensure you disable Defender by running <code class="inlineCode">Set-MpPreference -DisableRealtimeMonitoring $true</code> in PowerShell as administrator. </p>
    </div>
    <h1 id="_idParaDest-47" class="heading-1">CloudGoat </h1>
    <p class="normal"><strong class="keyWord">CloudGoat</strong> is an AWS <a id="_idIndexMarker158"/>deployment tool that is designed by Rhino Security Labs. This tool is written in Python, which deploys a purposefully vulnerable AWS resource in the account. We will set up the CloudGoat Docker image within Kali Linux and explore the different vulnerabilities that attackers can take advantage of in a misconfigured cloud environment. </p>
    <p class="normal">To make sure that CloudGoat can deploy the AWS resources, the first step is to possess a valid AWS account. Assuming that we have one from the <em class="italic">Kali on AWS Cloud</em> section, we will perform the following steps:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Access <a href="https://console.aws.amazon.com/iam/home?region=us-east-2#/home"><span class="url">https://console.aws.amazon.com/iam/home?region=us-east-2#/home</span></a>.</li>
      <li class="numberedList">Click on the users, then on <strong class="screenText">Add user</strong>; enter <code class="inlineCode">cloudgoat</code><strong class="screenText"> </strong>and select <strong class="screenText">Programmatic access</strong>; click <strong class="screenText">Next</strong>, which should bring us to the screen shown in <em class="italic">Figure 1.42</em>:<figure class="mediaobject"><img src="../Images/B17765_01_42.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.42: Creating an IAM user account in the AWS console</p>
      </li>
      <li class="numberedList">Select <strong class="screenText">Attach existing policies directly</strong> and check <strong class="screenText">AdministratorAccess</strong>, as shown in <em class="italic">Figure 1.43</em>; click on <strong class="screenText">Next</strong>:<figure class="mediaobject"><img src="../Images/B17765_01_43.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.43: Adding the IAM user to the AdministratorAccess group</p>
      </li>
      <li class="numberedList">Click on <strong class="screenText">Next </strong>until you reach the final stage. If no error is displayed, then you should <a id="_idIndexMarker159"/>see the following screen with the <strong class="screenText">Success </strong>message, where you can download the user <strong class="screenText">Access key ID</strong> and <strong class="screenText">Secret access key</strong>:<figure class="mediaobject"><img src="../Images/B17765_01_44.png" alt=""/></figure>
        <p class="packt_figref">Figure 1.44: Creation of an Access key ID for the IAM user </p>
      </li>
    </ol>
    <p class="normal">Now that we have created the IAM user with administrative privileges within the AWS account, let us go ahead and install CloudGoat on the Docker image within Kali Linux by running the <a id="_idIndexMarker160"/>following commands in the terminal:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo apt install docker.io
sudo docker pull rhinosecuritylabs/cloudgoat
sudo docker run -it rhinosecuritylabs/cloudgoat:latest 
</code></pre>
    <p class="normal">Finally, configure the AWS client to connect to our AWS infrastructure using <code class="inlineCode">aws configure --profile masteringkali</code> with the latest access key and secret that we downloaded from AWS, as shown in <em class="italic">Figure 1.45</em>. We will be exploring this tool in more detail in <em class="chapterRef">Chapter 8</em>,<em class="italic"> Cloud Security Exploitation</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_45.png" alt=""/></figure>
    <p class="packt_figref">Figure 1.45: Configuration of AWS client for our newly created access key</p>
    <p class="normal"><em class="italic">Figure 1.46</em> depicts the LAB architecture of our setup for practicing penetration testing on our defined targets:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_46.png" alt="Graphical user interface  Description automatically generated with medium confidence"/></figure>
    <p class="packt_figref">Figure 1.46: Our Mastering Kali Linux practice lab architecture</p>
    <p class="normal">We have <a id="_idIndexMarker161"/>successfully built our own virtualized internal lab, and this should provide us with a wide range of exposure to identify and exploit multiple vulnerabilities within the infrastructure, application, and cloud. We should have the following set up: </p>
    <ul>
      <li class="bulletList">A Domain Controller running on Windows Server 2016 running Mutillidae through XAMPP</li>
      <li class="bulletList">A vulnerable on-premises Microsoft Exchange server running on Windows Server 2016 with missing patches. </li>
      <li class="bulletList">An obsolete Microsoft Windows 2008 R2 (Metasploitable3 server) running multiple vulnerable services.</li>
      <li class="bulletList">One domain administrator, one exchange administrator, and a normal domain user – which we will utilize in the latter part of this book to perform privilege escalation based on the roles.</li>
      <li class="bulletList">The AWS cloud deployment tool on a Docker image to set up vulnerable AWS infrastructure resources.</li>
    </ul>
    <p class="normal">Testers have to ensure that all the VMs that are created as part of this lab network should always have the settings of the network set to NAT network and the network name as InsideNetwork, so that the VMs can communicate with each other. </p>
    <h1 id="_idParaDest-48" class="heading-1">Managing collaborative penetration testing using Faraday</h1>
    <p class="normal">One of the most difficult aspects of penetration testing is remembering to test all of the relevant parts <a id="_idIndexMarker162"/>of the network <a id="_idIndexMarker163"/>or system target, or trying to remember whether the target was actually tested after the testing has been completed. In some cases, a single client may have multiple penetration testers performing scanning activities from multiple locations, and management would like to have a single view. Faraday can provide this, assuming all of the penetration testers are able to ping each other on the same network or on the internet for external assessment.</p>
    <p class="normal">Faraday is a <a id="_idIndexMarker164"/>multiuser penetration test <strong class="keyWord">Integrated Development Environment</strong> (<strong class="keyWord">IDE</strong>). It is <a id="_idIndexMarker165"/>designed for testers to distribute, index, and analyze all of the data that is generated during the process of a penetration test or technical security audit to provide different views, such as <strong class="screenText">Management</strong>, <strong class="screenText">Executive Summary</strong>, and <strong class="screenText">Overall Issues</strong> lists.</p>
    <p class="normal">This IDE platform was developed in Python by InfoByte, and version 3.14.3 is installed by default in the latest version of Kali Linux. You can navigate, from the menu, to <strong class="screenText">Applications</strong>, click on <strong class="screenText">12-Reporting tools</strong>, and then click on <strong class="screenText">Faraday start</strong>. It should open up a new screen for you to enter your password to perform service changes. You should now be presented with the following screen to set up a username and password for the Faraday web portal.</p>
    <p class="normal">Once the username and password are both set, the application should open the web browser, pointing to <code class="inlineCode">http://localhost:5985/</code></p>
    <p class="normal">You will now be able to create workspaces for each project. The next step is to make sure all the testers that are to utilize the Faraday client perform all the tasks by running <code class="inlineCode">faraday-client</code> in the terminal; it should prompt you to enter the credentials for the application. Use the same credentials that you just created, and you should now be able to see the same screen as that displayed in <em class="italic">Figure 1.47</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_47.png" alt="Text  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.47: Running Nmap scan through the Faraday client</p>
    <p class="normal">Following <a id="_idIndexMarker166"/>this screen, any <a id="_idIndexMarker167"/>scanning command-line activities that you or any other penetration testers in your team carry out can be visualized by clicking on the <strong class="screenText">Faraday web</strong> application; this will display something similar to that shown in <em class="italic">Figure 1.48</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_01_48.png" alt="Graphical user interface, text, application  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 1.48: The real-time dashboard of Faraday</p>
    <div class="note">
      <p class="normal">There is <a id="_idIndexMarker168"/>a limitation <a id="_idIndexMarker169"/>of the free version of Faraday 3.15.0, where real-time operations, insights, and data analysis cannot be utilized by testers to visualize the whole list of issues in a single place.</p>
    </div>
    <h1 id="_idParaDest-49" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, we looked at the different threat actors and their motivations, along with certain methodologies and goal-based penetration testing that help organizations to test themselves against real-time attacks. We learned how penetration testers can use Kali Linux on different platforms to assess the security of data systems and networks. We have taken a quick look at how to install Kali on different virtualized and cloud platforms and ran a Kali Linux operating system Docker image, along with one on a non-rooted Android phone.</p>
    <p class="normal">We built our own verification lab, set up Active Directory Domain Services, along with an Exchange Server instance, and two VMs on the same network, one of which is hosting a vulnerable web application. Most importantly, we learned how to customize Kali to increase the security of our tools and the data that they collect. We’re working to achieve the goal of making tools support our process instead of the other way around!</p>
    <p class="normal">In the next chapter, we will learn how we can effectively master <strong class="keyWord">Open-Source Intelligence</strong> (<strong class="keyWord">OSINT</strong>) in this era to identify the weak attack surfaces of our target and create customized username and password lists to facilitate more focused attacks, extracting these details from the dark web, along with other methods.</p>
  </div>
</body></html>