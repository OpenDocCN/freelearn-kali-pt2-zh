<html><head></head><body><div class="chapter" title="Chapter&#xA0;10.&#xA0;WLAN Penetration Testing Methodology"><div class="titlepage"><div><div><h1 class="title"><a id="ch10"/>Chapter 10. WLAN Penetration Testing Methodology</h1></div></div></div><div class="blockquote"><table border="0" cellpadding="0" cellspacing="0" class="blockquote" summary="Block quote" width="100%"><tr><td valign="top"> </td><td valign="top"><p><span class="emphasis"><em>"The proof is in the pudding."</em></span></p></td><td valign="top"> </td></tr><tr><td valign="top"> </td><td align="right" colspan="2" style="text-align: center" valign="top">--<span class="attribution"><span class="emphasis"><em>Popular saying</em></span></span></td></tr></table></div><p>
<span class="emphasis"><em>This chapter will lay out the steps that go in to taking the techniques taught in the previous chapters and turning them into a full wireless penetration test.</em></span>
</p><div class="section" title="Wireless penetration testing"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec92"/>Wireless penetration testing</h1></div></div></div><p>To <a class="indexterm" id="id296"/>perform a wireless penetration test, it is important to follow a defined methodology. Simply firing up the <code class="literal">airbase</code> or <code class="literal">airodump</code> command and hoping for the best will not satisfy the goals of a test. When working as a penetration tester, you must ensure that you adhere to the standards of the organization you're working for, and if they don't have any, then you should hold yourself to the highest standards.</p><p>Broadly, we can <a class="indexterm" id="id297"/>break up a wireless penetration testing exercise into the following phases:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Planning phase</li><li class="listitem">Discovery phase</li><li class="listitem">Attack phase</li><li class="listitem">Reporting phase</li></ol></div><p>We will now look at each of these phases separately.</p></div></div>
<div class="section" title="Planning"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec93"/>Planning</h1></div></div></div><p>In <a class="indexterm" id="id298"/>this phase, we must understand the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Scope of the assessment</strong></span>: The penetration tester should work with the client to define a scope that is achievable and will also provide the greatest amount of insight into the security of a network. Typically, the following information is gathered:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Location of the penetration test.</li><li class="listitem" style="list-style-type: disc">Total coverage area of the premises.</li><li class="listitem" style="list-style-type: disc">Approximate number of access points and wireless clients deployed.</li><li class="listitem" style="list-style-type: disc">Which wireless networks are included in the assessment?</li><li class="listitem" style="list-style-type: disc">Is exploitation in scope?</li><li class="listitem" style="list-style-type: disc">Are attacks against users in scope?</li><li class="listitem" style="list-style-type: disc">Is denial of service in scope?</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Effort estimation</strong></span>: Based on the scope defined, the tester will then have to estimate how much time is required. Bear in mind that rescoping may occur following this estimate, as organizations may have limited resources available in terms of both time and money.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Legality</strong></span>: Prior to performing a test, the client must give consent. This should explain the testing to be covered and clearly define the level of indemnity, insurance, and the limitations of the scope. If you are unsure, you will need to speak to a professional in these areas. Most organizations will have their own versions <a class="indexterm" id="id299"/>that will likely also incorporate a <span class="strong"><strong>Non-Disclosure Agreement</strong></span> (<span class="strong"><strong>NDA</strong></span>).</li></ul></div><p>Once all of the preceding requirements are in place, we are ready to go!</p></div>
<div class="section" title="Discovery"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec94"/>Discovery</h1></div></div></div><p>In <a class="indexterm" id="id300"/>this phase, the aim is to identify and apply characteristics to the wireless devices and wireless networks within the scope.</p><p>All the techniques to perform these have been laid out in the previous chapters but, in brief, the aim is to:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Enumerate visible and hidden wireless networks in the area</li><li class="listitem" style="list-style-type: disc">Enumerate devices in the area, along with those connected to the targeted networks</li><li class="listitem" style="list-style-type: disc">Map the range of the networks, where they are reachable from and whether there are places a malicious individual could operate from to perform an attack, for example, a cafe</li></ul></div><p>All of this <a class="indexterm" id="id301"/>information should be recorded. If the test is limited to the performance of reconnaissance only, the test will end here, and the tester will attempt to draw conclusions based on this information. Some statements that would be useful to a client are as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The number of devices that have associations with open networks and the corporate network</li><li class="listitem" style="list-style-type: disc">The number of devices that have networks that can be linked to locations through solutions such as WiGLE</li><li class="listitem" style="list-style-type: disc">The existence of weak encryption</li><li class="listitem" style="list-style-type: disc">The networks are too restrictive and block standard users</li></ul></div></div>
<div class="section" title="Attack"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec95"/>Attack</h1></div></div></div><p>Once <a class="indexterm" id="id302"/>reconnaissance has been performed, exploitation must be performed for proof of concept. If the attack is being performed as part of a red team or wider assessment, then exploitation should be performed to gain access to the network as surreptitiously as possible.</p><p>In our attacking phase, we will explore the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Cracking the encryption</li><li class="listitem" style="list-style-type: disc">Attacking the infrastructure</li><li class="listitem" style="list-style-type: disc">Compromising clients</li><li class="listitem" style="list-style-type: disc">Finding vulnerable clients</li><li class="listitem" style="list-style-type: disc">Finding unauthorized clients</li></ul></div><div class="section" title="Cracking the encryption"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec82"/>Cracking the encryption</h2></div></div></div><p>The first <a class="indexterm" id="id303"/>step is to retrieve the keys for any vulnerable networks identified. If networks with WEP exist, perform the WEP-cracking methods explained in <a class="link" href="ch04.html" title="Chapter 4. WLAN Encryption Flaws">Chapter 4</a>, <span class="emphasis"><em>WLAN Encryption Flaws</em></span>. Regardless of whether you can crack it or not though, the presence of WEP is still considered a vulnerability. If WPA2-secured systems are present, you have two choices. If aiming to be stealthy, arrive on-site at times when individuals are likely to be authenticating or re-authenticating. These times are likely to be:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Start of the day</li><li class="listitem" style="list-style-type: disc">Lunch time</li><li class="listitem" style="list-style-type: disc">End of the day</li></ul></div><p>At this time, set up your WPA key retrieval setup as shown in <a class="link" href="ch04.html" title="Chapter 4. WLAN Encryption Flaws">Chapter 4</a>, <span class="emphasis"><em>WLAN Encryption Flaws</em></span>. Alternatively, perform <a class="indexterm" id="id304"/>the deauthentication attack, as shown in <a class="link" href="ch06.html" title="Chapter 6. Attacking the Client">Chapter 6</a>, <span class="emphasis"><em>Attacking the Client</em></span>.</p><p>This is noisier and more likely to be detected in a mature organization.</p><p>If WPA-Enterprise is in place, bear in mind you will have to use the information gathered from the reconnaissance to target the correct network and set up your dummy Enterprise setup as shown in the <span class="emphasis"><em>Attacking PEAP</em></span> section in <a class="link" href="ch09.html" title="Chapter 9. Attacking WPA-Enterprise and RADIUS">Chapter 9</a>, <span class="emphasis"><em>Attacking WPA-Enterprise and RADIUS</em></span>.</p><p>You can attempt to break all passphrases but bear in mind that some will be unbreakable. Following the performance of the test, check with the wireless administrator for the passphrase in use. Check to see whether it is a secure passphrase and that you, as a tester, did not experience a tool failure or were merely unlucky.</p></div><div class="section" title="Attacking infrastructure"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec83"/>Attacking infrastructure</h2></div></div></div><p>If <a class="indexterm" id="id305"/>network access is gained through cracking the encryption, perform a standard network penetration test if allowed in scope. The following should be performed as a minimum:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A port scan</li><li class="listitem" style="list-style-type: disc">Identifying which services are running</li><li class="listitem" style="list-style-type: disc">Enumerating any open services, such as unauthenticated FTP, SMB, or HTTP</li><li class="listitem" style="list-style-type: disc">Exploiting any vulnerable services identified</li></ul></div></div><div class="section" title="Compromising clients"><div class="titlepage"><div><div><h2 class="title"><a id="ch10lvl2sec84"/>Compromising clients</h2></div></div></div><p>After <a class="indexterm" id="id306"/>enumerating and testing all wireless systems, there are various types of engagements that would suit performing attacks against clients.</p><p>If necessary, after establishing which clients are vulnerable to KARMA attacks, create a Honeypot to force them to connect with the methods laid out in the <span class="emphasis"><em>Attacking PEAP</em></span> section in <a class="link" href="ch09.html" title="Chapter 9. Attacking WPA-Enterprise and RADIUS">Chapter 9</a>, <span class="emphasis"><em>Attacking WPA-Enterprise and RADIUS</em></span>. There are various useful pieces of information <a class="indexterm" id="id307"/>that can be gathered through this method, but ensure that the collected data serves a purpose and is stored, transmitted, and used in an ethical and safe manner.</p></div></div>
<div class="section" title="Reporting"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec96"/>Reporting</h1></div></div></div><p>Finally, at the <a class="indexterm" id="id308"/>end of testing, it is necessary to report your findings to the client. It's important to ensure that the report matches the quality of your testing. As the client will only see the report, you have to give it as much love and attention as you do to your testing. The following is a guideline to the layout of the report:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Management summary</li><li class="listitem">Technical summary</li><li class="listitem">Findings:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Vulnerability description</li><li class="listitem" style="list-style-type: disc">Severity</li><li class="listitem" style="list-style-type: disc">Affected devices</li><li class="listitem" style="list-style-type: disc">Vulnerability type—software/hardware/configuration</li><li class="listitem" style="list-style-type: disc">Remediation</li></ul></div></li><li class="listitem">Appendices</li></ol></div><p>The <span class="strong"><strong>management summar</strong></span>y should be aimed at talking to a senior nontechnical audience with a <a class="indexterm" id="id309"/>focus on the effects and mitigations required at a high level. Avoid language that is too technical and ensure that the root causes are covered.</p><p>The <span class="strong"><strong>technical summary</strong></span> should be a midpoint between the management summary and findings <a class="indexterm" id="id310"/>list. It should be aimed at a developer or a technical lead with a focus on how to fix the issues and broad solutions that could be implemented.</p><p>The findings list should describe each vulnerability at a low level, explaining the methods to identify, and replicate, and vulnerabilities.</p><p>Appendices should contain any extra information that would be too long to describe in a short description. This is where any screenshots, proof-of-concept code, or stolen data should be presented.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch10lvl1sec97"/>Summary</h1></div></div></div><p>In this chapter, we discussed a methodology for performing a range of wireless tests and referred to the relevant chapters for each step. We also listed methods for reporting vulnerabilities and techniques for making technical data presentable. In the next and final chapter, we will cover new techniques developed since the initial publication of this book, WPS, and probe monitoring for surveillance.</p></div></body></html>