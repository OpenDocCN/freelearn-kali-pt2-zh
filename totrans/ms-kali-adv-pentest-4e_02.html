<html><head></head><body>
  <div id="_idContainer096" class="Basic-Text-Frame">
    <h1 class="chapterNumber">2</h1>
    <h1 id="_idParaDest-50" class="chapterTitle">Open-Source Intelligence and Passive Reconnaissance</h1>
    <p class="normal">Gathering all possible information on a target is always the most important aspect of a penetration tester’s thinking to achieve the best outcomes. In cybersecurity, gathering information through publicly available sources is often referred to as <strong class="keyWord">Open-Source Intelligence</strong> (<strong class="keyWord">OSINT</strong>). Passive reconnaissance through OSINT occurs during the first step of the kill chain when conducting a penetration test or attack against a given organization. An attacker will typically dedicate up to 75% of the overall work effort for a penetration test to reconnaissance, as it is this phase that allows the target to be defined, mapped, and explored for the vulnerabilities that will eventually lead to exploitation.</p>
    <p class="normal">There are two types of reconnaissance:</p>
    <ul>
      <li class="bulletList">Passive reconnaissance (direct and indirect)</li>
      <li class="bulletList">Active reconnaissance</li>
    </ul>
    <p class="normal">Passive reconnaissance is the art of collecting and analyzing openly available information, usually from the target itself or public sources online. On accessing this information, the tester or attacker does not interact with the target in an unusual manner—requests and activities will not be logged and so will not be traced directly to the tester. Therefore, passive reconnaissance is conducted first to minimize the direct contact that may signal an impending attack or to identify the attacker. </p>
    <p class="normal">In this chapter, you will learn the principles and practices of passive reconnaissance and OSINT, which include the following:</p>
    <ul>
      <li class="bulletList">Basic principles of reconnaissance</li>
      <li class="bulletList">OSINT</li>
      <li class="bulletList">Online resources and dark web search</li>
      <li class="bulletList">Obtaining user information</li>
      <li class="bulletList">Profiling users for password lists</li>
      <li class="bulletList">Using social media to extract password wordlist</li>
    </ul>
    <p class="normal">Active reconnaissance, which involves direct interaction with the target, will be covered in <em class="chapterRef">Chapter 3</em>, <em class="italic">Active Reconnaissance of External and Internal Networks</em>.</p>
    <h1 id="_idParaDest-51" class="heading-1">Basic principles of reconnaissance</h1>
    <p class="normal">Reconnaissance, or<a id="_idIndexMarker170"/> recon, is the first step of the kill chain when conducting a penetration test or an attack against a data target. It is conducted before the actual test or attack on a target network. The findings will give us an idea of where additional reconnaissance may be required or the vulnerabilities that can be capitalized upon during the exploitation phase. Reconnaissance activities are segmented on a gradient of interactivity with the target network or device.</p>
    <p class="normal">Passive reconnaissance does not involve any malicious, direct interaction with the target network. The attacker’s source IP address and activities are not logged (for example, a Google search for the target’s email addresses will not leave a trail that the target can detect). It is difficult, if not impossible, for the target to differentiate passive reconnaissance from normal business activities.</p>
    <p class="normal">Passive reconnaissance is divided further into the categories of direct and indirect. Direct passive reconnaissance involves the normal interactions that occur when an attacker expectedly interacts with the target. For example, an attacker will log on to the corporate website, view various pages, and download documents for further study. These interactions are expected user activities and are rarely detected as a prelude to an attack on the target. In indirect passive reconnaissance, there will be absolutely no interaction with the target organization.</p>
    <p class="normal">In contrast, active reconnaissance involves direct queries or other interactions (for example, port scanning of the target network) that can trigger system alarms or allow the target to capture the attacker’s IP address and activities. This information could be used to identify and arrest an attacker, or used during legal proceedings. Therefore, passive reconnaissance carries a lot less risk but, like its active counterpart, has its limitations.</p>
    <p class="normal">Penetration testers or attackers generally follow a process of structured information gathering, moving from a broad scope (the business and regulatory environments) to something much more specific (user account data).</p>
    <p class="normal">To be effective, testers should know exactly what they are looking for and how the data will be used <a id="_idIndexMarker171"/>before collection starts. Using passive reconnaissance and limiting the amount of data collected minimizes the risk of being detected by the target.</p>
    <h2 id="_idParaDest-52" class="heading-2">OSINT</h2>
    <p class="normal">The first step<a id="_idIndexMarker172"/> in a penetration test or an attack is information<a id="_idIndexMarker173"/> collection using OSINT. This is the art of collecting information from public sources, particularly through the internet. The amount of available information is considerable—most intelligence and military organizations are actively engaged in OSINT activities to collect information about their targets, and to guard against data leakage about them.</p>
    <p class="normal">OSINT can be<a id="_idIndexMarker174"/> divided into two types: <strong class="keyWord">offensive</strong> and <strong class="keyWord">defensive</strong>. Offensive deals with<a id="_idIndexMarker175"/> harvesting<a id="_idIndexMarker176"/> all the data that is required to prepare an attack on the target, while defensive is the art of collecting the data of previous breaches and any other security incidents relevant to the target that can be utilized to defend or protect themselves. The diagram displayed in <em class="italic">Figure 2.1</em> depicts a basic mind map for OSINT:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.1: Basic mind map for OSINT</p>
    <h2 id="_idParaDest-53" class="heading-2">Offensive OSINT</h2>
    <p class="normal">The information<a id="_idIndexMarker177"/> that is targeted for collection is <a id="_idIndexMarker178"/>dependent on the initial goal of the penetration test. For example, if testers want to access personal health records, they will need the names and biographical information of relevant parties involved (third-party insurance companies, healthcare providers, head of IT operations in any industry, commercial suppliers, and so on), their usernames, and their passwords. If the route of an attack involves social engineering, they may supplement this information with details that give credibility to the requests for information, such as:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Domain names</strong>: Identification of targets for the attackers or penetration testers during an external scenario begins with domain names, which is the most crucial element of OSINT:<ul>
          <li class="bulletList"><strong class="keyWord">Sub-domains</strong>: These are the domains that are part of the main domain; for example, if a domain offered to the target is <code class="inlineCode">sample.com</code>, it might use <code class="inlineCode">demo.sample.com</code>, <code class="inlineCode">producton.sample.com</code>, <code class="inlineCode">ecommerce.sample.com</code>, and so on. Identification of these domains will provide the attackers with a wider range of assets to assess in the reconnaissance phase.</li>
          <li class="bulletList"><strong class="keyWord">DNS entries</strong>: In today’s cyber world, everything can be potentially networked. That means each device that is connected to the internet has a unique IP address assigned to it. Likewise, the DNS entries are a list of human-friendly names that are assigned to a specific IP address, for example, <code class="inlineCode">demo.sample.com</code>, that is translated to an IP address in the format <code class="inlineCode">104.x.x.243</code>. DNS entries include A (hostname to an IP), NS (name server), CNAME (canonical name), MX (mail exchange) AAAA (DNS record to IP v6), SRV (service record), TXT (text record), and PTR (pointer record, which is opposite to the A record). All this information will provide the attackers not only with details relating to DNS, but also a wide range of other information—such as what type of service they run on—which attackers can then utilize to begin equipping the attack strategy.</li>
          <li class="bulletList"><strong class="keyWord">Mail exchange</strong>: Although we will find the MX records from the DNS entries, identifying the mail exchange is treated as a completely different set of enumeration, since most of the time they involve a third party that provides mail delivery services, which can be potentially utilized by the attackers to send bulk emails by exploiting the SMTP normal functionality of the mail relay.</li>
        </ul>
      </li>
      <li class="bulletList"><strong class="keyWord">DNS reconnaissance and route mapping</strong>: Once a tester has identified the target<a id="_idIndexMarker179"/> that<a id="_idIndexMarker180"/> has an online presence and contains items of interest, the next step is to identify the IP addresses and routes to the target. DNS reconnaissance is concerned with identifying who owns a particular domain or series of IP addresses (information such as WHOIS, although this has changed a lot after the General Data Protection Regulation), the DNS information defining the actual domain names and IP addresses assigned to the target, and the route between the penetration tester or the attacker and the final target.</li>
    </ul>
    <p class="normal">This information gathering is semi-active—some of the information is available from freely available sources, while other information is available from third parties such as DNS registrars. Although the registrar may collect IP addresses and data concerning requests made by the attacker, it is rarely provided to the end target. The information that could be directly monitored by the target, such as DNS server logs, is almost never reviewed or retained. Because the information needed can be queried using a defined systematic and methodical approach, its collection can be automated.</p>
    <p class="normal">In the<a id="_idIndexMarker181"/> following sections, we will discuss how<a id="_idIndexMarker182"/> easy it would be to enumerate all the domain names just by using simple tools that are pre-installed within Kali Linux.</p>
    <h2 id="_idParaDest-54" class="heading-2">Gather domain information</h2>
    <p class="normal">We will utilize <a id="_idIndexMarker183"/>the sublist3r tool to perform domain harvesting. This tool is not preinstalled in Kali Linux; however, it can be installed by running <code class="inlineCode">sudo apt install sublist3r</code> in the terminal. This tool is written in Python, which will enumerate the sub-domains of a primary domain using the OSINT techniques. It utilizes APIs such as the Google, Bing, Baidu, and ASK search engines. Additionally, it also performs searches in NetCraft, VirusTotal, Threatcrowd, DNSDumpster, and ReverseDNS, while also performing DNS brute force using a specific wordlist. </p>
    <p class="normal">Once the tool is installed, attackers can run <code class="inlineCode">sudo sublist3r -d ourtargetcompany.com -t 3 -e bing</code> to search for sub-domains in the Bing search engine, as shown in <em class="italic">Figure 2.2</em> for <code class="inlineCode">packtpub.com</code>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.2: Sub-domain information gathering through sublist3r of packtpub.com using the Bing API</p>
    <p class="normal">One might encounter an error message of VirusTotal blocking the requests. This can be fixed by adding <a id="_idIndexMarker184"/>your own API key by entering <code class="inlineCode">export VT_APIKEY=yourapikey</code>. An API key can be generated by creating an account at <code class="inlineCode">virustotal.com</code>.</p>
    <h2 id="_idParaDest-55" class="heading-2">Maltego</h2>
    <p class="normal">Maltego is <a id="_idIndexMarker185"/>one of<a id="_idIndexMarker186"/> the most capable OSINT frameworks for both individual and organizational reconnaissance. It is a GUI tool that can gather information on any individual by extracting the information that is publicly available on the internet by various methods, such as email addresses, URLs, social media network profiles of an individual, and mutual connections between two individuals. It is also capable of enumerating the DNS, brute-forcing the normal DNS, and collecting the data from social media in a format that can be easily read.</p>
    <p class="normal">We can utilize this tool by developing a visualization of the data that has been gathered. The community edition, Maltego 4.2.17, is shipped along with Kali Linux. The easiest way to access this application is to type <code class="inlineCode">maltego</code> in the terminal. The tasks in Maltego are called transforms. Transforms come built into the tool and are defined as being code scripts that execute specific tasks. </p>
    <p class="normal">There are also multiple plugins available in Maltego, such as the SensePost toolset, Shodan, VirusTotal, and ThreatMiner.</p>
    <p class="normal">The steps<a id="_idIndexMarker187"/> to<a id="_idIndexMarker188"/> use Maltego for OSINT are as follows:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">In order to access <a id="_idIndexMarker189"/>Maltego, you will need to create an account by visiting <span class="url">https://www.maltego.com/ce-registration/</span>. Once the account is created and you are successfully logged in to the Maltego application, you should see the screen shown in <em class="italic">Figure 2.3</em>:<figure class="mediaobject"><img src="../Images/B17765_02_03.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.3: Start-up screen of Maltego</p>
      </li>
      <li class="numberedList">Upon<a id="_idIndexMarker190"/> clicking <strong class="screenText">Run</strong> under <strong class="screenText">Maltego CE (Free)</strong>, agree <a id="_idIndexMarker191"/>to the terms and conditions, install transforms, select a web browser option (privacy mode), and lastly, click on <strong class="screenText">Ready</strong>. That will enable us to utilize the community transforms. There is a limit on how many you can utilize, however.</li>
      <li class="numberedList">Transform Hub is where the Maltego client allows users to easily install the transforms from different data providers, which have both commercial and community transforms.</li>
      <li class="numberedList">Once everything is complete, you should be ready to use Maltego; create a machine by navigating to <strong class="screenText">Machines</strong> in the <strong class="screenText">Menu</strong> folder and clicking on <strong class="screenText">Run Machine</strong>, as shown in <em class="italic">Figure 2.4</em>; then you will be able to start an instance of the Maltego engine.<figure class="mediaobject"><img src="../Images/B17765_02_04.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.4: Running a machine in Maltego </p>
      </li>
    </ol>
    <p class="normal">After<a id="_idIndexMarker192"/> running a<a id="_idIndexMarker193"/> machine, the following machine<a id="_idIndexMarker194"/> selections will typically be presented:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Company Stalker</strong>: This will retrieve all email addresses associated with a domain and then see which one has entries on social networking sites, such as LinkedIn. It also downloads and extracts metadata from published documents on the internet by filtering to the specific domain as a target.</li>
      <li class="bulletList"><strong class="keyWord">Find Wikipedia edits</strong>: This transform looks for the details from the Wikipedia edits and searches for them across all social media platforms.</li>
      <li class="bulletList"><strong class="keyWord">Footprint L1</strong>: This performs basic footprints of a domain.</li>
      <li class="bulletList"><strong class="keyWord">Footprint L2</strong>: This performs medium-level footprints of a domain.</li>
      <li class="bulletList"><strong class="keyWord">Footprint L3</strong>: This performs an intense deep dive into a domain and is typically used with care since it will consume a large amount of the memory resources running on Kali Linux.</li>
      <li class="bulletList"><strong class="keyWord">Footprint XML</strong>: This works on large targets, such as a company hosting its own data centers, and tries to obtain the footprint by looking at <strong class="keyWord">sender policy framework</strong> (<strong class="keyWord">SPF</strong>) records<a id="_idIndexMarker195"/> hoping for netblocks, as well as reverse delegated DNS to their name servers.</li>
      <li class="bulletList"><strong class="keyWord">Person - Email Address</strong>: This is used to obtain someone’s email address and see where it’s used on the internet. The input is not a domain, but rather a full email address.</li>
      <li class="bulletList"><strong class="keyWord">Prune Leaf entries</strong>: This filters the information by providing options to delete certain parts of the network.</li>
      <li class="bulletList"><strong class="keyWord">Twitter digger X</strong>: This analyzes tweets for aliases.</li>
      <li class="bulletList"><strong class="keyWord">Twitter digger Y</strong>: This works on Twitter affiliations; it finds a tweet, extracts it, and analyzes it.</li>
      <li class="bulletList"><strong class="keyWord">Twitter Monitor</strong>: This can be used to monitor Twitter for hashtags and named entities mentioned <a id="_idIndexMarker196"/>around a certain phrase. The input is a phrase.</li>
      <li class="bulletList"><strong class="keyWord">URL to Network and</strong> <strong class="keyWord">Domain Information</strong>: This transform will identify the domain information of <a id="_idIndexMarker197"/>other <strong class="keyWord">Top-Level Domains</strong> (<strong class="keyWord">TLDs</strong>). For example, if you provide <code class="inlineCode">www.cyberhia.com</code>, it will identify <code class="inlineCode">www.cyberhia.co.uk</code> and <code class="inlineCode">cyberhia.co.in</code> and so on as the other TLDs. </li>
    </ul>
    <p class="normal">Attackers begin with Footprint L1 to gain a basic understanding of the domain and the sub-domains that are potentially available, along with relevant IP addresses. It is good practice to begin <a id="_idIndexMarker198"/>with this information as part of information gathering; however, attackers<a id="_idIndexMarker199"/> can also utilize all the other machines mentioned previously to achieve their goal. Once the machine is selected, click on <strong class="screenText">Next </strong>and specify a domain, for example, <code class="inlineCode">cyberhia.com</code>. <em class="italic">Figure 2.5</em> provides an overview of <code class="inlineCode">cyberhia.com</code>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.5: Maltego results on a dashboard on the Footprint L1 module for cyberhia.com</p>
    <h2 id="_idParaDest-56" class="heading-2">OSRFramework</h2>
    <p class="normal">OSRFramework<a id="_idIndexMarker200"/> is a tool designed by i3visio to perform <a id="_idIndexMarker201"/>open-source threat intelligence as a web interface with consoles such as OSRFConsole. To install this framework, install <code class="inlineCode">pip3</code> by running <code class="inlineCode">sudo apt install python3-pip</code> in the terminal. Finally, the OSRFramework tool can be installed directly through <code class="inlineCode">pip3</code> by running the <code class="inlineCode">sudo pip3 install osrframework</code> command in the same terminal.</p>
    <p class="normal">OSRFramework provides threat intelligence about keywords in multiple sources and also provides the flexibility to be a standalone tool—or a plugin to Maltego. There are three handy modules that come with OSRFramework, each of which can be utilized by penetration testers during external threat intelligence data collection:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">usufy</code>: This is used for searching on multiple search engines, to identify the keywords in a URL, and to automatically enumerate and store all the results in <code class="inlineCode">.csv</code> format. The following is the output of <code class="inlineCode">cyberhia</code> as a keyword for <code class="inlineCode">usufy</code>:
        <pre class="programlisting con"><code class="hljs-con">usufy -n cyberhia
</code></pre>
      </li>
      <li class="bulletList"><code class="inlineCode">mailfy</code>: This identifies a keyword and adds the email domains to the end of the keyword, while automatically searching in <a href="http://haveibeenpawned.com"><span class="url">haveibeenpawned.com</span></a> with an API call:
        <pre class="programlisting con"><code class="hljs-con">mailfy -n cyberhia
</code></pre>
      </li>
      <li class="bulletList"><code class="inlineCode">searchfy</code>: This searches for a keyword in Facebook, GitHub, Instagram, Twitter, and YouTube. The testers can run <code class="inlineCode">searchfy -q "cyberhia"</code> in the terminal to<a id="_idIndexMarker202"/> query <code class="inlineCode">cyberhia</code> as a keyword for <code class="inlineCode">searchfy</code>, as shown in <em class="italic">Figure 2.6</em>:<figure class="mediaobject"><img src="../Images/B17765_02_06.png" alt=""/></figure>
        <p class="packt_figref">Figure 2.6: searchfy output for the cyberhia keyword</p>
      </li>
    </ul>
    <h2 id="_idParaDest-57" class="heading-2">Web archives</h2>
    <p class="normal">When <a id="_idIndexMarker203"/>something<a id="_idIndexMarker204"/> is deleted from the internet, it is not necessarily completely deleted from everywhere. Every page that is visited by Google is backed up as a snapshot in Google’s cache servers. Typically, these cache servers are intended to see whether Google can serve you the best available option to base your search query on. </p>
    <p class="normal">The same technique can be utilized by attackers to gather information about a given target. For example, say a hacked database’s details were posted in <code class="inlineCode">sampledatadumpwebsite.com</code>, and that the website or the link is taken off the internet. </p>
    <p class="normal">If the page has been accessed by Google, this information can serve as a great source of information for attackers, including usernames, password hashes, what type of backend was being utilized, and other relevant technical and policy information.</p>
    <p class="normal">Wayback Machine maintains the digital archive of the internet web pages. The following link is the second level used after the google cache when harvesting past data
<a href="https://web.archive.org/web/"><span class="url">https://web.archive.org/web/</span></a>. 
<em class="italic">Figure 2.7</em> is a screenshot of <code class="inlineCode">cyberhia.com</code> in the WayBack<a id="_idIndexMarker205"/> Machine, as of 24 March 2018:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.7: Cached page for cyberhia.com as of March 2018</p>
    <p class="normal">Google Cache, Wayback Machine, and the live version of any given domain can be accessed <a id="_idIndexMarker206"/>directly by visiting <a href="https://cachedviews.com/"><span class="url">https://cachedviews.com/</span></a>.</p>
    <h2 id="_idParaDest-58" class="heading-2">Passive Total</h2>
    <p class="normal">Passive Total <a id="_idIndexMarker207"/>by <a id="_idIndexMarker208"/>RiskIQ is another platform that provides OSINT on any specific target domain. It has both a commercial offering and a version for the community (<a href="https://community.riskiq.com/"><span class="url">https://community.riskiq.com/</span></a>). Attackers can enumerate the information about a target within this portal such as the DNS and IP address, certificate information, and the frequency of the changes that happen on a particular sub-domain. </p>
    <p class="normal"><em class="italic">Figure 2.8</em> provides the details about <code class="inlineCode">cyberhia.com</code>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.8: Passive total output on a search for cyberhia.com</p>
    <p class="normal">We will be<a id="_idIndexMarker209"/> discussing the hidden face of Google in more <a id="_idIndexMarker210"/>depth in the <em class="italic">Google Hacking Database</em><strong class="keyWord"> </strong>section.</p>
    <h1 id="_idParaDest-59" class="heading-1">Scraping</h1>
    <p class="normal">A technique that<a id="_idIndexMarker211"/> attackers utilize to extract a large number of datasets from websites, whereby the extracted data is stored locally in a filesystem, is called scraping, or web scraping. In the following section, we will utilize some of the most commonly used tools in Kali Linux to perform scraping.</p>
    <h2 id="_idParaDest-60" class="heading-2">Gathering usernames and email addresses</h2>
    <p class="normal">theHarvester<a id="_idIndexMarker212"/> is a <a id="_idIndexMarker213"/>Python <a id="_idIndexMarker214"/>script<a id="_idIndexMarker215"/> that searches through popular search engines and other sites for email addresses, hosts, and sub-domains. Using theHarvester is relatively simple, as there are only a few command switches to set. The options are as follows:</p>
    <ul>
      <li class="bulletList"><code class="inlineCode">-d</code>: This identifies the domain to be searched, usually the domain or target’s website.</li>
      <li class="bulletList"><code class="inlineCode">-b</code>: This identifies the source for extracting the data; it must be one of the following: <code class="inlineCode">Bing</code>, <code class="inlineCode">BingAPI</code>, <code class="inlineCode">Google</code>, <code class="inlineCode">Google-Profiles</code>, <code class="inlineCode">Jigsaw</code>, <code class="inlineCode">LinkedIn</code>, <code class="inlineCode">People123</code>, <code class="inlineCode">PGP</code>, or <code class="inlineCode">All</code>.</li>
      <li class="bulletList"><code class="inlineCode">-l</code>: This limiting option instructs theHarvester to only harvest data from a specified number of returned search results.</li>
      <li class="bulletList"><code class="inlineCode">-f</code>: This option is used to save the final results to an HTML and XML file. If this option is omitted, the results will only be displayed on the screen, and not saved.</li>
    </ul>
    <p class="normal"><em class="italic">Figure 2.9</em> provides<a id="_idIndexMarker216"/> the<a id="_idIndexMarker217"/> sample<a id="_idIndexMarker218"/> data extract from theHarvester <a id="_idIndexMarker219"/>for the <code class="inlineCode">packtpub.com</code> domain by running <code class="inlineCode">theHarvester -d packtpub.com -l 500 -b google</code>.</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.9: Running theHarvester to gather details on packtpub.com</p>
    <div class="packt_tip">
      <p class="normal">Note there might be two versions of theHarvester installed on Kali, so it is recommended to use the latest version of theHarvester.</p>
    </div>
    <p class="normal">Attackers <a id="_idIndexMarker220"/>can <a id="_idIndexMarker221"/>also<a id="_idIndexMarker222"/> utilize the<a id="_idIndexMarker223"/> LinkedIn API to extract a list of people within the given domain and easily form a list of possible valid email addresses and/or usernames. An example would be when an organization uses first and last names within the format of <code class="inlineCode">X.Y@domain.com</code>; for example, <code class="inlineCode">vijay.velu@company.com</code>. theHarvester tool can be utilized to enumerate user details on who is currently working in the organization; this can be easily run using:</p>
    <pre class="programlisting con"><code class="hljs-con">theHarvester -d packtpub.com -l 500 -b LinkedIn
</code></pre>
    <p class="normal">The results can be utilized to create a list of email IDs to perform email phishing. </p>
    <div class="packt_tip">
      <p class="normal">Email addresses of former employees can still be of use. When conducting social engineering attacks, directing information requests to a former employee usually results in a redirect that gives the attacker the credibility of having dealt with the previous employee. In addition, many organizations do not properly terminate <a id="_idIndexMarker224"/>employee accounts, and it is possible<a id="_idIndexMarker225"/> that<a id="_idIndexMarker226"/> these<a id="_idIndexMarker227"/> credentials may still give access to the target system.</p>
    </div>
    <h2 id="_idParaDest-61" class="heading-2">Obtaining user information</h2>
    <p class="normal">Many penetration<a id="_idIndexMarker228"/> testers gather usernames and email <a id="_idIndexMarker229"/>addresses, as this information is frequently used to log on to targeted systems. The most commonly employed tool is the web browser, which is used to manually search the target organization’s website as well as third-party sites, such as LinkedIn or other social networking websites.</p>
    <p class="normal">Pentesters may also choose to search on other portals, such as <a href="https://hunter.io"><span class="url">https://hunter.io</span></a> and/or utilize Firefox plugins such as Email Extractor in their browser to extract the email addresses.</p>
    <h3 id="_idParaDest-62" class="heading-3">TinEye</h3>
    <p class="normal">TinEye is an<a id="_idIndexMarker230"/> online reverse image search portal developed and offered by Idee, Inc. In short, this is a search engine like Google, but it allows the users to search using only images. This information can help the attacker to map images to the target, and can be utilized in a well-defined social engineering attack:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.10: Image search on TinEye</p>
    <h2 id="_idParaDest-63" class="heading-2">Online search portals </h2>
    <p class="normal">Where can <a id="_idIndexMarker231"/>you find a surfeit of vulnerable hosts, with the vulnerability <a id="_idIndexMarker232"/>details along with screenshots? Often, attackers utilize existing vulnerabilities to gain access to the system without much effort, so one of the easiest ways to do so is to search in Shodan. Shodan is one of the most important search engines available, as it lets anyone on the internet find devices connected to the internet using a variety of filters. It can be accessed by visiting <a href="https://www.shodan.io/"><span class="url">https://www.shodan.io/</span></a>. This is one of the most popular websites consulted for information around the globe. If the name of a company is searched for, it will provide any relevant information that it has in its database, such as IP addresses, port numbers, and the service that was running.</p>
    <p class="normal"><em class="italic">Figure 2.11</em> is a sample screenshot from <a href="http://shodan.io"><span class="url">shodan.io</span></a> that shows hosts that are running W<code class="inlineCode">indows 7</code>, which enables attackers to go ahead and narrow down the target and move laterally. We will <a id="_idIndexMarker233"/>learn <a id="_idIndexMarker234"/>about this in upcoming chapters:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_11.png" alt="Graphical user interface  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 2.11: Search results for Windows 7 in Shodan </p>
    <p class="normal">Similar to Shodan, attackers can also utilize the <a href="http://censys.io"><span class="url">censys.io</span></a> API for relevant information gathering; this can provide more information about IPv4 hosts, websites, certifications, and other stored<a id="_idIndexMarker235"/> information. As an example, <em class="italic">Figure 2.12</em> provides<a id="_idIndexMarker236"/> information about <code class="inlineCode">cyberhia.com</code>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_12.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.12: Results for cyberhia.com in censys.io</p>
    <h3 id="_idParaDest-64" class="heading-3">SpiderFoot</h3>
    <p class="normal">There are many more<a id="_idIndexMarker237"/> automated tools included within Kali that can supplement manual searches. One such tool is SpiderFoot, which automates both offensive and defensive passive reconnaissance using OSINT. The tool is written in Python 3 with the GPL license, and it is preinstalled in the latest version of Kali. The tool provides the option to configure a number of APIs to strengthen the outcome.</p>
    <p class="normal">The tool can be launched by running <code class="inlineCode">spiderfoot -l IP:Port</code>, as shown in <em class="italic">Figure 2.13</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_13.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.13: Running SpiderFoot from the terminal </p>
    <p class="normal">Once the engine is<a id="_idIndexMarker238"/> started, you will be able to visit <code class="inlineCode">http://IP:port</code>, click on <strong class="screenText">Settings</strong>, and add all the API keys that you might already have; an example, the <code class="inlineCode">AbusIPDB.com</code> API key (you can create this key by visiting abuseIPDB) is added to SpiderFoot, as shown in <em class="italic">Figure 2.14</em>; then save the changes. This can similarly be done for all the APIs that require tokens or API keys:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_14.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.14: Adding AbuseIPDB.com API key in SpiderFoot settings</p>
    <p class="normal">Once all the settings <a id="_idIndexMarker239"/>are configured, click on <strong class="screenText">New Scan </strong>and type the scan name and the seed target, which is our target organization’s primary domain, and select the options shown in <em class="italic">Figure 2.15</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_15.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.15: Creating a new scan in SpiderFoot </p>
    <p class="normal">The SpiderFoot web <a id="_idIndexMarker240"/>interface provides three different ways to run the passive reconnaissance scan:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">By Use Case</strong>, whereby pentesters can specify <strong class="screenText">All</strong>, <strong class="screenText">Footprint</strong>, <strong class="screenText">Investigate</strong>, and <strong class="screenText">Passive </strong>(for pentesters, it is a good option to remain stealthy while using SpiderFoot) </li>
      <li class="bulletList"><strong class="keyWord">By Required Data</strong>, which will allow the pentesters to select the information that they are looking for</li>
      <li class="bulletList"><strong class="keyWord">By Module</strong>, allowing the testers to select from which modules they want the information to be gathered</li>
    </ul>
    <p class="normal">The tools can also gather information on print media, academic publications, and so on. Like Passive Total, this tool also has commercial and community versions. </p>
    <p class="normal">Once the required selection is completed and the scan has finished running, you should be presented with a similar result to that shown in <em class="italic">Figure 2.16</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_16.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.16: Output of SpiderFoot scan results that are in progress</p>
    <p class="normal">The archive of the OSINT <a id="_idIndexMarker241"/>performed using SpiderFoot could be accessed by clicking on the <strong class="screenText">Scans </strong>tab, which will provide all of the past and current running scans, as shown in <em class="italic">Figure 2.17</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_17.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.17: SpiderFoot scan details</p>
    <h2 id="_idParaDest-65" class="heading-2">Other commercial tools</h2>
    <p class="normal">Spyse (<a href="https://spyse.com/"><span class="url">https://spyse.com/</span></a>) and<a id="_idIndexMarker242"/> ZoomEye (<a href="https://www.zoomeye.org/"><span class="url">https://www.zoomeye.org/</span></a>) are<a id="_idIndexMarker243"/> great <a id="_idIndexMarker244"/>search engines that can <a id="_idIndexMarker245"/>be utilized for defensive passive recon to quickly gather the entire attack surface of a given target. <em class="italic">Figure 2.18</em> provides a screenshot of what Spyse looks like:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_18.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.18: Spyse output on cyberhia.com</p>
    <h1 id="_idParaDest-66" class="heading-1">Google Hacking Database</h1>
    <p class="normal">The rise of an infodemic <a id="_idIndexMarker246"/>during the Covid-19 pandemic has had a significant impact on the world economy. The public generally utilizes Google to keep themselves updated; <strong class="keyWord">“google it”</strong> is a common idiom that can refer to a search for any type of information, whether it be a simple search query, or when collating information on a given topic. In this section, we will narrow down how penetration testers can utilize Google through dorks.</p>
    <div class="note">
      <p class="normal">A Google dork or Google Hacking query is a search string that uses advanced search techniques and methods to find information that is not readily available about a target website. These dorks can return information that is difficult to locate through<a id="_idIndexMarker247"/> simple search queries. </p>
    </div>
    <h2 id="_idParaDest-67" class="heading-2">Using dork scripts to query Google</h2>
    <p class="normal">The first<a id="_idIndexMarker248"/> step<a id="_idIndexMarker249"/> in<a id="_idIndexMarker250"/> understanding <strong class="keyWord">Google Hacking Database</strong> (<strong class="keyWord">GHDB</strong>) is that the testers must understand all the advanced Google operators, just like how machine-level programming engineers must understand computer OP codes (known<a id="_idIndexMarker251"/> as <strong class="keyWord">operation code</strong>, these are machine language instructions that specify what operations are to be performed). </p>
    <p class="normal">These Google operators are part of the Google query process, and the syntax for searching is as follows:</p>
    <pre class="programlisting code"><code class="hljs-code">operator:itemthatyouwanttosearch
</code></pre>
    <p class="normal">There is no space between <code class="inlineCode">operator,</code> the colon (<code class="inlineCode">:</code>), and <code class="inlineCode">itemthatyouwanttosearch</code>. <em class="italic">Table 2.1</em> lists all the advanced Google operators:</p>
    <table id="table001-1" class="table-container">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Operator</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Description</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Mixes with other operators?</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Can be used alone?</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">intitle</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Page title keyword search</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">allintitle</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">All keywords search at a time in the title</p>
          </td>
          <td class="table-cell">
            <p class="normal">No</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">inurl</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Search the keyword in the URL</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">site</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Filter Google search results only to the site</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">ext</code> or <code class="inlineCode">filetype</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Search for a particular extension or file type</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">No</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">allintext</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Keyword search for all number of occurrences</p>
          </td>
          <td class="table-cell">
            <p class="normal">No</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">link</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">External link search on a page</p>
          </td>
          <td class="table-cell">
            <p class="normal">No</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">inanchor</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Search anchor link on a web page</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">numrange</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Limit search on the range</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">daterange</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Limit search on the date</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">author</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Finding group author</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">group</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Searching group names</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">related</code></p>
          </td>
          <td class="table-cell">
            <p class="normal">Search related keywords</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
          <td class="table-cell">
            <p class="normal">Yes</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="packt_figref">Table 2.1: A list of advanced operators to be used in GHDB</p>
    <p class="normal"><em class="italic">Figure 2.19</em> provides<a id="_idIndexMarker252"/> a <a id="_idIndexMarker253"/>screenshot of a simple Google dork to search any<a id="_idIndexMarker254"/> plaintext passwords on poorly configured WordPress sites. The dork search is in the following format, entered in the search bar:</p>
    <pre class="programlisting code"><code class="hljs-code">inurl:/wp-content/uploads/ ext:txt "username" AND "password" | "pwd" | "pw"
</code></pre>
    <figure class="mediaobject"><img src="../Images/B17765_02_19.png" alt="Graphical user interface, text, application, email  Description automatically generated"/> </figure>
<p class="packt_figref">Figure 2.19: Google dork search output for plain text passwords</p>
    <p class="normal">For<a id="_idIndexMarker255"/> more specific<a id="_idIndexMarker256"/> operators, we<a id="_idIndexMarker257"/> can refer to the guide from Google at <a href="http://www.googleguide.com/advanced_operators_reference.html"><span class="url">http://www.googleguide.com/advanced_operators_reference.html</span></a>.</p>
    <p class="normal">We can utilize the Google hacking database from exploit-db, which is constantly updated by th<a id="_idIndexMarker258"/>e security <a id="_idIndexMarker259"/>research <a id="_idIndexMarker260"/>community, available <a id="_idIndexMarker261"/>at <a href="https://www.exploit-db.com/google-hacking-database/"><span class="url">https://www.exploit-db.com/google-hacking-database/</span></a><span class="url">.</span></p>
    <h2 id="_idParaDest-68" class="heading-2">Data dump sites</h2>
    <p class="normal">In today’s <a id="_idIndexMarker262"/>world, any information<a id="_idIndexMarker263"/> can be shared online quickly and more effectively with the birth of apps such as <a href="http://pastebin.com"><span class="url">pastebin.com</span></a>. However, this turns out to be one of the major drawbacks when developers store source code, crypto keys, and other confidential information on the app, which leaves it unattended; this online information provides attackers with a list of abundant information with which to formulate more focused attacks.</p>
    <p class="normal">The archive forums also reveal the logs of a particular website or the past hacking incidents, if it was previously hacked; Pastebin also offers this information. <em class="italic">Figure 2.20</em> provides a list of confidential information about a target:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_20.png" alt="Graphical user interface, text, application, email  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 2.20: Pastebin output of plaintext username and passwords</p>
    <h2 id="_idParaDest-69" class="heading-2">Defensive OSINT</h2>
    <p class="normal">Defensive OSINT is<a id="_idIndexMarker264"/> typically used to see <a id="_idIndexMarker265"/>what is already on the internet, including breached information; it is also used to see whether that information is valuable during penetration testing. If the goal of penetration testing is to demonstrate a real-world scenario where this data will be useful, the first step is to identify a similar target that has already been breached. The majority of organizations fix only the affected platform or the host—they often forget about other similar environments. Defensive OSINT is largely divided into three places of search.</p>
    <h3 id="_idParaDest-70" class="heading-3">Dark web</h3>
    <p class="normal">The dark web is <a id="_idIndexMarker266"/>the encrypted network that exists between Tor <a id="_idIndexMarker267"/>servers and their clients, whereas the deep web is simply the content of databases and other web services that for one reason or another cannot be indexed by conventional search engines, such as Google.</p>
    <p class="normal">Let’s take an example of expired drugs or banned drugs that can be sold on the dark web. We will explore how to identify information on the dark web using the Tor browser. Some<a id="_idIndexMarker268"/> websites, such as <a href="https://dark.fail/"><span class="url">https://dark.fail/</span></a>, provide a market list of hidden deep web links. These links can only be accessed through the Tor browser. <em class="italic">Figure 2.21</em> provides an example of<a id="_idIndexMarker269"/> drugs that are being sold on such a market, called <strong class="keyWord">Dream Market</strong>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_21.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.21: Darknetlive Dream Market</p>
    <p class="normal">Although governments attempt to block access to these black markets, there are always clones of these<a id="_idIndexMarker270"/> sites that are up and running. We have now learned where to <a id="_idIndexMarker271"/>locate information to access the dark web using the Tor browser.</p>
    <h3 id="_idParaDest-71" class="heading-3">Security breaches</h3>
    <p class="normal">A security<a id="_idIndexMarker272"/> breach is any incident that results in unauthorized <a id="_idIndexMarker273"/>access to data, applications, services, networks, and/or devices, by bypassing their underlying security mechanisms. One such example is Facebook’s data breach in April 2021 that saw the details of 533 million users leaked. This can potentially help attackers to create a good dictionary of passwords, which we will examine in <em class="italic">Profiling users for a password list</em>.</p>
    <p class="normal">Hackers are known to visit the following websites:</p>
    <ul>
      <li class="bulletList"><a href="https://haveibeenpwned.com/"><span class="url">https://haveibeenpwned.com</span></a></li>
      <li class="bulletList"><a href="https://haveibeenzuckered.com/"><span class="url">https://haveibeenzuckered.com/</span></a></li>
    </ul>
    <p class="normal">These websites contain an archive of breached data. The following screenshot provides information about whether your email ID was breached as part of the recent Facebook breach: <a href="https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&amp;IR=T"><span class="url">https://www.businessinsider.com/stolen-data-of-533-million-facebook-users-leaked-online-2021-4?r=US&amp;IR=T</span></a>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_22.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.22: Confirmation of whether an email address has been breached, along with what other information was leaked in Facebook’s data breach</p>
    <p class="normal">To harvest<a id="_idIndexMarker274"/> more <a id="_idIndexMarker275"/>information about a target, pentesters can look into websites such as <a href="http://zone-h.com"><span class="url">zone-h.com</span></a>, which provide information about breaches. For example, a defacement of <a href="http://chinaseeds.com"><span class="url">chinaseeds.com</span></a> was performed by a threat actor group named Moroccohackteam. <em class="italic">Figure 2.23</em> provides details on the IP address, web server, and operating system used during the defacement:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_23.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.23: Output of chinaseeds.com hacked snapshot</p>
    <p class="normal">Testers can utilize these different sources to enumerate the information about a target organization or individual, which can then be leveraged in social engineering attacks. Attackers can <a id="_idIndexMarker276"/>email the victim posing as a law enforcement<a id="_idIndexMarker277"/> agency, asking them to confirm their identity by clicking on the attacker-controlled site, for example. We will learn different scenarios in more detail in <em class="chapterRef">Chapter 5</em>,<em class="italic"> Advanced Social Engineering and Physical Security</em>.</p>
    <h3 id="_idParaDest-72" class="heading-3">Public records</h3>
    <p class="normal">Harvesting<a id="_idIndexMarker278"/> information<a id="_idIndexMarker279"/> about high-profile targets, such as C-Level, board of directors, or VIPs during social engineering or red team activities, is very useful. Public records can be utilized to form a password list based on the information that is available to profile an individual. One such example is a public record of individuals, such as Findmypast, which provides information about individuals (say, Donald Trump), as<a id="_idIndexMarker280"/> shown<a id="_idIndexMarker281"/> in <em class="italic">Figure 2.24</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_24.png" alt="Graphical user interface, application  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 2.24: Results on Findmypast.co.uk on “Donald Trump” name search</p>
    <h2 id="_idParaDest-73" class="heading-2">Threat intelligence</h2>
    <p class="normal">Threat<a id="_idIndexMarker282"/> intelligence <a id="_idIndexMarker283"/>is controlled, calculated, and refined information about potential or current attacks that threaten an organization. The primary purpose of this kind of intelligence is to ensure organizations are aware of the current risks and profile them according to the threat that they present, such <a id="_idIndexMarker284"/>as <strong class="keyWord">Advanced Persistent Threats</strong> (<strong class="keyWord">APTs</strong>), zero-day exploits, and other severe external threats. For example, if Company A—a healthcare drug manufacturer—was hit with by ransomware through APTs, Company B could be alerted to this threat intelligence with<a id="_idIndexMarker285"/> the <strong class="keyWord">Tactics, Techniques, and Procedures</strong> (<strong class="keyWord">TTPs</strong>) and adjust their security accordingly.</p>
    <p class="normal">In reality, it is much more likely that organizations will take a very long time to make a decision due to a lack of trusted sources, and also the spending involved due to the nature and probability of the threats. In the preceding example, Company B may have fewer systems on site, or may have to halt all connections to and from the internet to its assets, until an internal review is carried out.</p>
    <p class="normal">This information has the potential to be utilized by attackers to exploit a network. However, this information is considered part of the passive reconnaissance activity, since no direct attack has been launched on the target yet. Pentesters and attackers will always subscribe <a id="_idIndexMarker286"/>to these kinds of open-source<a id="_idIndexMarker287"/> threat intelligence frameworks, such as the ATT&amp;CK matrix for <strong class="keyWord">indicators of compromise</strong> (<strong class="keyWord">IOCs</strong>).</p>
    <h2 id="_idParaDest-74" class="heading-2">Profiling users for password lists</h2>
    <p class="normal">So far, you<a id="_idIndexMarker288"/> have learned <a id="_idIndexMarker289"/>how to use passive reconnaissance to collect names and biographical information for users of the target being tested; this is the same process used by hackers. The next step is to use this information to create password lists specific to the users and the target.</p>
    <p class="normal">Lists of commonly used passwords are available for download and are stored locally on Kali in the <code class="inlineCode">/usr/share/wordlists</code> directory. These lists reflect the choices of a large population of users, and it can be time-consuming for an application to attempt to use each possible password before moving on to the next one in the queue.</p>
    <p class="normal">Fortunately, <strong class="keyWord">Common User Password Profiler</strong> (<strong class="keyWord">CUPP</strong>) allows the pentester to generate a wordlist that is<a id="_idIndexMarker290"/> specific to a particular user. It is not installed by default in the latest version of Kali; it can, however, be installed by entering the following command in the terminal:</p>
    <pre class="programlisting con"><code class="hljs-con">sudo apt install cupp 
</code></pre>
    <p class="normal">This will download and install the tool. CUPP is a Python script, and it can be simply invoked from the CUPP directory by entering the following command:</p>
    <pre class="programlisting con"><code class="hljs-con">root@kali:~# cupp -i
</code></pre>
    <p class="normal">This will launch CUPP in interactive mode, which prompts the user for specific elements of information to <a id="_idIndexMarker291"/>use in <a id="_idIndexMarker292"/>creating wordlists. An example is shown in <em class="italic">Figure 2.25</em>:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_25.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.25: Creating password lists using CUPP</p>
    <p class="normal">When the <a id="_idIndexMarker293"/>wordlist has <a id="_idIndexMarker294"/>been created, it is placed in the <code class="inlineCode">cupp</code> directory.</p>
    <h1 id="_idParaDest-75" class="heading-1">Creating custom wordlists for cracking passwords</h1>
    <p class="normal">There are <a id="_idIndexMarker295"/>multiple tools that are readily <a id="_idIndexMarker296"/>available in Kali Linux to create custom wordlists for cracking passwords offline. We will now take a look at a couple of them.</p>
    <h2 id="_idParaDest-76" class="heading-2">Using CeWL to map a website</h2>
    <p class="normal">CeWL is a<a id="_idIndexMarker297"/> Ruby <a id="_idIndexMarker298"/>app that spiders a given URL to a specified depth, optionally following external links, and returns a list of words that can then be used in password crackers, such as John the Ripper. <em class="italic">Figure 2.26</em> provides the custom list of words generated from the Google index page:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_26.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.26: Creating custom password list using the CeWL from the web pages</p>
    <p class="normal">These texts extracted from the web pages sometimes include the HTML comments that are left by<a id="_idIndexMarker299"/> the <a id="_idIndexMarker300"/>developers, which can be very useful for performing more informed attacks.</p>
    <h2 id="_idParaDest-77" class="heading-2">Extracting words from Twitter using twofi</h2>
    <p class="normal">While we <a id="_idIndexMarker301"/>can profile <a id="_idIndexMarker302"/>a user on social media platforms such as Facebook, Twitter, and LinkedIn, we can also use <strong class="keyWord">twofi</strong>, which stands <a id="_idIndexMarker303"/>for <strong class="keyWord">Twitter words of interest</strong>. This tool is written using Ruby script and utilizes the Twitter API to generate a custom list of words that can be utilized for offline password cracking. Twofi is not installed in Kali Linux by default, so you have to run <code class="inlineCode">sudo apt install twofi</code> in the terminal.</p>
    <p class="normal">To use <code class="inlineCode">twofi</code>, we must have a valid Twitter API key and an API secret. Ensure that you are entering these details in <code class="inlineCode">/etc/twofi/twofi.yml</code>. <em class="italic">Figure 2.27</em> shows how to utilize <code class="inlineCode">twofi</code> during passive reconnaissance to form our custom password wordlist; in the following example, we run <code class="inlineCode">twofi -m 6 -u @PacktPub &gt; filename</code>, which generates a list of custom words that were posted by the <code class="inlineCode">PacktPub</code> Twitter handle:</p>
    <figure class="mediaobject"><img src="../Images/B17765_02_27.png" alt=""/></figure>
    <p class="packt_figref">Figure 2.27: Using twofi to create a wordlist for packtpub.com</p>
    <p class="normal"><strong class="keyWord">Twofi</strong> is powerful <a id="_idIndexMarker304"/>during <a id="_idIndexMarker305"/>an individual targeted attack. For example, it is easy to create a profile for a frequent Twitter user and to use these wordlists to crack the password on other platforms, such as Microsoft 365, along with other social media platforms.</p>
    <h1 id="_idParaDest-78" class="heading-1">Summary</h1>
    <p class="normal">This chapter has detailed the first step in an attack process or kill chain: to conduct information harvesting, or passive reconnaissance, to identify the right information on the target with the power of OSINT. Passive reconnaissance provides a real-time view of an attacker’s perspective on a target company. This is a stealthy assessment: the IP address and activities of an attacker are almost indistinguishable from normal business traffic. </p>
    <p class="normal">The same information is extremely fruitful during social engineering attacks or when facilitating other attacks. We took a deep dive into the use of automated tools to save time and performed passive reconnaissance using both offensive and defensive OSINT.</p>
    <p class="normal">In the next chapter, we will learn the difference between the types of reconnaissance in an active sense and make use of the data that was harvested using OSINT. Although active reconnaissance techniques will provide more information, there is always an increase in the risk of detection. Therefore, the emphasis will be on advanced stealth techniques.</p>
  </div>
</body></html>