<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;WLAN and Its Inherent Insecurities"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. WLAN and Its Inherent Insecurities</h1></div></div></div><div class="blockquote"><table border="0" cellpadding="0" cellspacing="0" class="blockquote" summary="Block quote" width="100%"><tr><td valign="top"> </td><td valign="top"><p><span class="emphasis"><em>"The loftier the building, the deeper the foundation must be laid."</em></span></p></td><td valign="top"> </td></tr><tr><td valign="top"> </td><td align="right" colspan="2" style="text-align: center" valign="top">--<span class="attribution"><span class="emphasis"><em>Thomas Kempis</em></span></span></td></tr></table></div><p>
<span class="emphasis"><em>Nothing great can be built on a weak foundation, and in our context, nothing secure can be built on something that is inherently insecure.</em></span>
</p><p>
<span class="emphasis"><em>WLANs, by design, have certain insecurities that are relatively easy to exploit, for example, by packet spoofing, packet injection, and sniffing (this could even happen from far away). We will explore these flaws in this chapter.</em></span>
</p><p>In this chapter, we shall look at the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Revisiting WLAN frames</li><li class="listitem" style="list-style-type: disc">Different frame types and subtypes</li><li class="listitem" style="list-style-type: disc">Using Wireshark to sniff management, control, and data frames</li><li class="listitem" style="list-style-type: disc">Sniffing data packets for a given wireless network</li><li class="listitem" style="list-style-type: disc">Injecting packets into a given wireless network</li></ul></div><p>Let's get started!</p><div class="section" title="Revisiting WLAN frames"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec21"/>Revisiting WLAN frames</h1></div></div></div><p>As this book deals <a class="indexterm" id="id30"/>with the security aspects of wireless, we will assume that you already have a basic understanding of the protocol and the packet headers. If not, or if it's been some time since you worked on wireless, this would be a good time to revisit this topic again.</p><p>Let's now quickly review some basic concepts of WLANs that most of you may already be aware of. In WLANs, communication happens over frames. A frame would have the following header structure:</p><div class="mediaobject"><img alt="Revisiting WLAN frames" src="graphics/B09903_02_01.jpg"/></div><p>The <code class="literal">Frame Control</code> field itself has<a class="indexterm" id="id31"/> a more complex structure:</p><div class="mediaobject"><img alt="Revisiting WLAN frames" src="graphics/B09903_02_02.jpg"/></div><p>The <code class="literal">Type</code> field defines three types of WLAN frame:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Management frames</strong></span>: Management frames are responsible for maintaining communication between<a class="indexterm" id="id32"/> access points and wireless clients. Management frames can have the following subtypes:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Authentication</li><li class="listitem" style="list-style-type: disc">Deauthentication</li><li class="listitem" style="list-style-type: disc">Association request</li><li class="listitem" style="list-style-type: disc">Association response</li><li class="listitem" style="list-style-type: disc">Reassociation request</li><li class="listitem" style="list-style-type: disc">Reassociation response</li><li class="listitem" style="list-style-type: disc">Disassociation</li><li class="listitem" style="list-style-type: disc">Beacon</li><li class="listitem" style="list-style-type: disc">Probe request</li><li class="listitem" style="list-style-type: disc">Probe response</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Control frames</strong></span>: Control frames are responsible for ensuring a proper exchange of data between<a class="indexterm" id="id33"/> access points and wireless<a class="indexterm" id="id34"/> clients. Control frames can have the<a class="indexterm" id="id35"/> following subtypes:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Request to Send</strong></span> (<span class="strong"><strong>RTS</strong></span>)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Clear to Send</strong></span> (<span class="strong"><strong>CTS</strong></span>)</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Acknowledgement</strong></span> (<span class="strong"><strong>ACK</strong></span>)</li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Data frames</strong></span>: Data frames<a class="indexterm" id="id36"/> carry the actual data that is sent on the <a class="indexterm" id="id37"/>wireless network. There are no subtypes for data frames.</li></ul></div><p>We will discuss the security implications of each of these frames when we discuss different attacks in later chapters.</p><p>We will now look at how to sniff these frames over a wireless network using Wireshark. There are other tools—such as Airodump-NG, Tcpdump, or Tshark—that you can use for sniffing as well. We will, however, mostly use Wireshark in this book, but we encourage you to explore other tools as well. The first step to do this is to create a monitor mode interface. This will create an interface for our adapter, which allows us to read all wireless frames in the air, regardless of whether they are destined for us or not. In the wired world, this is popularly called <span class="strong"><strong>promiscuous mode</strong></span>.</p></div></div>
<div class="section" title="Time for action &#x2013; creating a monitor mode interface"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec22"/>Time for action – creating a monitor mode interface</h1></div></div></div><p>Let's now set our <a class="indexterm" id="id38"/>wireless adapter to monitor mode.</p><p>Follow these<a class="indexterm" id="id39"/> instructions to get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Boot Kali with your adapter connected. Once you are within the console, enter <code class="literal">iwconfig</code> to confirm that your card has been detected and the driver has been loaded properly:<div class="mediaobject"><img alt="Time for action – creating a monitor mode interface" src="graphics/B09903_02_03.jpg"/></div></li><li class="listitem">Use the <code class="literal">ifconfig wlan0 up</code> command to bring the card up (where <code class="literal">wlan0</code> is your adapter). Verify <a class="indexterm" id="id40"/>whether the card is up by running <code class="literal">ifconfig wlan0</code>. You should see the word <code class="literal">UP</code> in the first line of the output as shown in the following screenshot:<div class="mediaobject"><img alt="Time for action – creating a monitor mode interface" src="graphics/B09903_02_04.jpg"/></div></li><li class="listitem">To put our card into monitor mode, we will use the <code class="literal">airmon-ng</code> utility that is available by <a class="indexterm" id="id41"/>default on Kali. First run the <code class="literal">airmon-ng</code> command to verify whether it detects the available cards. You should see the <code class="literal">wlan0</code> or <code class="literal">wlan1</code> interface listed in the output:<div class="mediaobject"><img alt="Time for action – creating a monitor mode interface" src="graphics/B09903_02_05.jpg"/></div></li><li class="listitem">Now enter the <code class="literal">airmon-ng start wlan0</code> command to create a monitor mode interface<a class="indexterm" id="id42"/> corresponding to the <code class="literal">wlan0</code> device. This new monitor mode interface will be named <code class="literal">wlan0mon</code>. (You can verify if it has been created by running <code class="literal">airmon-ng</code> without arguments again):<div class="mediaobject"><img alt="Time for action – creating a monitor mode interface" src="graphics/B09903_02_06.jpg"/></div></li><li class="listitem">Also, running <code class="literal">ifconfig wlan0mon</code> should<a class="indexterm" id="id43"/> now display a new interface called <code class="literal">wlan0mon</code>:<div class="mediaobject"><img alt="Time for action – creating a monitor mode interface" src="graphics/B09903_02_07.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec18"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We have successfully created a monitor mode interface called <code class="literal">wlan0mon</code>. This interface will be used to sniff wireless packets off the air. This interface has been created for our wireless adapter.</p></div><div class="section" title="Have a go hero – creating multiple monitor mode interfaces"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec19"/>Have a go hero – creating multiple monitor mode interfaces</h2></div></div></div><p>It is possible to create multiple<a class="indexterm" id="id44"/> monitor mode interfaces using the same physical card. Use the <code class="literal">airmon-ng</code> utility to see how you can do this.</p><p>Awesome! We have a monitor mode interface just waiting to read some packets off the air. So let's get started.</p><p>In the next exercise, we will use Wireshark to sniff packets off the air using the <code class="literal">wlan0mon</code> monitor mode interface we just created.</p></div></div>
<div class="section" title="Time for action &#x2013; sniffing wireless packets"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec23"/>Time for action – sniffing wireless packets</h1></div></div></div><p>Follow the following instructions<a class="indexterm" id="id45"/> to begin sniffing packets:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Power up the <a class="indexterm" id="id46"/>access point <code class="literal">Wireless Lab</code> that we configured in <a class="link" href="ch01.html" title="Chapter 1. Wireless Lab Setup">Chapter 1</a>, <span class="emphasis"><em>Wireless Lab Setup</em></span>.</li><li class="listitem">Start Wireshark by typing <code class="literal">Wireshark &amp;</code> in the console. Once Wireshark is running, navigate to <span class="strong"><strong>Capture</strong></span> | <span class="strong"><strong>Options</strong></span>:<div class="mediaobject"><img alt="Time for action – sniffing wireless packets" src="graphics/B09903_02_08.jpg"/></div></li><li class="listitem">Select packet capture<a class="indexterm" id="id47"/> from the <code class="literal">wlan0mon</code> interface by clicking on the <span class="strong"><strong>Start</strong></span> button at the bottom right of the interface as shown in the previous screenshot. Wireshark will begin the capture, and now you should see packets within the Wireshark window.<div class="mediaobject"><img alt="Time for action – sniffing wireless packets" src="graphics/B09903_02_09.jpg"/></div></li><li class="listitem">These are wireless<a class="indexterm" id="id48"/> packets that your wireless adapter is sniffing off the air. In order to view any packet, select it in the top window and the entire packet will be displayed in the middle window.<div class="mediaobject"><img alt="Time for action – sniffing wireless packets" src="graphics/B09903_02_10.jpg"/></div><p>Click on the triangle in front of <span class="strong"><strong>IEEE 802.11 Wireless LAN</strong></span> management frame to expand and view additional information.</p></li></ol></div><p>Look at the different header fields in the packet and correlate them with the WLAN frame types and<a class="indexterm" id="id49"/> subtypes you learned earlier.</p><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec20"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We just sniffed our first set of packets off the air! We launched Wireshark, which used the monitor mode interface, <code class="literal">wlan0mon</code> we created previously. You should notice, by looking at Wireshark's footer region, the speed at which the packets are being captured and also the number of packets captured till now.</p></div><div class="section" title="Have a go hero – finding different devices"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec21"/>Have a go hero – finding different devices</h2></div></div></div><p>Wireshark traces can be a bit<a class="indexterm" id="id50"/> daunting at times; even for a reasonably populated wireless network, you could end up sniffing a few thousand packets. Hence, it is important to be able to drill down to those packets that interest us. This can be accomplished using filters in Wireshark. Explore how you can use these filters to identify unique wireless devices in the traces—both access points and wireless clients.</p><p>If you are unable to do this, don't worry as this is the next thing we will learn.</p></div></div>
<div class="section" title="Time for action &#x2013; viewing management, control, and data frames"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec24"/>Time for action – viewing management, control, and data frames</h1></div></div></div><p>Now we will learn how to apply filters in Wireshark to look at management, control, and data frames.</p><p>Please follow these instructions <a class="indexterm" id="id51"/>step by step:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To view all the <a class="indexterm" id="id52"/>management frames in the packets being captured, enter the filter <code class="literal">wlan.fc.type == 0</code> into the filter window and hit <span class="emphasis"><em>Enter</em></span>. You can <a class="indexterm" id="id53"/>stop the packet capture if you want to prevent the packets from scrolling down too fast.<div class="mediaobject"><img alt="Time for action – viewing management, control, and data frames" src="graphics/B09903_02_11.jpg"/></div></li><li class="listitem">To view control <a class="indexterm" id="id54"/>frames, modify the filter expression<a class="indexterm" id="id55"/> to read <code class="literal">wlan.fc.type == 1</code>:<div class="mediaobject"><img alt="Time for action – viewing management, control, and data frames" src="graphics/B09903_02_12.jpg"/></div></li><li class="listitem">To view<a class="indexterm" id="id56"/> data frames, modify the filter expression to <code class="literal">wlan.fc.type == 2</code>:<div class="mediaobject"><img alt="Time for action – viewing management, control, and data frames" src="graphics/B09903_02_13.jpg"/></div></li><li class="listitem">To <a class="indexterm" id="id57"/>additionally select a subtype, use the <code class="literal">wlan.fc.subtype</code> filter. For<a class="indexterm" id="id58"/> example, to view all the beacon <a class="indexterm" id="id59"/>frames among all management frames, use the following filter:<div class="informalexample"><pre class="programlisting">(wlan.fc.type == 0) &amp;&amp; (wlan.fc.subtype == 8)</pre></div><div class="mediaobject"><img alt="Time for action – viewing management, control, and data frames" src="graphics/B09903_02_14.jpg"/></div></li><li class="listitem">Alternatively, you<a class="indexterm" id="id60"/> can right-click on any of the header fields in the<a class="indexterm" id="id61"/> middle window <a class="indexterm" id="id62"/>and then select <span class="strong"><strong>Apply as Filter</strong></span> | <span class="strong"><strong>Selected</strong></span> to add it as a filter:<div class="mediaobject"><img alt="Time for action – viewing management, control, and data frames" src="graphics/B09903_02_15.jpg"/></div></li><li class="listitem">This will <a class="indexterm" id="id63"/>automatically add the correct filter expression for <a class="indexterm" id="id64"/>you in the <span class="strong"><strong>Filter</strong></span> field.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec22"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We just learned <a class="indexterm" id="id65"/>how to filter packets in Wireshark using various filter expressions. This helps us monitor selected packets from devices we are interested in, instead of trying to analyze all the packets in the air.</p><p>Also, we can see that the packet headers of management, control, and data frames are in plain text and are not encrypted. Anyone who can sniff the packets can read these headers. It is also important to note that it is also possible for a hacker to modify any of these packets and retransmit them. As there is no integrity or replay attack mitigation in the protocol, this is very easy to do. We will look at some of these attacks in later chapters.</p></div><div class="section" title="Have a go hero – playing with filters"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec23"/>Have a go hero – playing with filters</h2></div></div></div><p>You can consult Wireshark's manual to learn more about available filter expressions and how to use them. Try <a class="indexterm" id="id66"/>playing around with various filter combinations till you are confident that you can drill down to any level of detail, even in a very large packet trace.</p><p>In the next exercise, we will look at how to sniff data packets transferred between our access point and wireless client.</p></div></div>
<div class="section" title="Time for action &#x2013; sniffing data packets for our network"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec25"/>Time for action – sniffing data packets for our network</h1></div></div></div><p>In this exercise, we will<a class="indexterm" id="id67"/> learn how to sniff data packets for a given wireless network. For the sake of simplicity, we will look at packets without any encryption.</p><p>Follow these instructions to get started:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Switch on the access point we named <code class="literal">Wireless Lab</code>. Let it remain configured to use no encryption.</li><li class="listitem">We will first need to find the channel on which the <code class="literal">Wireless Lab</code> access point is running. To do this, open a terminal and run <code class="literal">airodump-ng --bssid &lt;mac&gt; wlan0mon</code>, where &lt;<code class="literal">mac</code>&gt; is the MAC address of our access point. Let the program run, and shortly you should see your access point shown on the screen along with the channel it is running on.</li><li class="listitem">We can see from the preceding screenshot that our access point <code class="literal">Wireless Lab</code> is running on channel 11. Note that this may be different for your access point.<p>In order to sniff data packets going to and from this access point, we need to lock our wireless card on the same channel, that is channel 11. To do this, run the <code class="literal">iwconfig wlan0mon channel 11</code> command and then run <code class="literal">iwconfig wlan0mon</code> to verify it. You should see the <code class="literal">Frequency: 2.462 GHz</code> value in the output. This corresponds to channel 11.</p><div class="mediaobject"><img alt="Time for action – sniffing data packets for our network" src="graphics/B09903_02_16.jpg"/></div></li><li class="listitem">Now fire up Wireshark and start sniffing on the <code class="literal">wlan0mon</code> interface. After Wireshark has started sniffing the packets, apply a filter for the <code class="literal">bssid</code> of our access point as<a class="indexterm" id="id68"/> shown in the following screenshot using <code class="literal">wlan.bssid == &lt;mac&gt;</code> in the filter area. Use the appropriate MAC address for your access point.<div class="mediaobject"><img alt="Time for action – sniffing data packets for our network" src="graphics/B09903_02_17.jpg"/></div></li><li class="listitem">In order to see the data packets for our access point, add the following to the filter <code class="literal">(wlan.bssid == &lt;mac&gt;) &amp;&amp; (wlan.fc.type_subtype == 0x20)</code>. Open your browser on the client laptop and type the URL of the access point in the management interface. In my case, as we have seen in <a class="link" href="ch01.html" title="Chapter 1. Wireless Lab Setup">Chapter 1</a>, <span class="emphasis"><em>Wireless Lab Setup</em></span>, it is <code class="literal">http://192.168.0.1</code>. This will generate data packets that Wireshark will capture.</li><li class="listitem">Packet sniffing allows us to analyze unencrypted data packets very easily. This is the reason why we need to use encryption in wireless.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec24"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We have just sniffed data packets over the air with Wireshark using various filters. As our access point is not using any encryption, we are able to see all the data in plain text. This is a major security<a class="indexterm" id="id69"/> issue as anyone within RF range of the access point can see all the packets if he uses a sniffer such as Wireshark.</p></div><div class="section" title="Have a go hero – analyzing data packets"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec25"/>Have a go hero – analyzing data packets</h2></div></div></div><p>Use Wireshark to analyze the data packets further. You will notice that a DHCP request is made by the <a class="indexterm" id="id70"/>client and, if a DHCP server is available, it responds with an address. Then you will find ARP packets and other protocol packets on the air. This is a nice and simple way to do passive host discovery on the wireless network. It is important to be able to see a packet trace and reconstruct how applications on the wireless host are communicating with the rest of the network. One of the interesting features Wireshark provides is the ability to follow a stream. This allows you to view multiple packets together, that are part of a TCP exchange, in the same connection.</p><p>Also, try logging into <a class="ulink" href="http://www.gmail.com">www.gmail.com</a> or any other popular website and analyze the data traffic generated.</p><p>We will now see a demonstration of how to inject packets into a wireless network.</p></div></div>
<div class="section" title="Time for action &#x2013; packet injection"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec26"/>Time for action – packet injection</h1></div></div></div><p>We will be using the <code class="literal">aireplay-ng</code> tool, which is<a class="indexterm" id="id71"/> available in Kali, for this exercise.</p><p>Follow these instructions carefully:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In order to do an injection test, first start Wireshark and the filter expression <code class="literal">(wlan.bssid == &lt;mac&gt;) &amp;&amp; !(wlan.fc.type_subtype == 0x08)</code>. This will ensure that we only see non-beacon packets for our lab network.</li><li class="listitem">Now run the <code class="literal">aireplay-ng -9 -e Wireless Lab -a &lt;mac&gt; wlan0mon</code> command in a terminal.</li><li class="listitem">Go back to Wireshark and you should see a lot of packets on the screen now. Some of these packets have been sent by <code class="literal">aireplay-ng</code>, which we launched, and others are from the access point <code class="literal">Wireless Lab</code> in response to the injected packets.</li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec26"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We just successfully injected packets into our test lab network using <code class="literal">aireplay-ng</code>. It is important to note that our card injected these arbitrary packets into the network without being actually connected to the access point <code class="literal">Wireless Lab</code>.</p></div><div class="section" title="Have a go hero – installing Kali on VirtualBox"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec27"/>Have a go hero – installing Kali on VirtualBox</h2></div></div></div><p>We will look at <a class="indexterm" id="id72"/>packet injection in greater detail in later chapters; however, feel free to explore other options of the <code class="literal">aireplay-ng</code> tool to inject packets. You can verify whether injection succeeded by using Wireshark to monitor the air.</p></div></div>
<div class="section" title="Important note on WLAN sniffing and injection"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec27"/>Important note on WLAN sniffing and injection</h1></div></div></div><p>WLANs typically operate<a class="indexterm" id="id73"/> within three different frequency ranges—2.4 GHz, 3.6 GHz, and 4.9/5.0 GHz. Not all Wi-Fi cards support all these ranges and associated bands. For instance, older Alfa cards only support IEEE 802.11b/g. This would mean that these cards cannot operate in 802.11a/n. The key here is to sniff or inject <a class="indexterm" id="id74"/>packets in a particular band; your Wi-Fi card will need to support it.</p><p>Another interesting aspect of Wi-Fi is that, in each of these bands, there are multiple channels. It is important to note that your Wi-Fi card can only be on one channel at any given moment. It is not possible to tune into multiple channels at the same time. The best analogy I can give you is your car radio. You can tune it to only one of the available channels at any given time. If you want to hear something else, you will have to change the channel. The same principle applies to WLAN sniffing. This brings us to an important conclusion—we cannot sniff all channels at the same time; we will need to select the channel that is of interest to us. What this means is that, if our access point of interest is on channel 1, we will need to set our card on channel 1.</p><p>Though we have addressed WLAN sniffing in the preceding paragraphs, the same applies to injection as well. To inject packets on a specific channel, we will need to put the card radio on that channel.</p><p>Let's now do some exercises on setting our card to specific channels, channel hopping, setting regulatory domains, power levels, and many more.</p></div>
<div class="section" title="Time for action &#x2013; experimenting with your adapter"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec28"/>Time for action – experimenting with your adapter</h1></div></div></div><p>Follow these<a class="indexterm" id="id75"/> instructions carefully:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To set the card on a particular channel, we use the <code class="literal">iwconfig wlan0mon channel X</code> commands:<div class="mediaobject"><img alt="Time for action – experimenting with your adapter" src="graphics/B09903_02_18.jpg"/></div></li><li class="listitem">The <code class="literal">iwconfig</code> series of commands does not have a channel hopping mode. One could write a<a class="indexterm" id="id76"/> simple script over it to make it do so. An easier way is to use <code class="literal">airodump-ng</code> with options to either hop channels arbitrarily, use only a subset, or use only selected bands. All these options are illustrated in the following screenshot when we run <code class="literal">airodump-ng --help</code>:<div class="mediaobject"><img alt="Time for action – experimenting with your adapter" src="graphics/B09903_02_19.jpg"/></div></li></ol></div><div class="section" title="What just happened?"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec28"/>
<span class="emphasis"><em>What just happened?</em></span>
</h2></div></div></div><p>We understood that both wireless sniffing and packet injection depend on the hardware support available. This<a class="indexterm" id="id77"/> means that we can only operate on bands and channels allowed by our card. Also, the wireless card radio can only be on one channel at a time. Furthermore, this means that we can only sniff or inject in one channel at a time.</p></div><div class="section" title="Have a go hero – sniffing multiple channels"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec29"/>Have a go hero – sniffing multiple channels</h2></div></div></div><p>If you need to<a class="indexterm" id="id78"/> simultaneously sniff on multiple channels, you will require multiple physical Wi-Fi cards. If you can procure additional cards, then try to sniff on multiple channels simultaneously.</p></div><div class="section" title="Pop quiz – WLAN packet sniffing and injection"><div class="titlepage"><div><div><h2 class="title"><a id="ch02lvl2sec30"/>Pop quiz – WLAN packet sniffing and injection</h2></div></div></div><p>Q1. Which frame types are responsible for authentication in WLANs?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Control</li><li class="listitem">Management</li><li class="listitem">Data</li><li class="listitem">QoS</li></ol></div><p>Q2. What is the name of the second monitor mode interface that can be created on <code class="literal">wlan0</code> using <code class="literal">airmon-ng</code>?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">wlan0mon</code></li><li class="listitem"><code class="literal">wlan0mon1</code></li><li class="listitem"><code class="literal">1mon</code></li><li class="listitem"><code class="literal">monb</code></li></ol></div><p>Q3. What is the filter expression to view all non-beacon frames in Wireshark?</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem"><code class="literal">!(wlan.fc.type_subtype == 0x08)</code></li><li class="listitem"><code class="literal">wlan.fc.type_subtype == 0x08</code></li><li class="listitem"><code class="literal">(no beacon)</code></li><li class="listitem"><code class="literal">wlan.fc.type == 0x08</code></li></ol></div></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec29"/>Summary</h1></div></div></div><p>In this chapter, we have made some key observations about WLAN protocols.</p><p>Management, control, and data frames are unencrypted and thus can be easily read by someone who is monitoring the airspace. It is important to note here that the data packet payload can be protected using encryption to keep it confidential. We will talk about this in the next chapter.</p><p>We can sniff the entire airspace in our vicinity by putting our card into monitor mode.</p><p>As there is no integrity protection in management and control frames, it is very easy to inject these packets by modifying them or replaying them as-is using tools such as <code class="literal">aireplay-ng</code>.</p><p>Unencrypted data packets can also be modified and replayed back to the network. If the packet is encrypted, we can still replay the packet as-is, as WLAN by design does not have packet replay protection.</p><p>In the next chapter, we will look at different authentication mechanisms that are used in WLANs such as MAC filtering and shared authentication, and understand the various security flaws in them through live demonstrations.</p></div></body></html>