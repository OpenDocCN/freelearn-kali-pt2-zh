<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en" lang="en">
<head>
<title>The Ultimate Kali Linux Book - Third Edition</title>
<link rel="stylesheet" type="text/css" href="../styles/stylesheet1.css"/>
<link rel="stylesheet" type="text/css" href="../styles/stylesheet2.css"/>
</head>
<body>
<div id="book-content">
<div id="sbo-rt-content"><section id="performing-vulnerability-assessments" class="level1 pkt" data-number="8">
<h1 data-number="8">7 Performing Vulnerability Assessments</h1>
<section id="join-our-book-community-on-discord-6" class="level2" data-number="8.1">
<h2 data-number="8.1">Join our book community on Discord</h2>
<p><a href="https://packt.link/SecNet">https://packt.link/SecNet</a><img src="../media/file258.png" alt="Qr code Description automatically generated" width="150" height="150"/>As you have learnt so far, the reconnaissance phase is very important for successfully moving onto the exploitation phase of penetration testing and the Cyber Kill Chain. Discovering security vulnerabilities on a targeted system helps adversaries identify the attack surface, which is the points of entry on a system which can be exploited to gain unauthorized access. As an aspiring ethical hacker and penetration tester, understanding how to efficiently identify the attack surface and profile a targeted system will help you better plan your method of attack and determine which exploits will help you gain a foothold on the target.In this chapter, you will learn how to use Kali Linux with various popular tools to perform a vulnerability assessment on a network. You will start by learning how to install, perform, and analyze scan results using Nessus, one of the most popular and industry-recognized vulnerability scanners within the cybersecurity industry. Then, you will learn how to leverage the hidden secrets and power of Nmap to easily discover security flaws on systems. Finally, you will learn how to perform web vulnerability assessments.In this chapter, we will cover the following topics:</p>
<ul>
<li>Getting started with Nessus</li>
<li>Vulnerability identification using Nmap</li>
<li>Working with Greenbone Vulnerability Manager</li>
<li>Using web application scanners</li>
</ul>
<p>Let’s dive in!</p>
</section>
<section id="technical-requirements-5" class="level2" data-number="8.2">
<h2 data-number="8.2">Technical Requirements</h2>
<p>To follow along with the exercises in this chapter, please ensure that you have met the following hardware and software requirements:</p>
<ul>
<li>Kali Linux - <a href="https://www.kali.org/get-kali/">https://www.kali.org/get-kali/</a></li>
<li>Nessus Essentials - <a href="https://www.tenable.com/products/nessus/nessus-essentials">https://www.tenable.com/products/nessus/nessus-essentials</a></li>
<li>Greenbone Vulnerable Manager - <a href="https://github.com/greenbone/gvmd">https://github.com/greenbone/gvmd</a></li>
</ul>
</section>
<section id="getting-started-with-nessus" class="level2" data-number="8.3">
<h2 data-number="8.3">Getting started with Nessus</h2>
<p>When diving into the field of cybersecurity, there is a very well-known tool everyone needs to know about, and that's Nessus. Nessus is a vulnerability scanner that can detect over 47,000 <strong>Common Vulnerability and Exposure</strong> (<strong>CVE</strong>) security flaws on systems. Furthermore, Nessus allows security professionals to deploy Nessus within centralized locations and automate periodic scanning on targeted systems, which allows continuous and automated vulnerability assessment within an organization.As an aspiring penetration tester, you may need to use Nessus to perform a vulnerability assessment within an organization, determine the risk and severity of each security flaw, and provide recommendations on how to mitigate the risk of possible cyber-attacks based on the security vulnerabilities found. In this section, you will learn how to set up and perform a vulnerability assessment using Nessus on your Kali Linux machine.To get started working with Nessus Essentials, please use the following instructions:</p>
<blockquote>
<p>If you’re a Mac user who is running Kali Linux in Parallels on the M1 Mac (ARM64) chip, you may experience some issues when setting up Nessus within Kali Linux. However, the process works fine on a Windows-based system.</p>
</blockquote>
<section id="part-1-installing-nessus" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1">Part 1 – installing Nessus</h3>
<p>In this part, you will learn how to install and setup Nessus Essentials on the Kali Linux virtual machine to identify security vulnerabilities on targeted systems:</p>
<ol>
<li>Firstly, power-on the <strong>Kali Linux</strong> virtual machine and ensure it has internet connectivity.</li>
<li>Next, either on Kali Linux or your host machine, open the web browser and go to <a href="https://www.tenable.com/products/nessus/nessus-essentials">https://www.tenable.com/products/nessus/nessus-essentials</a> to register for a free license to activate Nessus Essentials during the setup process:</li>
</ol>
<img src="../media/file259.png" width="612" height="566"/>
<p>As shown the preceding screenshot, a business email address is required to complete the registration, however I’ve used a personal free email address and was able to successfully register and received a Nessus Essentials activation code.</p>
<ol>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands to update the local software packages repository list:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo apt update</code></pre>
</div>
<ol>
<li>Next, use the following commands to download the Nessus Essentials package onto the Kali Linux virtual machine:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ curl --request GET \
  --url 'https://www.tenable.com/downloads/api/v2/pages/nessus/files/Nessus-10.6.0-debian10_amd64.deb' \
  --output 'Nessus-10.6.0-debian10_amd64.deb' </code></pre>
</div>
<p>The following screenshot shows the execution of the preceding commands:</p>
<img src="../media/file260.png" width="964" height="470"/>
<blockquote>
<p>If you’re having difficulties running the preceding commands, please go to <a href="https://www.tenable.com/downloads/nessus">https://www.tenable.com/downloads/nessus</a>, select the latest version of Nessus and choose <strong>Linux – Debian – amd64</strong> to download the software package onto Kali Linux.</p>
</blockquote>
<ol>
<li>Next, install the Nessus software package onto Kali Linux:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo dpkg -i Nessus-10.6.0-debian10_amd64.deb</code></pre>
</div>
<p>The following screenshots the installation of Nessus:</p>
<img src="../media/file261.png" width="963" height="274"/>
<ol>
<li>Next, use the following command to start and restart the Nessus service:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo /bin/systemctl start nessusd.service
kali@kali:~$ sudo /bin/systemctl restart nessusd.service</code></pre>
</div>
<blockquote>
<p>The <code>systemctl status nessusd.service</code> command can be used to verify whether the Nessus service is active and running on Kali Linux.</p>
</blockquote>
<ol>
<li>To continue the Nessus setup process, open the web browser within Kali Linux and go <a href="https://kali:8834/">https://kali:8834/</a>, as shown below:</li>
</ol>
<img src="../media/file262.png" width="976" height="877"/>
<p>When you first visit <a href="https://kali:8834/">https://kali:8834/</a>, the web browser will provide a security warning because Nessus uses a self-signed digital certificate. Click on <strong>Advanced</strong>, then on <strong>Accept the Risk and Continue</strong>.</p>
<ol>
<li>Next, the Nessus initialization page will appear, click on <strong>Continue</strong> as shown below:</li>
</ol>
<img src="../media/file263.png" width="365" height="447"/>
<ol>
<li>Next, select the <strong>Register for Nessus Essentials</strong> option and click on <strong>Continue</strong>, as shown below:</li>
</ol>
<img src="../media/file264.png" width="372" height="496"/>
<ol>
<li>Since you have registered and received a Nessus Essentials license key during <em>step 2</em>, click on <strong>Skip</strong> on the registration page, as shown below:</li>
</ol>
<img src="../media/file265.png" width="372" height="485"/>
<ol>
<li>Next, enter the license key from your email message and into the <strong>Activation Code</strong> field, then click on <strong>Continue</strong>, as shown below:</li>
</ol>
<img src="../media/file266.png" width="361" height="348"/>
<ol>
<li>Next, Nessus will show the license key/activation code, click on <strong>Continue</strong> as shown below:</li>
</ol>
<img src="../media/file267.png" width="371" height="303"/>
<ol>
<li>Next, create a user account and click on <strong>Submit</strong>, as shown below:</li>
</ol>
<img src="../media/file268.png" width="365" height="454"/>
<blockquote>
<p>If you’re getting an error: <code>invalid code field bad format</code>, try entering the license key/activation code manually to activate Nessus Essentials.</p>
</blockquote>
<ol>
<li>Nessus will automatically log-in to the Dashboard, then starts the initialization process and begin downloading additional updates and plugins for the application. This process usually takes a few minutes to complete. To view the event logs, click on <strong>Settings</strong> | <strong>About</strong> | <strong>Events</strong> as shown in the following screenshot:</li>
</ol>
<img src="../media/file269.png" width="977" height="592"/>
<ol>
<li>Once the download process is completed, Nessus will compile all the plugins. Ensure this is completed before proceeding to scan a targeted system.</li>
</ol>
</section>
<section id="part-2-identifying-vulnerabilities" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2">Part 2 – identifying vulnerabilities</h3>
<p>Nessus is able to detect over 78,000 CVEs on targeted systems to help cybersecurity professionals such as ethical hackers and penetration testers to identify the attack surface of assets owned by organizations, and use the collected information to provide recommendations on preventing and mitigating cyber-attacks and threats.Use the following instructions to get started with scanning for security vulnerabilities using Nessus:</p>
<ol>
<li>Power-on the <strong>Metasploitable 3</strong> (<strong>Windows version</strong>) virtual machine as our targeted system on the network.</li>
<li>On <strong>Kali Linux</strong>, log-in to Nessus Essential dashboard at <a href="https://kali:8834/">https://kali:8834/</a> and click on <strong>New Scan</strong>, as shown below:</li>
</ol>
<img src="../media/file270.png" width="1024" height="341"/>
<ol>
<li>Next, various vulnerability and compliance scanning templates will be presented, enabling you to easily choose the best suitable template based on your scanning objectives. For instance, you scan use a pre-defined template to detect whether targeted systems are vulnerability to WannaCry, ZeroLogon, PrintNightmware and even Log4Shell. For our exercise, click on <strong>Basic Network Scan</strong>, as shown below:</li>
</ol>
<img src="../media/file271.png" width="1566" height="651"/>
<ol>
<li>Next, the scan <strong>Settings</strong> page will appear that provides you with the options to set a name, description, folder to easily organize your scans, targets. Set a name, description and the IP address of the Metasploitable 3 (Windows version) virtual machine as the target, then click on <strong>Launch</strong>, as shown below:</li>
</ol>
<img src="../media/file272.png" width="958" height="601"/>
<p>As shown in the preceding screenshot, there are various options and sub-menus, such as the following:</p>
<ul>
<li><strong>Credentials</strong> tab enables you to specify login credentials that allows Nessus to log-in to the targeted system to retrieve specific information that’s not easily available when performing a non-credential scan.</li>
<li><strong>Scheduling</strong> allows penetration testers to automate their scans over a period of time.</li>
<li><strong>Notifications</strong> allows Nessus to send email notifications when scan have started and completed.</li>
<li><strong>Discovery</strong> specifies port scanning options.</li>
<li><strong>Assessment</strong> enables you to choose whether Nessus scans for web vulnerabilities.</li>
<li>Report allows you to specify how Nessus handles the processing of information <strong>that</strong> will be shown in its report.</li>
<li><strong>Advanced</strong> enables you to specific how much traffic Nessus will send on the network, this is useful for low bandwidth networks.</li>
</ul>
<ol>
<li>Next, Nessus will begin scanning the target and displays the progress within the <strong>My Scans</strong> summary window, as shown below:</li>
</ol>
<img src="../media/file273.png" width="1095" height="320"/>
<p>After the scan is completed, Nessus will automatically update the scan status, as shown below:</p>
<img src="../media/file274.png" width="1151" height="329"/>
<p>After the scan is completed, it’s automatically saved within the <strong>My Scans</strong> section.</p>
</section>
<section id="part-3-vulnerability-analysis" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3">Part 3 – Vulnerability analysis</h3>
<p>Using vulnerability scanners such as Nessus can help us automate our process of vulnerability discovery and classification. As an aspiring ethical hacker and penetration tester, it’s essential to understand how to perform vulnerability analysis on reported data. To get started with vulnerability analysis with Nessus, please use the following instructions:</p>
<ol>
<li>To view the scan results, click on <strong>My Scan</strong> | <strong>Identifying Vulnerability on Target1</strong>, as shown below:</li>
</ol>
<img src="../media/file275.png" width="1151" height="329"/>
<p>The following screenshot shows a summary on the all security vulnerabilities that were found on the targeted system:</p>
<img src="../media/file276.png" width="1109" height="599"/>
<p>As shown in the preceding screenshot, Nessus provides a very nice and easy-to-understand view of all the security vulnerabilities that were discovered. Both the Column and Doughnut charts provide an overview of how many security vulnerabilities were found based on their severity ratings and scores.</p>
<ol>
<li>To view a list of all discovered security vulnerabilities, click on the <strong>Vulnerabilities</strong> tab, as shown below:</li>
</ol>
<img src="../media/file277.png" width="761" height="438"/>
<p>As shown in the preceding screenshot, Nessus has grouped multiple security vulnerabilities together.</p>
<ol>
<li>Next, click on the <strong>CRITICAL</strong> severity group to display all the security vulnerabilities that belong to this group, as shown below:</li>
</ol>
<img src="../media/file278.png" width="889" height="442"/>
<p>As shown in the preceding screenshot, Nessus has listed the security vulnerabilities in order of most to least severe. As a penetration tester, this is an indication of the security vulnerabilities that are most likely to create a large impact on the targeted system.</p>
<ol>
<li>Next, click on any one of the critical vulnerability to view more details about it, as shown below:</li>
</ol>
<img src="../media/file279.png" width="1010" height="541"/>
<p>As shown in the preceding screenshot, Nessus provides a description to help cybersecurity professionals to better understand the risk of having this security vulnerability on a system and its impact. In addition, Nessus also provides solutions to remediate this security vulnerability and provide the security posture of the targeted system or asset owned by the organization.</p>
<ol>
<li>Furthermore, Nessus provides their <strong>Vulnerability Priority Rating</strong> (<strong>VPR</strong>) scoring system to help cybersecurity professionals on prioritize their resources on resolving this security risk, as shown below:</li>
</ol>
<img src="../media/file280.png" width="325" height="242"/>
<ol>
<li>Additionally, Nessus provides the metrics that were used from the <strong>Common Vulnerability Scoring System</strong> (<strong>CVSS</strong>) to calculate the severity of the vulnerability, as shown below:</li>
</ol>
<img src="../media/file281.png" width="350" height="404"/>
<blockquote>
<p>Cybersecurity professionals and researchers uses the CVSS calculator at <a href="https://www.first.org/cvss/calculator/3.1">https://www.first.org/cvss/calculator/3.1</a> to determine the severity rating and score of security vulnerabilities on systems. This calculation helps industry experts to determine the risk factors when classifying security vulnerabilities based on severity rating, risk level and impact.</p>
</blockquote>
<ol>
<li>Next, let's take the CVSS 3.0 Vector and insert it into the calculator to determine how a threat actor would compromise a system with this vulnerability:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</code></pre>
</div>
<ol>
<li>Next, append the CVSS 3.0 Vector to the end of the following URL:</li>
</ol>
<p><a href="https://www.first.org/cvss/calculator/3.0#">https://www.first.org/cvss/calculator/3.0#</a>The following is the final version of the URL, with the CVSS 3.0 Vector as the suffix:<a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H">https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</a></p>
<ol>
<li>Upon visiting the preceding URL, you will see how the vectors were allocated to determine the vulnerability score of 9.8, as shown below:</li>
</ol>
<img src="../media/file282.png" width="1051" height="595"/>
<p>As shown in the preceding screenshot, a threat actor will need to create an exploit that needs to be delivered across a <strong>Network</strong> (<strong>N</strong>) path with a <strong>Low</strong> (<strong>L</strong>) attack complexity, which requires <strong>None</strong> (<strong>N</strong>) privileges to be successful. Furthermore, <strong>None</strong> (<strong>N</strong>) human user interactions are needed, due to the scope of the attack will remain <strong>Unchanged</strong> (<strong>U</strong>). Once the exploit takes advantage of the security vulnerability on the targeted system, the impact on the confidentiality, integrity, and availability of the system will be <strong>High</strong> (<strong>H</strong>).</p>
</section>
<section id="part-4-exporting-vulnerability-reports" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4">Part 4 – Exporting vulnerability reports</h3>
<p>Generating a report from Nessus helps you quickly reference vulnerabilities and their descriptions after a penetration test. In this section, you will learn how to generate various types of reports using Nessus.To get started with this exercise, please use the following instructions:</p>
<ol>
<li>On the Nessus Dashboard, click on <strong>Report</strong> as shown below:</li>
</ol>
<img src="../media/file283.png" width="1349" height="390"/>
<ol>
<li>Next, a pop-up window will appear and provide you with various report generating options. Choose the <strong>Report Format</strong>, <strong>Report Template</strong> and click on <strong>Generate Report</strong> as shown below:</li>
</ol>
<img src="../media/file284.png" width="909" height="474"/>
<ol>
<li>Once the report is generated, ensure you save it on your desktop and open it using a PDF reader, as shown below:</li>
</ol>
<img src="../media/file285.png" width="923" height="650"/>
<p>Having completed this section, you have learned how to use Nessus to perform a vulnerability assessment on a target during a penetration test. In the next section, you will learn how to identify security vulnerabilities using the Nmap.</p>
</section>
</section>
<section id="vulnerability-identification-using-nmap" class="level2" data-number="8.4">
<h2 data-number="8.4">Vulnerability identification using Nmap</h2>
<p>The <strong>Nmap Scripting Engine</strong> (<strong>NSE</strong>) is one of the most powerful features of Nmap. It enables penetration testers and security researchers to create, automate, and perform customized scanning on targeted systems. When working with NSE, the scanning techniques are usually aggressive and has the potential to cause unexpected data loss or even crash the targeted system. However, NSE allows a penetration tester to easily identify security vulnerabilities and determine whether the target is exploitable.There are 600+ pre-built scripts that belongs to the following NSE categories:</p>
<ul>
<li><strong>Auth</strong>: This category contains scripts that scan a targeted system to identify whether authentication bypass is possible.</li>
<li><strong>Broadcast</strong>: This category contains scripts that are used to discover host systems on a network.</li>
<li><strong>Brute</strong>: This category contains scripts that are used to perform some types of brute-force attacks on a remote server to with the intention to gain unauthorized access.</li>
<li><strong>Default</strong>: This category contains a set of default scripts within NSE for scanning.</li>
<li><strong>Discovery</strong>: This category contains scripts that are used in active reconnaissance to identify network services on a targeted system.</li>
<li><strong>DoS</strong>: This category contains scripts that simulate a <strong>Denial-of-Service</strong> (<strong>DoS</strong>) attack on a targeted system to check whether it’s susceptible to such types of attacks.</li>
<li><strong>Exploit</strong>: This category contains scripts that are used to actively exploit security vulnerabilities on a target.</li>
<li><strong>External</strong>: This category contains scripts that usually send data that's been gathered from a targeted system to an external resource for further processing.</li>
<li><strong>Fuzzer</strong>: This category contains scripts that are used to send random data into an application to discover any software bugs and vulnerabilities within applications.</li>
<li><strong>Intrusive</strong>: This category contains high-risk scripts that can crash systems and cause data loss.</li>
<li><strong>Malware</strong>: This category contains scripts that can determine whether a target is infected with malware.</li>
<li><strong>Safe</strong>: This category contains scripts that are not intrusive and safe to use on a targeted system.</li>
<li><strong>Version</strong>: This category contains scripts that are used to gather the version information of services on a targeted system.</li>
<li><strong>Vuln</strong>: This category contains scripts that are used to check for specific vulnerabilities on a targeted system.</li>
</ul>
<blockquote>
<p>To learn more about NSE, please see: <a href="https://nmap.org/book/nse.html">https://nmap.org/book/nse.html</a>. For a full list of NSE scripts, please see: <a href="https://nmap.org/nsedoc/scripts/">https://nmap.org/nsedoc/scripts/</a>.</p>
</blockquote>
<p>To get started working with NSE to identify security vulnerabilities, please use the following instructions:</p>
<ol>
<li>Power-on <strong>Kali Linux</strong> and <strong>Metasploitable 2</strong> virtual machines.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands to view a list of locally available NSE scripts:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ ls -l /usr/share/nmap/scripts</code></pre>
</div>
<p>The following screenshot shows there are 4000+ NSE scripts within the <code>/usr/share/nmap/scripts</code> directory on Kali Linux:</p>
<img src="../media/file286.png" width="945" height="303"/>
<ol>
<li>To filter all <strong>File Transfer Protocol</strong> (<strong>FTP</strong>) NSE scripts, use the following the commands:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ ls -l /usr/share/nmap/scripts/ftp*</code></pre>
</div>
<p>As shown in the following screenshot, the <code>*</code> works as a wildcard to show all scripts which begins with <code>ftp</code>:</p>
<img src="../media/file287.png" width="1403" height="318"/>
<ol>
<li>Next, let’s use Nmap to determine whether the targeted system (Metasploitable 2) is running an FTP service and determine the service version:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo nmap -sV -p 20,21 172.30.1.49</code></pre>
</div>
<img src="../media/file288.png" width="993" height="359"/>
<p>As shown in the preceding screenshot, port 21 is open and the service is identified as <em>vsftpd 2.3.4</em> on the targeted system.</p>
<ol>
<li>Next, let’s use one of the NSE scripts to determine whether vsftpd is vulnerable on the target:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo nmap --script ftp-vsftpd-backdoor 172.30.1.49</code></pre>
</div>
<p>The <code>--script</code> command allows you to specify either a single script, multiple scripts, or a category of scripts. The following screenshot shows the results of performing a scan on our victim machine:</p>
<img src="../media/file289.png" width="1211" height="616"/>
<p>As shown in the preceding screenshot, the ftp-vsftpd-backdoor script was used to check whether the target is vulnerable to a backdoor present within the vsFTPd 2.3.4 application. As a result, NSE indicated the targeted system is running a vulnerable service.</p>
<ol>
<li>Now that a vulnerability has been found, the next step is to determine whether there are exploits that can leverage this security weakness. The following screenshot shows the results of performing a Google search for known exploits for the vsFTPd 2.3.4 service:</li>
</ol>
<img src="../media/file290.png" width="736" height="439"/>
<p>As shown in the preceding screenshot, there's a link for an exploit from Rapid7, the creator of Metasploit. Using this Rapid7 URL, you can gather further details on how to exploit the vulnerability using Metasploit on Kali Linux. Additionally, notice the second URL within the Google search result, which is from Exploit-DB. This is a trusted exploit database that is maintained by the creators of Kali Linux. These are two trusted online resources for gathering exploits during a penetration test.</p>
<ol>
<li>Additionally, within Kali Linux, there is a tool known as <strong>searchsploit</strong> that allows you to perform a query/search for exploits within the offline version of Exploit-DB on Kali Linux.</li>
</ol>
<p>The following screenshot shows the search results when using the <code>searchsploit</code> command:</p>
<img src="../media/file291.png" width="1399" height="392"/>
<p>As shown in the preceding screenshot, <code>searchsploit</code> was able to identify multiple exploits from the local, offline version of the Exploit-DB database. Notice there is a particular entry that indicates there's already an exploit module within Metasploit. The following screenshot shows the <code>vsFTPd exploit</code> module within Metasploit:</p>
<img src="../media/file292.png" width="1826" height="333"/>
<p>As shown in the preceding screenshot, this exploit module can take advantage of security vulnerabilities that are found within any Linux-based system, which is running vsFTPd version 2.3.4. If the exploit is successful, the penetration tester will be able to create a backdoor with <strong>Remote Code Execution</strong> (<strong>RCE</strong>) on the targeted system.</p>
<blockquote>
<p>Many vulnerability scripts can be used within Nmap as part of NSE. Please be sure to check out the complete list at <a href="https://nmap.org/nsedoc/categories/vuln.html">https://nmap.org/nsedoc/categories/vuln.html</a>, where you will be able to identify the names and details of each script that can be found within the vulnerability category.</p>
</blockquote>
<ol>
<li>If you want to execute an entire category of scripts, you can use the <code>nmap --script &lt;category-name&gt;</code> command, as shown here:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo nmap --script vuln 172.30.1.49</code></pre>
</div>
<p>When using the <code>vuln</code> category, NSE will use all the vulnerability detection scripts to check for security weaknesses on the target. As shown in the following screenshot, additional security flaws were discovered on the Metasploitable 2 victim machine:</p>
<img src="../media/file293.png" width="1204" height="386"/>
<p>As an aspiring ethical hacker and penetration tester, you have learned how to perform various scanning techniques to fingerprint and discover security vulnerabilities on host systems within a network using Nmap. Using the information found within this section can help you in researching exploits and payloads, which can take advantage of these security vulnerabilities.In the next section, you will learn how to install and use an open source vulnerability management tool on Kali Linux.</p>
</section>
<section id="working-with-greenbone-vulnerability-manager" class="level2" data-number="8.5">
<h2 data-number="8.5">Working with Greenbone Vulnerability Manager</h2>
<p>The <strong>Open Vulnerability Assessment Scanner</strong> (<strong>OpenVAS</strong>) tool is a free vulnerability scanner that allows both ethical hackers and penetration testers to perform a vulnerability assessment on a network. OpenVAS can scan both authenticated and unauthenticated vulnerability assets within an organization. When using an authenticated scan, the penetration tester provides valid login credentials to the vulnerability scanner, which allows it to authenticate to a system to provide a thorough scan for any misconfigurations on the target system's settings. However, the unauthenticated scan is usually not as thorough since it looks for any security vulnerabilities on the surface of the target and provides a report.<strong>Greenbone Vulnerability Manager</strong> (<strong>GVM</strong>) is a centralized management tool that manages the functions and vulnerabilities of OpenVAS. In this exercise, you will learn how to set up GVM on Kali Linux and perform a vulnerability assessment on a target using OpenVAS.To get started with this exercise, please use the following instructions:</p>
<section id="part-1-installing-gvm" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1">Part 1 – Installing GVM</h3>
<ol>
<li>Power-on the <strong>Kali Linux</strong> virtual machine and ensure it has internet connectivity.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands to update the local software package repository list file and install the GVM package:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo apt update
kali@kali:~$ sudo apt install gvm</code></pre>
</div>
<ol>
<li>During the installation, you may be prompted to restart various services, ensure you use the <code>spacebar</code> on your keyboard to select the services to be restarted, then use <code>Tab</code> key to move between options and hit <code>Enter</code> on OK, as shown below:</li>
</ol>
<img src="../media/file294.png" width="724" height="361"/>
<ol>
<li>Once the installation is complete, reboot the Kali Linux virtual machine and login to continue.</li>
<li>Next, use the following commands to initialize the setup process and generate default user credentials:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo gvm-setup</code></pre>
</div>
<p>The setup process usually takes a while to complete as it downloads addition updates and plugins. Once the setup process is completed, the default admin account is created with a randomized password, as shown below:</p>
<img src="../media/file295.png" width="1318" height="199"/>
<ol>
<li>Next, use the <code>sudo gvm-check-setup</code> command to verify GVM is set up correctly.</li>
<li>Next, open the web browser within Kali Linux and go to <code>https://127.0.0.1:9392</code> to access the web interface for GVM.</li>
<li>Use the default <code>admin</code> user account that was created at the end of the setup process and login as shown below:</li>
</ol>
<img src="../media/file296.png" width="450" height="420"/>
<ol>
<li>After logging-in, click on <strong>Administration</strong> | <strong>Feed Status</strong> as shown below:</li>
</ol>
<img src="../media/file297.png" width="687" height="261"/>
<p>GVM will continue to download addition <strong>Cyber Threat Intelligence</strong> (<strong>CTI</strong>) from multiple trusted online sources to ensure the vulnerability scanning engine within GVM has the latest updates and signatures to identify the latest security flaws on system, as shown below:</p>
<img src="../media/file298.png" width="976" height="277"/>
<p>The download process usually takes a while to complete. Once all content is updated, the feed status will automatically change, as shown below:</p>
<img src="../media/file299.png" width="877" height="291"/>
<p>Ensure all threat feeds are updated before performing any vulnerability scans on targeted systems.</p>
</section>
<section id="part-2-vulnerability-identification" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2">Part 2 – vulnerability identification</h3>
<p>To use GVM to identify security vulnerabilities on a targeted system, please use the following instructions:</p>
<ol>
<li>On the GVM dashboard, click on <strong>Configurations</strong> | <strong>Targets</strong> to set our target host, as shown below:</li>
</ol>
<img src="../media/file300.png" width="490" height="194"/>
<ol>
<li>Next, click on the <strong>New Target</strong> icon that’s located on the top-left corner.</li>
<li>On the <strong>New Target</strong> window, ensure you set a Name, Hosts (IP address of Metasploitable 3) and click on <strong>Save</strong>, as shown below:</li>
</ol>
<img src="../media/file301.png" width="605" height="536"/>
<ol>
<li>As shown in the preceding screenshot, the <strong>New Target</strong> window provides additional options such as entering user credentials to perform credential scanning to obtain more information. Furthermore, you can specific multiple targeted systems from a list and exclude specific targets if you’re scanning a range of addresses.</li>
<li>Next, create a new scan task by clicking on <strong>Scans</strong> | <strong>Tasks</strong>, as shown below:</li>
</ol>
<img src="../media/file302.png" width="651" height="250"/>
<ol>
<li>Next, click on the <strong>Magic Paper</strong> icon (top-left corner), then <strong>New Task</strong>, as shown below:</li>
</ol>
<img src="../media/file303.png" width="432" height="142"/>
<ol>
<li>On the <strong>New Task</strong> window, enter a name of the task and select <strong>Scan Targets</strong> from the drop-down menu, then click on <strong>Save</strong>, as shown below:</li>
</ol>
<img src="../media/file304.png" width="749" height="531"/>
<ol>
<li>Next, the new scan task will appear on the lower section of the same page, click on the <strong>Play</strong> icon to start the scan on the targeted system, as shown below:</li>
</ol>
<img src="../media/file305.png" width="971" height="167"/>
<ol>
<li>The task status will change automatically during this process. Once the task is completed, the status will appear as <strong>Done</strong> and display its results, as shown below:</li>
</ol>
<img src="../media/file306.png" width="1165" height="430"/>
</section>
<section id="part-3-vulnerability-analysis-and-reporting" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3">Part 3 – vulnerability analysis and reporting</h3>
<p>To perform vulnerability analysis using GVM, please use the following instructions:</p>
<ol>
<li>To view the results of the report, click on <strong>Scans</strong> | <strong>Reports</strong>, as shown below:</li>
</ol>
<img src="../media/file307.png" width="1936" height="521"/>
<p>As shown in the preceding screenshot, GVM analyzed and categorized the discovered security vulnerabilities into <strong>High</strong>, <strong>Medium</strong>, <strong>Low</strong>, <strong>Log</strong> and <strong>False Positives</strong> to help cybersecurity professionals with their decision-making process and prioritizing resources to more critical vulnerabilities.</p>
<ol>
<li>To view a detailed list of identified security vulnerability, click on the report date, as shown below:</li>
</ol>
<img src="../media/file308.png" width="620" height="130"/>
<p>Then, click on the <strong>Results</strong> tab to view a list of all security vulnerabilities and their severity levels that were found on the targeted system, as shown below:</p>
<img src="../media/file309.png" width="1143" height="487"/>
<ol>
<li>To view the description of a vulnerability, click on any one from the results list, as shown below:</li>
</ol>
<img src="../media/file310.png" width="832" height="696"/>
<p>Using the information shown in the preceding screenshot, ethical hackers and penetration testers will gain a better insight on the impact a vulnerability has on a system if it’s exploited by an adversary. In addition, ethical hackers can use this information to develop or acquire exploits to compromise multiple systems with the same security flaw on the targeted network.In this section, you have learnt how to setup and work with GVM to identify security vulnerabilities on a targeted system. In the next section, you will learn how to use common tools to identify security flaws on web applications.</p>
</section>
</section>
<section id="using-web-application-scanners" class="level2" data-number="8.6">
<h2 data-number="8.6">Using web application scanners</h2>
<p>As an aspiring penetration tester, you will also be required to perform web application security testing based on the scope of your penetration testing engagements. In this section, you will learn how to use various types of web application scanners to identify and fingerprint web applications on a target server.Let’s get started!</p>
<section id="whatweb" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1">WhatWeb</h3>
<p>WhatWeb enables ethical hackers and penetration testers to identify and fingerprint the type of technologies that are running on web application servers. WhatWeb is pre-installed on Kali Linux and should be part of your arsenal of tools during your reconnaissance and vulnerability assessment phase.To profile a targeted web server using WhatWeb, please use the following instructions:</p>
<ol>
<li>Firstly, power-on the <strong>Kali Linux</strong> and <strong>Metasploitable 3</strong> (Windows version) virtual machines.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands to identify whether there’s a web application running on the target:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ nmap -p 80,443,8080 172.30.1.48</code></pre>
</div>
<p>As shown in the following screenshot, web services were found on port 80 and 8080:</p>
<img src="../media/file311.png" width="985" height="380"/>
<blockquote>
<p>Web application protocols such as HTTP and HTTPS operates on ports 80, 443 and 8080.</p>
</blockquote>
<ol>
<li>Next, use the following commands to profile the web server:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ whatweb http://172.30.1.48</code></pre>
</div>
<p>As shown in the following screenshot, WhatWeb was able to identify the web application and additional web technologies on the targeted system:</p>
<img src="../media/file312.png" width="973" height="174"/>
<p>As an aspiring ethical hacker and penetration tester, some tools will help you gather information about the web server, while others will discover security vulnerabilities. However, it's important to research all the technologies that are found on a targeted web server when using WhatWeb; many security researchers share their findings and disclosure vulnerabilities to help others fight the battle against cyber criminals.To put it simply, WhatWeb provides the following details:</p>
<ul>
<li>The web application and its version</li>
<li>The web technologies and their versions</li>
<li>The host operating system and its version</li>
</ul>
<p>By researching the version numbers of each technology, you will be able to find exploits that can take advantage of the vulnerabilities on the targeted system. In the next section, you will learn how to use Nmap to discover web application vulnerabilities.</p>
</section>
<section id="nmap" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2">Nmap</h3>
<p>As you have learnt, Nmap has a lot of very cool features and enables penetration testers to perform various types of scanning on targeted system to discover specific details them. Within NSE, many scripts are already pre-loaded onto Kali Linux.Using the following command, you will be able to see an entire list of all the Nmap scripts that begin with http:</p>
<div class="C0-ConsolePACKT">
<pre><code>kali@kali:~$ ls /usr/share/nmap/scripts/http*</code></pre>
</div>
<p>From the list, you can choose to use a particular script to check for HTTP vulnerabilities on a targeted system. Let's imagine you want to identify whether a web application is vulnerable to <strong>Structured Query Language</strong> (<strong>SQL</strong>) <strong>Injection</strong> attacks. The <code>http-sql-injection</code> NSE script will be able to identify such security flaws. The following Nmap command shows how to invoke the SQL Injection script and perform a scan on a target that has port 80 open for web services:</p>
<div class="C0-ConsolePACKT">
<pre><code>kali@kali:~$ nmap --script http-sql-injection -p 80 172.30.1.49</code></pre>
</div>
<p>The following screenshot shows Nmap was able to identify possible SQL Injection at multiple points on the target:<img src="../media/file313.png" width="1919" height="856"/>As shown in the preceding screenshot, the Nmap script was able to automate the process of checking whether various URLs and paths are susceptible to a possible SQL Injection attack.</p>
<blockquote>
<p>While many NSE scripts can be leveraged to identify security vulnerabilities in web applications, it’s important to always identify the service version of the web application by simply using the <code>-A</code> or <code>-sV</code> syntax when performing an initial scan to profile your target. Once you have identified the web application's service version, use the internet to research known vulnerabilities. As a penetration tester, it's always good to perform additional research on vulnerabilities as you may find more information on how to compromise the target.</p>
</blockquote>
<p>Be sure to perform additional scanning on the target to discover any hidden security vulnerabilities, and use the information found at <a href="https://nmap.org/nsedoc/">https://nmap.org/nsedoc/</a> to gain an in-depth understanding of the purpose of various NSE scripts. In the next section, you will learn how to use Nikto to check for web application vulnerabilities on a target.</p>
</section>
<section id="nikto" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3">Nikto</h3>
<p>Nikto is an open source web application scanner that comes pre-installed within Kali Linux. This tool allows penetration testers to easily automate the process of identifying security vulnerabilities that may exist within a web application on a web server.To get started using Nikto, please use the following instructions:</p>
<ol>
<li>Power-on the <strong>Kali Linux</strong> and <strong>Metasploitable 2</strong> virtual machines.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands to scan the web application on <strong>Metasploitable 2</strong>:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ nikto -h 172.30.1.49</code></pre>
</div>
<blockquote>
<p>Using the <code>-h</code> syntax allows you to specify the target's hostname or IP address. To learn more about various scanning options, use the <code>nikto --help</code> command.</p>
</blockquote>
<p>The following screenshot shows some of the scan results from our target system:</p>
<img src="../media/file314.png" width="1924" height="780"/>
<p>As shown in the preceding screenshot, Nikto can identify various security vulnerabilities within the target web application. They are listed in bullet format, and the <code>+</code> icon is used to indicate a new result. Take some time to read each line thoroughly as Nikto helps security professionals understand the details of the security vulnerabilities. It also provides references to where the flaws were found and how to resolve those weaknesses. Next, you will learn how to use identify web application vulnerabilities using Metasploit.</p>
</section>
<section id="metasploit" class="level3" data-number="8.6.4">
<h3 data-number="8.6.4">Metasploit</h3>
<p>In this section, you will learn how to leverage the power of Metasploit to discover security vulnerabilities on a web application server. For our target, we'll be using the Metasploitable 2 virtual machine. To get started with this exercise, please use the following instructions:</p>
<ol>
<li>Firstly, power-on both the <strong>Kali Linux</strong> and <strong>Metasploitable 2</strong> virtual machines.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following command to start the PostgreSQL datatbase and initialize Metasploit:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ sudo service postgresql start
kali@kali:~$ sudo msfdb init</code></pre>
</div>
<ol>
<li>Next, use the following commands to access the Metasploit framework:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ msfconsole</code></pre>
</div>
<ol>
<li>Then, use the following command to load the WMAP web vulnerability scanner module within Metasploit:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; load wmap</code></pre>
</div>
<p>The following screenshot shows the execution of the preceding commands and the WMAP plugin loaded successfully:</p>
<img src="../media/file315.png" width="732" height="245"/>
<ol>
<li>Next, use the following commands to set the targeted system as the Metasploitable 2:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; wmap_sites -a http://172.30.1.49</code></pre>
</div>
<p>The following screenshot shows how to set the targeted host within the WMAP web vulnerability scanner:</p>
<img src="../media/file316.png" width="1007" height="336"/>
<ol>
<li>Skip Next, use the following commands to specific the URL of the targeted web application. We'll be targeting the Mutillidae web application within the Metasploitable 2 virtual machine:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; wmap_targets -t http://172.30.1.49/mutillidae/index.php</code></pre>
</div>
<p>The following screenshot shows the expected results once the target has been set:</p>
<img src="../media/file317.png" width="961" height="313"/>
<p>As shown in the preceding screenshot, the target web application has been set to Mutillidae within the host system.</p>
<ol>
<li>Next, use the following commands to automatically load various web scanning modules from Metasploit for security testing:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; wmap_run -t</code></pre>
</div>
<p>The following screenshot shows many Metasploit web scanning modules that are being loaded into the WMAP web vulnerability scanner:</p>
<img src="../media/file318.png" width="940" height="791"/>
<ol>
<li>Once the web scanning modules have been loaded, use the following commands to perform web security testing on the target web application:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; wmap_run -e</code></pre>
</div>
<ol>
<li>When WMAP scan is completed, use the following command to view a list of web security vulnerabilities that have been discovered by the WMAP web scanner within Metasploit:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; wmap_vulns -l</code></pre>
</div>
<ol>
<li>Lastly, use the <code>vulns</code> command to see the overall results of the security assessment from WMAP:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>msf6 &gt; vulns</code></pre>
</div>
<blockquote>
<p>If Metasploit is able to identify vulnerabilities based on their CVE IDs, it will be shown with the <code>vulns</code> command.</p>
</blockquote>
<p>Having completed this exercise, you have learnt how to use Metasploit to identify web application vulnerabilities. Next, you will learn how to perform a vulnerability scan on a target WordPress web application using WPScan.</p>
</section>
<section id="wpscan" class="level3" data-number="8.6.5">
<h3 data-number="8.6.5">WPScan</h3>
<p>While there are many web applications within the e-commerce industry, there are many organizations that deploy the WordPress web application as their preferred <strong>Content Management System</strong> (<strong>CMS</strong>). While WordPress provides a very stylish and clean presentation of websites, many organizations do not always update their WordPress platforms and plugins, thereby leaving their web server and web application vulnerable to potential cyberattacks from threat actors on the internet. Within Kali Linux, you will learn about the WPScan tool, which allows penetration testers to perform vulnerability scanning and enumeration on the WordPress web application on a target server. To get started with this exercise, please use the following instructions:</p>
<ol>
<li>Firstly, power-on both <strong>Kali Linux</strong> and <strong>Metasploitable 3</strong> (Windows version) virtual machines.</li>
<li>On <strong>Kali Linux</strong>, open the <strong>Terminal</strong> and use the following commands update the WPScan database:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ wpscan --update</code></pre>
</div>
<ol>
<li>Next, use the following commands to identify security vulnerabilities on the Wordpress web application on Metasploitable 3 (Windows version) virtual machine:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ wpscan --url http://172.30.1.48:8585/wordpress --no-update</code></pre>
</div>
<p>The following screenshot shows the vulnerability scan's results:</p>
<img src="../media/file319.png" width="1478" height="616"/>
<p>As shown in the preceding screenshot, WPScan will check each component of the WordPress installation and configuration on the remote target and provide details of its findings.</p>
<ol>
<li>Next, use the <code>-e u</code> commands to enumerate the username(s) for any logon accounts on the targeted Wordpress web application, as shown below:</li>
</ol>
<div class="C1-ConsolePACKT">
<pre><code>kali@kali:~$ wpscan --url http://172.30.1.48:8585/wordpress --no-update -e u</code></pre>
</div>
<p>As shown in the following screenshot, WPScan was able to identify the login usernames of the targeted web server:</p>
<img src="../media/file320.png" width="1192" height="659"/>
<p>As you have seen, it's quite simple to perform a vulnerability scan on a WordPress server and gather a list of potentially authorized usernames on the target server.</p>
<blockquote>
<p>To learn more about WPScan, please see: <a href="https://www.kali.org/tools/wpscan/">https://www.kali.org/tools/wpscan/</a>.</p>
</blockquote>
<p>Having completed this section, you have learned how to perform web scanning using various tools and techniques within Kali Linux. Having gathered a list of web application security vulnerabilities, with some additional research, you will be able to find working exploits to test whether these vulnerabilities are truly exploitable.</p>
</section>
</section>
<section id="summary-6" class="level2" data-number="8.7">
<h2 data-number="8.7">Summary</h2>
<p>In this chapter, you have learnt about the importance of discovering security vulnerabilities within an organization and its assets. You also gained hands-on experience and skills with using various tools such as Nessus, Nmap, and GVM to perform security assessments on systems. You also discovered how various tools and techniques can be used to easily identify security flaws on web applications.I trust that the knowledge presented in this chapter has provided you with valuable insights, supporting your path towards becoming an ethical hacker and penetration tester in the dynamic field of cybersecurity. May this newfound understanding empower you in your journey, allowing you to navigate the industry with confidence and make a significant impact. In the next chapter, <em>Understanding Network Penetration Testing</em>, you will focus on how to use various techniques and strategies when performing network penetration testing.</p>
</section>
<section id="further-reading-6" class="level2" data-number="8.8">
<h2 data-number="8.8">Further Reading</h2>
<ul>
<li>Understanding Nessus - <a href="https://www.techtarget.com/searchnetworking/definition/Nessus">https://www.techtarget.com/searchnetworking/definition/Nessus</a></li>
<li>Nmap Scripting Engine (NSE) - <a href="https://nmap.org/book/man-nse.html">https://nmap.org/book/man-nse.html</a></li>
<li>Nmap NSE scripts - <a href="https://nmap.org/nsedoc/scripts/">https://nmap.org/nsedoc/scripts/</a></li>
<li>CVSS scoring system - <a href="https://www.first.org/cvss/">https://www.first.org/cvss/</a></li>
</ul>
</section>
</section>
</div>
</div>
</body>
</html>