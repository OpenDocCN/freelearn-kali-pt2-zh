- en: '12'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Autopsy Forensic Browser
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Autopsy** and **The Sleuth Kit** go hand in hand. Both were created by Brian
    Carrier. The Sleuth Kit is a powerful suite of **Command-Line Interface** (**CLI**)
    forensic tools, whereas Autopsy is the **Graphical User Interface** (**GUI**;
    pronounced *gooey*) that sits on top of The Sleuth Kit and is accessed through
    a web browser. The Sleuth Kit supports disk image file types, including Raw **Data
    Dump (DD)**, **EnCase (.01)**, and **Advanced Forensic** **Format** (**AFF**).'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Sleuth Kit uses CLI tools to perform the following tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: Find and list allocated and unallocated (deleted) files, and even files hidden
    by rootkits
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reveal NTFS **Alternate Data Streams** (**ADS**) where files can be concealed
    within other files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: List files by type
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Display metadata information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a timeline
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Autopsy can be run from a live **Compact Disk** (**CD**)/**Universal Serial
    Bus** (**USB**) in forensic mode as part of a live analysis in live mode, or it
    can be used on a dedicated Kali Linux machine to investigate analysis in dead
    mode.
  prefs: []
  type: TYPE_NORMAL
- en: 'The topics we will cover in this chapter include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to The Sleuth Kit and the Autopsy forensic browser
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Downloading sample files for use and creating a case in the Autopsy browser
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Evidence analysis using the Autopsy forensic browser
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction to Autopsy – The Sleuth Kit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will focus on the Autopsy browser, which is based on data
    recovery and disk analysis tools found within The Sleuth Kit. Tools in The Sleuth
    Kit are all command line-based and the Autopsy browser allows us to access the
    tools and their functionality via a GUI for easy disk and file carving, recovery,
    analysis, and reporting.
  prefs: []
  type: TYPE_NORMAL
- en: Autopsy offers GUI access to a variety of investigative command-line tools from
    The Sleuth Kit, including file analysis, image and file hashing, deleted file
    recovery, and case management, among other capabilities. Autopsy can be a bit
    tricky to install but, fortunately for us, it comes built into Kali Linux, and
    is also very easy to set up and use.
  prefs: []
  type: TYPE_NORMAL
- en: 'Although the Autopsy browser is based on The Sleuth Kit, the features of Autopsy
    differ when using the Windows version as compared to the Linux version. We will
    cover the Windows version of Autopsy using Wine in [*Chapter 13*](B19441_13.xhtml#_idTextAnchor234)*,
    Performing a Full DFIR Analysis with the Autopsy 4 GUI*. Some of the official
    features offered by The Sleuth Kit and Autopsy 2.4 in Kali Linux include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Image analysis**: Analyzing directories and files, including sorting files,
    recovering deleted files, and previewing files'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**File activity timelines**: Creating timelines based on timestamps of when
    files were written, accessed, and created'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Image integrity**: Creating MD5 hashes of the image file used, as well as
    individual files'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Hash databases**: Matching digital hashes or fingerprints of unknown files
    (such as suspected malicious **.exe** files) against those in the NIST **National
    Software Reference** **Library** (**NSRL**)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Events sequencer**: Displaying events sorted by date and time'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**File analysis**: Analyzing the entire image file to display directory and
    file information and contents'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Keyword search**: Allows searching using keyword lists and predefined expression
    lists'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Metadata analysis**: Allows viewing metadata details and the structure of
    files that are essential for data recovery'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now that we are familiar with some of the uses of Autopsy, let’s first download
    our sample files for analysis before we begin using the tool.
  prefs: []
  type: TYPE_NORMAL
- en: Downloading sample files for use and creating a case in the Autopsy browser
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will find the links to download the required sample files
    that we will be analyzing using the Autopsy browser.
  prefs: []
  type: TYPE_NORMAL
- en: Download the image file
  prefs: []
  type: TYPE_NORMAL
- en: The image file used for analysis is publicly available for download at [http://downloads.digitalcorpora.org/corpora/scenarios/2009-m57-patents/usb/](http://downloads.digitalcorpora.org/corpora/scenarios/2009-m57-patents/usb/).
  prefs: []
  type: TYPE_NORMAL
- en: Be sure to note the location of the downloaded sample file, as this will be
    required later on.
  prefs: []
  type: TYPE_NORMAL
- en: 'The file we will be working with is **terry-work-usb-2009-12-11.E01**, as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.1 – Sample evidence files at digitalcorpora.org](image/Figure_12.01_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.1 – Sample evidence files at digitalcorpora.org
  prefs: []
  type: TYPE_NORMAL
- en: Please note
  prefs: []
  type: TYPE_NORMAL
- en: When investigating hard drives and devices, be sure to always follow proper
    acquisition procedures and use a write-blocker to avoid tampering with original
    evidence.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have our sample image file downloaded (or perhaps even a forensically
    acquired image of our own), let’s proceed with the analysis using the Autopsy
    browser by first getting acquainted with the different ways to start Autopsy.
  prefs: []
  type: TYPE_NORMAL
- en: Starting Autopsy
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Autopsy can be started in two ways:'
  prefs: []
  type: TYPE_NORMAL
- en: 'For the first method, we use the **Applications** menu by clicking on **Applications**
    | **11 - Forensics** | **autopsy (root)**:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 12.2 – autopsy (root) in the Kali Linux Forensics menu](image/Figure_12.02_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.2 – autopsy (root) in the Kali Linux Forensics menu
  prefs: []
  type: TYPE_NORMAL
- en: 'Alternatively, we can click on the search bar at the top left of the Kali Linux
    screen and type the word **autopsy** into it, and then click on the **autopsy
    (****root)** icon:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 12.3 – Searching for the autopsy (root) application](image/Figure_12.03_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.3 – Searching for the autopsy (root) application
  prefs: []
  type: TYPE_NORMAL
- en: Once the Autopsy icon is clicked, a new terminal is opened showing the program
    information along with connection details for opening the Autopsy forensic browser.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: The Autopsy forensic browser has not been updated for the past few years; however;
    we will be using the updated GUI version in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the following screenshot, we can see that the version number is listed as
    **2.24** with the path to the **Evidence Locker** folder as **/var/lib/autopsy**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.4 – Process to start the Autopsy forensic browser](image/Figure_12.04_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.4 – Process to start the Autopsy forensic browser
  prefs: []
  type: TYPE_NORMAL
- en: 'Alternatively, instead of clicking on the link shown in *Figure 12**.4*, you
    can copy and paste the following link into the browser: **http://localhost:9999/autopsy**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 12.5 – Opening Autopsy from the terminal](image/Figure_12.05_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.5 – Opening Autopsy from the terminal
  prefs: []
  type: TYPE_NORMAL
- en: Once the link is opened using either method, you will be greeted with the following
    web interface screen to the Autopsy forensic browser.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.6 – The Autopsy forensic browser web interface](image/Figure_12.06_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.6 – The Autopsy forensic browser web interface
  prefs: []
  type: TYPE_NORMAL
- en: Creating a new case in the Autopsy forensic browser
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To create a new case, follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'When the Autopsy forensic browser opens, investigators are presented with three
    options: **OPEN CASE**, **NEW CASE**, and **HELP**.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click on **NEW CASE**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.7 – NEW CASE option](image/Figure_12.07_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.7 – NEW CASE option
  prefs: []
  type: TYPE_NORMAL
- en: 'Enter details for **Case Name**, **Description**, and **Investigator Names**.
    For **Case Name**, I’ve entered **Terry_USB**, as it closely matches the image
    name (**terry-work-usb**) that we will be using for this investigation. Once all
    the information is entered, click **NEW CASE**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.8 – New case details](image/Figure_12.08_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.8 – New case details
  prefs: []
  type: TYPE_NORMAL
- en: 'The locations of the case directory and configuration file are displayed and
    shown as in *Figure 12**.9*. It’s important to take note of the case directory
    location, as seen in the screenshot: **Case directory (/var/lib/autopsy/Terry_USB/)
    created**. Click **ADD HOST** to continue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.9 – Case location and directory details](image/Figure_12.09_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.9 – Case location and directory details
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Several investigator name fields are available, as there may be instances where
    several investigators may be working together.
  prefs: []
  type: TYPE_NORMAL
- en: Enter the details for the hostname (name of the computer being investigated)
    and the description of the host.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here are some optional settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Time zone**: Defaults to local settings if not specified'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Timeskew Adjustment**: Adds a value in seconds to compensate for time differences'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Path of Alert Hash Database**: Specifies the path of a created database of
    known bad hashes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Path of Ignore Hash Database**: Specifies the path of a created database
    of known good hashes similar to the NIST NSRL:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 12.10 – Case details information](image/Figure_12.10_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.10 – Case details information
  prefs: []
  type: TYPE_NORMAL
- en: Click on the **ADD HOST** button to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once the host is added and directories are created, we add the forensic image
    we want to analyze by clicking the **ADD** **IMAGE** button:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.11 – Host details](image/Figure_12.11_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.11 – Host details
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the **ADD IMAGE FILE** button to add the image file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.12 – Adding the forensic image file](image/Figure_12.12_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.12 – Adding the forensic image file
  prefs: []
  type: TYPE_NORMAL
- en: To import the image for analysis, the full path must be specified. On my machine,
    I’ve saved the image file to the default **Downloads** folder. As such, the location
    of the file would be **/Downloads/terry-work-usb-2009-12-11.E01**, as seen in
    *Figure 12**.13*.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.13 – Location and Import Method details](image/Figure_12.13_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.13 – Location and Import Method details
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: For **Import Method**, we choose **Symlink**. This way, the image file can be
    imported from its current location (**Downloads**) to the **Evidence Locker**
    directory without the risks associated with moving or copying the image file.
  prefs: []
  type: TYPE_NORMAL
- en: Upon clicking **Next**, the image file details are displayed. Click on the **ADD**
    button to continue and then click on **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.14 – Image File Details](image/Figure_12.14_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.14 – Image File Details
  prefs: []
  type: TYPE_NORMAL
- en: At this point, we’re just about ready to analyze the image file. Be sure to
    select the **C:/** option and then click on **Analyze**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.15 – Volume selection](image/Figure_12.15_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.15 – Volume selection
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have added our downloaded sample evidence file and configured all
    case and directory details, we can move on to the analysis of the sample evidence
    file.
  prefs: []
  type: TYPE_NORMAL
- en: Evidence analysis using the Autopsy forensic browser
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now that we’ve created our case, added host information with appropriate directories,
    and added our sample evidence file, we come to the analysis stage, which involves
    the following steps for file and drive analysis, file carving, and recovery:'
  prefs: []
  type: TYPE_NORMAL
- en: 'After clicking on the **ANALYZE** button (see *Figure 12**.15*), we’re presented
    with several options in the form of tabs with which to begin our investigation:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.16 – Analysis tab options](image/Figure_12.16_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.16 – Analysis tab options
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s look at the details of the image by clicking on the **IMAGE DETAILS**
    tab. In the following screenshot, we can see the volume serial number and the
    operating system (**OEM Name**) listed as **BSD 4.4**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.17 – IMAGE DETAILS tab](image/Figure_12.17_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.17 – IMAGE DETAILS tab
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we click on the **FILE ANALYSIS** tab. This tab opens into **file browsing
    mode**, which allows the examination of directories and files within the image.
    Directories within the image are listed by default in the main view area:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.18 – FILE ANALYSIS tab](image/Figure_12.18_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.18 – FILE ANALYSIS tab
  prefs: []
  type: TYPE_NORMAL
- en: 'As seen in the preceding screenshot, for each directory and file, there are
    fields showing when the item was written, accessed, changed, and created, along
    with its size and metadata:'
  prefs: []
  type: TYPE_NORMAL
- en: '**WRITTEN**: The date and time the file was last written to'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ACCESSED**: The date and time the file was last accessed (only the date is
    accurate)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**CHANGED**: The date and time the descriptive data of the file was changed'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**CREATED**: The data and time the file was created'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**META**: Metadata describing the file and information about the file'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: If we scroll down a bit, we can see carved items listed in red, which are deleted
    files, as seen in *Figure 12**.19*.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.19 – Carved files](image/Figure_12.19_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.19 – Carved files
  prefs: []
  type: TYPE_NORMAL
- en: If we scroll even further, we can see that there is an installer (**vnc-4_1_3-x86_win32.exe**)
    file for VNC, which was possibly downloaded to use on another machine as this
    operating system is not Windows.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There is also a keylogger installation file (**xpadvancedkeylogger.exe**) listed
    in red, meaning it was deleted.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 12.20 – Deleted keylogger software discovered](image/Figure_12.20_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.20 – Deleted keylogger software discovered
  prefs: []
  type: TYPE_NORMAL
- en: 'The left pane of the Autopsy browser window also contains four main features
    that can assist in our DFIR investigation and analysis:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Directory Seek**: Allows the searching of directories'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**File Name Search**: Allows the searching of files by Perl expressions or
    filenames'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**ALL DELETED FILES**: Searches the image for deleted files'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**EXPAND DIRECTORIES**: Expands all directories for easier viewing of contents'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Figure 12.21 – Additional analysis menus](image/Figure_12.21_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.21 – Additional analysis menus
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the **EXPAND DIRECTORIES** button to easily view and access all contents
    within the left pane and main window. The **+** icon next to a directory indicates
    that it can be further expanded to view subdirectories (**++**) and their contents:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.22 – Expanded directories within the left pane](image/Figure_12.22_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.22 – Expanded directories within the left pane
  prefs: []
  type: TYPE_NORMAL
- en: 'To view deleted files, we click on the **ALL DELETED FILES** button in the
    left pane. Deleted files are marked in red and also adhere to the same format
    of **WRITTEN**, **ACCESSED**, **CHANGED**, and **CREATED** times. In the following
    screenshot, we can see that the image contains several deleted files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 12.23 – Viewing all deleted files](image/Figure_12.23_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 12.23 – Viewing all deleted files
  prefs: []
  type: TYPE_NORMAL
- en: This brings us to the end of our analysis using the Autopsy forensic browser.
    However, we will continue with another version known as the **Autopsy GUI v4**
    in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we looked at automated DFIR investigation and analysis using
    the Autopsy forensic browser and The Sleuth Kit. Compared to individual tools,
    Autopsy has case management features and supports various types of file analysis,
    searching, and sorting of allocated, unallocated, and hidden files. Autopsy can
    also perform hashing on the file and directory levels to maintain evidence integrity.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will be using the updated and much more powerful stand-alone
    version of the Autopsy GUI, version 4, to analyze the same file used in this chapter
    for comparison.
  prefs: []
  type: TYPE_NORMAL
