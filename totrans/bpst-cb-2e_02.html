<html><head></head><body>
		<div id="_idContainer069">
			<h1 id="_idParaDest-39" class="chapter-number"><a id="_idTextAnchor073"/>2</h1>
			<h1 id="_idParaDest-40"><a id="_idTextAnchor074"/>Getting to Know the Burp Suite of Tools</h1>
			<p>This chapter provides overviews of the most commonly used tools within Burp Suite. The chapter begins by establishing the <strong class="bold">target</strong> scope<a id="_idIndexMarker043"/> within the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong>. This is followed by an introduction to the message editor. Then, there will be some hands-on recipes <a id="_idIndexMarker044"/>using <strong class="bold">OWASP Mutillidae II</strong> to get acquainted with <strong class="bold">Proxy</strong>, <strong class="bold">Repeater</strong>, <strong class="bold">Decoder</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="bold">Intruder</strong></span><span class="No-Break">.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following recipes:</span></p>
			<ul>
				<li>Setting the Target <span class="No-Break">Site Map</span></li>
				<li>Understanding the <span class="No-Break">message editor</span></li>
				<li>Repeating <span class="No-Break">with </span><span class="No-Break"><strong class="bold">Repeater</strong></span></li>
				<li>Decoding <span class="No-Break">with </span><span class="No-Break"><strong class="bold">Decoder</strong></span></li>
				<li>Intruding <span class="No-Break">wit<a id="_idTextAnchor075"/><a id="_idTextAnchor076"/>h </span><span class="No-Break"><strong class="bold">Intrude<a id="_idTextAnchor077"/>r</strong></span></li>
			</ul>
			<h1 id="_idParaDest-41"><a id="_idTextAnchor078"/>Technical requirements</h1>
			<p>To complete the recipes in this chapter, you will need <span class="No-Break">the following:</span></p>
			<ul>
				<li>Burp Proxy Community or <span class="No-Break">Professional (</span><a href="https://portswigger.net/burp/"><span class="No-Break">https://portswigger.net/burp/</span></a><span class="No-Break">)</span></li>
				<li>The Firefox browser configured to allow Burp to proxy <span class="No-Break">traffic (</span><a href="https://www.mozilla.org/en-US/firefox/new/"><span class="No-Break">https://www.mozilla.org/en-US/firefox/new/<span id="_idTextAnchor079"/><span id="_idTextAnchor080"/></span></a><span class="No-Break">)</span></li>
			</ul>
			<h1 id="_idParaDest-42"><a id="_idTextAnchor081"/>Setting the Target Site Map</h1>
			<p>Now<a id="_idIndexMarker045"/> that we have traffic flowing between your browser, Burp, and the<a id="_idIndexMarker046"/> OWASP <strong class="bold">Broken Web Applications</strong> (<strong class="bold">BWA</strong>) <strong class="bold">virtual machine</strong> (<strong class="bold">VM</strong>), we can begin setting the scope of our test. For this recipe, we will use the OWASP Mutillidae II link (<strong class="source-inline">http://&lt;Your_VM_Assigned_IP_Address&gt;/mutillidae/</strong>) available in the OWASP BWA VM as our <span class="No-Break">target application.</span></p>
			<p>Looking more closely at the <strong class="bold">Target</strong> tab, you will notice there are two subtabs available: <strong class="bold">Site map</strong> and <strong class="bold">Scope</strong>. From the initial proxy setup between your browser, Burp, and the web server, you should now have some URLs, folders, and files shown in the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> tabs. You may find the amount of information overwhelming, but setting the scope for our project will help to focus our <span class="No-Break">attention bet<a id="_idTextAnchor082"/>t<a id="_idTextAnchor083"/>er.</span></p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor084"/>Getting ready</h2>
			<p>Using<a id="_idIndexMarker047"/> the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> and <strong class="bold">Target</strong> | <strong class="bold">Scope</strong> tabs, we will assign the URL for Mutillidae (<strong class="source-inline">http://&lt;Your_VM_Assigned_IP_Address&gt;/mutillidae/</strong>) as <span class="No-Break">the s<a id="_idTextAnchor085"/>c<a id="_idTextAnchor086"/>ope.</span></p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor087"/>How to do it...</h2>
			<p>Execute the following steps to set the Target <span class="No-Break">Site Map:</span></p>
			<ol>
				<li>Search for the <strong class="source-inline">mutillidae</strong> folder and then right-click on it, and select <strong class="bold">Add to scope</strong> from the <span class="No-Break">drop-down list:</span></li>
			</ol>
			<div>
				<div id="_idContainer028" class="IMG---Figure">
					<img src="image/B21173_Figure_2.1.jpg" alt="Figure 2.1 – Setting the scope for the target application"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Setting the scope for the target application</p>
			<ol>
				<li value="2">Upon <a id="_idIndexMarker048"/>adding the <strong class="source-inline">mutillidae</strong> folder to your scope, you may be presented with a <strong class="bold">Proxy history logging</strong> dialog box, as follows. You may choose to avoid collecting messages out of your scope by clicking <strong class="bold">Yes</strong>, or you may choose to continue to have the <strong class="bold">Proxy HTTP History</strong> tab collect any messages passing through Burp, even if those messages fall outside the scope you’ve identified. For our purposes, we will <span class="No-Break">select </span><span class="No-Break"><strong class="bold">Yes</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<img src="image/B21173_Figure_2.2.jpg" alt="Figure 2.2 – Proxy history prompt"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Proxy history prompt</p>
			<ol>
				<li value="3">Clicking the <strong class="bold">Target</strong> | <strong class="bold">Scope settings</strong> tabs, after the pop-out menu displays, you should now see <span class="No-Break">the following:</span></li>
			</ol>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<img src="image/B21173_Figure_2.3.jpg" alt="Figure 2.3 – Clicking the Scope settings to have a pop-out display appear"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Clicking the Scope settings to have a pop-out display appear</p>
			<p>The full URL for OWASP Mutillidae II is shown in the <strong class="bold">Include in scope</strong> table of <strong class="bold">Project</strong> | <strong class="bold">Scope</strong>, <span class="No-Break">as follows:</span></p>
			<p class="IMG---Figure"><a id="_idTextAnchor088"/></p>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<img src="image/B21173_Figure_2.4.jpg" alt="Figure 2.4 – Pop-out display showing scope set to target applicatio﻿n"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Pop-out display showing scope set to target applicatio<a id="_idTextAnchor089"/>n</p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor090"/>How it works...</h2>
			<p>Setting <a id="_idIndexMarker049"/>scope is important for a clearer understanding of traffic flow through Burp from your target. Once properly scoped, all HTTP traffic can be seen in your <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> and Burp’s <strong class="bold">Proxy</strong> | <strong class="bold">HTTP history</strong> tabs. Details within individual requests and responses can be viewed using the <span class="No-Break">message edito<a id="_idTextAnchor091"/>r<a id="_idTextAnchor092"/>.</span></p>
			<h1 id="_idParaDest-46"><a id="_idTextAnchor093"/>Understanding the message editor</h1>
			<p>On almost every tool and tab within Burp Suite that displays an HTTP message, you will see an editor identifying the request and response. This is commonly referred to as the <strong class="bold">message editor</strong>. The <a id="_idIndexMarker050"/>message editor allows viewing and editing HTTP requests and responses <span class="No-Break">with specialties.</span></p>
			<p>Within the message editor are multiple subtabs. The subtabs for a request message, at a minimum, include <span class="No-Break">the following:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="bold">Pretty</strong></span></li>
				<li><span class="No-Break"><strong class="bold">Raw</strong></span></li>
				<li><span class="No-Break"><strong class="bold">Hex</strong></span></li>
			</ul>
			<p>The <a id="_idIndexMarker051"/>subtabs for a response message include <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="bold">Pretty</strong>: The <strong class="bold">Pretty</strong> subtab gives you the same information as <strong class="bold">Raw</strong> but in a more readable format. Please note the <strong class="bold">Pretty</strong> subtab may be disabled. This is due to the supported formats. For the <strong class="bold">Pretty</strong> subtab to be enabled, the message must be in one of the <span class="No-Break">following formats:</span><ul><li><span class="No-Break">JSON</span></li><li>XML (including image/SVG + <span class="No-Break">XML content)</span></li><li><span class="No-Break">HTML</span></li><li><span class="No-Break">CSS</span></li><li><span class="No-Break">JavaScript</span></li></ul></li>
				<li><strong class="bold">Raw</strong>: The <strong class="bold">Raw</strong> subtab gives you the message in its raw <span class="No-Break">HTTP form.</span></li>
				<li><strong class="bold">Hex</strong>: The <strong class="bold">Hex</strong> subtab, which presents the message in hexadecimal format; it is, in essence, a hex editor. You are permitted to edit individual bytes within tools such as <strong class="bold">Proxy</strong> and <strong class="bold">Repeater</strong>, but those values must be given in two-digit hexadecimal form, from <strong class="source-inline">00</strong> <span class="No-Break">through </span><span class="No-Break"><strong class="source-inline">FF</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">Render</strong> (sometimes): Finally, the <strong class="bold">Render</strong> subtab can be grayed out or viewable depending on the HTTP response content type. This subtab is only enabled when the response returned is HTML, giving you the same view as if seen from <span class="No-Break">a bro<a id="_idTextAnchor094"/>w<a id="_idTextAnchor095"/>ser.</span></li>
			</ul>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor096"/>Getting ready</h2>
			<p>Let’s explore the multiple tabs available in the message editor for each request and response captured in Burp. An important distinction to note—messages inside the message editor from the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> and the <strong class="bold">Proxy</strong> | <strong class="bold">HTTP History</strong> tabs are <em class="italic">not</em> editable. Both of these areas preserve the state of traffic flowing through Burp. If you wish to <em class="italic">edit</em> any message, you must send the individual message to some other tool within Burp—such as <strong class="bold">Repeater</strong>, <strong class="bold">Intruder</strong>, and so on—where you are able to <span class="No-Break"><em class="italic">edit</em></span><span class="No-Break"> val<a id="_idTextAnchor097"/>u<a id="_idTextAnchor098"/>es.</span></p>
			<h2 id="_idParaDest-48"><a id="_idTextAnchor099"/>How to do it...</h2>
			<p>Ensure you have traffic <a id="_idIndexMarker052"/>flowing between your browser, Burp, and the OWASP <span class="No-Break">BWA VM.</span></p>
			<ol>
				<li>Looking at the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> tab, notice the message editor section. Let’s focus on the <strong class="bold">Request</strong> side of the <span class="No-Break">message first:</span></li>
			</ol>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<img src="image/B21173_Figure_2.5.jpg" alt="Figure 2.5 – Message editor viewing a request"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – Message editor viewing a request</p>
			<ol>
				<li value="2">When viewing a request, note that the subtabs available include <strong class="bold">Pretty</strong>, <strong class="bold">Raw</strong>, and <strong class="bold">Hex</strong>. To see other values, such as cookies, attributes, and parameters, use the <strong class="bold">Inspector</strong> side tab. The <strong class="bold">Inspector</strong> tab can be expanded or collapsed by clicking the three lines above the <span class="No-Break">word </span><span class="No-Break"><strong class="bold">INSPECTOR</strong></span><span class="No-Break">.</span></li>
			</ol>
			<p>The <strong class="bold">Inspector</strong> tab is <span class="No-Break">now collapsed:</span></p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<img src="image/B21173_Figure_2.6.jpg" alt="Figure 2.6 – Message editor with Inspector collapsed"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – Message editor with Inspector collapsed</p>
			<p>The <strong class="bold">Inspector</strong> tab is <span class="No-Break">now expanded:</span></p>
			<div>
				<div id="_idContainer034" class="IMG---Figure">
					<img src="image/B21173_Figure_2.7.jpg" alt="Figure 2.7 – Message editor with Inspector expanded"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Message editor with Inspector expanded</p>
			<p>Once expanded, attributes, parameters, cookies, and headers are enumerated. Each section can be expanded as a dropdown to display the individual section information. For<a id="_idIndexMarker053"/> example, to see all cookies used in this request, expand the <strong class="bold">Request cookies</strong> subsection showing the number <strong class="bold">4</strong> to indicate there are four cookies used in <span class="No-Break">this request:</span></p>
			<div>
				<div id="_idContainer035" class="IMG---Figure">
					<img src="image/B21173_Figure_2.8.jpg" alt="Figure 2.8 – Inspector view with Request cookies subsection expanded"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Inspector view with Request cookies subsection expanded</p>
			<ol>
				<li value="3">The other side <a id="_idIndexMarker054"/>of the message is the <strong class="bold">Response</strong> tab, containing the <strong class="bold">Pretty</strong>, <strong class="bold">Raw</strong>, and <strong class="bold">Hex</strong> subtabs and, sometimes, <strong class="bold">Render</strong>. If the content is HTML, then the <strong class="bold">Render</strong> subtab provides an HTML display as it would be presented in a browser. The <strong class="bold">Inspector</strong> side tab is also available with the same information as previously described in the <strong class="bold">Request</strong> portion of <span class="No-Break">the message:</span><a id="_idTextAnchor100"/></li>
			</ol>
			<div>
				<div id="_idContainer036" class="IMG---Figure">
					<img src="image/B21173_Figure_2.9.jpg" alt="Figure 2.9 – Message editor viewing a response with Inspector collaps﻿ed"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – Message editor viewing a response with Inspector collaps<a id="_idTextAnchor101"/>ed</p>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor102"/>Repeating with Repeater</h1>
			<p><strong class="bold">Repeater</strong> allows <a id="_idIndexMarker055"/>for slight changes or tweaks to a request, and it is displayed in the left-hand window. The <strong class="bold">Send</strong> button allows a request to be reissued, and the response is displayed in the <span class="No-Break">right-hand window.</span></p>
			<p>Details related to your HTTP request include standard message editor details such as <strong class="bold">Pretty</strong>, <strong class="bold">Raw</strong>, and <strong class="bold">Hex</strong> as subtabs along with the <strong class="bold">Inspector</strong> <span class="No-Break">side tab.</span></p>
			<p>Details related to the HTTP response include standard message editor details including <strong class="bold">Pretty</strong>, <strong class="bold">Raw</strong>, and <strong class="bold">Hex</strong> as subtabs along with the <strong class="bold">Inspector</strong> side tab and, <span class="No-Break">sometimes, </span><span class="No-Break"><strong class="bold">Render</strong></span><span class="No-Break">.</span></p>
			<p>At the bottom of each panel is a search box, allowing the tester to quickly find a value present in <span class="No-Break">a messag<a id="_idTextAnchor103"/>e:</span></p>
			<div>
				<div id="_idContainer037" class="IMG---Figure">
					<img src="image/B21173_Figure_2.10.jpg" alt="Figure 2.10 – Search box at the bottom of the request in Repeater"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – Search box at the bottom of the request in Repeater</p>
			<p>There are<a id="_idIndexMarker056"/> additional search box settings available when the gear icon is clicked, including <strong class="bold">Case sensitive</strong>, <strong class="bold">Regex</strong>, and <strong class="bold">Auto-scroll to match when text changes</strong>. When searching for text, if case sensitivity is necessary, then the option can be toggled ON. In addition to searching for plain text strings, users can use <strong class="bold">regular expression</strong> (<strong class="bold">regex</strong>) patterns<a id="_idIndexMarker057"/> when matching a value present in a message. Finally, the auto-scroll feature, when checked, will automatically move to the position of the value the user <span class="No-Break">is searching:</span></p>
			<div>
				<div id="_idContainer038" class="IMG---Figure">
					<img src="image/B21173_Figure_2.11..jpg" alt="Figure 2.11 – Additional search box settings availa﻿ble"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Additional search box settings availa<a id="_idTextAnchor104"/>ble</p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor105"/>Getting ready</h2>
			<p><strong class="bold">Repeater</strong> allows <a id="_idIndexMarker058"/>you to manually modify and then re-issue an individual HTTP request, analyzing the response that <span class="No-Break">you rec<a id="_idTextAnchor106"/>e<a id="_idTextAnchor107"/>ive.</span></p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor108"/>How to do it...</h2>
			<ol>
				<li>From the <strong class="bold">Target</strong> | <strong class="bold">Site map</strong> or <strong class="bold">Proxy</strong> | <strong class="bold">HTTP history</strong> tabs (shown in the following screenshot), right-click a message and select <strong class="bold">Send </strong><span class="No-Break"><strong class="bold">to Repeater</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer039" class="IMG---Figure">
					<img src="image/B21173_Figure_2.12..jpg" alt="Figure 2.12 – Contextual menu to send the request to Repeater from Proxy HTTP history"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – Contextual menu to send the request to Repeater from Proxy HTTP history</p>
			<ol>
				<li value="2">Switch over <a id="_idIndexMarker059"/>to the <strong class="bold">Repeater</strong> tab. The <strong class="bold">Request</strong> is now in <strong class="bold">Repeater</strong> and is ready for  <span class="No-Break">parameter tweaking.</span></li>
			</ol>
			<div>
				<div id="_idContainer040" class="IMG---Figure">
					<img src="image/B21173_Figure_2.13..jpg" alt="Figure 2.13 – Request in Repeater, ready for tweaking"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Request in Repeater, ready for tweaking</p>
			<p>We will<a id="_idIndexMarker060"/> use <strong class="bold">Repeater</strong> quite a bit throughout this book. This chapter is just an introduction to <strong class="bold">Repeater</strong> and to understand its purpose. With regard to purpose, please note the main difference between <strong class="bold">Repeater</strong> and <strong class="bold">Intruder</strong> is the number of requests you can send at one time. If you are experimenting with slight changes to identify exposure points, <strong class="bold">Repeater</strong> is very handy. Once a pattern is established, <strong class="bold">Intruder</strong> can then be used to brute-force your vulnerable parameter over and over again with <span class="No-Break">many requ<a id="_idTextAnchor109"/>e<a id="_idTextAnchor110"/>sts.</span></p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor111"/>Decoding with Decoder</h1>
			<p><strong class="bold">Burp Decoder</strong> is a<a id="_idIndexMarker061"/> tool that allows the tester to convert raw data into encoded data or to take encoded data and convert it back to plain text. <strong class="bold">Decoder</strong> supports several formats, including URL encoding, HTML encoding, Base64 encoding, binary code, hashed data, and others. <strong class="bold">Decoder</strong> also includes a built-in <span class="No-Break">hex e<a id="_idTextAnchor112"/>d<a id="_idTextAnchor113"/>itor.</span></p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor114"/>Getting ready</h2>
			<p>As a web <a id="_idIndexMarker062"/>penetration test progresses, a tester might happen upon an encoded value. Burp eases the decoding process by allowing the tester to send the encoded value to <strong class="bold">Decoder</strong> and try the various decoding <span class="No-Break">functions ava<a id="_idTextAnchor115"/>i<a id="_idTextAnchor116"/>lable.</span></p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor117"/>How to do it...</h2>
			<p>Let’s try to decode the value of the <strong class="source-inline">PHPSESSID</strong> session token found in the OWASP Mutillidae II application. When a user initially browses to the URL (<strong class="source-inline">http://&lt;Your_VM_Assigned_IP_Address&gt;/mutillidae/</strong>), that user will be assigned a <strong class="source-inline">PHPSESSID</strong> cookie. The <strong class="source-inline">PHPSESSID</strong> value appears to be encrypted and then wrapped in Base64 encoding. Using <strong class="bold">Decoder</strong>, we can unwrap <span class="No-Break">the value:</span></p>
			<ol>
				<li>Browse to the <span class="No-Break"><strong class="source-inline">http://&lt;Your_VM_Assigned_IP_Address&gt;/mutillidae/</strong></span><span class="No-Break"> application.</span></li>
				<li>Find the HTTP request you just generated from your browser within the <strong class="bold">Proxy</strong> | <strong class="bold">HTTP history</strong> tab (shown in the next screenshot). Highlight the <strong class="source-inline">PHPSESSID</strong> value itself, not the parameter name, right-click, and then select <strong class="bold">Send </strong><span class="No-Break"><strong class="bold">to Decoder</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer041" class="IMG---Figure">
					<img src="image/B21173_Figure_2.14..jpg" alt="Figure 2.14 – Contextual menu to send ﻿the highlighted value in ﻿the request to Decoder from ﻿the Proxy HTTP history"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Contextual menu to send the highlighted value in the request to Decoder from the Proxy HTTP history</p>
			<ol>
				<li value="3">In the <strong class="bold">Decoder</strong> tab, in<a id="_idIndexMarker063"/> the <strong class="bold">Decode as…</strong> dropdown shown as follows, select <strong class="bold">Base64</strong>. Note the results <span class="No-Break">are encrypted:</span></li>
			</ol>
			<div>
				<div id="_idContainer042" class="IMG---Figure">
					<img src="image/B21173_Figure_2.15..jpg" alt="Figure 2.15 – Highlighted value from request in Decoder and encode/decode options available"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Highlighted value from request in Decoder and encode/decode options available</p>
			<p>In this example, we cannot <a id="_idIndexMarker064"/>proceed any further. We can confirm the value was, indeed, wrapped in Base64. However, the value that is unwrapped is encrypted. The purpose of this recipe is to show you how you can use <strong class="bold">Decoder</strong> to manipulate <span class="No-Break">encoded v<a id="_idTextAnchor118"/>alues.</span></p>
			<h2 id="_idParaDest-55"><a id="_idTextAnchor119"/>There’s more...</h2>
			<p>PortSwigger added <strong class="bold">Decoder</strong> functionality to the <strong class="bold">Inspector</strong> side tab as well. This makes the manipulation of values easier to see within the full context of the request or response when viewed through the <span class="No-Break">message editor:</span></p>
			<div>
				<div id="_idContainer043" class="IMG---Figure">
					<img src="image/B21173_Figure_2.16..jpg" alt="Figure 2.16 – Using Inspector to perform encoding/dec﻿oding"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – Using Inspector to perform encoding/dec<a id="_idTextAnchor120"/>oding</p>
			<h1 id="_idParaDest-56"><a id="_idTextAnchor121"/>Intruding with Intruder</h1>
			<p><strong class="bold">Burp Intruder</strong> allows a<a id="_idIndexMarker065"/> tester to brute-force or fuzz specific portions of an HTTP message, using <span class="No-Break">customized payloads.</span></p>
			<p>To properly set up customized attacks in <strong class="bold">Intruder</strong>, a tester will need to use the settings available in the four subtabs <span class="No-Break">of </span><span class="No-Break"><strong class="bold">Intrud<a id="_idTextAnchor122"/>er</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer044" class="IMG---Figure">
					<img src="image/B21173_Figure_2.17..jpg" alt="Figure 2.17 – Intruder and subtabs avai﻿lable"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – Intruder and subtabs avai<a id="_idTextAnchor123"/>lable</p>
			<h2 id="_idParaDest-57"><a id="_idTextAnchor124"/>Getting ready</h2>
			<p>A tester may<a id="_idIndexMarker066"/> wish to fuzz or brute-force parameter values within a message. Burp <strong class="bold">Intruder</strong> eases this process by providing various intruder attack styles, payloads, <span class="No-Break">and o<a id="_idTextAnchor125"/>p<a id="_idTextAnchor126"/>tions.</span></p>
			<h2 id="_idParaDest-58"><a id="_idTextAnchor127"/>How to do it...</h2>
			<ol>
				<li>Browse to the login screen of Mutillidae and attempt to log in to the application. For example, type a username of <strong class="source-inline">admin</strong> and an invalid password <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">adminpass</strong></span><span class="No-Break">.</span></li>
				<li>Find the login attempt in the <strong class="bold">Proxy</strong> | <strong class="bold">HTTP history</strong> tab. Your request number (that is, the <strong class="bold">#</strong> sign on the left-hand side) will be different from the one shown next. Select the message that captured your attempt to <span class="No-Break">log in.</span></li>
				<li>As the login attempt message is highlighted in the <strong class="bold">HTTP history</strong> table, right-click the <strong class="bold">Request</strong> tab, and select <strong class="bold">Send </strong><span class="No-Break"><strong class="bold">to Intrud<a id="_idTextAnchor128"/>er</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer045" class="IMG---Figure">
					<img src="image/B21173_Figure_2.18..jpg" alt="Figure 2.18 – Contextual menu to send the request to Intruder from Proxy HTTP hi﻿story"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – Contextual menu to send the request to Intruder from Proxy HTTP hi<a id="_idTextAnchor129"/>story</p>
			<h3>Positions</h3>
			<p>The <strong class="bold">Positions</strong> subtab<a id="_idIndexMarker067"/> identifies where the payload markers are to be defined <a id="_idIndexMarker068"/>within the <strong class="bold">Payload</strong> | <strong class="bold">Positions</strong> section. The <strong class="bold">Positions</strong> subtab also identifies the Attack type and the default setting is Sniper, which will work for us in this recipe. For our purposes, click the <strong class="bold">Clear §</strong> button (that is, payload markers) from the right-hand side menu. Manually <a id="_idIndexMarker069"/>select the password field by highlighting it with your cursor. Now, click the <strong class="bold">Add §</strong> button on the right-hand side menu. You should have the payload markers wrapping around the<a id="_idIndexMarker070"/> password field <span class="No-Break">as fo<a id="_idTextAnchor130"/>llows:</span></p>
			<div>
				<div id="_idContainer046" class="IMG---Figure">
					<img src="image/B21173_Figure_2.19..jpg" alt="Figure 2.19 – Substitution marker placed on password value in the﻿ request"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Substitution marker placed on password value in the<a id="_idTextAnchor131"/> request</p>
			<h3>Payloads</h3>
			<p>After <a id="_idIndexMarker071"/>the <strong class="bold">Positions</strong> subtab is<a id="_idIndexMarker072"/> the <span class="No-Break"><strong class="bold">Payloads</strong></span><span class="No-Break"> subtab:</span></p>
			<div>
				<div id="_idContainer047" class="IMG---Figure">
					<img src="image/B21173_Figure_2.20..jpg" alt="Figure 2.20 – Intruder Payloads subtab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.20 – Intruder Payloads subtab</p>
			<p>The <strong class="bold">Payloads</strong> subtab <a id="_idIndexMarker073"/>identifies wordlist values or numbers you wish to be inserted into the positions you<a id="_idIndexMarker074"/> identified on the previous tab. There are several sections within the <strong class="bold">Payloads</strong> subtab, including <strong class="bold">Payload sets</strong>, <strong class="bold">Payload options</strong>, <strong class="bold">Payload processing</strong>, and <span class="No-Break"><strong class="bold">Paylo<a id="_idTextAnchor132"/>a<a id="_idTextAnchor133"/>d encoding</strong></span><span class="No-Break">.</span></p>
			<h4>Payload sets</h4>
			<p><strong class="bold">Payload sets</strong> allows <a id="_idIndexMarker075"/>for the setting of the number of payloads as well as the type. For our purposes, we will use the default settings for <strong class="bold">Sniper</strong>, seen on the previous subtab, <strong class="bold">Positions</strong>. This configuration will allow us to use one payload with a <strong class="bold">Payload type</strong> value of <span class="No-Break"><strong class="bold">Sim<a id="_idTextAnchor134"/>ple list</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer048" class="IMG---Figure">
					<img src="image/B21173_Figure_2.21..jpg" alt="Figure 2.21 – Payloads subtab allows Payload sets to be﻿ configured"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.21 – Payloads subtab allows Payload sets to be<a id="_idTextAnchor135"/> configured</p>
			<h4>Payload options</h4>
			<p>In the <strong class="bold">Payload options</strong> section, a <a id="_idIndexMarker076"/>tester can configure a custom payload or load a preconfigured one from <span class="No-Break">a file.</span></p>
			<p>For our purposes, we will add one value to our payload. In the textbox, type <strong class="source-inline">admin</strong>, and then click the <strong class="bold">Add</strong> button to create our <span class="No-Break">custom<a id="_idTextAnchor136"/> payload:</span></p>
			<div>
				<div id="_idContainer049" class="IMG---Figure">
					<img src="image/B21173_Figure_2.22..jpg" alt="Figure 2.22 – Values can be set in the simple list of this ﻿payload set"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.22 – Values can be set in the simple list of this <a id="_idTextAnchor137"/>payload set</p>
			<h4>Payload processing</h4>
			<p><strong class="bold">Payload processing</strong> is useful when <a id="_idIndexMarker077"/>configuring special rules to be used while <strong class="bold">Intruder</strong> substitutes payloads into payload marker positions. For this recipe, we do not need any special <span class="No-Break">payload-processi<a id="_idTextAnchor138"/>ng rules:</span></p>
			<div>
				<div id="_idContainer050" class="IMG---Figure">
					<img src="image/B21173_Figure_2.23..jpg" alt="Figure 2.23 – Payload processing allows for rules to be applied to payloads as they run through an intr﻿uder attack"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.23 – Payload processing allows for rules to be applied to payloads as they run through an intr<a id="_idTextAnchor139"/>uder attack</p>
			<h4>Payload encoding</h4>
			<p><strong class="bold">Payload encoding</strong> is applied <a id="_idIndexMarker078"/>to the payload value prior to sending the request to the web server. Many web servers may block offensive payloads (for example, <strong class="source-inline">&lt;script&gt;</strong> tags), so the encoding feature is a means to circumvent any <span class="No-Break">blacklist blocking.</span></p>
			<p>For this recipe’s purpose, leave the default <span class="No-Break">box<a id="_idTextAnchor140"/> checked:</span></p>
			<div>
				<div id="_idContainer051" class="IMG---Figure">
					<img src="image/B21173_Figure_2.24..jpg" alt="Figure 2.24 – Payload encoding to be applied to the payload value substituted at the substitution marker within e﻿ach request"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.24 – Payload encoding to be applied to the payload value substituted at the substitution marker within e<a id="_idTextAnchor141"/>ach request</p>
			<h3>Resource pool</h3>
			<p>After<a id="_idIndexMarker079"/> the <strong class="bold">Payloads</strong> subtab <a id="_idIndexMarker080"/>is the <strong class="bold">Resource </strong><span class="No-Break"><strong class="bold">pool</strong></span><span class="No-Break"> subtab:</span></p>
			<div>
				<div id="_idContainer052" class="IMG---Figure">
					<img src="image/B21173_Figure_2.25..jpg" alt="Figure 2.25 – Intruder Resource pool subtab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.25 – Intruder Resource pool subtab</p>
			<p>The <strong class="bold">Resource pool</strong> subtab is <a id="_idIndexMarker081"/>used to assign the number of threads to be used <a id="_idIndexMarker082"/>during an intruder attack. The default pool size is <strong class="bold">10</strong>, which is resource-dependent. This tab allows the creation and management of various pool sizes combined with throttling of fixed or <span class="No-Break">random delays:</span></p>
			<div>
				<div id="_idContainer053" class="IMG---Figure">
					<img src="image/B21173_Figure_2.26..jpg" alt="Figure 2.26 – Default resource pool configured in Intruder"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.26 – Default resource pool configured in Intruder</p>
			<p>Depending<a id="_idIndexMarker083"/> upon your target application’s level of fortitude, you <a id="_idIndexMarker084"/>may wish to create a new resource pool with less intrusive behavior and <span class="No-Break">network noise:</span></p>
			<div>
				<div id="_idContainer054" class="IMG---Figure">
					<img src="image/B21173_Figure_2.27..jpg" alt="Figure 2.27 – Creation of custom resource po﻿ol in Intruder"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.27 – Creation of custom resource po<a id="_idTextAnchor142"/>ol in Intruder</p>
			<h3>Settings</h3>
			<p>Finally, the <strong class="bold">Intruder</strong> | <strong class="bold">Settings</strong> tab <a id="_idIndexMarker085"/>provides attack table customizations, particularly related to <a id="_idIndexMarker086"/>responses captured such as specific error messages. There are several sections within the <strong class="bold">Intruder</strong> | <strong class="bold">Settings</strong> tab, including <strong class="bold">Save attack</strong>, <strong class="bold">Request headers</strong>, <strong class="bold">Error handling</strong>, <strong class="bold">Attack results</strong>, <strong class="bold">Grep - Match</strong>, <strong class="bold">Grep - Extract</strong>, <strong class="bold">Grep -  Payloads</strong>, <strong class="bold">Redirections</strong>, and <span class="No-Break"><strong class="bold">HTTP version</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer055" class="IMG---Figure">
					<img src="image/B21173_Figure_2.28..jpg" alt="Figure 2.28 – Intrud﻿er Settings tab"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.28 – Intrud<a id="_idTextAnchor143"/>er Settings tab</p>
			<h4>Save attack</h4>
			<p><strong class="bold">Save attack</strong> is an<a id="_idIndexMarker087"/> option allowing you to save your intruder attacks, configurations, and results to your project file. This feature is turned off, by default, to save space as the accumulation of attack data can become <span class="No-Break">quite</span><span class="No-Break"><a id="_idIndexMarker088"/></span><span class="No-Break"> large:</span></p>
			<div>
				<div id="_idContainer056" class="IMG---Figure">
					<img src="image/B21173_Figure_2.29..jpg" alt="Figure 2.29 – Saving your ﻿intruder attacks"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.29 – Saving your <a id="_idTextAnchor144"/>intruder attacks</p>
			<h4>Request headers</h4>
			<p><strong class="bold">Request headers</strong> offers <a id="_idIndexMarker089"/>configurations specific to header parameters while <strong class="bold">Intruder</strong> is running attacks. For this recipe, leave the default <a id="_idTextAnchor145"/><span class="No-Break">boxes checked:</span></p>
			<div>
				<div id="_idContainer057" class="IMG---Figure">
					<img src="image/B21173_Figure_2.30..jpg" alt="Figure 2.30 – Request header﻿s configurations"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.30 – Request header<a id="_idTextAnchor146"/>s configurations</p>
			<h4>Error handling</h4>
			<p><strong class="bold">Error handling</strong> is a <a id="_idIndexMarker090"/>configuration to tell <strong class="bold">Intruder</strong> how you want to handle network errors during an attack. The default settings are <strong class="source-inline">3</strong> retries and a pause of <strong class="source-inline">2000</strong> milliseconds before <span class="No-Break">each retry.</span></p>
			<p>For this recipe, leave the default <a id="_idTextAnchor147"/>setting as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer058" class="IMG---Figure">
					<img src="image/B21173_Figure_2.31..jpg" alt="Figure 2.31 ﻿– Error handling"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.31 <a id="_idTextAnchor148"/>– Error handling</p>
			<h4>Attack results</h4>
			<p>After <a id="_idIndexMarker091"/>starting the attack, <strong class="bold">Intruder</strong> creates an attack table. The <strong class="bold">Attack results</strong> section offers some settings around what is captured within <span class="No-Break">that table.</span></p>
			<p>For this recipe, leave the default s<a id="_idTextAnchor149"/>ettings as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer059" class="IMG---Figure">
					<img src="image/B21173_Figure_2.32..jpg" alt="Figure 2.32 – Attack﻿ results options"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.32 – Attack<a id="_idTextAnchor150"/> results options</p>
			<h4>Grep - Match</h4>
			<p><strong class="bold">Grep - Match</strong> is a<a id="_idIndexMarker092"/> highly useful feature that, when enabled, creates additional columns in the attack table results to quickly identify errors, exceptions, or even a custom string within <span class="No-Break">the response.</span></p>
			<p>For this recipe, leave the default s<a id="_idTextAnchor151"/>ettings as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer060" class="IMG---Figure">
					<img src="image/B21173_Figure_2.33..jpg" alt="Figure 2.33 – Grep - M﻿atch on keywords"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.33 – Grep - M<a id="_idTextAnchor152"/>atch on keywords</p>
			<h4>Grep - Extract</h4>
			<p><strong class="bold">Grep - Extract</strong>, when<a id="_idIndexMarker093"/> enabled, is another option for adding a column in the attack table whose label is specific to a string found in the response. This option differs from <strong class="bold">Grep - Match</strong> since <strong class="bold">Grep - Extract</strong> values are taken from an actual HTTP response, as opposed to an <span class="No-Break">arbitrary string.</span></p>
			<p>For this recipe, leave the default s<a id="_idTextAnchor153"/>ettings as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer061" class="IMG---Figure">
					<img src="image/B21173_Figure_2.34..jpg" alt="Figure 2.34 – Grep - Extract b﻿ased on response"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.34 – Grep - Extract b<a id="_idTextAnchor154"/>ased on response</p>
			<h4>Grep - Payloads</h4>
			<p><strong class="bold">Grep - Payloads</strong> provides <a id="_idIndexMarker094"/>you with the ability to add columns to the attack table in which responses contain reflections <span class="No-Break">of payloads.</span></p>
			<p>For this recipe, leave the default s<a id="_idTextAnchor155"/>ettings as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer062" class="IMG---Figure">
					<img src="image/B21173_Figure_2.35..jpg" alt="Figure 2.35 – Grep responses on payload values use﻿d in the request"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.35 – Grep responses on payload values use<a id="_idTextAnchor156"/>d in the request</p>
			<h4>Redirections</h4>
			<p><strong class="bold">Redirections</strong> instructs <strong class="bold">Intruder</strong> to never, conditionally, or always follow redirections. This feature is very <a id="_idIndexMarker095"/>useful, particularly when brute-forcing logins since a 302 redirect is generally an indication <span class="No-Break">of entry.</span></p>
			<p>For this recipe, leave the default settings as <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer063" class="IMG---Figure">
					<img src="image/B21173_Figure_2.36..jpg" alt="Figure 2.36 – Redi﻿rection behavior"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.36 – Redi<a id="_idTextAnchor157"/>rection behavior</p>
			<h4>HTTP version</h4>
			<p><strong class="bold">HTTP version</strong> instructs <strong class="bold">Intruder</strong> to use either <strong class="source-inline">HTTP/2</strong> or <strong class="source-inline">HTTP/1</strong> as the protocol during the attack. The <a id="_idIndexMarker096"/>default setting will use whichever protocol is currently used by the <span class="No-Break">target server:</span></p>
			<div>
				<div id="_idContainer064" class="IMG---Figure">
					<img src="image/B21173_Figure_2.37..jpg" alt="Figure 2.37 – HTTP protocol behavior"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.37 – HTTP protocol behavior</p>
			<p>Enable this feature if you wish to override the target’s project and use <strong class="source-inline">HTTP/1</strong> instead. Make sure to uncheck <strong class="bold">Default to HTTP/2 if the server supports it</strong> to force the <span class="No-Break"><strong class="source-inline">HTTP/1</strong></span><span class="No-Break"> protocol:</span></p>
			<div>
				<div id="_idContainer065" class="IMG---Figure">
					<img src="image/B21173_Figure_2.38..jpg" alt="Figure 2.38 – ﻿HTTP/2 override"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.38 – <a id="_idTextAnchor158"/>HTTP/2 override</p>
			<h4>Start attack button</h4>
			<p>Finally, we <a id="_idIndexMarker097"/>are ready to start <strong class="bold">Intruder</strong>. On either the <strong class="bold">Payloads</strong> or the <strong class="bold">Settings</strong> subtab, click the <strong class="bold">Start attack</strong> button <span class="No-Break">to begin:</span></p>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="image/B21173_Figure_2.39..jpg" alt="Figure 2.39 – Intruder’s Start attack button"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.39 – Intruder’s Start attack button</p>
			<p>When the attack starts, an attack results table will appear as a pop-out screen. This allows the tester to review all requests using the payloads within the payload marker positions. It also allows us to review all responses and columns showing <strong class="bold">Status code</strong>, <strong class="bold">Error</strong>, <strong class="bold">Timeout</strong>, <strong class="bold">Length</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="bold">Comment</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer067" class="IMG---Figure">
					<img src="image/B21173_Figure_2.40..jpg" alt="Figure 2.40 – Attack results table"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.40 – Attack results table</p>
			<p>For this recipe, we <a id="_idIndexMarker098"/>note that the payload of admin in the <strong class="source-inline">password</strong> parameter produced a status code of <strong class="source-inline">302</strong>, which is a redirect. This means we logged in to the Mutillidae <span class="No-Break">application successfully.</span></p>
			<p>Looking at <strong class="bold">Response</strong> | <strong class="bold">Render</strong> within the attack table allows us to see how the web application responded to our payload. As you can see, we are successfully logged in as <span class="No-Break">an admin:</span></p>
			<div>
				<div id="_idContainer068" class="IMG---Figure">
					<img src="image/B21173_Figure_2.41..jpg" alt="Figure 2.41 – The result of the intruder attack is a logged-in session"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.41 – The result of the intruder attack is a logged-in session</p>
		</div>
	</body></html>