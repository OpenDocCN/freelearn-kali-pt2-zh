<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer262">
<h1 class="chapter-number" id="_idParaDest-130"><a id="_idTextAnchor179"/>9</h1>
<h1 id="_idParaDest-131"><a id="_idTextAnchor180"/>File Recovery and Data Carving Tools</h1>
<p>Now that we’ve learned how to create forensic images of evidence, let’s look at the file recovery and data carving process, using specific tools in <span class="No-Break">Kali Linux.</span></p>
<p>File carving retrieves data and files from unallocated space using specific characteristics such as the file structure and file headers, instead of traditional metadata created by, or associated with, filesystems. A simple way to think of file carving is to think of an ice sculpture. It starts off with a huge block of ice, which, when given to a skilled individual, can be chipped away into a piece of art. In the same way, DFIR investigators and analysts can create a forensic image using any of the tools mentioned in the previous chapter, and then use a variety of tools to extract useful data and files from the acquired <span class="No-Break">forensic image.</span></p>
<p>In this chapter, we’ll cover the <span class="No-Break">following topics:</span></p>
<ul>
<li><span class="No-Break">File basics</span></li>
<li>Downloading sample files for the labs in <span class="No-Break">this chapter</span></li>
<li>Performing file recovery and data carving <span class="No-Break">using Foremost</span></li>
<li>Performing image recovery <span class="No-Break">with Magicrescue</span></li>
<li>Data carving <span class="No-Break">with Scalpel</span></li>
<li>Data extraction <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">bulk_extractor</strong></span></li>
<li>NTFS recovery <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">scrounge_ntfs</strong></span></li>
<li>JPEG recovery <span class="No-Break">using Recoverjpeg</span></li>
</ul>
<h1 id="_idParaDest-132"><a id="_idTextAnchor181"/>File basics</h1>
<p>Before we get<a id="_idIndexMarker748"/> started on the practical aspects, let’s briefly go through some <span class="No-Break">common terminology.</span></p>
<p>When we last covered filesystems in <a href="B19441_06.xhtml#_idTextAnchor093"><span class="No-Break"><em class="italic">Chapter 6</em></span></a><em class="italic">, Understanding File Systems and Storage</em>, we learned that various operating systems use their own filesystems to be able to store, access, and modify data. Storage media use file systems to do the <span class="No-Break">very same.</span></p>
<p><strong class="bold">Metadata</strong>, or data<a id="_idIndexMarker749"/> about data, helps an operating system identify data. Metadata includes technical information, such as the creation and modification dates, and the file type of the data. This data makes it much easier to locate and <span class="No-Break">index files.</span></p>
<p>As the name<a id="_idIndexMarker750"/> implies, <strong class="bold">unallocated space</strong> is an area of storage media that has been marked by an operating system or file table as empty, or unallocated to any file or data. Although the location of, and information about, the file is not present and sometimes corrupted, there are still characteristics about the file that reside in its header and footer that can identify the file, or even fragments of <span class="No-Break">the file.</span></p>
<p>Even if a file extension has been changed or is missing altogether, file headers contain information that can identify the file type and we can attempt to carve the file by analyzing the header and footer information. Data carving is quite a lengthy process and should be done using automated tools to save time. It also helps if the investigator has an idea of what file types they are looking for, giving them a better focus and saving time. Nevertheless, this is<a id="_idIndexMarker751"/> forensics, and we know that time and patience <span class="No-Break">are key.</span></p>
<p>Some <a id="_idIndexMarker752"/>common<a id="_idIndexMarker753"/> file types, as displayed in hexadecimal format within the file headers, include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Joint Photographic Experts Group (JPEG)</strong>: FF D8 <span class="No-Break">FF E0</span></li>
<li><strong class="bold">Portable Document Format (PDF)</strong>: 25 50 <span class="No-Break">44 46</span></li>
</ul>
<p>While more on the analysis of files and headers will be looked at in <a href="B19441_12.xhtml#_idTextAnchor225"><span class="No-Break"><em class="italic">Chapter 12</em></span></a>, <em class="italic">Autopsy Forensic Browser,</em> and <a href="B19441_13.xhtml#_idTextAnchor234"><span class="No-Break"><em class="italic">Chapter 13</em></span></a>, <em class="italic">Performing a Full DFIR Analysis with the Autopsy 4 GUI</em>, using Autopsy, let’s first download the sample files we will be using for data carving in <span class="No-Break">Kali Linux.</span></p>
<h1 id="_idParaDest-133"><a id="_idTextAnchor182"/>Downloading the sample files</h1>
<p>Before we begin <a id="_idIndexMarker754"/>our DFIR file recovery and data carving activities, I thought it would be a good idea to first have all sample files downloaded, which will allow us to jump straight into the specifics of using each tool without the process <span class="No-Break">being interrupted.</span></p>
<p>We will be using the following sites, which generously offer free datasets and acquisitions to the public. A special thank you to all that have compiled and invested their time and resources to make these datasets available <span class="No-Break">to us:</span></p>
<ul>
<li>Digital Forensics <a id="_idIndexMarker755"/>Tool Testing<a id="_idIndexMarker756"/> <span class="No-Break">Images: </span><a href="https://dftt.sourceforge.net/"><span class="No-Break">https://dftt.sourceforge.net/</span></a></li>
<li><strong class="bold">Computer Forensic Reference DataSets</strong> (<span class="No-Break"><strong class="bold">CFReDS</strong></span><span class="No-Break">): </span><a href="https://cfreds.nist.gov/"><span class="No-Break">https://cfreds.nist.gov/</span></a></li>
<li>Digital <a id="_idIndexMarker757"/><span class="No-Break">Corpora: </span><a href="https://digitalcorpora.org/"><span class="No-Break">https://digitalcorpora.org/</span></a></li>
<li>Foremost <a id="_idIndexMarker758"/>sample <a id="_idIndexMarker759"/><span class="No-Break">file: </span><a href="https://cfreds-archive.nist.gov/FileCarving/Images/L0_Documents.dd.bz2"><span class="No-Break">https://cfreds-archive.nist.gov/FileCarving/Images/L0_Documents.dd.bz2</span></a></li>
<li><span class="No-Break">Scalpel: </span><a href="http://prdownloads.sourceforge.net/dftt/11-carve-fat.zip?download"><span class="No-Break">http://prdownloads.sourceforge.net/dftt/11-carve-fat.zip?download</span></a></li>
<li>Bulk <a id="_idIndexMarker760"/><span class="No-Break">Extractor: </span><a href="https://digitalcorpora.s3.amazonaws.com/corpora/drives/nps-2010-emails/nps-2010-emails.E01"><span class="No-Break">https://digitalcorpora.s3.amazonaws.com/corpora/drives/nps-2010-emails/nps-2010-emails.E01</span></a></li>
</ul>
<p>Although only the preceding sample files will be used for our lab purposes, you are certainly free to download other sample files from the aforementioned sites and try to carve those images, using the following tools <span class="No-Break">where applicable.</span></p>
<h1 id="_idParaDest-134"><a id="_idTextAnchor183"/>File recovery and data carving with Foremost</h1>
<p>Foremost is <a id="_idIndexMarker761"/>a simple <a id="_idIndexMarker762"/>and <a id="_idIndexMarker763"/>effective <a id="_idIndexMarker764"/>CLI tool that carves and recovers files by reading the headers and footers of the files. We can start Foremost by clicking on <strong class="bold">Applications</strong> | <strong class="bold">11 - Forensics</strong> | <strong class="bold">Foremost</strong>. However, I prefer starting Foremost from the Terminal within the folder containing our sample acquired files, which will simplify the entire process without errors. So, let’s <span class="No-Break">get started:</span></p>
<ol>
<li>If you haven’t yet downloaded the sample forensic acquisition file, you can do so now by clicking on <span class="No-Break">this link:</span></li>
</ol>
<p><a href="https://cfreds-archive.nist.gov/FileCarving/Images/L0_Documents.dd.bz2"><span class="No-Break">https://cfreds-archive.nist.gov/FileCarving/Images/L0_Documents.dd.bz2</span></a></p>
<ol>
<li value="2">Once this file has been downloaded, I recommend creating a <em class="italic">new folder</em> in the <strong class="source-inline">Downloads</strong> folder by right-clicking in the <strong class="source-inline">Downloads</strong> folder and clicking on <strong class="bold">Create Folder</strong>. We will call this folder <strong class="source-inline">Foremost</strong>. We will also create folders for each tool as we move along in this chapter to avoid having a cluttered <strong class="source-inline">Downloads</strong> folder, and<a id="_idIndexMarker765"/> for the sake of having<a id="_idIndexMarker766"/> an <a id="_idIndexMarker767"/>organized <a id="_idIndexMarker768"/><span class="No-Break">DFIR workspace.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer220">
<img alt="Figure 9.1 – File downloads with the Downloads folder" height="275" src="image/Figure_9.01_B19441.jpg" width="325"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 – File downloads with the Downloads folder</p>
<ol>
<li value="3">Drag the <strong class="source-inline">L0_Documents.dd.bz2</strong> file into the <strong class="source-inline">Foremost</strong> folder that you just created. By default, the <strong class="source-inline">L0_Documents.dd.bz2</strong> file will be downloaded to your <strong class="source-inline">Downloads</strong> folder. The downloaded file is a compressed <strong class="source-inline">BunZip (.bz2)</strong> format and contains a <strong class="source-inline">datadump (.dd)</strong> acquisition file that must <span class="No-Break">be extracted.</span></li>
</ol>
<p>To extract the <strong class="source-inline">.dd</strong> file, right-click on the <strong class="source-inline">L0_Documents.dd.bz2</strong> file and click on the <strong class="bold">Extract Here</strong> option, as <span class="No-Break">shown here.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer221">
<img alt="Figure 9.2 – Extracting the downloaded files" height="375" src="image/Figure_9.02_B19441.jpg" width="414"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 – Extracting the downloaded files</p>
<p>You <a id="_idIndexMarker769"/>should <a id="_idIndexMarker770"/>now <a id="_idIndexMarker771"/>see<a id="_idIndexMarker772"/><a id="_idIndexMarker773"/> the <strong class="source-inline">L0_Documents.dd</strong> evidence file in your <span class="No-Break"><strong class="source-inline">Foremost</strong></span><span class="No-Break"> folder.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer222">
<img alt="Figure 9.3 – The extracted image file" height="168" src="image/Figure_9.03_B19441.jpg" width="335"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 – The extracted image file</p>
<ol>
<li value="4">Here’s the fun part! Let’s click on the <strong class="bold">New Terminal</strong> icon at the top of the screen to open a new Terminal and begin carving and recovering files from our forensic <span class="No-Break">acquisition sample.</span></li>
</ol>
<p>Once in the Terminal, we must change our working directory (using the <strong class="source-inline">cd</strong> command) to the <strong class="source-inline">Foremost</strong> folder within our <strong class="source-inline">Downloads</strong> folder. To do this, type<a id="_idIndexMarker774"/> the <a id="_idIndexMarker775"/>following <a id="_idIndexMarker776"/>commands<a id="_idIndexMarker777"/> in the Terminal and <span class="No-Break">press </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">:</span></p>
<pre class="source-code">
<strong class="bold">cd /Downloads/Foremost</strong></pre>
<p class="callout-heading">Important note</p>
<p class="callout">All commands are <em class="italic">case-sensitive</em> and should be typed exactly as I have <span class="No-Break">typed them.</span></p>
<ol>
<li value="5">Next, type <strong class="source-inline">ls</strong> to list and show the files to ensure that we are in the correct directory, where our files <span class="No-Break">are located.</span><pre class="source-code">
<strong class="bold">ls</strong></pre></li>
</ol>
<p>In the following screenshot, I’ve entered the aforementioned commands and can see the files we have downloaded <span class="No-Break">and extracted.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer223">
<img alt="Figure 9.4 – Using the ls command" height="113" src="image/Figure_9.04_B19441.jpg" width="378"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.4 – Using the ls command</p>
<ol>
<li value="6">To have a better understanding of Foremost and the switches used, try browsing the <strong class="bold">Foremost System Manager’s Manual</strong>. This can be done<a id="_idIndexMarker778"/> by entering <a id="_idIndexMarker779"/>the<a id="_idIndexMarker780"/> <span class="No-Break">following</span><span class="No-Break"><a id="_idIndexMarker781"/></span><span class="No-Break"> command:</span><pre class="source-code">
<strong class="bold">man foremost</strong></pre></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer224">
<img alt="Figure 9.5 – The Foremost help manual" height="525" src="image/Figure_9.05_B19441.jpg" width="711"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.5 – The Foremost help manual</p>
<ol>
<li value="7">The syntax for using Foremost is <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">foremost -i (forensic image) -o (output folder) -options</strong></pre></li>
<li>Using the <a id="_idIndexMarker782"/>preceding<a id="_idIndexMarker783"/> format, let’s enter the following command and options to carve files from the evidence file and recover them into a folder of <span class="No-Break">our choice:</span><pre class="source-code">
<strong class="bold">foremost -i L0_Documents.dd -o L0_Documents_Recovery</strong></pre></li>
</ol>
<p>In this example, we have specified the <strong class="source-inline">L0_documents.dd</strong> file as the input file <strong class="source-inline">(-i</strong>) and specified an empty folder named <strong class="source-inline">L0_Documents_Recovery</strong> as the output file (<strong class="source-inline">-o</strong>). Additionally, other switches can be specified <span class="No-Break">as needed.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer225">
<img alt="Figure 9.6 – Foremost command output" height="483" src="image/Figure_9.06_B19441.jpg" width="714"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.6 – Foremost command output</p>
<p>Although <a id="_idIndexMarker784"/>the<a id="_idIndexMarker785"/> characters in the preceding output may be unreadable, the carved files will be clearly categorized and summarized in the specified <span class="No-Break">output folder.</span></p>
<ol>
<li value="9">To view our carved files, click on the <strong class="bold">Home</strong> folder icon at the top of the screen, click on the <strong class="source-inline">Downloads</strong> folder, and then click on <strong class="bold">Open Folder</strong>. Double-click on your <strong class="source-inline">Foremost</strong> folder and then open the <span class="No-Break"><strong class="source-inline">LO_Documents_Recovery</strong></span><span class="No-Break"> folder.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer226">
<img alt="Figure 9.7 – The Foremost recovery folder" height="240" src="image/Figure_9.07_B19441.jpg" width="729"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.7 – The Foremost recovery folder</p>
<ol>
<li value="10">Foremost has<a id="_idIndexMarker786"/> automatically <a id="_idIndexMarker787"/>created <a id="_idIndexMarker788"/>subfolders for the <a id="_idIndexMarker789"/>relevant file types. To view a list of all files carved and recovered, open the <span class="No-Break"><strong class="source-inline">audit.txt</strong></span><span class="No-Break"> file.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer227">
<img alt="Figure 9.8 – The contents of the audit.txt file" height="438" src="image/Figure_9.08_B19441.jpg" width="714"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.8 – The contents of the audit.txt file</p>
<ol>
<li value="11">The <strong class="source-inline">audit.txt</strong> file tells us that there were nine files carved/recovered, including<a id="_idIndexMarker790"/> images, MS<a id="_idIndexMarker791"/> Office, and<a id="_idIndexMarker792"/> PDF documents. Feel free to <a id="_idIndexMarker793"/>browse the various subfolders to view the <span class="No-Break">carved files.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer228">
<img alt="Figure 9.9 – Recovered .xlsx documents" height="150" src="image/Figure_9.09_B19441.jpg" width="285"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.9 – Recovered .xlsx documents</p>
<p>Congratulations on your first successful DFIR recovery! Let us now move on to another recovery tool called <span class="No-Break">Magic Rescue.</span></p>
<h1 id="_idParaDest-135"><a id="_idTextAnchor184"/>Image recovery with Magicrescue</h1>
<p><strong class="bold">Magicrescue</strong> is an older <a id="_idIndexMarker794"/>tool that is still very useful, as it<a id="_idIndexMarker795"/> quickly scans and recovers certain file types that must be manually specified. For this lab, I’ll be using a 32-GB SanDisk flash drive, which once contained several audio, video, and image files that were all deleted <span class="No-Break">by accident:</span></p>
<ol>
<li>I’ll first run the <strong class="source-inline">fdisk</strong> command to view the device information by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">sudo fdisk -l</strong></pre></li>
</ol>
<p>The <strong class="source-inline">fdisk</strong> command output seen in the following screenshot shows that the flash drive is recognized <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">sdc2</strong></span><span class="No-Break">.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer229">
<img alt="Figure 9.10 – fdisk command output showing disk information" height="416" src="image/Figure_9.10_B19441.jpg" width="678"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.10 – fdisk command output showing disk information</p>
<ol>
<li value="2">Before <a id="_idIndexMarker796"/>we<a id="_idIndexMarker797"/> continue, it is useful to view the magicrescue help manual by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">man magicrescue</strong></pre></li>
</ol>
<p>The following figure shows the usage options <span class="No-Break">in magicrescue:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer230">
<img alt="Figure 9.11 – Magicrescue usage options" height="516" src="image/Figure_9.11_B19441.jpg" width="694"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.11 – Magicrescue usage options</p>
<ol>
<li value="3">To run magicrescue<a id="_idIndexMarker798"/> and<a id="_idIndexMarker799"/> search and recover files, we must first know which file types can be recovered. I’ve navigated to the <strong class="source-inline">usr</strong> | <strong class="source-inline">share</strong> | <strong class="source-inline">magicrescue</strong> | <strong class="source-inline">recipes</strong> folder, which shows the recipes or file types available for recovery by magicrescue. These <em class="italic">recipes</em>, as they are called, must be manually specified when using the <span class="No-Break"><strong class="source-inline">magicrescue</strong></span><span class="No-Break"> command.</span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer231">
<img alt="Figure 9.12 – Magicrescue recipe types" height="456" src="image/Figure_9.12_B19441.jpg" width="1068"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.12 – Magicrescue recipe types</p>
<ol>
<li value="4">To use magicrescue to recover JPEG files from my flash drive, recognized as <strong class="source-inline">sdb2</strong>, I’ll first create a folder on my desktop called <strong class="source-inline">Rescue</strong>, which will be the destination to which to<a id="_idIndexMarker800"/> save<a id="_idIndexMarker801"/> my <span class="No-Break">recovered files.</span></li>
<li>In a new Terminal, change to the <strong class="source-inline">Desktop</strong> directory by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">cd Desktop</strong></pre></li>
<li>Then, create a new folder by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">mkdir Rescue</strong></pre></li>
<li>Change to the <strong class="source-inline">Rescue</strong> directory by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">cd Rescue</strong></pre></li>
</ol>
<p>The following screenshot shows the output within the Terminal when <span class="No-Break">changing directories.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer232">
<img alt="Figure 9.13 – Changing working directories" height="207" src="image/Figure_9.13_B19441.jpg" width="371"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.13 – Changing working directories</p>
<ol>
<li value="8">To use Magic Rescue to recover files from my <strong class="source-inline">sdb2</strong> drive into the <strong class="source-inline">Rescue</strong> folder on the desktop, I’ll type the following command with specific recipe options for <span class="No-Break">image files:</span><pre class="source-code">
<strong class="bold">sudo magicrescue -r png -r jpeg-jfif -r jpeg-exif -d recovered -M io /dev/sdc &gt; logs</strong></pre></li>
</ol>
<p>Once run, Kali <a id="_idIndexMarker802"/>will <a id="_idIndexMarker803"/>output the details of the recovered files, as shown in the <span class="No-Break">following screenshot.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer233">
<img alt="Figure 9.14 – Magicrescue file carving and recovery" height="310" src="image/Figure_9.14_B19441.jpg" width="734"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.14 – Magicrescue file carving and recovery</p>
<ol>
<li value="9">We can now open the <strong class="source-inline">Rescue</strong> folder on the desktop to view the recovered files. As shown in the following screenshot, several deleted images were <span class="No-Break">quickly recovered.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer234">
<img alt="Figure 9.15 – Carved and recovered files" height="610" src="image/Figure_9.15_B19441.jpg" width="921"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.15 – Carved and recovered files</p>
<p>Let’s now move on <a id="_idIndexMarker804"/>to <a id="_idIndexMarker805"/>another popular and powerful file carving tool <span class="No-Break">called Scalpel.</span></p>
<h1 id="_idParaDest-136"><a id="_idTextAnchor185"/>Data carving with Scalpel</h1>
<p><strong class="bold">Scalpel</strong> was created <a id="_idIndexMarker806"/>as an<a id="_idIndexMarker807"/> improvement of a much earlier version of Foremost. Scalpel aims to address the high CPU and RAM usage issues of Foremost when <span class="No-Break">carving data.</span></p>
<p>Unlike Foremost, file types of interest must be specified by an investigator in the Scalpel configuration file. This file is called <strong class="source-inline">scalpel.conf</strong> and is located <span class="No-Break">at </span><span class="No-Break"><strong class="source-inline">etc/scapel/</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer235">
<img alt="Figure 9.16 – The Scalpel configuration file" height="145" src="image/Figure_9.16_B19441.jpg" width="692"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.16 – The Scalpel configuration file</p>
<p>To specify the file types, the investigator must remove the comments at the start of the<em class="italic"> </em>line containing the file type, as all supported file types are commented out with a hashtag at the beginning of the file type. The following screenshot shows the default Scalpel <a id="_idIndexMarker808"/>configuration file (<strong class="source-inline">scalpel.conf</strong>) with all file types commented <a id="_idIndexMarker809"/>out. Note that each line begins with <span class="No-Break">a hashtag:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer236">
<img alt="Figure 9.17 – Scalpel file types within the conf file" height="463" src="image/Figure_9.17_B19441.jpg" width="689"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.17 – Scalpel file types within the conf file</p>
<p>I’ve removed the hashtags at the beginning of some of the lines to let Scalpel know to search for these specific file types; this also reduces the time taken to otherwise search for all supported file types. The following screenshot (<span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.17</em>) shows that Scalpel will be searching for GIF, PNG, and TIFF files, as the comments have been removed. I have also removed hashtags from all video, MS Office, email, and PDF file types to allow Scalpel to search for additional file types. If you are having issues with saving the changes to the file, this may have to be done as a user with <span class="No-Break">root access:</span></p>
<ol>
<li>For this lab, we will use the <strong class="source-inline">11-carve-fat.dd</strong> evidence file that we previously downloaded. If you did not do so, you can do so now by clicking on the <span class="No-Break">following link:</span></li>
</ol>
<p><a href="http://prdownloads.sourceforge.net/dftt/11-carve-fat.zip?download"><span class="No-Break">http://prdownloads.sourceforge.net/dftt/11-carve-fat.zip?download</span></a></p>
<p>The <a id="_idIndexMarker810"/>file<a id="_idIndexMarker811"/> downloads as a <strong class="source-inline">.zip</strong> file and must be extracted before <span class="No-Break">being used.</span></p>
<ol>
<li value="2">In the <strong class="source-inline">Downloads</strong> folder, right-click on the <strong class="source-inline">11-carve-fat.zip</strong> file and click on the <strong class="bold">Extract Here</strong> option, which will then extract the <strong class="source-inline">11-carve-fat.zip</strong> file to the <span class="No-Break"><strong class="source-inline">Downloads</strong></span><span class="No-Break"> folder.</span></li>
<li>Let’s use the Terminal to change directories to the <strong class="source-inline">Downloads</strong> folder like we did when using Foremost by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">cd Downloads</strong></pre></li>
<li>To view the available options and their usage in Scalpel, type the <span class="No-Break">following command:</span><pre class="source-code">
<strong class="bold">scalpel -h</strong></pre></li>
</ol>
<p>As we can see in the following screenshot, we have many options available to us for carving and recovery when <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">scalpel</strong></span><span class="No-Break">.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer237">
<img alt="Figure 9.18 – Scalpel usage options" height="530" src="image/Figure_9.18_B19441.jpg" width="664"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.18 – Scalpel usage options</p>
<ol>
<li value="5">To run <a id="_idIndexMarker812"/>Scalpel <a id="_idIndexMarker813"/>against our sample evidence file, type the <span class="No-Break">following command:</span><pre class="source-code">
<strong class="bold">scalpel -o scalpelOutput/ 11-carve-fat.dd</strong></pre></li>
</ol>
<p>The following screenshot shows the output of the previously <span class="No-Break">used command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer238">
<img alt="Figure 9.19 – Scalpel carving command" height="113" src="image/Figure_9.19_B19441.jpg" width="502"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.19 – Scalpel carving command</p>
<p>The following screenshot shows the continued output of the command that we <span class="No-Break">just used.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer239">
<img alt="Figure 9.20 – Scalpel command output" height="315" src="image/Figure_9.20_B19441.jpg" width="743"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.20 – Scalpel command output</p>
<p>In the <a id="_idIndexMarker814"/>previous <a id="_idIndexMarker815"/>screenshot (<span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.20</em>), we can see that Scalpel builds a carve list, showing the file type with header and footer information, as well as the number of <span class="No-Break">files carved.</span></p>
<p>Taking a closer look at the last few lines produced by the Scalpel output, we can see that the carving process was 100% complete, with 18 files <span class="No-Break">being carved:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer240">
<img alt="Figure 9.21 – A snippet of the Scalpel command output" height="78" src="image/Figure_9.21_B19441.jpg" width="740"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.21 – A snippet of the Scalpel command output</p>
<ol>
<li value="6">We can now open the <strong class="source-inline">scalpelOutput</strong> folder to view our carved files. The results of the Scalpel output are similar to that of Foremost, with both output folders containing various subfolders with carved files, along with an <strong class="source-inline">audit.txt</strong> file with details of <span class="No-Break">the findings:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer241">
<img alt="Figure 9.22 – Carved contents within the scalpelOutput folder" height="164" src="image/Figure_9.22_B19441.jpg" width="544"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.22 – Carved contents within the scalpelOutput folder</p>
<p>Foremost, magicrescue, and Scalpel, as we’ve seen so far, are quite impressive at file carving and <a id="_idIndexMarker816"/>data <a id="_idIndexMarker817"/>recovery; however, they are limited to specific file types only. For further extraction of data, we will now look at another tool <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">bulk_extractor</strong></span><span class="No-Break">.</span></p>
<h1 id="_idParaDest-137"><a id="_idTextAnchor186"/>Data extraction with bulk_extractor</h1>
<p>The <strong class="source-inline">bulk_extractor</strong> tool extracts <a id="_idIndexMarker818"/>several additional types of information<a id="_idIndexMarker819"/> that can be very useful in investigations. Although <strong class="source-inline">bulk_extractor</strong> is quite capable of recovering and carving image, video, and document files, other data that can be carved and extracted by <strong class="source-inline">bulk_extractor</strong> includes <span class="No-Break">the following:</span></p>
<ul>
<li>Credit <span class="No-Break">card numbers</span></li>
<li><span class="No-Break">Email addresses</span></li>
<li><span class="No-Break">URLs</span></li>
<li><span class="No-Break">Online searches</span></li>
<li>Social media profiles <span class="No-Break">and information</span></li>
</ul>
<p>For this example, we will work with a freely available evidence file <span class="No-Break">named </span><span class="No-Break"><strong class="source-inline">nps-2010-emails.E01</strong></span><span class="No-Break">:</span></p>
<ol>
<li>The <strong class="source-inline">nps-2010-emails.E01</strong> file can be downloaded directly from the digital corpora website, which allows the use of forensic evidence images for forensic <span class="No-Break">research purposes.</span></li>
</ol>
<p>If not <a id="_idTextAnchor187"/>already downloaded, the file can be downloaded <span class="No-Break">at </span><a href="https://digitalcorpora.s3.amazonaws.com/corpora/drives/nps-2010-emails/nps-2010-emails.E01"><span class="No-Break">https://digitalcorpora.s3.amazonaws.com/corpora/drives/nps-2010-emails/nps-2010-emails.E01</span></a><span class="No-Break">.</span></p>
<ol>
<li value="2">Once downloaded, open a new Terminal and change to the <strong class="source-inline">Downloads</strong> folder, just as we<a id="_idIndexMarker820"/> previously<a id="_idIndexMarker821"/> did. You can view the available options and usage by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">bulk_extractor -h</strong></pre></li>
</ol>
<p>The following screenshot shows the output of the previously <span class="No-Break">used command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer242">
<img alt="Figure 9.23 – bulk_extractor usage options" height="312" src="image/Figure_9.23_B19441.jpg" width="709"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.23 – bulk_extractor usage options</p>
<ol>
<li value="3">Like Foremost and Scalpel, the syntax for using <strong class="source-inline">bulk_extractor</strong> is quite simple and requires that an output folder (<strong class="source-inline">-o</strong>) and the forensic image be specified. Let us now use <strong class="source-inline">bulk_extractor</strong> to carve the evidence file and save all discovered files and information to a folder named <strong class="source-inline">bulk_carved</strong> in the <strong class="source-inline">Downloads</strong> folder, by typing the <span class="No-Break">following command:</span><pre class="source-code">
<strong class="bold">bulk_extractor -o bulk_carved nps-2010-emails.E01</strong></pre></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer243">
<img alt="Figure 9.24 – bulk_extractor command output" height="392" src="image/Figure_9.24_B19441.jpg" width="712"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.24 – bulk_extractor command output</p>
<ol>
<li value="4">Once <a id="_idIndexMarker822"/>completed, <strong class="source-inline">bulk_extractor</strong> indicates that all<a id="_idIndexMarker823"/> threads have finished and provides a summary of the process and even some findings. The last line in the following screenshot lists 67 found <span class="No-Break">email features:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer244">
<img alt="Figure 9.25 – A snippet of the bulk_extractor output" height="284" src="image/Figure_9.25_B19441.jpg" width="706"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.25 – A snippet of the bulk_extractor output</p>
<ol>
<li value="5">To view the output<a id="_idIndexMarker824"/> and <a id="_idIndexMarker825"/>findings of <strong class="source-inline">bulk_extractor</strong>, we can change our directory to the <strong class="source-inline">bulk_carved</strong> folder in <strong class="source-inline">Downloads</strong> and use the <strong class="source-inline">ls -l</strong> command. In the following screenshot, we can see that several text files such as <strong class="source-inline">domain_histogram.txt</strong>, <strong class="source-inline">domain.txt</strong>, <strong class="source-inline">email_domain_histogram.txt</strong>, and <strong class="source-inline">email.txt</strong> contain data, as their file sizes are greater <span class="No-Break">than zero:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer245">
<img alt="Figure 9.26 – A list of files carved by bulk_extractor" height="397" src="image/Figure_9.26_B19441.jpg" width="571"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.26 – A list of files carved by bulk_extractor</p>
<ol>
<li value="6">We can<a id="_idIndexMarker826"/> also<a id="_idIndexMarker827"/> open our <strong class="source-inline">bulk_carved</strong> folder and double-click on text files containing data. Note that not all files will contain information. Files with a file size of <em class="italic">zero</em> will contain <span class="No-Break">no information.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer246">
<img alt="Figure 9.27 – Carved files within the bulk_extractor output folder" height="460" src="image/Figure_9.27_B19441.jpg" width="647"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.27 – Carved files within the bulk_extractor output folder</p>
<p>Let’s have <a id="_idIndexMarker828"/>a look <a id="_idIndexMarker829"/>at the <strong class="source-inline">email.txt</strong> file, as shown in the following screenshot. We can see several email addresses and attachment details were carved <span class="No-Break">by </span><span class="No-Break"><strong class="source-inline">bulk_extractor</strong></span><span class="No-Break">.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer247">
<img alt="Figure 9.28 – Content within the carved email.txt file" height="502" src="image/Figure_9.28_B19441.jpg" width="683"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.28 – Content within the carved email.txt file</p>
<p>Now that we’ve<a id="_idIndexMarker830"/> covered some of the most popular file <a id="_idIndexMarker831"/>carving tools, let’s have a look at<em class="italic"> </em>a file recovery tool <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">scrounge-ntfs</strong></span><span class="No-Break">.</span></p>
<h1 id="_idParaDest-138"><a id="_idTextAnchor188"/>NTFS recovery using scrounge-ntfs</h1>
<p><strong class="source-inline">scrounge-ntfs</strong> is a<a id="_idIndexMarker832"/> tiny tool<a id="_idIndexMarker833"/> that comes with the default version as well as the <strong class="source-inline">Everything</strong> metapackages of Kali Linux. A tiny but powerful tool, <strong class="source-inline">scrouge-ntfs</strong> is a command-line tool for recovering drives formatted as <strong class="bold">NTFS</strong> (short for <strong class="bold">New Technology</strong> <strong class="bold">File System</strong>), generally used by Windows devices. Most storage media, including flash drives and storage media, can also be formatted as NTFS using default formatting tools within <span class="No-Break">Windows systems.</span></p>
<p>It’s quite common for hard drives to have a corrupt <strong class="bold">MFT</strong> (short for <strong class="bold">Master File Table</strong>). This table<a id="_idIndexMarker834"/> stores information about all files, including size, permissions, content, and time stamps within NTFS drives. If this table becomes corrupt or is missing, the contents of the drive may be inaccessible, or the drive may not boot if it contains a bootable <span class="No-Break">operating system.</span></p>
<p>Regardless of the reason for an NTFS drive becoming corrupted, <strong class="source-inline">scrounge-ntfs</strong> was built for the specific purpose of recovering files within an NTFS partition. For this lab, I’ll be using an external hard drive formatted as NTFS, which has also had all its <span class="No-Break">contents deleted:</span></p>
<ol>
<li>Let’s first<a id="_idIndexMarker835"/> see <a id="_idIndexMarker836"/>what our device is listed as in Kali by running <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">sudo fdisk -l</strong></pre></li>
</ol>
<p>The following screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer248">
<img alt="Figure 9.29 – fdisk output" height="204" src="image/Figure_9.29_B19441.jpg" width="595"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.29 – fdisk output</p>
<p>As seen here, my attached drive is listed as <span class="No-Break"><strong class="source-inline">sdb</strong></span><span class="No-Break"> too.</span></p>
<ol>
<li value="2">Before we begin the recovery process, I’d like to create a folder called <strong class="source-inline">Scrounge_recovery</strong> on the desktop where all <strong class="source-inline">scrounge-ntfs-</strong>recovered files will <span class="No-Break">be saved.</span></li>
</ol>
<p>To do so, I’ll switch to the <strong class="source-inline">Desktop</strong> directory by typing <span class="No-Break">the following:</span></p>
<pre class="source-code">
<strong class="bold">cd Desktop</strong></pre>
<ol>
<li value="3">Then, I’ll create the new directory by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">mkdir Scrounge_recovery</strong></pre></li>
<li>I’ll now change my output directory to avoid having to specify the directory name when typing the <strong class="source-inline">scrounge-ntfs</strong> command, by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">cd Scrounge_recovery</strong></pre></li>
</ol>
<p>The<a id="_idIndexMarker837"/> following<a id="_idIndexMarker838"/> screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer249">
<img alt="Figure 9.30 – Changing working directories" height="212" src="image/Figure_9.30_B19441.jpg" width="703"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.30 – Changing working directories</p>
<p>Note in the preceding screenshot (<span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.30</em>) that we can see my current directory <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">/Desktop/Scrounge_recovery</strong></span><span class="No-Break">.</span></p>
<ol>
<li value="5">Let’s now view the usage and options of <strong class="source-inline">scrounge_ntfs</strong> by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">Scrounge-ntfs -h</strong></pre></li>
</ol>
<p>The following screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer250">
<img alt="Figure 9.31 – scrounge-nfts usage options" height="276" src="image/Figure_9.31_B19441.jpg" width="668"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.31 – scrounge-nfts usage options</p>
<ol>
<li value="6">Let’s list all drive partitions by typing <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">sudo scrounge-ntfs -l /dev/sdb</strong></pre></li>
</ol>
<p>The <a id="_idIndexMarker839"/>following<a id="_idIndexMarker840"/> screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer251">
<img alt="Figure 9.32 – The drive details" height="125" src="image/Figure_9.32_B19441.jpg" width="567"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.32 – The drive details</p>
<p>Now that we can see the specific sector, cluster, and offset values (which I’ve also listed here for clarity), we can use the format specified in the preceding <strong class="source-inline">scrounge-ntfs -h</strong> output (<span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.32</em></span><span class="No-Break">):</span></p>
<ul>
<li><strong class="bold">Start </strong><span class="No-Break"><strong class="bold">Sector</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">16128</strong></span></li>
<li><strong class="bold">End </strong><span class="No-Break"><strong class="bold">Sector</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">976768002</strong></span></li>
<li><strong class="bold">Cluster </strong><span class="No-Break"><strong class="bold">Size</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">8</strong></span></li>
<li><strong class="bold">MFT </strong><span class="No-Break"><strong class="bold">Offset</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">24</strong></span></li>
</ul>
<ol>
<li value="7">The default usage for <strong class="source-inline">scrounge-ntfs</strong> is <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">sudo scrounge-ntfs [-m offset] [-c clustersize] [-o outdir] disk start end</strong></pre></li>
</ol>
<p>Let’s break down the <span class="No-Break">preceding options:</span></p>
<ul>
<li><strong class="source-inline">-o [outdir]</strong> = the <a id="_idIndexMarker841"/>output<a id="_idIndexMarker842"/> directory to save all recovered <span class="No-Break">files to</span></li>
<li><strong class="source-inline">disk</strong> = the drive <span class="No-Break">to recover</span></li>
<li><strong class="source-inline">start</strong> = the <span class="No-Break">start sector</span></li>
<li><strong class="source-inline">end</strong> = the <span class="No-Break">end sector</span></li>
</ul>
<ol>
<li value="8">For my drive, the command will be <span class="No-Break">the following:</span><pre class="source-code">
<strong class="bold">sudo scrounge-ntfs -m 629456 -c 8 /dev/sdb/ 2048 15726592</strong></pre></li>
</ol>
<p>I did not specify an outdir or output directory command, as I am already within the output directory of <strong class="source-inline">Scrounge_recovery</strong>, which I <span class="No-Break">previously created.</span></p>
<ol>
<li value="9">Once you have double-checked your values to ensure they are correct, hit the <span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break"> key.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer252">
<img alt="Figure 9.33 – The scrounge-ntfs command and output" height="259" src="image/Figure_9.33_B19441.jpg" width="602"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.33 – The scrounge-ntfs command and output</p>
<p>In the <a id="_idIndexMarker843"/>preceding <a id="_idIndexMarker844"/>output, you can see the files <span class="No-Break">being recovered.</span></p>
<ol>
<li value="10">I can now list all files in the <strong class="source-inline">Scrounge_recovery</strong> directory or double-click on <strong class="source-inline">Scrounge_directory</strong> on the desktop to view my <span class="No-Break">recovered files:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer253">
<img alt="Figure 9.34 – The recovered files" height="448" src="image/Figure_9.34_B19441.jpg" width="576"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.34 – The recovered files</p>
<p>As seen in this section, <strong class="source-inline">scrounge-ntfs</strong> is a very useful tool for NTFS drive and partition<a id="_idIndexMarker845"/> recovery. Let’s <a id="_idIndexMarker846"/>move on to our final tool for this chapter called Recoverjpeg, which can be used to quickly recover <span class="No-Break">image files.</span></p>
<h1 id="_idParaDest-139"><a id="_idTextAnchor189"/>Image recovery using Recoverjpeg</h1>
<p>The last tool <a id="_idIndexMarker847"/>that I’ll <a id="_idIndexMarker848"/>cover in this chapter is <strong class="bold">recoverjpeg</strong>, which, as the name implies, recovers JPEG images. This tool quickly and easily recovers deleted photos from any storage media type. For this lab, I’ll be using a formatted 32-GB flash drive that once contained family photos I’d like <span class="No-Break">to recover:</span></p>
<ol>
<li>I’ll first create a folder called <strong class="source-inline">Recoverjpeg</strong> on my desktop where all recovered files will be saved to. This helps keep things organized, as not specifying an output folder for all recovered files to be saved results in the recovered files being saved to the <strong class="source-inline">Home</strong> or current working directory, which can clutter <span class="No-Break">your workspace.</span></li>
</ol>
<p>In the<a id="_idIndexMarker849"/> following <a id="_idIndexMarker850"/>screenshot, I’ve typed the <strong class="source-inline">cd</strong> command followed by <strong class="source-inline">mkdir Recoverjpeg</strong> to create this folder on <span class="No-Break">my desktop:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer254">
<img alt="Figure 9.35 – Creating the output folder" height="89" src="image/Figure_9.35_B19441.jpg" width="301"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.35 – Creating the output folder</p>
<ol>
<li value="2">Next, I’ll install the <strong class="source-inline">recoverjpeg</strong> tool by typing the <span class="No-Break">following command:</span><pre class="source-code">
<strong class="bold">sudo apt-get install recoverjpeg</strong></pre></li>
</ol>
<p>The following screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer255">
<img alt="Figure 9.36 – Installing recoverjpeg" height="324" src="image/Figure_9.36_B19441.jpg" width="565"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.36 – Installing recoverjpeg</p>
<ol>
<li value="3">Note that the <a id="_idIndexMarker851"/>last<a id="_idIndexMarker852"/> line in the preceding screenshot prompts us to press <em class="italic">Y</em> to continue the installation. Press <em class="italic">Y</em> and then <em class="italic">Enter</em> <span class="No-Break">to proceed.</span></li>
<li>Next, I’ll make sure that my flash drive is recognized in Kali by typing <strong class="source-inline">sudo </strong><span class="No-Break"><strong class="source-inline">fdisk –l</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer256">
<img alt="Figure 9.37 – fdisk command output" height="441" src="image/Figure_9.37_B19441.jpg" width="621"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.37 – fdisk command output</p>
<p>In the<a id="_idIndexMarker853"/> preceding <a id="_idIndexMarker854"/>screenshot, we can see that my Cruzer Blade 32-GB flash drive is listed <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">/dev/sdb</strong></span><span class="No-Break">.</span></p>
<ol>
<li value="5">I’ll now change directories to the <strong class="source-inline">Recoverjpeg</strong> folder that I previously created, where all recovered files will be stored, by typing <span class="No-Break"><strong class="source-inline">cd Recoverjpeg</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer257">
<img alt="Figure 9.38 – Changing to the output directory" height="47" src="image/Figure_9.38_B19441.jpg" width="292"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.38 – Changing to the output directory</p>
<ol>
<li value="6">To view the usage options for Recoverjpeg, <span class="No-Break">type </span><span class="No-Break"><strong class="source-inline">recoverjpeg</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer258">
<img alt="Figure 9.39 – recoverjpeg usage options" height="275" src="image/Figure_9.39_B19441.jpg" width="516"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.39 – recoverjpeg usage options</p>
<ol>
<li value="7">Now that I know which drive I’d like to recover images from, I now use <strong class="source-inline">recoverjpeg</strong> to scan and recover images by typing the <span class="No-Break">following command:</span></li>
</ol>
<pre class="console">
sudo recover jpeg /dev/sdb</pre>
<p>The following screenshot shows the output of the previously <span class="No-Break">typed command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer259">
<img alt="Figure 9.40 – Using the recoverjpeg command" height="39" src="image/Figure_9.40_B19441.jpg" width="403"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.40 – Using the recoverjpeg command</p>
<p class="callout-heading">Important note</p>
<p class="callout">Depending on the size of the drive or image, this can take quite a few minutes. Once the recovery is complete, recoverjpeg will display the number of files recovered. In <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.44</em>, we can see that a total of 2,021 files <span class="No-Break">were recovered.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer260">
<img alt="Figure 9.41 – recoverjpeg process completion" height="31" src="image/Figure_9.41_B19441.jpg" width="253"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.41 – recoverjpeg process completion</p>
<p>The recovered files were saved in the <strong class="source-inline">Recoverjpeg</strong> folder on the desktop but will not have their original names. Instead, all recovered images will be named in numeric order, starting <a id="_idIndexMarker855"/>from <strong class="source-inline">image00000.jpg</strong>, as<a id="_idIndexMarker856"/> shown in the <span class="No-Break">following screenshot.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer261">
<img alt="Figure 9.42 – Recovered jpeg photos within the output folder" height="423" src="image/Figure_9.42_B19441.jpg" width="408"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.42 – Recovered jpeg photos within the output folder</p>
<p>I hope you found this tool as useful and easy to use as I do. This brings us to the end of our chapter. I encourage you to practice using these tools, as you will find that data recovery is one of the most common aspects <span class="No-Break">of DFIR.</span></p>
<h1 id="_idParaDest-140"><a id="_idTextAnchor190"/>Summary</h1>
<p>In this chapter, we learned about file recovery and data carving using popular open source tools in Kali Linux. We first performed file carving using the very impressive Foremost, which carved the entire downloaded forensic image for supported file types within the file header and footers. We then did the same using Magicrescue and Scalpel, but we had to make slight modifications by selecting the file types we wished to carve. Both Foremost and Scalpel presented us with an <strong class="source-inline">audit.txt</strong> file, summarizing the carve list and its details along with subfolders containing the <span class="No-Break">actual evidence.</span></p>
<p><strong class="source-inline">bulk_extractor</strong> is a wonderful tool that carves data and also finds useful information, such as email addresses, visited URLs, Facebook URLs, credit card numbers, and a variety of other information. <strong class="source-inline">bulk_extractor</strong> is also great for investigations requiring file recovery and carving, together with either Foremost or Scalpel, or <span class="No-Break">even both.</span></p>
<p>Lastly, we looked at file recovery using <strong class="source-inline">scrounge_NTFS</strong> and <strong class="source-inline">recoverjpeg</strong> to recover data and images from drives rather than <span class="No-Break">forensic images.</span></p>
<p>Now that we’ve covered file carving and recovery, let’s move on to something more analytical. In the next chapter, we’ll take a look at exploring RAM and the paging file as part of memory forensics, using the very powerful volatility. See <span class="No-Break">you there!</span></p>
</div>
<div>
<div id="_idContainer263">
</div>
</div>
</div></body></html>