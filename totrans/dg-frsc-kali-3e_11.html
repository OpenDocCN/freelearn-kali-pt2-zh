<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer218">
<h1 class="chapter-number" id="_idParaDest-113"><a id="_idTextAnchor147"/>8</h1>
<h1 id="_idParaDest-114"><a id="_idTextAnchor148"/>Evidence Acquisition Tools</h1>
<p>In the previous chapter, we learned that documentation and proper DFIR procedures are key in any investigation. These ensure the integrity of the investigation by providing proof of data authenticity and preservation of the original evidence and documentation, which can be used to achieve the same exact results if the usage of tools and methods <span class="No-Break">is repeated.</span></p>
<p>In this chapter, we will focus on and demonstrate forensically sound techniques for the acquisition of data by creating bitstream copies of evidence inclusive of data hashes, and also perform evidence acquisition of the drives, RAM, and paging files using <span class="No-Break">various tools.</span></p>
<p>This is the first technical step in DFIR investigations, so it is very important to familiarize yourself with the tools and processes for evidence acquisition that are covered in this chapter. Upon completion of this chapter, you will know how to perform formal evidence acquisitions for analysis, which will be covered in <span class="No-Break">later chapters.</span></p>
<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
<ul>
<li><a id="_idTextAnchor149"/>Using the <strong class="source-inline">fdisk</strong> command for <span class="No-Break">partition recognition</span></li>
<li>Creating strong hashes for <span class="No-Break">evidence integrity</span></li>
<li>Drive acquisition <span class="No-Break">using DC3DD</span></li>
<li>Drive acquisition <span class="No-Break">using DD</span></li>
<li>Drive acquisition <span class="No-Break">using Guymager</span></li>
<li>Drive and memory acquisition using FTK Imager <span class="No-Break">in Wine</span></li>
<li>RAM and paging file acquisition using Belkasoft RAM Capturer <span class="No-Break">in Wine</span></li>
</ul>
<h1 id="_idParaDest-115"><a id="_idTextAnchor150"/>Using the fdisk command for partition recognition</h1>
<p>For anyone using Kali<a id="_idIndexMarker643"/> as a standalone<a id="_idIndexMarker644"/> operating system, the process of mounting a removable drive is straightforward, where you insert the removable storage drive and then run the <strong class="source-inline">fdisk</strong> command. However, for those using Kali as a virtual machine or VM, you will first need to ensure that the removable storage is recognized by VirtualBox. To do so, follow <span class="No-Break">these steps:</span></p>
<ol>
<li>Click on <strong class="bold">Devices</strong> in the VirtualBox window running Kali Linux, and then click on the <strong class="bold">USB</strong> option, as seen in the following screenshot, which will display a list of all detected USB devices. You can take a screenshot or photo of this list for <span class="No-Break">comparison purposes.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer170">
<img alt="Figure 8.1 – The VirtualBox Manager devices menu" height="312" src="image/Figure_8.01_B19441.jpg" width="537"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.1 – The VirtualBox Manager devices menu</p>
<ol>
<li value="2">In the preceding step, there are eight detected devices. You can now plug in your 2-GB microSD card and click on <strong class="bold">Devices</strong> | <strong class="bold">USB</strong> again to see what your microSD card is listed as. In the following screenshot, we can see a new entry on our list of USB devices, <strong class="bold">Generic Mass Storage Device [0100]</strong>. Click on this entry in the list to mount the device in <span class="No-Break">Kali Linux.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer171">
<img alt="Figure 8.2 – The VirtualBox Manager USB devices menu" height="330" src="image/Figure_8.02_B19441.jpg" width="666"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.2 – The VirtualBox Manager USB devices menu</p>
<p>Once the <a id="_idIndexMarker645"/>device <a id="_idIndexMarker646"/>is recognized by VirtualBox and mounted in Kali, you should see your device showing as an icon on your Kali desktop. In the following screenshot, we can see that the 8-GB microSD card is now mounted and available for use <span class="No-Break">by Kali.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer172">
<img alt="Figure 8.3 – The storage media desktop icon" height="126" src="image/Figure_8.03_B19441.jpg" width="156"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.3 – The storage media desktop icon</p>
<ol>
<li value="3">Once our disk has been mounted, we can now use the <strong class="source-inline">fdisk</strong> command to view the drive <span class="No-Break">partition details.</span></li>
</ol>
<p>Now that we’ve <a id="_idIndexMarker647"/>successfully<a id="_idIndexMarker648"/> mounted our removable storage drive, we will learn how to identify the device and partitions using the <strong class="source-inline">fdisk</strong> command in the <span class="No-Break">next section<a id="_idTextAnchor151"/><a id="_idTextAnchor152"/>.</span></p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor153"/>Device identification using the fdisk command</h2>
<p>For this <a id="_idIndexMarker649"/>exercise, an 8-GB Sony Pro Duo card was<a id="_idIndexMarker650"/> connected via an external USB 3.0 card reader to my standalone Kali Linux desktop. Feel free to use any other type of storage media device for this exercise, as the process is exactly the same regardless of the device type used. Before we begin any acquisition processes, we will first run the <strong class="source-inline">sudo fdisk -l</strong> command to list all the attached storage devices to differentiate between them. This is necessary, as we will not be using the storage device names given to them and will, instead, be using their disk <span class="No-Break">identification information.</span></p>
<p>Open a new Terminal, type the following command, and <span class="No-Break">press </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">:</span></p>
<pre class="console">
sudo fdisk -l</pre>
<p>In the following screenshot, the primary drive is listed as <strong class="source-inline">sda</strong> and the attached Sony Pro Duo card is listed <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">sdb</strong></span><span class="No-Break">.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer173">
<img alt="Figure 8.4 – The fdisk –l command output" height="485" src="image/Figure_8.04_B19441.jpg" width="620"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.4 – The fdisk –l command output</p>
<p>As seen in the<a id="_idIndexMarker651"/> preceding<a id="_idIndexMarker652"/> screenshot, the <a id="_idIndexMarker653"/>details of the Sony ProDuo card are <span class="No-Break">as follows:</span></p>
<ul>
<li><span class="No-Break"><strong class="bold">Disk</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">sdb</strong></span></li>
<li><strong class="bold">Size</strong>: <span class="No-Break"><strong class="source-inline">7.4 GB</strong></span></li>
<li><strong class="bold">Sector size</strong>: <span class="No-Break"><strong class="source-inline">512 bytes</strong></span></li>
<li><span class="No-Break"><strong class="bold">Filesystem</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">FAT32</strong></span></li>
</ul>
<p>As seen in the previous screenshot, Kali Linux recognizes <span class="No-Break">two devices:</span></p>
<ul>
<li><strong class="source-inline">sda</strong>: The primary hard disk with <span class="No-Break">three partitions</span></li>
<li><strong class="source-inline">sdb</strong>: The storage drive to be forensically acquired <span class="No-Break">or imaged</span></li>
</ul>
<p>Users new to Kali or any Linux version or variation may find that the drive and partition recognition and naming conventions in Kali are different from those on <span class="No-Break">Windows devices.</span></p>
<p>A typical device in Linux can be addressed or recognized as <strong class="source-inline">/dev/sda</strong>, whereas drives in Windows are usually recognized as <strong class="source-inline">Disk 0</strong> and <strong class="source-inline">Disk 1</strong>, and <span class="No-Break">so on:</span></p>
<ul>
<li><strong class="source-inline">/dev</strong>: This refers to the path of all devices and drives that can be read from or written to, recognized <span class="No-Break">by Linux</span></li>
<li><strong class="source-inline">/sda</strong>: This<a id="_idIndexMarker654"/> refers to <strong class="bold">SCSI</strong> (short for <strong class="bold">Small Computer Systems Interface</strong>), SATA, and <span class="No-Break">USB devices</span></li>
</ul>
<p><strong class="source-inline">sd</strong> stands for <strong class="bold">SCSI Mass-Storage Driver</strong>, with the following letter (for example, a, b, etc.) representing <a id="_idIndexMarker655"/>the <span class="No-Break">drive number:</span></p>
<ul>
<li><strong class="source-inline">sda</strong>: Drive <strong class="source-inline">0</strong> or the first <span class="No-Break">drive recognized</span></li>
<li><strong class="source-inline">sdb</strong>: The second drive or <span class="No-Break">storage media</span></li>
</ul>
<p>While<a id="_idIndexMarker656"/> Windows<a id="_idIndexMarker657"/> recognizes partitions as primary, logical, and extended, Linux partitions are recognized as numbers that follow the <span class="No-Break">drive letter:</span></p>
<ul>
<li><strong class="source-inline">sda1</strong>: Partition 1 on the first <span class="No-Break">disk (</span><span class="No-Break"><strong class="source-inline">sda</strong></span><span class="No-Break">)</span></li>
<li><strong class="source-inline">sda2</strong>: Partition 2 on the <span class="No-Break">first disk</span></li>
<li><strong class="source-inline">sdb1</strong>: Partition 1 on the second <span class="No-Break">disk (</span><span class="No-Break"><strong class="source-inline">sdb</strong></span><span class="No-Break">)</span></li>
<li><strong class="source-inline">sdb2</strong>: Partition 2 on the <span class="No-Break">second disk</span></li>
</ul>
<p>More information <a id="_idIndexMarker658"/>on Linux device naming conventions can be found <span class="No-Break">at </span><a href="https://www.dell.com/support/kbdoc/en-tt/000132092/ubuntu-linux-terms-for-your-hard-drive-and-devices-explained#:~:text=Under%20Linux%2C%20the%20original%20naming,address%2Dwise%20and%20so%20on"><span class="No-Break">https://www.dell.com/support/kbdoc/en-tt/000132092/ubuntu-linux-terms-for-your-hard-drive-and-devices-explained#:~:text=Under%20Linux%2C%20the%20original%20naming,address%2Dwise%20and%20so%20on</span></a><span class="No-Break">.</span></p>
<p>Now that we can identify the drives and partitions within a Linux file system, let’s learn how to create hashes of the evidence for integrity purposes in the <span class="No-Break">ne<a id="_idTextAnchor154"/>xt section.</span></p>
<h1 id="_idParaDest-117"><a id="_idTextAnchor155"/>Creating strong hashes for evidence integrity</h1>
<p>To provide proof <a id="_idIndexMarker659"/>that evidence was not tampered<a id="_idIndexMarker660"/> with, a cryptographic algorithm must be run against the evidence drive before, during, and after a forensic acquisition. These algorithms produce an output string (or hash output) of hexadecimal characters (a–f and 0–9) of various lengths, depending on <span class="No-Break">their strength.</span></p>
<p>Common <a id="_idIndexMarker661"/>cryptographic algorithms are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="source-inline">MD5</strong>: Message <span class="No-Break">Digest 5</span></li>
<li><strong class="source-inline">SHA-1</strong>: Secure Hash Algorithm <span class="No-Break">version 1</span></li>
<li><strong class="source-inline">SHA-256</strong>: <span class="No-Break">SHA-2 256-bit</span></li>
</ul>
<p class="callout-heading">Note</p>
<p class="callout">More information<a id="_idIndexMarker662"/> on cryptographic hashes can be found <span class="No-Break">at </span><a href="https://www.tutorialspoint.com/cryptography/cryptography_hash_functions.htm"><span class="No-Break">https://www.tutorialspoint.com/cryptography/cryptography_hash_functions.htm</span></a><span class="No-Break">.</span></p>
<p>In Kali Linux, we can use the <strong class="source-inline">md5sum</strong>, <strong class="source-inline">sha1sum</strong>, or <strong class="source-inline">sha256sum</strong> commands, followed by the path of the device, to create a hash output of the evidence/input file. For example, to create a <strong class="source-inline">SHA-256</strong> hash, we would use the following command, where <strong class="source-inline">sdx</strong> represents the drive we are trying to acquire <span class="No-Break">or image:</span></p>
<pre class="console">
Sha256sum /dev/sdx.</pre>
<p>Although I mentioned the <strong class="source-inline">md5sum</strong> command, I recommend using a stronger algorithm, such as <strong class="source-inline">SHA-1</strong> or <strong class="source-inline">SHA-256</strong>, as <strong class="source-inline">MD5</strong> is much older and can <span class="No-Break">be compromised:</span></p>
<ul>
<li><strong class="source-inline">MD5 strength</strong>: 128-bit <span class="No-Break">hash value</span></li>
<li><strong class="source-inline">SHA-1 strength</strong>: 160-bit <span class="No-Break">hash value</span></li>
<li><strong class="source-inline">SHA-256 strength</strong>: <span class="No-Break">256-bit value</span></li>
<li><strong class="source-inline">SHA-3 strength</strong>: 256-bit value (but faster <span class="No-Break">than SHA-2)</span></li>
</ul>
<p>To create an <strong class="source-inline">MD5</strong> hash output against my Pro Duo card (<strong class="source-inline">sdb</strong>), I used the <span class="No-Break">fol<a id="_idTextAnchor156"/>lowing command:</span></p>
<pre class="console">
sudo md5sum /dev/sdb.</pre>
<p>To create an <strong class="source-inline">SHA-1</strong> hash output against my Pro Duo card (<strong class="source-inline">sdb</strong>), I used the <span class="No-Break">following command:</span></p>
<pre class="console">
sudo sha1sum /dev/sdb.</pre>
<p>To create an <strong class="source-inline">SHA-256</strong> hash output against my Pro Duo card (<strong class="source-inline">sdb</strong>), I used the <span class="No-Break">following command:</span></p>
<pre class="console">
sudo sha256sum /dev/sdb.</pre>
<p>In the following <a id="_idIndexMarker663"/>screenshot, I have run all the preceding<a id="_idIndexMarker664"/> commands. Note that the <strong class="source-inline">SHA-256</strong> output is <span class="No-Break">the longest.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer174">
<img alt="Figure 8.5 – Cryptographic algorithm output hashes" height="302" src="image/Figure_8.05_B19441.jpg" width="640"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.5 – Cryptographic algorithm output hashes</p>
<p class="callout-heading">Important note</p>
<p class="callout">When performing forensic acquisition or forensic imaging of any drive or storage media, the hash output of the original file must always match the output of the forensically acquired forensic image, which assures the integrity of the evidence and the copy of the evidence (the <span class="No-Break">forensic image).</span></p>
<p>Now that we’ve distinguished between drives and are certain of which drive is to be imaged (<strong class="source-inline">sdb</strong>), we can begin the forensic imaging using DC3DD. Although I have used an older 8-GB Pro Duo storage drive to demonstrate the usage of DC3DD, you can use any drive (portable or otherwise) to practice using the tools in this chapter. Be sure to use the <strong class="source-inline">fdisk -l</strong> co<a id="_idTextAnchor157"/>mmand <a id="_idIndexMarker665"/>to <a id="_idIndexMarker666"/>identify your drives and partitions <a id="_idTextAnchor158"/><a id="_idTextAnchor159"/><span class="No-Break">before continuing.</span></p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor160"/>Drive acquisition using DC3DD</h1>
<p>The first tool<a id="_idIndexMarker667"/> we <a id="_idIndexMarker668"/>will use <a id="_idIndexMarker669"/>for acquisition is called <strong class="bold">DC3DD</strong> (developed by the <strong class="bold">department of Defense Cyber Crime Center</strong>). DC3DD is a patch of the very<a id="_idIndexMarker670"/> popular <strong class="bold">Data Dump</strong> (<strong class="bold">DD</strong>) tool, used for forensic acquisition <span class="No-Break">and hashing.</span></p>
<p>These are the<a id="_idIndexMarker671"/> features <span class="No-Break">of DD:</span></p>
<ul>
<li>Bitstream (raw) disk acquisition <span class="No-Break">and cloning</span></li>
<li>Copying <span class="No-Break">disk partitions</span></li>
<li>Copying folders <span class="No-Break">and files</span></li>
<li>Hard disk drive <span class="No-Break">error checking</span></li>
<li>Forensic wiping or forensic and secure deletion of all data on hard <span class="No-Break">disk drives</span></li>
</ul>
<p>DC3DD is updated whenever DD updates. DC3DD offers the best of DD with more features, including <span class="No-Break">the following:</span></p>
<ul>
<li>On-the-fly hashing (or hashing done instantly by the tool), using more algorithm choices (<strong class="source-inline">MD5</strong>, <strong class="source-inline">SHA-1</strong>, <strong class="source-inline">SHA-256</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">SHA-512</strong></span><span class="No-Break">)</span></li>
<li>A meter to monitor progress and <span class="No-Break">acquisition time</span></li>
<li>Writing of errors to <span class="No-Break">a file</span></li>
<li>Splitting of <span class="No-Break">output files</span></li>
<li>Verification <span class="No-Break">of files</span></li>
<li>Wiping of output files (<span class="No-Break">pattern wiping)</span></li>
</ul>
<p>DC3DD must be installed manually in Kali Linux. First, we’ll update our version of Kali Linux by using the <strong class="source-inline">apt-get </strong><span class="No-Break"><strong class="source-inline">update</strong></span><span class="No-Break"> command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer175">
<img alt="Figure 8.6 – Updating Kali Linux" height="117" src="image/Figure_8.06_B19441.jpg" width="743"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.6 – Updating Kali Linux</p>
<p>Once Kali updates, you<a id="_idIndexMarker672"/> can <a id="_idIndexMarker673"/>manually install DC3DD by typing the <strong class="source-inline">sudo apt-get install </strong><span class="No-Break"><strong class="source-inline">dc3dd</strong></span><span class="No-Break"> command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer176">
<img alt="Figure 8.7 – Installing dc3dd" height="347" src="image/Figure_8.07_B19441.jpg" width="630"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.7 – Installing dc3dd</p>
<p>DC3DD is a CLI tool and can be easily run in Kali Linux by first opening a Terminal and typing <strong class="source-inline">dc3dd</strong>. To start with, I recommend using the <strong class="source-inline">dc3dd --help</strong> command, which lists the available parameters used <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">dc3dd</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer177">
<img alt="Figure 8.8 – The dc3dd help option" height="259" src="image/Figure_8.08_B19441.jpg" width="651"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.8 – The dc3dd help option</p>
<p>As shown in the <a id="_idIndexMarker674"/>previous<a id="_idIndexMarker675"/> screenshot that shows the use of the <strong class="source-inline">dc3dd --help</strong> command, typical usage of the DC3DD command looks <span class="No-Break">like this:</span></p>
<pre class="console">
dc3dd [option 1] [option 2] ... [option n]</pre>
<p>To create a forensic image of my 8-GB drive, I’ve used the following options <span class="No-Break">within </span><span class="No-Break"><strong class="source-inline">dc3dd</strong></span><span class="No-Break">:</span></p>
<pre class="console">
sudo dc3dd if=/dev/sdb hash=sha1 log=dc3dd8gb of=8gbproduo.dd</pre>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer178">
<img alt="Figure 8.9 – The drive acquisition command within dc3dd" height="180" src="image/Figure_8.09_B19441.jpg" width="605"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.9 – The drive acquisition command within dc3dd</p>
<p>The following list explains the output of the screenshot shown in <span class="No-Break"><em class="italic">Figure 8</em></span><span class="No-Break"><em class="italic">.9</em></span><span class="No-Break">:</span></p>
<ul>
<li><strong class="source-inline">if</strong>: This specifies the <em class="italic">input file</em>, which is the device we will <span class="No-Break">be imaging.</span></li>
<li><strong class="source-inline">hash</strong>: This specifies the type of hash algorithm we will be using for integrity verification. In this case, I have used the older <span class="No-Break"><strong class="source-inline">MD5</strong></span><span class="No-Break"> hash.</span></li>
<li><strong class="source-inline">log</strong>: This specifies the name of the log file that logs the details of the device and the acquisition, <span class="No-Break">including errors.</span></li>
<li><strong class="source-inline">of</strong>: This specifies the output file name of the forensic image created by DC3DD. Although a <strong class="source-inline">.dd</strong> image file type was specified in this example, other formats are recognized by DC3DD, including <strong class="source-inline">.img</strong>, as shown in a <span class="No-Break">later example.</span></li>
</ul>
<p>The device size (in sector and bytes) should be noted and later compared to the output results for the device field. Once the acquisition process has been completed, the input and output results <span class="No-Break">are displayed.</span></p>
<p>In <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.10</em>, the <a id="_idIndexMarker676"/>last <a id="_idIndexMarker677"/>line displays the progress and status of the acquisition process, showing the amount of data copied, the elapsed time in seconds, and the speed of the imaging process <span class="No-Break">in Mbps:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer179">
<img alt="Figure 8.10 – The completed dc3dd output" height="344" src="image/Figure_8.10_B19441.jpg" width="665"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.10 – The completed dc3dd output</p>
<p>The larger the drive or file to be acquired, the lengthier the time taken to do so. Might I suggest you get yourself a cup of coffee or a refreshing beverage, or even have a look at some other wonderful titles available from Packt <span class="No-Break">at </span><a href="https://www.packtpub.com/"><span class="No-Break">https://www.packtpub.com/</span></a><span class="No-Break">.</span></p>
<p>Analyzing the results in <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.10</em>, we can see that the same amount of sectors (<strong class="source-inline">15630336</strong>) have been imaged, with no bad sectors being replaced by zeros. We can also see that the exact <strong class="source-inline">SHA1</strong> hash was created for the image, assuring us that an exact copy was created <span class="No-Break">without modification.</span></p>
<p>In the Terminal, we can also use the <strong class="source-inline">ls</strong> command to list the directory contents to ensure that the DC3DD output file (<strong class="source-inline">8gbproduo.dd</strong>) and log (<strong class="source-inline">dc3dd8gb</strong>) have <span class="No-Break">been created:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer180">
<img alt="Figure 8.11 – The home directory listing using the ls command" height="112" src="image/Figure_8.11_B19441.jpg" width="799"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.11 – The home directory listing using the ls command</p>
<p>To access our<a id="_idIndexMarker678"/> forensic<a id="_idIndexMarker679"/> image and log file, we can go to our <strong class="source-inline">/home</strong> directory by clicking on the folder icon (in the top-left corner) on the desktop and then clicking on <span class="No-Break"><strong class="bold">Open Folder</strong></span><span class="No-Break">.</span></p>
<p>Within the <strong class="source-inline">Home</strong> folder, the first file, <strong class="source-inline">8gbproduo.dd</strong>, is the output image created by DC3DD using the <strong class="source-inline">of=8gbproduo.dd</strong> command. The last file, <strong class="source-inline">dc3dd8gb</strong>, is the log file, created when we used the <span class="No-Break"><strong class="source-inline">log=dc3dd8gb</strong></span><span class="No-Break"> command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer181">
<img alt="Figure 8.12 – The forensic image and log file in the Home folder" height="256" src="image/Figure_8.12_B19441.jpg" width="766"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.12 – The forensic image and log file in the Home folder</p>
<p>It’s important to keep this log file to have a record of the acquisition process and its results, which were displayed on the screen <span class="No-Break">upon completion:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer182">
<img alt="Figure 8.13 – The contents within the log file" height="420" src="image/Figure_8.13_B19441.jpg" width="684"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.13 – The contents within the log file</p>
<p>In <a href="B19441_12.xhtml#_idTextAnchor225"><span class="No-Break"><em class="italic">Chapter 12</em></span></a>, <em class="italic">Autopsy Forensic Browser,</em> and <a href="B19441_13.xhtml#_idTextAnchor234"><span class="No-Break"><em class="italic">Chapter 13</em></span></a>, <em class="italic">Performing a Full DFIR Analysis with the Autopsy 4 GUI</em>, we <a id="_idIndexMarker680"/>will<a id="_idIndexMarker681"/> analyze acquired forensic images using Autopsy; however, the acquired evidence images can also be copied or directly cloned to another device if an investigator <span class="No-Break">so wishes.</span></p>
<p>As an example, we could clone the forensic image acquired previously (<strong class="source-inline">8gbproduo.dd</strong>) onto a new drive, recognized as <strong class="source-inline">sdc</strong>. The command used to perform this task would be <span class="No-Break">as follows:</span></p>
<pre class="console">
dc3dd if=8gbproduo.dd of=/dev/sdc log=drivecopy.log</pre>
<p>When copying an image to a drive, the destination drive size should be of equal size or lar<a id="_idTextAnchor161"/><a id="_idTextAnchor162"/><a id="_idTextAnchor163"/><a id="_idTextAnchor164"/>ger than the <span class="No-Break">image file.</span></p>
<h2 id="_idParaDest-119"><a id="_idTextAnchor165"/>Verifying the hash output of image files</h2>
<p>To verify the<a id="_idIndexMarker682"/> hash<a id="_idIndexMarker683"/> output <a id="_idIndexMarker684"/>of <strong class="source-inline">sdb</strong>, the following command can <span class="No-Break">be used:</span></p>
<pre class="console">
sudo sha1sum /dev/sdb</pre>
<p> The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer183">
<img alt="Figure 8.14 – sha1sum output" height="78" src="image/Figure_8.14_B19441.jpg" width="646"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.14 – sha1sum output</p>
<p>You can also use the <span class="No-Break">following command:</span></p>
<pre class="console">
cat 8gbproduo.dd | sha1sum</pre>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer184">
<img alt="Figure 8.15 – cat sha1sum output" height="69" src="image/Figure_8.15_B19441.jpg" width="396"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.15 – cat sha1sum output</p>
<h2 id="_idParaDest-120"><a id="_idTextAnchor166"/>Erasing a drive using DC3DD</h2>
<p>We’ve seen the<a id="_idIndexMarker685"/> power of DC3DD as a very impressive forensic acquisition tool, but I’d also like to go one step further and introduce you to its capabilities as a <span class="No-Break">data-wiping tool.</span></p>
<p>DC3DD can wipe data and erase drives by overwriting data in <span class="No-Break">three ways:</span></p>
<ul>
<li>Overwriting and filling data and drives with zeroes. The command used is <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">dc3dd wipe=/dev/sdb</strong></pre></li>
</ul>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer185">
<img alt="Figure 8.16 – dc3dd wipe command output" height="172" src="image/Figure_8.16_B19441.jpg" width="531"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.16 – dc3dd wipe command output</p>
<ul>
<li>Overwriting and filling data and drives, using a hexadecimal pattern and the <strong class="source-inline">pat</strong> option. The<a id="_idIndexMarker686"/> command used is <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">dc3dd wipe=/dev/sdb pat=10101010</strong></pre></li>
</ul>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer186">
<img alt="Figure 8.17 – The dc3dd wipe command with pattern output" height="288" src="image/Figure_8.17_B19441.jpg" width="578"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.17 – The dc3dd wipe command with pattern output</p>
<ul>
<li>Overwriting and filling the data and drives, using a text pattern and the <strong class="source-inline">tpat</strong> option. The command used is <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">dc3dd wipe=/dev/sdb tpat=CFSI</strong></pre></li>
</ul>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer187">
<img alt="Figure 8.18 – The dc3dd wipe command with text pattern output" height="307" src="image/Figure_8.18_B19441.jpg" width="531"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.18 – The dc3dd wipe command with text pattern output</p>
<p>We’ve covered the <a id="_idIndexMarker687"/>usage of the <strong class="source-inline">dc3dd</strong> tool and the various methods to forensically wipe media. Let’s now look at another tool called DD that can also be used for forensic data copying <span class="No-Break">and wiping.</span></p>
<h1 id="_idParaDest-121"><a id="_idTextAnchor167"/>Drive acquisition using DD</h1>
<p>Before we get <a id="_idIndexMarker688"/>started using DD, I need to again <a id="_idIndexMarker689"/>draw your attention to one of the features of DD, the ability to wipe data, partitions, and drives. Hence, you may find that DD is sometimes fondly referred to as <a id="_idIndexMarker690"/>the <strong class="bold">data destroyer</strong>. Be sure to always first identify your devices, partitions, input and output files, and parameters when using DD <span class="No-Break">and DC3DD.</span></p>
<p>For the exercises in this chapter, I’ll be using an older but functional 2-GB flash drive for the acquisition process <span class="No-Break">using DC3DD.</span></p>
<p>Should you also wish to use the DD tool, the commands and usage are very much <span class="No-Break">the same.</span></p>
<p>You may want to<a id="_idIndexMarker691"/> first <a id="_idIndexMarker692"/>ensure that you can access the dd tool by running <strong class="source-inline">dd –-help</strong>. If the <strong class="source-inline">dd</strong> command cannot be found, update Kali by running the <strong class="source-inline">apt-get update</strong> command, and then run the <strong class="source-inline">dd –-help</strong> <span class="No-Break">command again.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer188">
<img alt="Figure 8.19 – dd help options" height="682" src="image/Figure_8.19_B19441.jpg" width="731"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.19 – dd help options</p>
<p>To perform<a id="_idIndexMarker693"/> image <a id="_idIndexMarker694"/>acquisition, I’ve used <span class="No-Break">this command:</span></p>
<pre class="console">
dd if=/dev/sdb of=produo8g<a id="_idTextAnchor168"/>b.img bs=65536 conv=noerror,sync</pre>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer189">
<img alt="Figure 8.20 – Drive acquisition using dd" height="120" src="image/Figure_8.20_B19441.jpg" width="655"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.20 – Drive acquisition using dd</p>
<p>Let’s do a breakdown of the individual options in the <span class="No-Break">preceding command:</span></p>
<ul>
<li><strong class="source-inline">If</strong>: The input file (<span class="No-Break"><strong class="source-inline">sdb</strong></span><span class="No-Break"> device)</span></li>
<li><strong class="source-inline">Of</strong>: The output file (the name of the <span class="No-Break">forensic image)</span></li>
<li><strong class="source-inline">Bs</strong>: The block size (the default size <span class="No-Break">is 512)</span></li>
<li><strong class="source-inline">conv=noerror, sync</strong>: Continue the imaging even if there are errors (<strong class="source-inline">noerror</strong>), and if there are errors, null-fill the <span class="No-Break">blocks (</span><span class="No-Break"><strong class="source-inline">sync</strong></span><span class="No-Break">).</span></li>
</ul>
<p>In the preceding command, the<strong class="source-inline">.img</strong> output file extension was specified; however, you can use another format, such as <strong class="source-inline">.iso</strong>, by specifying the file extension in the output file’s <strong class="source-inline">(</strong><span class="No-Break"><strong class="source-inline">of)</strong></span><span class="No-Break"> option.</span></p>
<p>We can view the<a id="_idIndexMarker695"/> created<a id="_idIndexMarker696"/> files by using the <strong class="source-inline">ls</strong> command, where we can also see the <span class="No-Break">two images.</span></p>
<p>The following screenshot shows the output of the <span class="No-Break">preceding command:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer190">
<img alt="Figure 8.21 – The evidence acquisition files in the Home directory" height="69" src="image/Figure_8.21_B19441.jpg" width="196"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.21 – The evidence acquisition files in the Home directory</p>
<p>We will now explore another very popular acquisition tool called Guymager, which offers man<a id="_idTextAnchor169"/><a id="_idTextAnchor170"/>y of the same features in a <strong class="bold">Graphical User </strong><span class="No-Break"><strong class="bold">Interface </strong></span><span class="No-Break">(</span><span class="No-Break"><strong class="bold">GUI</strong></span><span class="No-Break">).</span></p>
<h1 id="_idParaDest-122"><a id="_idTextAnchor171"/>Drive acquisition using Guymager</h1>
<p>Guymager is<a id="_idIndexMarker697"/> another standalone acquisition tool that can be <a id="_idIndexMarker698"/>used to create forensic images and also perform disk cloning. Developed by Guy Voncken, Guymager is completely open source, has many of the same features as DC3DD, and is also only available for Linux-based hosts. While some investigators may prefer CLI tools, Guymager is a GUI tool and for beginners, so it may <span class="No-Break">be preferred.</span></p>
<p>For this acquisition, I’ll also use the very same 2-GB flash drive used in the DC3DD examples, at the end of which we can compare results. It’s also important to remember to continue using your write-blocker when acquiring and creating forensic images of evidence and drives, in an effort to not write data to the drives or modify the original <span class="No-Break">evidence files.</span></p>
<p>As previously done in the DC3DD acquisition, we should first ensure that we are familiar with the devices attached to our machine, using the <strong class="source-inline">fdisk -l or sudo fdisk -</strong><span class="No-Break"><strong class="source-inline">l</strong></span><span class="No-Break"> command.</span></p>
<h2 id="_idParaDest-123"><a id="_idTextAnchor172"/>Running Guymager</h2>
<p>Guymager can be <a id="_idIndexMarker699"/>started by using the menu in Kali and clicking on the <strong class="bold">Applications</strong> menu at the top, then the <strong class="bold">11 - Forensics</strong> option, and then expanding the <strong class="bold">Forensic Imaging Tools</strong> menu, as shown in the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer191">
<img alt="Figure 8.22 – The Kali Linux forensics menu" height="1024" src="image/Figure_8.22_B19441.jpg" width="1280"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.22 – The Kali Linux forensics menu</p>
<p>The Guymager <a id="_idIndexMarker700"/>application runs and then displays the existing drives recognized in Kali Linux. As shown in the following screenshot, the details of the 2-GB flash drive being used are shown, including <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Linux device</strong>: Recognized <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">/dev/sdb</strong></span></li>
<li><span class="No-Break"><strong class="bold">Model</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="source-inline">USB_Flash_Memory</strong></span></li>
<li><strong class="bold">State</strong>: Shown as <strong class="bold">Idle</strong>, as the image acquisition has not <span class="No-Break">yet begun</span></li>
<li><span class="No-Break"><strong class="bold">Size</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="bold">2.0GB</strong></span></li>
<li><strong class="bold">Serial number</strong>: <strong class="source-inline">001CC0C60D…</strong> (this will be unique for <span class="No-Break">each drive)</span></li>
<li><strong class="bold">Hidden </strong><span class="No-Break"><strong class="bold">areas</strong></span><span class="No-Break">: </span><span class="No-Break"><strong class="bold">unknown</strong></span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer192">
<img alt="Figure 8.23 – Guymager interface" height="633" src="image/Figure_8.23_B19441.jpg" width="1586"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.23 – Guymager interface</p>
<p>Should your device not be listed in Guymager or you need to add an additional device, click the <strong class="bold">Rescan</strong> button <a id="_idIndexMarker701"/>in the top-left corner of the application to detect <span class="No-Break">the device.</span></p>
<h2 id="_idParaDest-124"><a id="_idTextAnchor173"/>Acquiring evidence with Guymager</h2>
<p>To begin the <a id="_idIndexMarker702"/>acquisition <a id="_idIndexMarker703"/>process, right-click on the evidence drive (<strong class="source-inline">/dev/sdb</strong> in this example) and select <strong class="bold">Acquire image</strong>. Note that the <strong class="bold">Clone device</strong> option is also available if you wish to clone the evidence drive to another. Again, as previously mentioned, when cloning a device, the capacity of the destination device must be equal to or exceed that of the source (original) <span class="No-Break">evidence drive:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer193">
<img alt="Figure 8.24 – Acquisition and clone options in Guymager" height="112" src="image/Figure_8.24_B19441.jpg" width="187"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.24 – Acquisition and clone options in Guymager</p>
<p>Before the<a id="_idIndexMarker704"/> actual<a id="_idIndexMarker705"/> acquisition process starts, the investigator is prompted to enter details about themselves and the evidence under the following <span class="No-Break">two sections:</span></p>
<ul>
<li><span class="No-Break"><strong class="bold">File format</strong></span><span class="No-Break">:</span><ul><li><strong class="bold">File extensions</strong>: <strong class="source-inline">.dd</strong>, <strong class="source-inline">.xxx</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">.Exx</strong></span></li><li><strong class="bold">Split size</strong>: Allows the investigator to choose the size of multiple <span class="No-Break">image parts</span></li><li><strong class="bold">Case management information</strong>: The case number, evidence<a id="_idIndexMarker706"/> number, examiner <a id="_idIndexMarker707"/>name, description, <span class="No-Break">and notes</span></li></ul></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer194">
<img alt="Figure 8.25 – Guymager file format options" height="272" src="image/Figure_8.25_B19441.jpg" width="742"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.25 – Guymager file format options</p>
<ul>
<li><span class="No-Break"><strong class="bold">Destination</strong></span><span class="No-Break">:</span><ul><li><strong class="bold">Image directory</strong>: The location of the created image file and log (the <span class="No-Break">info file)</span></li><li><strong class="bold">Image filename</strong>: The<a id="_idIndexMarker708"/> name<a id="_idIndexMarker709"/> of the <span class="No-Break">image file</span></li></ul></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer195">
<img alt="Figure 8.26 – Guymager destination folder options" height="126" src="image/Figure_8.26_B19441.jpg" width="737"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.26 – Guymager destination folder options</p>
<h3>Hash calculation/verification</h3>
<p>Multiple hashing<a id="_idIndexMarker710"/> algorithms can be selected and calculated, allowing the investigator to choose from <strong class="source-inline">MD5</strong>, <strong class="source-inline">SHA-1</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">SHA-256</strong></span><span class="No-Break">.</span></p>
<p>The <strong class="bold">Re-read source after acquisition for verification</strong> option verifies <span class="No-Break">the source.</span></p>
<p>The <strong class="bold">Verify image after acquisition</strong> option verifies <span class="No-Break">the destination.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<img alt="Figure 8.27 – Guymager cryptographic algorithm options" height="168" src="image/Figure_8.27_B19441.jpg" width="737"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.27 – Guymager cryptographic algorithm options</p>
<p>At the bottom of <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.27</em>, note that there are two <span class="No-Break">grayed-out options.</span></p>
<p>Guymager adds a convenient <strong class="bold">Duplicate image...</strong> button (grayed-out in <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.27</em>) to create duplicate copies without having to repeat the data <span class="No-Break">entry process.</span></p>
<p>For new users, you may want to specify the directory where the image file will be saved. In the destination section, click on the <strong class="bold">Image directory</strong> button and choose your location. For this acquisition, I’ve chosen the <strong class="source-inline">Desktop</strong> directory as the location for both the image and the <span class="No-Break">log/info file.</span></p>
<p>The following screenshot shows the data that I’ve used for the Guymager acquisition, having chosen <strong class="source-inline">Desktop</strong> as the image directory and the <strong class="source-inline">MD5</strong> and <strong class="source-inline">SHA-1</strong> <span class="No-Break">hashing algorithms:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<img alt="Figure 8.28 – Guymager acquisition image folder options" height="327" src="image/Figure_8.28_B19441.jpg" width="452"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.28 – Guymager acquisition image folder options</p>
<p>Once the <strong class="bold">Start</strong> button is<a id="_idIndexMarker711"/> clicked (refer to <span class="No-Break"><em class="italic">Figure 8</em></span><em class="italic">.29</em>), note that the state changes from <strong class="bold">Idle</strong> to <strong class="bold">Running</strong>. The <strong class="bold">Progress</strong> field also now displays a <span class="No-Break">progress bar:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer198">
<img alt="Figure 8.29 – The Guymager drive acquisition process" height="616" src="image/Figure_8.29_B19441.jpg" width="1586"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.29 – The Guymager drive acquisition process</p>
<p>Taking a closer look at the details in the lower-left corner of the screen, we can see the size, image and info file paths, names and extensions, current speed, and chosen hash calculations. We also see that <strong class="bold">Image verification</strong> is <span class="No-Break">turned </span><span class="No-Break"><strong class="bold">on</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer199">
<img alt="Figure 8.30 – Guymager process details" height="190" src="image/Figure_8.30_B19441.jpg" width="528"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.30 – Guymager process details</p>
<p>Once the acquisition process is completed, the color of the <strong class="bold">State</strong> field button changes from blue to green, indicating that the acquisition process is finished, and it also displays <strong class="bold">Finished - Verified &amp; ok</strong> if verification options were selected in the <strong class="bold">Hash verification / calculation</strong> pane. The progress bar also <span class="No-Break">displays </span><span class="No-Break"><strong class="bold">100%</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer200">
<img alt="Figure 8.31 – The Guymager completed acquisition process" height="582" src="image/Figure_8.31_B19441.jpg" width="1589"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.31 – The Guymager completed acquisition process</p>
<p>Our output file <a id="_idIndexMarker712"/>and info file can be found on the desktop, as this was specified in the the evidence. We’ll now look into this by verifying and comparing hash <span class="No-Break">algorithms next.</span></p>
<h3>Exploring the .info file</h3>
<p>Double-clicking <a id="_idIndexMarker713"/>on the info file in the image directory <a id="_idIndexMarker714"/>window allows us to inspect a variety of details about the acquisition process, from start to completion, including the <span class="No-Break">hashed outputs.</span></p>
<p>This info file contains much more data than the log file produced by DC3DD, including the case <span class="No-Break">management details.</span></p>
<p>Let’s have a closer look at the hash details within the <strong class="source-inline">.</strong><span class="No-Break"><strong class="source-inline">info</strong></span><span class="No-Break"> file:</span></p>
<p>We can see that the <strong class="source-inline">MD5</strong> and <strong class="source-inline">SHA-1</strong> hashes have been created and verified, as shown in the last line of the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer201">
<img alt="Figure 8.32 – Guymager log file hash outputs" height="166" src="image/Figure_8.32_B19441.jpg" width="490"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.32 – Guymager log file hash outputs</p>
<p>This completes the evidence and drive acquisition processes using Guymager, which can be much simpler to use<a id="_idIndexMarker715"/> than the previous command-line<a id="_idIndexMarker716"/> tools, namely <strong class="source-inline">dc3dd</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">dd</strong></span><span class="No-Break">.</span></p>
<p>Let’s have a look at another acquisition tool called FTK Imager, which can also be used within <span class="No-Break">Kali Linux.</span></p>
<h1 id="_idParaDest-125"><a id="_idTextAnchor174"/>Drive and memory acquisition using FTK Imager in Wine</h1>
<p>There are several<a id="_idIndexMarker717"/> tools for Windows systems that you <a id="_idIndexMarker718"/>may wish to take advantage of to be able to capture the memory and paging files on a Windows device. The forensic images can then be opened on your Kali machine for <a id="_idIndexMarker719"/>analysis, using <strong class="bold">Volatility 3</strong> for memory analysis and <strong class="bold">Autopsy</strong> for<a id="_idIndexMarker720"/> drive analysis. Let’s first look at installing and using FTK Imager within Wine in <span class="No-Break">Kali Linux.</span></p>
<h2 id="_idParaDest-126"><a id="_idTextAnchor175"/>Installing FTK Imager</h2>
<p><strong class="bold">FTK</strong> (<strong class="bold">Forensic Toolkit</strong>) Imager<a id="_idIndexMarker721"/> is a free Windows tool for the live acquisition<a id="_idIndexMarker722"/> of memory (RAM), the paging file, and <span class="No-Break">drive images.</span></p>
<p>Follow these steps to install FTK Imager in Kali Linux to create <span class="No-Break">forensic acquisitions:</span></p>
<ol>
<li>First, download FTK Imager from the official website at <a href="https://go.exterro.com/l/43312/2022-08-23/f7rytx">https://go.exterro.com/l/43312/2022-08-23/f7rytx</a>. Enter all relevant detail on the registration page. Once all fields are completed, click on the <strong class="bold">Submit</strong> button, and you will be prompted to download <span class="No-Break">the application.</span></li>
<li>Once downloaded, click on the <strong class="bold">Home</strong> folder icon, then the <strong class="source-inline">Downloads</strong> folder, and then select <strong class="bold">Open Folder</strong>, as <span class="No-Break">shown here:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer202">
<img alt="Figure 8.33 – The Kali folder menu" height="393" src="image/Figure_8.33_B19441.jpg" width="570"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.33 – The Kali folder menu</p>
<ol>
<li value="3">Next, right-click <a id="_idIndexMarker723"/>on the <strong class="source-inline">AccessData_FTK_Imager</strong> file you downloaded, choose <strong class="bold">Open With</strong>, and then select <strong class="bold">Open with “Wine Windows Program Loader”</strong>, as shown in the <span class="No-Break">following screenshot.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer203">
<img alt="Figure 8.34 – Opening FTK Imager in Wine" height="313" src="image/Figure_8.34_B19441.jpg" width="797"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.34 – Opening FTK Imager in Wine</p>
<ol>
<li value="4">FTK Imager will now begin installing on your Kali Linux machine. Click <strong class="bold">Next</strong> <span class="No-Break">to proceed.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer204">
<img alt="Figure 8.35 – The FTK Imager installer" height="392" src="image/Figure_8.35_B19441.jpg" width="514"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.35 – The FTK Imager installer</p>
<ol>
<li value="5">Accept the <a id="_idIndexMarker724"/>license agreement, accept the destination folder by clicking <strong class="bold">Next</strong>, and then click on the <strong class="bold">Install</strong> button. Once the installation is complete, click on the <strong class="bold">Finish</strong> button to launch FTK Imager, as <span class="No-Break">shown here.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer205">
<img alt="Figure 8.36 – FTK Installation complete" height="390" src="image/Figure_8.36_B19441.jpg" width="508"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.36 – FTK Installation complete</p>
<ol>
<li value="6">You may be prompted<a id="_idIndexMarker725"/> to download the Wine Gecko installer, which is required for some applications to run correctly. Click on <strong class="bold">Install</strong> <span class="No-Break">to continue.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer206">
<img alt="Figure 8.37 – The Wine Gecko Installer" height="190" src="image/Figure_8.37_B19441.jpg" width="402"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.37 – The Wine Gecko Installer</p>
<p>FTK Imager should now be installed and running on your Kali <span class="No-Break">Linux machine.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer207">
<img alt="Figure 8.38 – The FTK Imager interface in Kali Linux" height="561" src="image/Figure_8.38_B19441.jpg" width="929"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.38 – The FTK Imager interface in Kali Linux</p>
<ol>
<li value="7">To view the<a id="_idIndexMarker726"/> options for imaging and acquisition, click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">File</strong></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer208">
<img alt="Figure 8.39 – The FTK Imager File menu" height="502" src="image/Figure_8.39_B19441.jpg" width="291"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.39 – The FTK Imager File menu</p>
<ol>
<li value="8">Within the <strong class="bold">File</strong> menu, we<a id="_idIndexMarker727"/> are presented with several options within FTK Imager for evidence acquisition and analysis. The <strong class="bold">Create Disk Image…</strong> option allows you to perform a forensic acquisition of physical and logical drives, contents of a folder, and CDs and DVDs. Click on the <strong class="bold">Create Disk </strong><span class="No-Break"><strong class="bold">Image…</strong></span><span class="No-Break"> option.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer209">
<img alt="Figure 8.40 – FTK Imager source selection options" height="352" src="image/Figure_8.40_B19441.jpg" width="648"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.40 – FTK Imager source selection options</p>
<ol>
<li value="9">Click on <strong class="bold">Next</strong> to <a id="_idIndexMarker728"/>continue. I’ve selected a 32-GB Kingston physical drive to acquire. You can select any drive of your choice. Once selected, click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Finish</strong></span><span class="No-Break">.</span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer210">
<img alt="Figure 8.41 – Source Drive Selection" height="272" src="image/Figure_8.41_B19441.jpg" width="372"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.41 – Source Drive Selection</p>
<ol>
<li value="10">Next, we’ll need to choose a destination to save the image file. Click on <strong class="bold">Add</strong>, choose the image type (<strong class="bold">Raw</strong>, <strong class="bold">SMART</strong>, <strong class="bold">E01</strong>, or <strong class="bold">AFF</strong>), and then click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Next</strong></span><span class="No-Break">.</span></li>
</ol>
<p class="IMG---Figure"> </p>
<div>
<div class="IMG---Figure" id="_idContainer211">
<img alt="Figure 8.42 – Image acquisition type" height="325" src="image/Figure_8.42_B19441.jpg" width="416"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.42 – Image acquisition type</p>
<ol>
<li value="11">Complete <a id="_idIndexMarker729"/>the form by filling in the <strong class="bold">Evidence Item Information</strong> fields, and then click <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Next</strong></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer212">
<img alt="Figure 8.43 – Acquisition evidence details" height="389" src="image/Figure_8.43_B19441.jpg" width="498"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.43 – Acquisition evidence details</p>
<ol>
<li value="12">Lastly, select<a id="_idIndexMarker730"/> the image destination folder and type a filename with <span class="No-Break">an extension.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer213">
<img alt="Figure 8.44 – The image destination folder" height="390" src="image/Figure_8.44_B19441.jpg" width="503"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.44 – The image destination folder</p>
<p>I’ve specified the <a id="_idIndexMarker731"/>image fragment size to be a value of <strong class="source-inline">0</strong>. This tells the software to not fragment or split the image file. Click on <strong class="bold">Finish</strong> and then <strong class="bold">Start</strong> to begin the <span class="No-Break">acquisition process.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer214">
<img alt="Figure 8.45 – The FTK Imager evidence acquisition process" height="361" src="image/Figure_8.45_B19441.jpg" width="470"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.45 – The FTK Imager evidence acquisition process</p>
<p>The created <a id="_idIndexMarker732"/>disk image can now be analyzed using tools of your choice, such as Autopsy, which will be covered in <a href="B19441_10.xhtml#_idTextAnchor191"><span class="No-Break"><em class="italic">Chapter 10</em></span></a>, <em class="italic">Memory Forensics and Analysis with Volatility 3,</em> and <a href="B19441_11.xhtml#_idTextAnchor211"><span class="No-Break"><em class="italic">Chapter 11</em></span></a>, <em class="italic">Artifact, Malware, and </em><span class="No-Break"><em class="italic">Ransomware Analysis</em></span><span class="No-Break">.</span></p>
<h2 id="_idParaDest-127"><a id="_idTextAnchor176"/>RAM acquisition with FTK Imager</h2>
<p>We can also<a id="_idIndexMarker733"/> perform <a id="_idIndexMarker734"/>live acquisition with FTK Imager, whereby we acquire the RAM and <span class="No-Break">paging file:</span></p>
<ol>
<li>Click on <strong class="bold">File</strong> and <span class="No-Break"><strong class="bold">Memory Capture</strong></span><span class="No-Break">.</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer215">
<img alt="Figure 8.46 – The FTK Imager memory and paging file acquisition process" height="292" src="image/Figure_8.46_B19441.jpg" width="349"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.46 – The FTK Imager memory and paging file acquisition process</p>
<ol>
<li value="2">Next, select the destination path, and specify a filename for the memory dump (<strong class="source-inline">.mem</strong>) file. To include the pagefile, check the <strong class="bold">Include </strong><span class="No-Break"><strong class="bold">pagefile</strong></span><span class="No-Break"> checkbox.</span></li>
<li>Click on <strong class="bold">Capture Memory</strong> to begin the <span class="No-Break">acquisition process.</span></li>
</ol>
<p>The status bar indicates when the process is completed. This is usually not a lengthy process compared to the <a id="_idIndexMarker735"/>static<a id="_idIndexMarker736"/> dive acquisition process. Using this within a VM may be problematic; however, it can be used on your standalone installation of Kali with Wine installed or any <span class="No-Break">Windows machine.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer216">
<img alt="Figure 8.47 – The FTK memory acquisition process" height="223" src="image/Figure_8.47_B19441.jpg" width="480"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.47 – The FTK memory acquisition process</p>
<p>This was a fairly simple process of acquiring RAM using FTK Imager. Let’s look at another tool called<a id="_idIndexMarker737"/> RAM <a id="_idIndexMarker738"/>Capturer that can also be used for <span class="No-Break">RAM acquisition.</span></p>
<h1 id="_idParaDest-128"><a id="_idTextAnchor177"/>RAM and paging file acquisition using Belkasoft RAM Capturer</h1>
<p><strong class="bold">Belkasoft</strong> is a <a id="_idIndexMarker739"/>company<a id="_idIndexMarker740"/> that creates <a id="_idIndexMarker741"/>forensic <a id="_idIndexMarker742"/>tools and also has a full suite of tools available for forensic acquisition and analysis, along with its free RAM capturer tool, which can be downloaded at <a href="https://belkasoft.com/ram-capturer">https://belkasoft.com/ram-capturer</a>. This tool is best used in Windows but is mentioned here because of its popularity and speed when performing memory and paging <span class="No-Break">file analysis.</span></p>
<p>After browsing the https://belkasoft.com/ram-capturer page, click on the <strong class="bold">Download Now</strong> button, enter your email address, and click on <strong class="bold">Proceed</strong>. An email with the download link should be sent to you within <span class="No-Break">24 hours.</span></p>
<p>Once downloaded and extracted on your Windows machine, choose the appropriate version (<strong class="source-inline">x86 </strong>or <strong class="source-inline">x64</strong>) and launch <span class="No-Break">the environment.</span></p>
<p>The GUI is as <a id="_idIndexMarker743"/>simple as it gets with Belkasoft RAM Capturer. You are prompted to specify an output folder path, and from there, it captures the memory and paging file after clicking <span class="No-Break">on </span><span class="No-Break"><strong class="bold">Capture!</strong></span><span class="No-Break">.</span></p>
<div>
<div class="IMG---Figure" id="_idContainer217">
<img alt="Figure 8.48 – Belkasoft Live RAM Capturer acquisition" height="277" src="image/Figure_8.48_B19441.jpg" width="541"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.48 – Belkasoft Live RAM Capturer acquisition</p>
<p>The tool takes a few minutes to perform the acquisition, and from there, you can hash and analyze using the<a id="_idIndexMarker744"/> tools of your choice. This <a id="_idIndexMarker745"/>concludes our usage of RAM Capturer, one of <a id="_idIndexMarker746"/>the<a id="_idIndexMarker747"/> simplest tools available for <span class="No-Break">RAM acquisition.</span></p>
<h1 id="_idParaDest-129"><a id="_idTextAnchor178"/>Summary</h1>
<p>In this chapter, we covered several tools that can be used natively in Kali Linux and another tool called FTK Imager, which is native to Windows but can be installed in Kali Linux once Wine has been installed, for the acquisition of digital evidence. We first learned about the importance of being able to identify your devices so that you can accurately acquire a forensic copy or image of an evidence file using the <strong class="source-inline">fdisk - l</strong> command. For forensic analysis, bitstream copies of the evidence are needed, as these provide an exact copy of the evidence, bit by bit, which is why we used tools such as DC3DD, DD, <span class="No-Break">and Guymager.</span></p>
<p>Firstly, we used DC3DD, an enhancement of the data dump tool, and through the Terminal, we performed quite a few tasks, including device imaging, hashing, verification, and drive wiping. We also performed acquisition using DD, which is very similar <span class="No-Break">to DC3DD.</span></p>
<p>Our third tool, Guymager, has built-in case management abilities and also has many functional similarities to DC3DD, but it comes as a GUI tool and may be easier <span class="No-Break">for beginners.</span></p>
<p>All the tools covered in this chapter deliver accurate and forensically sound results. For those that may not constantly work with Guymager, DD, and DC3DD, Guymager may be the easier tool to use, given that all acquisition options including cloning are readily available through the GUI, along with an easy-to-read log, which provides case management details. For advanced uses such as drive wiping, however, you may wish to use DC3DD. In the end, however, the choice <span class="No-Break">remains yours.</span></p>
<p>We also looked at FTK Imager and Belkasoft Ram Capturer. FTK Imager runs on Windows and can acquire RAM and disk images, but it can easily be installed in Kali using Wine, whereas Belkasoft RAM Capturer (also for Windows) performs only <span class="No-Break">RAM acquisition.</span></p>
<p>Not bad for our first forensics tools in Kali Linux! Next, we’ll move on to some analysis and file recovery tools. <span class="No-Break">Exciting stuff!</span></p>
</div>
<div>
<div id="_idContainer219">
</div>
</div>
</div></body></html>