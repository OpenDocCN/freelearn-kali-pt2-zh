- en: '13'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Performing a Full DFIR Analysis with the Autopsy 4 GUI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As we previously learned in [*Chapter 12*](B19441_12.xhtml#_idTextAnchor225),
    *Autopsy Forensic Browser*, when we used the Autopsy forensic browser, which comes
    with Kali Linux, Autopsy is quite a powerful tool when it comes to automated evidence
    and file analysis. However, the Autopsy forensic browser has some limitations,
    especially as it is older and not as frequently updated as the **Graphical User
    Interface** (**GUI**) version. The Autopsy forensic browser has been at version
    2.2 for many years, whereas the Autopsy GUI is currently, at the time of writing,
    up to version 4.19.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will focus on the Autopsy v4 GUI (also called the Autopsy
    4 GUI) and analyze the very same file used in the previous chapter to compare
    the usage, features, and differences in analysis findings (if any). The following
    topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Autopsy 4 GUI features
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing Autopsy 4 in Kali Linux using Wine
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Downloading sample files for automated analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating new cases and getting acquainted with the Autopsy 4 interface
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Analyzing directories and recovering deleted files and artifacts with Autopsy
    4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Autopsy 4 GUI features
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Autopsy 4 GUI comes with many easy-to-use features for relatively simple
    and fast analysis. Autopsy 4 is one of the very few comprehensive forensic suites,
    is totally free to use, and is used by professionals and law enforcement.
  prefs: []
  type: TYPE_NORMAL
- en: 'Some of the features include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Simple and uncomplicated user interface
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Case management with all files for each case stored in their respective directories
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Available third-party add-ons and modules
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Indexed keyword searching
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extraction of web artifacts from the browser, including cookies and browser
    history from Chrome and Firefox
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automated file recovery using PhotoRec
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Exchangeable Image File** (**EXIF**) data extraction using photo and video
    analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Advanced timeline analysis and event viewing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Indicators of Compromise** (**IoC**) analysis'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Parallel task-processing for fast analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Freely available for Windows, Linux, and Mac
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Full details of Autopsy can be found on their home page at [https://www.sleuthkit.org/autopsy/#:~:text=Autopsy%C2%AE%20is%20a%20digital,from%20your%20camera’s%20memory%20card](https://www.sleuthkit.org/autopsy/#:~:text=Autopsy%C2%AE%20is%20a%20digital,from%20your%20camera%E2%80%99s%20memory%20card).
  prefs: []
  type: TYPE_NORMAL
- en: Now that we’re familiar with some of the uses of the Autopsy 4 GUI, let’s install
    it in Kali using Wine.
  prefs: []
  type: TYPE_NORMAL
- en: Installing Autopsy 4 in Kali Linux using Wine
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this example, we will be using Autopsy for Windows, which will be installed
    using Wine. Autopsy 4 can be downloaded for Linux; however, this may be best left
    to advanced users. If you haven’t installed Wine on Kali Linux, you can revisit
    [*Chapter 5*](B19441_05.xhtml#_idTextAnchor085), *Installing Wine in Kali Linux*,
    and then return to the current chapter.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s get started with installing Autopsy 4 in Kali Linux using Wine:'
  prefs: []
  type: TYPE_NORMAL
- en: 'All versions of Autopsy 4 can be found here: [https://www.autopsy.com/download/](https://www.autopsy.com/download/)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To download Autopsy for Windows, you can click on the direct link here: [https://github.com/sleuthkit/autopsy/releases/download/autopsy-4.19.3/autopsy-4.19.3-64bit.msi](https://github.com/sleuthkit/autopsy/releases/download/autopsy-4.19.3/autopsy-4.19.3-64bit.msi)'
  prefs: []
  type: TYPE_NORMAL
- en: The previous version is the most current and stable 64-bit version for Windows
    and at the time of writing is at version 4.19.3\. This tutorial should also apply
    to later versions as the usage has thus far remained the same over the years.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once Autopsy 4.19.3 has been downloaded, you can either double-click on the
    downloaded file or right-click on the **autopsy-4.19.3-64bit.msi** file and select
    **Open with Wine Windows Program Loader** to launch the program. Doing so will
    launch the **Autopsy Setup** window, as seen in the following figure:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.1 – Autopsy wizard welcome screen](image/Figure_13.01_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.1 – Autopsy wizard welcome screen
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Next** to proceed. The installation folder is listed as would usually
    be displayed within a Windows installation. Click on **Next** to proceed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.2 – Autopsy installation folder](image/Figure_13.02_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.2 – Autopsy installation folder
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Install** to begin the installation process.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.3 – Autopsy installation process](image/Figure_13.03_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.3 – Autopsy installation process
  prefs: []
  type: TYPE_NORMAL
- en: The installation may take a few minutes depending on how much RAM and CPU resources
    are assigned to your Kali environment.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.4 – Copy files during the installation process](image/Figure_13.04_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.4 – Copy files during the installation process
  prefs: []
  type: TYPE_NORMAL
- en: Once all files are installed, the wizard will tell us that the installation
    is complete. Click on **Finish** to start Autopsy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.5 – Completed Autopsy installation](image/Figure_13.05_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.5 – Completed Autopsy installation
  prefs: []
  type: TYPE_NORMAL
- en: After installation, you will be presented with the Autopsy 4 splash screen.
    It may take a minute to load all the required modules.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.6 – Autopsy 4 splash screen](image/Figure_13.06_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.6 – Autopsy 4 splash screen
  prefs: []
  type: TYPE_NORMAL
- en: After all the modules are loaded, information about case repositories is presented,
    as seen in the following screenshot. Click on **OK** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.7 – Case repository information](image/Figure_13.07_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.7 – Case repository information
  prefs: []
  type: TYPE_NORMAL
- en: We have now completed the installation and initial configuration of the Windows
    version of the Autopsy 4 GUI within Kali Linux using Wine. Before we proceed any
    further, let’s ensure we have all the necessary sample files downloaded.
  prefs: []
  type: TYPE_NORMAL
- en: Downloading sample files for automated analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The sample evidence file we will be using will be the same **terry-work-usb-2009-12-11.E01**
    file downloaded in the previous chapter, which was analyzed using the Autopsy
    forensic browser. It can again be downloaded directly from here: [https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/terry-work-usb-2009-12-11.E01](https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/terry-work-usb-2009-12-11.E01).'
  prefs: []
  type: TYPE_NORMAL
- en: 'I’d also like you to take this opportunity to download the other files for
    this example from the [digitalcorpora.com](http://digitalcorpora.com) website,
    which you can analyze on your own to become fully acquainted with Autopsy 4 as
    this is one of the main open source and free tools used by DFIR investigators
    and analysts:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Charlie-work-usb** file: [https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/charlie-work-usb-2009-12-11.E01](https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/charlie-work-usb-2009-12-11.E01)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The **Jo-favorites-usb** file: [https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/jo-favorites-usb-2009-12-11.E01](https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/jo-favorites-usb-2009-12-11.E01)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The **Jo-work-usb** file: [https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/jo-work-usb-2009-12-11.E01](https://digitalcorpora.s3.amazonaws.com/corpora/scenarios/2009-m57-patents/usb/jo-work-usb-2009-12-11.E01)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Again, feel free to come back to these files to improve upon your DFIR analytical
    skills either after reading this chapter or once you’ve reached the end of the
    book.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s now get back to our Autopsy 4 installation and familiarize ourselves with
    the interface.
  prefs: []
  type: TYPE_NORMAL
- en: Creating new cases and getting acquainted with the Autopsy 4 interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that we have installed the Autopsy 4 GUI in Wine on Kali and downloaded
    the required files from the previous section, we can get started in the Autopsy
    4 GUI by creating a new case using the sample evidence files, which we will then
    analyze in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s begin by creating a new case within the Autopsy 4 GUI:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Whether continuing from where we previously left off before downloading the
    sample evidence files or opening Autopsy 4 from the desktop or application menu,
    you will be greeted with the options to either begin a new case or open a case.
    For our purposes, let’s create a new case by clicking on **New Case**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.8 – Creating a new case in Autopsy](image/Figure_13.08_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.8 – Creating a new case in Autopsy
  prefs: []
  type: TYPE_NORMAL
- en: Next, we can add a case name. I’ve also selected the **Documents** folder in
    Kali as my **Base Directory** folder to house all files and logs. Click on **Next**
    to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.9 – New case details](image/Figure_13.09_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.9 – New case details
  prefs: []
  type: TYPE_NORMAL
- en: We will then have to give the case a number and fill in the examiner details.
    When completed, click on the **Finish** button to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.10 – Examiner details](image/Figure_13.10_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.10 – Examiner details
  prefs: []
  type: TYPE_NORMAL
- en: Creating your new case may take several minutes as Autopsy is prepared for usage.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.11 – Opening new case status display](image/Figure_13.11_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.11 – Opening new case status display
  prefs: []
  type: TYPE_NORMAL
- en: Then, select the host. We can leave the default option as **Generate new host
    name based on data source name** for now and click on **Next** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.12 – Case host name](image/Figure_13.12_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.12 – Case host name
  prefs: []
  type: TYPE_NORMAL
- en: Our next step is an important one that we must pay attention to. Here, we select
    the data source type. Our sample file (**terry-work-usb-2009-12-11.E01**) is a
    forensically acquired evidence image file and so we will be choosing the first
    option, **Disk Image or VM File**. Once selected, click on **Next** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.13 – Selecting a data source](image/Figure_13.13_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.13 – Selecting a data source
  prefs: []
  type: TYPE_NORMAL
- en: We will now select the file to be analyzed. I have downloaded the sample evidence
    file to my **Downloads** folder in Kali Linux. You can click on the **Browse**
    button and navigate to the **C:\users\kali\Downloads** folder, and then select
    the evidence file (**terry-work-usb-2009-12-11.E01**) or type in the path of your
    file. Select your time zone and click **Next** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.14 – Data source path specification](image/Figure_13.14_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.14 – Data source path specification
  prefs: []
  type: TYPE_NORMAL
- en: Next, we can configure the ingest modules that will determine the items on which
    Autopsy will run the selected modules to perform a fully automated DFIR analysis.
    I’ve left the default setting with all files and directories selected. Click on
    **Next** to continue.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.15 – Configuring ingest modules](image/Figure_13.15_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.15 – Configuring ingest modules
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  prefs: []
  type: TYPE_NORMAL
- en: On larger evidence files, disks, and images, the analysis process may be longer
    due to the large number of items being processed. Running all modules may not
    be possible. However, Autopsy will automatically cancel any modules that cannot
    be run if you do not manually specify them.
  prefs: []
  type: TYPE_NORMAL
- en: 'If Autopsy encounters any errors with modules, they will automatically be removed,
    as seen in the following screenshot. Click on **OK** to accept this and continue:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.16 – Ingest module failure error](image/Figure_13.16_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.16 – Ingest module failure error
  prefs: []
  type: TYPE_NORMAL
- en: 'Once any error messages have been dismissed, click on the **Finish** button
    to begin analyzing the files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Figure 13.17 – Finalizing data source details for analysis](image/Figure_13.17_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.17 – Finalizing data source details for analysis
  prefs: []
  type: TYPE_NORMAL
- en: We can now view all analyzed files in the Autopsy interface, as seen in the
    following screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.18 – Autopsy interface](image/Figure_13.18_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.18 – Autopsy interface
  prefs: []
  type: TYPE_NORMAL
- en: Let’s start exploring our findings in the Autopsy interface to view the results
    of the analysis.
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing directories and recovering deleted files and artifacts with Autopsy
    4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As previously mentioned, Autopsy has a very simple and uncomplicated interface.
    The Autopsy window is separated into three panes, as described here:'
  prefs: []
  type: TYPE_NORMAL
- en: The left pane shows the data source that was examined and analyzed and all directories
    and files discovered and recovered by Autopsy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The main pane displays all the discovered files within the data source folders
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The lower pane displays file details such as **Hex**, **Text**, **File Metadata**,
    and **Data Artifacts**
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In the following screenshot, I’ve expanded the **Data Sources**, **File Views**,
    and **Deleted Files** folders by clicking on the plus signs (**+**) next to each
    of the mentioned items, which all display sub-directories, as seen in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.19 – Analyzed data source findings in Autopsy](image/Figure_13.19_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.19 – Analyzed data source findings in Autopsy
  prefs: []
  type: TYPE_NORMAL
- en: By expanding the **Data Sources** item on the left pane, we can see that the
    evidence file has two volumes. Volume 1 is unallocated space and volume 2 is a
    Windows 95 FAT32 volume, which when expanded shows orphaned files, unallocated
    files, and even deleted folders, as seen in the following screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.20 – Data Sources volumes and discovered artifacts](image/Figure_13.20_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.20 – Data Sources volumes and discovered artifacts
  prefs: []
  type: TYPE_NORMAL
- en: If we look a bit closer at **File Types**, we can see that Autopsy has categorized
    the file types into **Images**, **Videos**, **Audio**, **Archives**, and even
    **Documents** sub-folders, which may contain discovered artifacts.
  prefs: []
  type: TYPE_NORMAL
- en: In the following screenshot, we can see that Autopsy has discovered several
    artifact types, including 4,992 images, 4 databases, and 24 deleted files. I’ve
    clicked on the expanded **Images** folder containing 4,992 files. In the right
    pane, we can see the list of all images along with the times the image files were
    modified, accessed, and created.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.21 – Viewing discovered images and associated timestamps](image/Figure_13.21_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.21 – Viewing discovered images and associated timestamps
  prefs: []
  type: TYPE_NORMAL
- en: Patience is key!
  prefs: []
  type: TYPE_NORMAL
- en: It may seem like a tedious task to go through all these files to discover any
    useful information or artifacts, but the key to successful DFIR investigation
    and analysis is patience!
  prefs: []
  type: TYPE_NORMAL
- en: Next up, I selected the **Deleted Files** folder, and then selected the **File
    System** folder. The contents of the **File System** folder are displayed in the
    main window with a red **X** next to each deleted file, as seen in *Figure 12**.22*.
    I also scrolled down and clicked on the deleted **xpadvancedkeylogger.exe** file,
    which is reported as last modified on 2009-12-03 at 08:40 EST.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.22 – Discovered and recovered artifacts](image/Figure_13.22_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.22 – Discovered and recovered artifacts
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding screenshot, we can see how useful Autopsy can be when having
    to sift through deleted files as they are all grouped together and timestamped.
  prefs: []
  type: TYPE_NORMAL
- en: The final feature I’d like to show you in this very short tutorial is the **Timeline**
    feature. Clicking the **Timeline** button at the top of the application generates
    a timeline of events by month, as seen in the following screenshot.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.23 – Autopsy Timeline feature](image/Figure_13.23_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.23 – Autopsy Timeline feature
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding timeline, you can also see events by month. Let’s click on
    the red **October** marker. In the pane below, we can see that there are two executable
    files that were created and modified on 2008-10-15 at 17:14\. These files are
    **vnc** files that can be used to gain or give remote access and possibly compromise
    devices.
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.24 – VNC files within the Timeline feature](image/Figure_13.24_B19441.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.24 – VNC files within the Timeline feature
  prefs: []
  type: TYPE_NORMAL
- en: This brings us to the end of our automated DFIR analysis using Autopsy 4\. I
    encourage you to return to this tool using the sample files mentioned at the beginning
    of the chapter and analyze the other downloaded sample files mentioned in the
    *Downloading sample files for automated analysis* section of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we downloaded and installed the more powerful Windows version
    of Autopsy known as the Autopsy 4 GUI and were able to run it in Kali Linux using
    Wine. We also learned how simple it is to automatically analyze evidence files
    to find artifacts such as deleted files using this version of Autopsy. I hope
    you enjoyed this chapter as it showcases the much more powerful version of Autopsy
    when compared to the Autopsy browser, which we looked at in [*Chapter 12*](B19441_12.xhtml#_idTextAnchor225),
    *Autopsy* *Forensic Browser*.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will learn about some popular scanning and reconnaissance tools that,
    although not specifically created for DFIR purposes, are very useful in network
    forensics analysis and investigations. See you in [*Chapter 14*](B19441_14.xhtml#_idTextAnchor243),
    *Network* *Discovery Tools*!
  prefs: []
  type: TYPE_NORMAL
