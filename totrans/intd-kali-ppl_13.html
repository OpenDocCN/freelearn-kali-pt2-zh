<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer172">
<h1 class="chapter-number" id="_idParaDest-143"><a id="_idTextAnchor147"/>9</h1>
<h1 id="_idParaDest-144"><a id="_idTextAnchor148"/>Digital Forensics</h1>
<p>The tools we’ve talked about up until now were designed to analyze, identify, capture, and store digital traffic to aid cybersecurity defense teams in further analyzing and responding. Some of the tools themselves had potential abilities built into their design to respond automatically on behalf of we silly <span class="No-Break">naïve humans.</span></p>
<p>However, no matter how technologically advanced and no matter how well trained we cyber defenders are, there is always going to be someone out there with our level of skillset or greater who is able to find deeply complex and advanced ways to circumvent our methods. These are some of the more damaging cybercriminals in the world; these are the folks who might be trained by big-budget organizations such as nation states or organized crime units. They are experts at playing the long game and taking the time and money – years upon years if need be – to train highly dedicated personnel who might share their employer’s mission and belief system; this is well within their level <span class="No-Break">of patience.</span></p>
<p>Folks with such advanced levels of skill and training will undoubtedly pass off some of their methods to less trained and experienced folks over time and collectively; this leads us to the top tier of cyber adversaries. Sometimes, the crimes committed by these folks are not digital in nature at all, but digital technology is used as a tool to support or document their activities. When such people are caught, depending on the legal jurisdiction that snatches them up, they may be entitled to due process as well as the default assertation that they are innocent until proven guilty. Getting any proof of wrongdoing, as it relates to technology, is up to digital <span class="No-Break">forensic investigators.</span></p>
<p>It turns out that Kali Purple either provides or supports several tools that relate to digital forensics and deep analysis. In this chapter, we are going to cover some of the more prominent tools that fall within this realm and how to add them to or activate them within our Kali <span class="No-Break">Purple installation.</span></p>
<p>Additionally, we are going to cover some of the tools that these bad actors use to conduct their business in the first place. Why? So we can understand these tools, which are also very much a part of Kali Purple, and how they can be used will help us learn what the bad actors were trying to do. Not only that, but we can also use these same tools to train the people of our organizations and then run mock campaigns to test what they’ve learned, therefore assessing the quality and effectiveness of any training we give. The following topics will be covered in <span class="No-Break">this chapter:</span></p>
<ul>
<li>Digital forensics and <span class="No-Break">malware analysis</span></li>
<li><strong class="bold">Social-Engineer </strong><span class="No-Break"><strong class="bold">Toolkit</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">SET</strong></span><span class="No-Break">)</span></li>
<li><strong class="bold">Browser Exploitation </strong><span class="No-Break"><strong class="bold">Framework</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">BeEF</strong></span><span class="No-Break">)</span></li>
<li><span class="No-Break">Maltego</span></li>
</ul>
<h1 id="_idParaDest-145"><a id="_idTextAnchor149"/>Technical requirements</h1>
<p>The applications in this chapter are far less resource intensive than in previous chapters. However, if you are working through the full Kali Purple experience, we recommend you keep the more stringent requirements in mind from the other chapters, should you be using any mix of the tools from <span class="No-Break">this endeavor:</span></p>
<ul>
<li><strong class="bold">Minimum requirements</strong>: A computing device with either amd64 (x86_64/64-bit) or i386 (x86/32-bit) architectures. It should contain at least 4 GB <span class="No-Break">of RAM.</span></li>
<li><strong class="bold">Recommended requirements</strong>: Based on feedback from cybersecurity field practitioners, aim for amd64 (x86_64/64-bit) architecture with 8 GB <span class="No-Break">of RAM.</span></li>
</ul>
<h1 id="_idParaDest-146"><a id="_idTextAnchor150"/>Digital forensics and malware analysis</h1>
<p><strong class="bold">Digital forensics</strong> is a career field unto <a id="_idIndexMarker737"/>itself. As technology continues to rapidly<a id="_idIndexMarker738"/> evolve, so does its uses in criminal behavior. Larger law enforcement agencies employ analysts who specialize in extracting valuable data from digital devices. Kali Purple offers compatibility with some of these utilities that are used to assist in this career field. You too can use these tools alongside many of the ones you’ve already been studying. Consider that not all malicious behavior is going to be realized from the perspective of a law <span class="No-Break">enforcement professional.</span></p>
<p>Those of you presently working careers in cybersecurity are already very well aware of this. There are going to be a number of times when you, the analyst, are the first point of contact – the original discoverer – with malicious and sometimes overtly criminal, even heinous activity. While nobody wants to be found in the middle of such an experience, imagine if you were. Through the routine of your day-to-day cybersecurity profession, what if you were to discover some incriminating evidence that results in taking a very bad person off the street before they can harm someone else? Just because we sit behind plastic and silicon breadboard devices doesn’t mean our profession isn’t important, and it certainly doesn’t mean we will not potentially save lives and protect<a id="_idIndexMarker739"/> innocent people<a id="_idIndexMarker740"/> from the evil intentions <span class="No-Break">of others.</span></p>
<p>In this section, we’re going to explore some of the tools used to conduct digital forensic extraction and analysis. Let’s begin with a tool that is used to analyze <span class="No-Break">Windows applications.</span></p>
<h2 id="_idParaDest-147"><a id="_idTextAnchor151"/>Portable Executable Identifier (PEiD)</h2>
<p>PEiD – also known as <strong class="bold">PEv</strong> (<strong class="bold">PE version</strong>) – is a popular and widely<a id="_idIndexMarker741"/> used tool for identifying<a id="_idIndexMarker742"/> and analyzing Windows executable files (PE files). It is specifically designed to detect packers, cryptors, and compilers used in executable files. PEv is commonly utilized in the field of malware analysis and reverse engineering to understand the nature of executable files and identify potential malicious traits. When a file is analyzed using PEv, it provides insights into the specific packer or compiler used to create the executable, which aids in understanding the file’s behavior and potential security risks. PEv assists security professionals and analysts in identifying and classifying executable files based on their internal characteristics aiding in the detection and analysis of potentially <span class="No-Break">harmful software.</span></p>
<p>To install PEv, perform the <span class="No-Break">following steps:</span></p>
<ol>
<li>Type <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">sudo </strong><span class="No-Break"><strong class="source-inline">apt upgrade</strong></span><span class="No-Break">.</span></li>
<li>Then, type <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install pev</strong></span><span class="No-Break">.</span></li>
</ol>
<p>Some older systems and versions might require you to start the PEiD by typing <strong class="source-inline">sudo bash pev</strong> or <strong class="source-inline">sudo ./pev &amp;</strong> but more likely than not, you’ll need to navigate to the directory it was installed – which should be <strong class="source-inline">/usr/bin</strong> – and type <strong class="source-inline">sudo pescan -v &lt;filepath/filename&gt;</strong> and note that the file must be a Windows executable file for this application to work because that’s what this application was <span class="No-Break">designed for.</span></p>
<p>Alternatively, you can select the icon with the Kali Dragon mascot in the upper left of your Kali Purple desktop, just under <strong class="bold">File</strong>, type <strong class="source-inline">pev</strong> into the search bar, and then select the <strong class="bold">pev</strong> option from the<a id="_idIndexMarker743"/> <span class="No-Break">dropdown menu:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer159">
<img alt="Figure 9.1 – Use the Kali search function to find an application" height="174" src="image/B21223_09_1.jpg" width="568"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 – Use the Kali search function to find an application</p>
<p>Let us check the <span class="No-Break">next product.</span></p>
<h2 id="_idParaDest-148"><a id="_idTextAnchor152"/>PEScan</h2>
<p>Another digital forensics product<a id="_idIndexMarker744"/> that works very well with PEiD is <strong class="bold">PEScan</strong>, and you should already have this installed on your system. Whereas PEv is designed specifically for analyzing PE files, PEScan is a separate tool entirely that is designed to serve the purpose of detecting what file type a file is with particular emphasis placed on identifying characteristics of PE file types. It does this by analyzing the structure of the files to determine whether they conform to known specifications of PE files. PEScan can also be used to identify the characteristics of headers, sections, imports, and <span class="No-Break">other attributes.</span></p>
<p>As far as malware analysis is concerned, PEScan is valuable for identifying and analyzing potential threats within the context of Windows executable files. It is commonly deployed in conjunction with other security tools and analysis techniques to gain insight into the functionality and behavior of executable files, aiding in the identification of <span class="No-Break">malicious code.</span></p>
<p>PEScan is most useful in identifying and confirming the presence of PE files within a system or analyzing suspicious files to determine their nature and potential impact on the host devices and/or network. This tool provides valuable information for aiding in the assessment of the files’ threat level along with assisting in the formulation of appropriate <span class="No-Break">mitigation strategies.</span></p>
<p>To use PEScan, open a command terminal<a id="_idIndexMarker745"/> on your Kali Purple desktop and first type <strong class="source-inline">pescan</strong> by itself to see a list of additional options. There, you’ll see an example of how to use this tool and that it’s very straightforward. If you wish to use any of the options presented, you will type the first value you see in the line for the option you want between <strong class="source-inline">pescan</strong> and <strong class="source-inline">&lt;filename&gt;</strong>. So, if you would like to show the version of <strong class="source-inline">putty.exe</strong>, for example, you would type <strong class="source-inline">pescan -V putty.exe</strong>, taking special note that the options are <span class="No-Break">case sensitive:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer160">
<img alt="Figure 9.2 – PEScan usage in a command terminal" height="582" src="image/B21223_09_2.jpg" width="1000"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 – PEScan usage in a command terminal</p>
<p>Let us check out the <span class="No-Break">next tool.</span></p>
<h2 id="_idParaDest-149"><a id="_idTextAnchor153"/>IDA Pro</h2>
<p><strong class="bold">IDA Pro</strong> is an advanced, interactive<a id="_idIndexMarker746"/> disassembler, widely regarded as one of the most powerful and comprehensive tools for reverse engineering, malware analysis, and binary analysis. Its robust set of features, extensibility, and cross-platform support make it a preferred choice for professionals working in malware analysis, vulnerability research, binary analysis, and where reverse engineering is a part of <span class="No-Break">their profession.</span></p>
<p><strong class="bold">Reverse engineering</strong> is the process of analyzing<a id="_idIndexMarker747"/> a system, product, or software application to understand its design, architecture, functionality, and behavior. This is typically done with the goal of reproducing or modifying its features, implementing interoperability, or identifying potential security vulnerabilities. As far as software is concerned, reverse engineering will often involve executable binaries, firmware, or hardware to uncover the underlying logic and functionality – that is, to uncover how the software was built <span class="No-Break">to </span><span class="No-Break"><em class="italic">think</em></span><span class="No-Break">.</span></p>
<p>IDA Pro has many key features<a id="_idIndexMarker748"/> which include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Disassembly and decompilation</strong>: IDA Pro can disassemble and decompile a wide range of executable files and binaries, providing a human-readable representation of the code and its behavior. It supports various processor architectures, making it versatile for analyzing different types <span class="No-Break">of executables.</span></li>
<li><strong class="bold">Graphical user interface (GUI)</strong>: IDA Pro’s GUI allows for interactive<a id="_idIndexMarker749"/> exploration of disassembled code, control flow graphs, and data structures, making it intuitive and user friendly for reverse engineers and security analysts. A <strong class="bold">data structure</strong> is a type of organization<a id="_idIndexMarker750"/> and storing of data within a program itself as opposed to a database so a computer can efficiently access and manipulate the data. Some examples include lists, queues, trees, graphs, and <span class="No-Break">hash tables.</span></li>
<li><strong class="bold">Cross-platform support</strong>: IDA Pro supports the disassembly and analysis of binaries across different operating systems and processor architectures, allowing analysts to work with a wide variety of executable formats <span class="No-Break">and platforms.</span></li>
<li><strong class="bold">Plugin ecosystem</strong>: IDA Pro boasts a robust plugin architecture, enabling users to extend its functionality with custom scripts and plugins. This extensibility allows for the creation of specialized analysis and visualization tools, enhancing IDA <span class="No-Break">Pro’s capabilities.</span></li>
<li><strong class="bold">Static analysis and data flow analysis</strong>: IDA Pro provides features for static analysis, including tracking<a id="_idIndexMarker751"/> data flow through the disassembled code, identifying function calls, and reconstructing high-level constructs such as loops and conditions. A <strong class="bold">loop</strong> in this circumstance<a id="_idIndexMarker752"/> is when a piece of software runs a section of code over and over again, often iterating some type of variable with each loop. An example might be incrementing or decrementing a numerical value. A <strong class="bold">condition</strong> would be when a piece<a id="_idIndexMarker753"/> of code is instructed to execute only if a particular set of criteria has been met and is often seen within raw code as <strong class="source-inline">if</strong>, <strong class="source-inline">else</strong>, <strong class="source-inline">if else</strong>, or <span class="No-Break"><strong class="source-inline">elseif</strong></span><span class="No-Break"> statements.</span></li>
<li><strong class="bold">Binary patching and modification</strong>: IDA Pro enables users to patch binaries and modify their behavior, providing a platform for vulnerability research, exploit development, and binary modification for specific <span class="No-Break">use cases.</span></li>
<li><strong class="bold">Collaborative analysis</strong>: IDA Pro supports collaborative analysis, allowing multiple analysts to work on the same disassembly database and share their findings, annotations, <span class="No-Break">and comments.</span></li>
<li><strong class="bold">Scripting and automation</strong>: IDA Pro includes a built-in scripting language that allows users to automate repetitive tasks, create custom analysis routines, and extend the tool’s functionality through scripting. The language is called <strong class="bold">IDAPython</strong> and in literal terms is the same<a id="_idIndexMarker754"/> as Python. It’s given its own identification, however, because of the specialized APIs and language library options included with it. These are tools focused specifically on <span class="No-Break">reverse engineering.</span></li>
<li><strong class="bold">Debugger integration</strong>: IDA Pro integrates with various debuggers, enabling a seamless transition between static analysis and dynamic debugging, facilitating the correlation of disassembled code with dynamic runtime behavior. Some of these include <strong class="bold">GNU Debugger</strong> (<strong class="bold">GDB</strong>), <strong class="bold">Windows Debugger</strong> (<strong class="bold">WinDbg</strong>), OllyDbg, x64dbg, <strong class="bold">LLVM Debugger</strong> (<strong class="bold">LLDB</strong>), QEMU Debugger, and<a id="_idIndexMarker755"/> Radare2 Debugger, as well<a id="_idIndexMarker756"/> as the option<a id="_idIndexMarker757"/> for advanced users to integrate <span class="No-Break">custom debuggers.</span></li>
<li><strong class="bold">Processor module software development kit (SDK)</strong>: IDA Pro provides a processor module SDK, which enables the creation of custom processor modules for analyzing and disassembling executable files targeting specific architectures. This is a tool provided to IDA Pro by Hex-Rays, the creator of IDA Pro, which assists developers in extending <span class="No-Break">disassembly capabilities.</span></li>
<li><strong class="bold">File format support</strong>: IDA Pro supports a wide range of file formats, including ELF, PE, Mach-O, and COFF, amongst others. This makes it a very versatile tool for analyzing executables from different operating systems <span class="No-Break">and platforms.</span></li>
<li><strong class="bold">Extensive community documentation</strong>: IDA Pro benefits from a very active user community, extensive documentation, and online resources, making it a well-supported and widely adopted tool in reverse engineering and security research communities. If you’d like to explore more about this product and its online community, just follow the link ahead and we’ll toss a copy of the link to Hex-Rays in the <em class="italic">Further reading</em> section for your future<a id="_idIndexMarker758"/> <span class="No-Break">reference also.</span></li>
</ul>
<p>To acquire a copy of IDA Pro, log into your Kali Purple environment, and within that environment, open<a id="_idIndexMarker759"/> a web browser, pointing the URL to <a href="https://hex-rays.com/ida-pro/">https://hex-rays.com/ida-pro/</a>. Don’t let the prompt to buy a license scare you. They have a free version for you to try out before deciding if you want to spend the dollar. To find that free version, simply scroll down the page until you see the <strong class="bold">Which version of IDA is the best for you?</strong> section. There, you will see a demo version or a barebones free version. Select which option you prefer, and you’ll be taken to a page where you can grab your SHA256 hash value. By now, you know what to do. Record your hash value and download the Linux version (assuming you’re within your Kali <span class="No-Break">Purple environment):</span></p>
<div>
<div class="IMG---Figure" id="_idContainer161">
<img alt="Figure 9.3 – IDA Pro website download page" height="725" src="image/B21223_09_3.jpg" width="1510"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 – IDA Pro website download page</p>
<p>After the file downloads, you will<a id="_idIndexMarker760"/> want to open a command line terminal window and go through your usual motions of <strong class="source-inline">sudo apt</strong> updating and upgrading if you haven’t done that yet. Perform the following steps from there (replace <strong class="source-inline">&lt;filename&gt;</strong> with your actual filename – ours <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">idafree84_linux.run</strong></span><span class="No-Break">):</span></p>
<ol>
<li>Navigate to your <strong class="bold">Downloads</strong> folder by typing <span class="No-Break"><strong class="source-inline">cd Downloads</strong></span><span class="No-Break">.</span></li>
<li>Type <strong class="source-inline">ls</strong> and press <em class="italic">Enter</em> to confirm your IDA Pro <span class="No-Break">downloaded successfully.</span></li>
<li>Type <strong class="source-inline">sha256sum &lt;filename&gt;</strong> to confirm that hash value, changing the filename if you have a <span class="No-Break">newer version.</span></li>
<li>Compare the hash value that prints to your screen with the value you recorded from the download page – the example is shown in <span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.3</em></span><span class="No-Break">.</span></li>
<li>Give your file the proper permissions so Kali can run it successfully by typing <strong class="source-inline">chmod +</strong><span class="No-Break"><strong class="source-inline">x &lt;filename&gt;</strong></span><span class="No-Break">.</span></li>
<li>To extract the file and formally install IDA Pro, <span class="No-Break">type </span><span class="No-Break"><strong class="source-inline">./&lt;filename&gt;</strong></span><span class="No-Break">.</span></li>
<li>You’ll get a small GUI popup, as seen in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.4</em>. Follow those prompts, accepting <span class="No-Break">default values:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer162">
<img alt="Figure 9.4 – IDA Pro download extraction" height="510" src="image/B21223_09_4.jpg" width="1500"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.4 – IDA Pro download extraction</p>
<p>To run<a id="_idIndexMarker761"/> <span class="No-Break">IDA Pro:</span></p>
<ol>
<li>Navigate to the directory where Kali placed the extracted files (ours <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">~/idafree-8.4</strong></span><span class="No-Break">).</span></li>
<li><span class="No-Break">Type </span><span class="No-Break"><strong class="source-inline">./ida64</strong></span><span class="No-Break">.</span></li>
<li>If you receive an error, try typing <strong class="source-inline">chmod +</strong><span class="No-Break"><strong class="source-inline">x ida64</strong></span><span class="No-Break">.</span></li>
<li>Retry <span class="No-Break">typing </span><span class="No-Break"><strong class="source-inline">./ida64</strong></span><span class="No-Break">.</span></li>
<li>Read and accept the EULA if you agree <span class="No-Break">with it.</span></li>
<li>Read the <strong class="bold">User interface telemetry</strong> popup and decide if you want to share data (entirely <span class="No-Break">your choice).</span></li>
<li>Follow the prompts from there and IDA Pro should be up <span class="No-Break">and running.</span></li>
</ol>
<p>Being able to deconstruct and reverse engineer any piece of modern technology is a braggable feat in and of itself. Be careful, though! No matter how innocent your intentions are, much in the world is based on perception and it may not be fair, but people do find themselves in hot legal water even over circumstantial evidence. Make sure when you – understandably so – show off your super skill of disassembly and reverse engineering to your friends or technology-challenged family members that you are very clear about your learning endeavor and that you are fully respecting the intellectual property rights of the creator. Also, make sure you review the license agreement of any product you might wish to disassemble very closely before doing so because many license agreements strictly forbid it for any reason and you can find yourself in legal trouble even if your intentions<a id="_idIndexMarker762"/> are innocent <span class="No-Break">and pure.</span></p>
<h2 id="_idParaDest-150"><a id="_idTextAnchor154"/>Volatility3</h2>
<p>According to The Volatility <a id="_idIndexMarker763"/>Foundation’s website, the <strong class="bold">Volatility Framework</strong> was first publicly released<a id="_idIndexMarker764"/> in the year 2007 at Black Hat DC. <strong class="bold">Volatility</strong> is an open-source memory<a id="_idIndexMarker765"/> forensics framework used for analyzing volatile memory, such as RAM, in a digital system. This is a type of memory that a system uses to store and process variables and other information needed to run as intended while the system is in use. Once the system is turned off, the memory empties; gone forever. Volatility enables incident responders, forensic analysts, and security researchers to extract valuable information from memory dumps to investigate security incidents, malware infections, and <span class="No-Break">system compromises.</span></p>
<p>As you might guess, Volatility has key features that make it a critical tool within the field of digital forensics. It provides valuable insights into volatile memory contents, which helps to assist in the identification, analysis, and response to security incidents, whether they be traditional security or <span class="No-Break">cybersecurity incidents.</span></p>
<p>Some of these features<a id="_idIndexMarker766"/> include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Cross-platform support</strong>: In this case, “platform” refers<a id="_idIndexMarker767"/> to the operating system brand/type – often called a platform. Volatility supports all mainstream operating systems, such as Windows, Linux, MacOS, and Android. This makes it an appealing option for forensic analysts who need to be prepared to conduct their memory analysis and other forensic investigations across a <span class="No-Break">diverse environment.</span></li>
<li><strong class="bold">Memory forensics</strong>: This is the primary focus of Volatility; it’s what the product is all about. Volatility was built especially for memory forensics by providing tools and plugins to extract and analyze volatile information – which is information that can rapidly go away if the system being analyzed is shut down – from memory dumps. Conducting this type of analysis can produce results that help in identifying running processes, network connections, registry hives, <span class="No-Break">and more.</span></li>
<li><strong class="bold">Plugin architecture</strong>: Volatility is modular in design and extensible through its plugin architecture. <strong class="bold">Modular</strong> means the code that is the product<a id="_idIndexMarker768"/> itself is separated<a id="_idIndexMarker769"/> into independently functioning chunks, called <strong class="bold">modules</strong>. This allows certain portions of a product’s programming code to be updated and tested without affecting the rest of the code. Having a modular architecture means that users can more easily develop custom plugins for Volatility or utilize existing ones to extract specific information from memory dumps more efficiently and with much less risk to the overall <span class="No-Break">product’s code.</span></li>
<li><strong class="bold">Process and malware analysis</strong>: Volatility enables the analysis of running processes, identifying malicious processes, command history, loaded modules, and injected code. Running processes are quite likely actively using volatile memory, RAM, because this is how programs can remain running. RAM stores critical values that processes will need to access to perform the tasks they were programmed to do. This feature aids in malware analysis and understanding <span class="No-Break">system behavior.</span></li>
<li><strong class="bold">Networking analysis</strong>: The framework allows analysts<a id="_idIndexMarker770"/> to extract network-related information from memory dumps, such as open ports, established connections, network configurations, and communication activities. A memory dump, which<a id="_idIndexMarker771"/> is also sometimes called a core dump or crash dump, is a quick copy <a id="_idIndexMarker772"/>of a system’s volatile memory at a specific point in time. When a system crashes or errs in some way, it will attempt to grab copies of volatile memory very quickly. The system sometimes only has a tiny fraction of a second to perform this operation and there are no guarantees it will succeed. Because of this, these<a id="_idIndexMarker773"/> copies are often referred to <span class="No-Break">as </span><span class="No-Break"><strong class="bold">snapshots</strong></span><span class="No-Break">.</span></li>
<li><strong class="bold">Registry analysis</strong>: Volatility supports the analysis of registry hives in memory dumps, helping analysts retrieve system configurations, user profiles, installed software, and artifacts related to user activity. A registry hive is a core component in the Windows operating system’s architecture. The Windows registry is a centralized database that stores configuration settings, options, and information related to the operating system itself, along with hardware, software, and individual user settings. It indeed will play a crucial role in system initialization, application settings, device configuration, user preferences, and the individual device’s <span class="No-Break">system security.</span></li>
<li><strong class="bold">File system analysis</strong>: Volatility provides tools to extract information about files, directories, and file system structures such as FAT, FAT16, FAT32, NTFX, and EXT APFS, as well as file handles present in memory dumps. Those of you with software engineering experience will recognize a file handle as something coders will call a file descriptor. A <strong class="bold">file descriptor</strong> is a unique numerical value<a id="_idIndexMarker774"/> assigned to open files or <strong class="bold">input/output</strong> (<strong class="bold">I/O</strong>) resources within<a id="_idIndexMarker775"/> an application. It helps a system keep track of and manage multiple file accesses simultaneously and having this information could be quite valuable to digital forensic investigators. It will assist them in understanding file access patterns and identifying <span class="No-Break">file-based artifacts.</span></li>
<li><strong class="bold">Timeline analysis</strong>: The framework offers timeline<a id="_idIndexMarker776"/> analysis capabilities to reconstruct the sequence of events on a system by correlating timestamped memory artifacts. That goes beyond simply knowing when an action or activity occurred. Investigators and analysts can reconstruct events and learn the order in which certain things might have happened and knowing the order itself can help determine whether the activity is malicious in nature. Even if maliciousness has already been determined, it can help identify the purpose or root cause of the activity. In other words, Volatility aids in incident reconstruction and <span class="No-Break">timeline recreation.</span></li>
<li><strong class="bold">Community support and updates</strong>: Like most of the resources included in the Kali Purple distribution, Volatility has an active community of users and developers who contribute new plugins, provide support, and continuously update the framework to address evolving forensic challenges and support new operating system versions. Today, Volatility is primarily managed by a 501(c) non-profit corporation called The Volatility Foundation. They do offer online training courses for <span class="No-Break">a fee.</span></li>
<li><strong class="bold">Integration with other tools</strong>: Volatility seamlessly integrates with IDA Pro and other forensic tools such as Wireshark and the class of debuggers we previously spoke of. As with all security integrations, this helps to enhance the overall capabilities of the product, in this case, memory forensics investigations, and enables interoperability<a id="_idIndexMarker777"/> with <span class="No-Break">existing workflows.</span></li>
</ul>
<p>To grab a copy of Volatility, open up your Kali Purple command line terminal window and go through the motions of updating and upgrading as needed. When ready, perform<a id="_idIndexMarker778"/> the <span class="No-Break">following actions:</span></p>
<ol>
<li>Type <strong class="source-inline">sudo git </strong><span class="No-Break"><strong class="source-inline">clone </strong></span><a href="https://github.com/volatilityfoundation/volatility3.git"><span class="No-Break">https://github.com/volatilityfoundation/volatility3.git</span></a><span class="No-Break">.</span></li>
<li>Navigate to the installation by typing <span class="No-Break"><strong class="source-inline">cd volatility3</strong></span><span class="No-Break">.</span></li>
<li>Type <strong class="source-inline">pip3 install -</strong><span class="No-Break"><strong class="source-inline">r requirements.txt</strong></span><span class="No-Break">.</span></li>
<li>Type <strong class="source-inline">python3 vol.py -h</strong> to verify <span class="No-Break">the installation.</span></li>
<li>Type <strong class="source-inline">sudo mkdir memory_dumps</strong> to create a directory for storing your memory <span class="No-Break">dump actions.</span></li>
<li>Type <strong class="source-inline">cd memory_dumps</strong> to enter <span class="No-Break">the directory.</span></li>
<li>Create a memory dump file for Volatility3 to report to by typing <strong class="source-inline">sudo touch firstdump.raw</strong>. (You can name it whatever you like as long as you remember the name for <span class="No-Break">executing Volatility3.)</span></li>
<li>Let’s make sure all user and file permissions are set – type <strong class="source-inline">pwd</strong> to get the full file path of your <strong class="source-inline">memory_dump</strong> directory, record that value, and then type <strong class="source-inline">cd</strong> to return to the <span class="No-Break">root directory.</span></li>
<li>Type <strong class="source-inline">sudo chmod -R 777 /home/misp/volatility3/memory_dumps/firstdump.raw</strong>, replacing the file path with the path you recorded in the <span class="No-Break">previous step.</span></li>
<li>Now, let’s run Volatility3 by typing <strong class="source-inline">python3 vol.py -f /</strong><span class="No-Break"><strong class="source-inline">home/misp/volatility3/memory_dumps/firstdump.raw linux.pslist</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer163">
<img alt="Figure 9.5 – Running Volatility3 limited test for educational purposes" height="144" src="image/B21223_09_5.jpg" width="900"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.5 – Running Volatility3 limited test for educational purposes</p>
<ol>
<li value="11">Type <strong class="source-inline">python3 vol.py -h</strong> to get a list of all the plugins you can use <span class="No-Break">with Volatility3.</span></li>
<li>Remember, the default command<a id="_idIndexMarker779"/> template for using Volatility3 is <strong class="source-inline">python3 vol.py -f &lt;path/to/memory_image.ext&gt; &lt;</strong><span class="No-Break"><strong class="source-inline">plugin_name&gt; [options]</strong></span><span class="No-Break">.</span></li>
</ol>
<p>Have fun playing with your volatile memory extraction! Next, we’re going to look at a lesser-known, but<a id="_idIndexMarker780"/> still quite valuable, tool that analyzes <strong class="bold">Domain Name System</strong> (<strong class="bold">DNS</strong>) activity from a <span class="No-Break">forensic perspective.</span></p>
<h2 id="_idParaDest-151"><a id="_idTextAnchor155"/>ApateDNS</h2>
<p><strong class="bold">ApateDNS</strong> is a tool designed for simulating<a id="_idIndexMarker781"/> DNS-related attacks and testing defensive capabilities in cybersecurity scenarios. It allows users to create a virtual DNS server that can mimic various DNS behaviors and threats to assess how systems and security tools respond to such attacks. The primary purpose of ApateDNS is to emulate DNS-based attacks in a controlled environment for defensive testing <span class="No-Break">and evaluation.</span></p>
<p>Overall, it’s a valuable tool for conducting DNS-related security assessments. It is also used for testing defensive mechanisms and improving the resilience of networks and systems against DS-based attacks. By leveraging its features and capabilities, cybersecurity professionals can enhance their preparedness and response to DNS threats in today’s evolving<a id="_idIndexMarker782"/> <span class="No-Break">threat landscape.</span></p>
<p>Key features unique to ApateDNS<a id="_idIndexMarker783"/> include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">DNS attack simulation</strong>: ApateDNS enables users to simulate different types of DNS attacks, including DNS spoofing, DNS cache poisoning, DNS amplification attacks, and DNS tunneling, among others. By recreating these attack scenarios, security professionals can evaluate the effectiveness of their defenses and responses. You likely know that a DNS server translates the numerical IP addresses to human-readable domain names (<strong class="source-inline">something.com</strong>). DNS spoofing and cache poisoning are attacks whereby the offender injects fake records into the DNS server’s cache files, causing users to be redirected to fake, <span class="No-Break">malicious websites.</span><p class="list-inset"><strong class="bold">DNS amplification attacks</strong> are a type of <strong class="bold">distributed denial of service</strong> (<strong class="bold">DDoS</strong>) attack that exploits<a id="_idIndexMarker784"/> vulnerabilities within the domain<a id="_idIndexMarker785"/> name server/system in an effort to overwhelm a target server or network with a very large volume of malicious traffic. In such a case, the attacker sends a small number of specially crafted DNS queries to open up DNS servers that support recursion. They do so in the hopes that these servers are misconfigured or are publicly accessible – which they often are – and that causes the servers to respond with significantly larger volumes of information in their responses to the target/victim’s <span class="No-Break">IP address.</span></p><p class="list-inset"><strong class="bold">DNS tunneling</strong> is a manner of transferring<a id="_idIndexMarker786"/> data to and from DNS systems that has both legitimate and malicious uses. It’s simply encoding the data in some manner so that it bypasses security controls. This can be done intentionally for legitimate covert communications but is also used by malicious actors for data exfiltration as well as simply creating a pathway into and out of a DNS system for a plethora of other <span class="No-Break">malicious desires.</span></p></li>
<li><strong class="bold">Customizable DNS responses</strong>: Users can configure ApateDNS to generate custom DNS responses, redirect DNS queries to specific IP addresses, alter DNS resource records, and manipulate DNS packet data. This flexibility allows for detailed testing of DNS-related security measures. This might<a id="_idIndexMarker787"/> include such adjustments as changing the <strong class="bold">Canonical Name</strong> (<strong class="bold">CNAME</strong>), which is more or less setting the response for a specific domain name to redirect the requester to another domain name. Sometimes, organizations want to reserve domain names that are similar to their brand to prevent competing organizations from using them to confuse and mislead customers. So, they will register many like-named domains and have them all pointed to the main organizational website. Organizations with deep enough pockets will sometimes do this, anticipating common typographical errors when users input web addresses. The DNS will detect the registered misspelled domain and redirect it to the <span class="No-Break">correct one.</span></li>
<li><strong class="bold">Testing DNS security controls</strong>: ApateDNS can be used<a id="_idIndexMarker788"/> to test the resilience <a id="_idIndexMarker789"/>of DNS security controls, such as DNS firewalls, <strong class="bold">intrusion detection systems</strong> (<strong class="bold">IDS</strong>)/<strong class="bold">intrusion prevention systems</strong> (<strong class="bold">IPS</strong>), and DNS monitoring tools. We talked<a id="_idIndexMarker790"/> about some of those systems in <a href="B21223_07.xhtml#_idTextAnchor108"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>. By simulating attacks, organizations can identify vulnerabilities and gaps in their DNS security posture. This is part of the beauty of Kali Purple. It gives all the tools to set up a proof-of-concept scenario and then it also gives you the tools to test against <span class="No-Break">those scenarios.</span></li>
<li><strong class="bold">Network defense assessment</strong>: In a broader scope than the previous item, security teams can use ApateDNS to assess the effectiveness of network defenses against DNS-based threats and attacks. As we have drilled down thus far, ApateDNS, as the name implies, is all about the forensic testing and analysis of DNS products and DNS is an integral part of any fully fleshed-out organizational network. By evaluating how well security solutions detect and respond to simulated attacks, organizations can enhance their overall <span class="No-Break">cybersecurity posture.</span></li>
<li><strong class="bold">Education and training</strong>: As is the theme for the entire Kali Purple distribution, ApateDNS can also serve as a training tool for cybersecurity professionals to develop skills in identifying and mitigating DNS threats. You might think of this as a sort of containerized training. Since you know ApateDNS is built with DNS in focus then you know this tool can be added to any training curriculum that is DNS focused. It’s not such a bad idea to break down your cybersecurity training into smaller chunks – themes – like this. Having hands-on experience with simulated attacks can help individuals understand DNS security concepts and practice response strategies. When you believe your team has developed solid DNS skills, then you can move on to <span class="No-Break">another topic.</span></li>
<li><strong class="bold">Open-source and cross-platform capable</strong>: ApateDNS is open-source software, which allows users to access and modify its source code for customization and research purposes. It is compatible with multiple operating systems, including the big three – Windows, Linux, and macOS. This helps with maximum flexibility<a id="_idIndexMarker791"/> for testing across a diverse span <span class="No-Break">of environments.</span></li>
</ul>
<p>Unfortunately, the advancement of cybersecurity tools across the board makes stand-alone specialty applications such as ApateDNS less appealing to some professionals. This is likely because if users can get the same or similar features bundled with other applications, then why not do that instead? At the time of this writing, many of the traditionally known download locations and repositories were not functional, including the well-known Mandiant and FireEye/Trellix locations. That’s okay! We’ve talked about this since the beginning of this title. Being an analyst, being a cybersecurity professional, means you need to always be prepared for the unexpected. Sometimes, things like this happen. Being an effective researcher will be one of your greatest assets. In our case, we found a copy<a id="_idIndexMarker792"/> of ApateDNS at the established <strong class="bold">Softpedia</strong> repository. Softpedia is not inherently malicious. However, it can be risky to grab software from there given the lack of security oversight. Proceed <span class="No-Break">with caution.</span></p>
<p>One location to grab<a id="_idIndexMarker793"/> ApateDNS is the following <span class="No-Break">link: </span><a href="https://www.softpedia.com/get/Network-Tools/Misc-Networking-Tools/ApateDNS.shtml"><span class="No-Break">https://www.softpedia.com/get/Network-Tools/Misc-Networking-Tools/ApateDNS.shtml</span></a><span class="No-Break">.</span></p>
<p>It should be pretty straightforward from there. You know the routine. When you launch ApateDNS, it should look similar to what you see in <span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.6</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer164">
<img alt="Figure 9.6 – ApateDNS launch screen" height="542" src="image/B21223_09_6.jpg" width="991"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.6 – ApateDNS launch screen</p>
<p>In this section, you learned five different<a id="_idIndexMarker794"/> tools to conduct deep forensic analysis in five different ways, from extracting volatile memory to examining Windows executables, to complete application disassembly and reverse engineering to DNS behavioral activity. Each of these resources helps a digital forensic investigator do their job and takes them one step closer to solving their case or developing evidentiary support to put bad <span class="No-Break">folks away.</span></p>
<p>Have you ever wondered how those bad folks were able to do what they did in the first place? This is a critical thought in our field. Knowing how this is done helps us develop mock campaigns to test and train the workers in our organizations. In the next section, we are going to examine three tools used to do the damage the previous tools in this book are built to identify and <span class="No-Break">respond to.</span></p>
<p>Throughout this book, we’ve covered various tools that are either included with or have support built into Kali Purple, covering a full cyber defense environment. These are tools we’ve used to set up cybersecurity defenses to help us grab information, organize it, store it, evaluate it, respond to it, and, in this chapter, conduct forensic investigations. All of these are the <em class="italic">Blue</em> side of the Kali <span class="No-Break">Purple family.</span></p>
<p>As we near completion of our Kali Purple experience, we’re going to take a look at some of the supported and included tools that we can use to put the utilities we’ve already covered to use! Indeed, Kali Purple also has an abundance of tools that can be used offensively. We will discuss some of the more prominent Red Team tools in <a href="B21223_10.xhtml#_idTextAnchor161"><span class="No-Break"><em class="italic">Chapter 10</em></span></a> along with some tools that might fall into either the <em class="italic">Blue</em> or <em class="italic">Red</em> category but were part of Kali Linux before the Purple distribution. Wireshark is a good example of such <span class="No-Break">a tool.</span></p>
<p>In the meantime, let’s take a look at how cyber activity all begins. While there are several variations of the process of hacking or the process of conducting a cyberattack, we are working off the generic steps <span class="No-Break">listed ahead:</span></p>
<ol>
<li><span class="No-Break">Reconnaissance</span></li>
<li><span class="No-Break">Scanning</span></li>
<li><span class="No-Break">Gaining access</span></li>
<li><span class="No-Break">Maintaining access</span></li>
<li>Covering <span class="No-Break">your tracks</span></li>
</ol>
<p>This isn’t a hacking or pen testing<a id="_idIndexMarker795"/> manual but if you decide you’d like to learn more about such topics, we’ve included several links in the <em class="italic">Further reading</em> section for you. For our purposes here, we’re going to focus on the beginning; we’re going to focus on reconnaissance. Let’s <span class="No-Break">dive in.</span></p>
<h1 id="_idParaDest-152"><a id="_idTextAnchor156"/>SET</h1>
<p><strong class="bold">Reconnaissance</strong> – or <strong class="bold">recon</strong> – is an information-gathering<a id="_idIndexMarker796"/> stage of an<a id="_idIndexMarker797"/> operation. It is commonly used in the context of military and intelligence operations worldwide, but you will also often see references to it in cybersecurity since it is one of the initial stages of most cyberattack frameworks. Depending on the framework you follow, to include custom frameworks, some might include planning and design phases before reconnaissance. It might include the discovery of security flaws, or potential entry points for attackers. It plays a vital role in the overall success of a penetration test – for that matter, also for the success of criminal activity. The process involves collecting data about the target to better understand its infrastructure, weaknesses, and <span class="No-Break">overall assets.</span></p>
<p>One of the most popular vectors of attack is the people who operate those resources. If a pentester or attacker can successfully compromise any person, or person’s credentials then, they can compromise any system associated with that person without leaving a single digital <span class="No-Break">artifact behind.</span></p>
<p>There are two basic types<a id="_idIndexMarker798"/> of reconnaissance activities. The first is <strong class="bold">passive reconnaissance</strong>. This is where the attacker begins collecting information about the target person or system without directly interacting with them. They will <a id="_idIndexMarker799"/>make liberal use of <strong class="bold">open-source intelligence</strong> (<strong class="bold">OSINT</strong>) sources, such as publicly posted information on websites, social media accounts, job postings, domain registration information, and a multitude<a id="_idIndexMarker800"/> of other items. The other type is called <strong class="bold">active reconnaissance</strong>, which involves direct interaction with the target person, system, or network. This can sometimes slide into the second stage of hacking we previously listed, which <span class="No-Break">is scanning.</span></p>
<p>As it relates to<a id="_idIndexMarker801"/> people, one of the most common <strong class="bold">active reconnaissance</strong> activities involves a person as the target and the use of social engineering to attempt to compromise the person and/or otherwise trick them into revealing protected information, such as login credentials for <span class="No-Break">organizational systems.</span></p>
<p>Enter the SET. This<a id="_idIndexMarker802"/> is one you really want to – and most assuredly will enjoy – invest some time <span class="No-Break">playing with.</span></p>
<p>Let’s grab <span class="No-Break">a copy:</span></p>
<ol>
<li>Fire up your Kali Purple VM and open a command <span class="No-Break">line terminal.</span></li>
<li>Type <strong class="source-inline">sudo apt update</strong> and if you see any upgrades from the list, take care of <span class="No-Break">that first.</span></li>
<li>Type <strong class="source-inline">sudo git </strong><span class="No-Break"><strong class="source-inline">clone </strong></span><a href="https://github.com/trustedsec/social-engineer-toolkit.git"><span class="No-Break">https://github.com/trustedsec/social-engineer-toolkit.git</span></a><span class="No-Break">.</span></li>
<li>After the cloning process completes, navigate to the installation by typing <span class="No-Break"><strong class="source-inline">cd social-engineer-toolkit</strong></span><span class="No-Break">.</span></li>
<li>You may or may not need to type the following command to complete the installation: <span class="No-Break"><strong class="source-inline">sudo ./setup.py</strong></span><span class="No-Break">.</span></li>
<li>Upon completion or if you receive an error suggesting it’s not needed, type <span class="No-Break"><strong class="source-inline">sudo ./setoolkit</strong></span><span class="No-Break">.</span></li>
<li>Press <em class="italic">Y</em> to agree to the terms (unless for some unbeknownst reason, you decide not to agree to <span class="No-Break">the terms).</span></li>
</ol>
<p>If your installation and launch<a id="_idIndexMarker803"/> were successful, you should see something resembling <span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.7</em></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer165">
<img alt="Figure 9.7 – SET" height="505" src="image/B21223_09_7.jpg" width="544"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.7 – SET</p>
<p>This wonderful product gives you everything<a id="_idIndexMarker804"/> you could ever want in a text-based product’s lobby box / start menu screen. You have credits, additional resources, <em class="italic">follow-us</em> fan clubs, updating instructions, and an abundance of options for using the product. If that’s not enough, these clever developers even provide you with a remarkably beautiful piece of ASCII text art for your visual satisfaction. We are focused on social engineering, so type <strong class="source-inline">1</strong> to select <strong class="bold">1</strong> and <span class="No-Break">press </span><span class="No-Break"><em class="italic">Enter</em></span><span class="No-Break">.</span></p>
<p>You will see that SET offers a generous supply of potential social engineering attack vectors, as seen in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.8</em>. Go ahead and navigate through the menus. Each one will give you the option to <span class="No-Break">go backward:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer166">
<img alt="Figure 9.8 – SET social engineering attack list" height="208" src="image/B21223_09_8.jpg" width="351"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.8 – SET social engineering attack list</p>
<p class="callout-heading">Note</p>
<p class="callout">This is the real deal, folks! It is of absolute paramount importance before you proceed to use this product that you have advanced permission – in writing – to perform the actions you are planning to take. There should be a type of document that lays out the boundaries of precisely what you are or are not allowed to do. This<a id="_idIndexMarker805"/> might be called a <strong class="bold">pen testing scope</strong> document, a <strong class="bold">rules of engagement</strong> (<strong class="bold">RoE</strong>) document, or something<a id="_idIndexMarker806"/> similar. If you don’t have that document, don’t do anything further with this tool other than attack yourself! If you fail to adhere to this warning, you may very well find both of your wrists bound by a couple of oversized stainless steel bracelets with a very short chain linking <span class="No-Break">them together.</span></p>
<p>As you navigate through the various menus, take note of the information provided to you on each screen. SET tells you every single thing you need to know if you want to learn to create your own exploits. In some cases, they have exploits already prepared for you and all you have to do is provide the necessary information, such as the system addresses of the target after you invoke the option. This along with <strong class="bold">Metasploit</strong> and <strong class="bold">Mimikatz</strong> (both Red Team tools) are some<a id="_idIndexMarker807"/> of the most<a id="_idIndexMarker808"/> powerful – and most dangerous – cybersecurity tools you will encounter<a id="_idIndexMarker809"/> in your career. Please use them carefully <span class="No-Break">and responsibly.</span></p>
<h1 id="_idParaDest-153"><a id="_idTextAnchor157"/>BeEF</h1>
<p>The BeEF is a powerful tool<a id="_idIndexMarker810"/> for testing the security of web browsers and conducting client-side attacks. It allows security professionals to assess the security posture of web applications, attempt to exploit client-side vulnerabilities, and demonstrate the risks associated with browser-based attacks. Like SET, BeEF should only be used for ethical purposes, such as penetration testing, security assessments, and educational demonstrations, and only with proper <span class="No-Break">written authorization.</span></p>
<p>By now, you’ve probably sensed a trend with the applications that are part of the Kali Purple family, be they part of the distribution or compatible with the Kali Purple environment. You’ll notice nearly every application in <em class="italic">Introduction to Kali Purple</em> has some level of extensibility allowing for user customizations, real-time or near-real-time responsiveness, cross-platform compatibility, and some type of online and/or community support. This is no different. These concepts are also reflected in some of BeEF’s key features<a id="_idIndexMarker811"/> which include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Browser exploitation</strong>: As mentioned, BeEF allows you to exploit vulnerabilities in web browsers to demonstrate the impact of client-side attacks. Some<a id="_idIndexMarker812"/> of these vulnerabilities<a id="_idIndexMarker813"/> can include <strong class="bold">cross-site scripting</strong> (<strong class="bold">XSS</strong>), <strong class="bold">Cross-Site Request Forgery</strong> (<strong class="bold">CSRF</strong>), clickjacking, browser fingerprinting, browser exploitation, and remote <span class="No-Break">command execution.</span><p class="list-inset">XSS is a type of security vulnerability that occurs when an attacker injects malicious scripts into web pages. Those scripts will execute when those pages are viewed by others. Usually, the scripts are written in JavaScript code since that’s a common web programming language used by developers. CSRF is similar except its focus is on taking advantage of the trust that a website has in a user’s browser. The attacker tricks the user into making a web request from the site without the user’s knowledge while they are authenticated – logged in – to <span class="No-Break">the website.</span></p><p class="list-inset"><strong class="bold">Clickjacking</strong> is when an attacker places<a id="_idIndexMarker814"/> an invisible layer on top of a legitimate web page with an invisible link on top of an otherwise valid link on the site, such as a submit button or like button. When the users go to click on what they believe is the legitimate action, they are actually clicking an invisible link to a malicious entity. The invisible layer is just another layer of content with the transparency set to 100% and a priority level set to display on top of all <span class="No-Break">other elements.</span></p></li>
<li><strong class="bold">Persistent client-side hooks</strong>: BeEF provides the ability to create<a id="_idIndexMarker815"/> persistent client-side hooks that remain active even when the target navigates away from the initial attack page. Hooks might be described as a type of backdoor to an application. There are too many different styles of hooks to mention here but one that is commonly seen is when they are employed as secret backdoors for developers to quickly gain access to a system. They have noble purposes as well in that developers and security professionals can use them to test an application and monitor how the data is flowing. However, we’d advise against using them if it is practical for your situation and if at all possible for those of you who work in development due to the inherent security risks. By deploying persistent hooks, an attacker can maintain access to the target’s browser and continue to interact with the hooked browser. If you refer back to the beginning of this section, maintaining access is one of the key steps of the hacking / pen <span class="No-Break">testing process.</span></li>
<li><strong class="bold">Extension framework</strong>: Like other applications we’ve covered, BeEF offers an extension framework that allows you to extend its capabilities through custom modules and plugins. They even hold your hand a bit if you’re new to developing your own extensions for applications. You can develop custom modules to enhance BeEF’s functionality, integrate with other tools, and automate browser-based attacks. In fact, at the very bottom of the default page, after you log in to the system, there is a <strong class="bold">Learn More</strong> section providing additional instructions to help you do just that, as seen in <span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.9</em></span><span class="No-Break">:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer167">
<img alt="Figure 9.9 – The Learn More section at the bottom of the BeEF default page" height="203" src="image/B21223_09_9.jpg" width="777"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.9 – The Learn More section at the bottom of the BeEF default page</p>
<ul>
<li><strong class="bold">Social engineering</strong>: Something BeEF has in common with SET is that it supports social engineering tactics, and it does this by complementing the email phishing campaigns produced with SET. With BeEF, you can craft the most convincing phishing pages and lure targets to visit additional malicious websites. You can use these crafted pages to harvest user credentials. If you’re wondering how this can possibly be considered anything other than criminal, then please understand that using every tool and technique that the actual cybercriminals use in a lab environment to either reproduce or test human behavior will always serve as a powerful training ground for your organization’s people. What we mean by that is that you can set up mock phishing campaigns and test how much your organizational members might have learned and what information they might have gained after providing phishing training. This is becoming a more and more common practice<a id="_idIndexMarker816"/> in the business world as phishing itself is becoming more and more creative, tricky, <span class="No-Break">and aggressive.</span></li>
<li><strong class="bold">Real-time control and monitoring</strong>: BeEF provides real-time control and monitoring of hooked browsers, allowing you to interact with the target’s browser environment and execute commands remotely. To test this feature, you can simply follow the directions on the login page after logging into BeEF after you install it per the instructions that are followed shortly hereafter. The directions for how to hook a browser are right there in the second paragraph. All you need to do is drag the link they provide for you into the bookmarks bar of any browser you wish to monitor and then refresh your BeEF instance. You’ll see the data in the left column. Feel free to click around and check all of the incredibly in-depth information you can get. As you can see, with BeEF, you can view detailed information about the hooked browsers, launch attacks, collect data, and analyze the impact of <span class="No-Break">client-side vulnerabilities.</span></li>
<li><strong class="bold">Cross-platform support</strong>: BeEF is designed to work across different operating systems, including the big three (Linux, macOS, and Windows) but it also <a id="_idIndexMarker817"/>can work <a id="_idIndexMarker818"/>with VMs, Docker, and cloud services such as <strong class="bold">Amazon Web Services</strong> (<strong class="bold">AWS</strong>), <strong class="bold">Google Cloud Platform</strong> (<strong class="bold">GCP</strong>), and Microsoft’s Azure. Within those platforms, it can work with multiple<a id="_idIndexMarker819"/> browsers such as Chrome, Edge, Firefox, Internet Explorer, Opera, <span class="No-Break">and Safari.</span></li>
</ul>
<p>To take advantage of these features and apply them in practice, you will first want to acquire, install, and start the <span class="No-Break">BeEF application.</span></p>
<p>Acquiring BeEF requires<a id="_idIndexMarker820"/> a few more steps than we’re <span class="No-Break">used to:</span></p>
<ol>
<li>If not there from the previous section, boot your Kali Purple VM and open a command <span class="No-Break">line terminal.</span></li>
<li>Type <strong class="source-inline">sudo apt update</strong> and if you see any upgrades from the list, take care of <span class="No-Break">that first.</span></li>
<li>BeEF is written in the <strong class="bold">Ruby language</strong>, so make sure <strong class="bold">Ruby</strong> is installed by typing <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install ruby</strong></span><span class="No-Break">.</span></li>
<li>Type <strong class="source-inline">sudo git </strong><span class="No-Break"><strong class="source-inline">clone </strong></span><a href="https://github.com/beefproject/beef.git"><span class="No-Break">https://github.com/beefproject/beef.git</span></a><span class="No-Break">.</span></li>
<li>After the cloning process completes, navigate to the install by typing <span class="No-Break"><strong class="source-inline">cd beef</strong></span><span class="No-Break">.</span></li>
<li>You may or may not need to type the following command to complete the installation: <strong class="source-inline">sudo apt </strong><span class="No-Break"><strong class="source-inline">install bundler</strong></span><span class="No-Break">.</span></li>
<li>Type <strong class="source-inline">sudo </strong><span class="No-Break"><strong class="source-inline">bundle install</strong></span><span class="No-Break">.</span></li>
</ol>
<p>Unlike every other application we’ve covered thus far, BeEF will not allow you to log in unless you first change the default credentials as seen in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.10</em>. We also want to set BeEF to have an accessible address. Therefore, you will need to edit the configuration file before logging in for the first time by typing <strong class="source-inline">sudo </strong><span class="No-Break"><strong class="source-inline">nano config.yaml</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer168">
<img alt="Figure 9.10 – BeEF error requiring default credentials to be changed" height="73" src="image/B21223_09_10.jpg" width="652"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.10 – BeEF error requiring default credentials to be changed</p>
<p>Once you have the file open in your nano editor, scroll down to <strong class="source-inline">beef:</strong> and then in the tabbed column, scroll a little further until you see <strong class="source-inline">credentials:</strong>, where you will change either one or both of the values to something unique. Because we’re going to blow away our test copy after grabbing some screenshots for you, we decided to change the <strong class="source-inline">user:</strong> value to <strong class="source-inline">"roast"</strong> and leave the <strong class="source-inline">passwd:</strong> value as <strong class="source-inline">"beef"</strong> but you can change it to <strong class="source-inline">"chicken"</strong>, <strong class="source-inline">"turkey"</strong>, or your neighbor’s bank account number if you prefer. Just make sure if you’re setting this up in a production environment that you actually select a solid password as we briefly discussed in <a href="B21223_03.xhtml#_idTextAnchor052"><span class="No-Break"><em class="italic">Chapter 3</em></span></a><span class="No-Break">.</span></p>
<p>After changing the default<a id="_idIndexMarker821"/> credentials, you’ll want to scroll down just a molecule further where you should see <strong class="source-inline">restrictions:</strong>, which should be directly under the <strong class="bold"># </strong><strong class="source-inline">Interface / IP restrictions</strong> heading. Change the values for <strong class="source-inline">permitted_hooking_subnet:</strong> from <strong class="source-inline">["0.0.0.0/0", "::/0"]</strong> to <strong class="source-inline">["127.0.0.1/32", "::/128"]</strong> and repeat this step by changing the same values for <strong class="source-inline">permitted_ui_subnet</strong>. Scroll down a little further until you see http: and change the <strong class="source-inline">host:</strong> value from <strong class="source-inline">"0.0.0.0"</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">"127.0.0.1"</strong></span><span class="No-Break">.</span></p>
<p>Make sure you edit the highlighted areas to match <span class="No-Break">this image:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer169">
<img alt="Figure 9.11 – The BeEF configuration file with navigation and edits highlighted" height="734" src="image/B21223_09_11.jpg" width="950"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.11 – The BeEF configuration file with navigation and edits highlighted</p>
<p>Press <em class="italic">Ctrl</em> + <em class="italic">X</em>, select <em class="italic">Y</em>, and press <em class="italic">Enter</em> to complete<a id="_idIndexMarker822"/> the file edit. Now, you’re ready to boot BeEF and log in for the <span class="No-Break">first time.</span></p>
<p>To start BeEF and log in<a id="_idIndexMarker823"/> for the first time, do <span class="No-Break">the following:</span></p>
<ol>
<li>Type <strong class="source-inline">sudo ./beef</strong> to start <span class="No-Break">the application.</span></li>
<li>Load a browser within your environment and <span class="No-Break">type </span><a href="http://127.0.0.1:3000/ui/authentication"><span class="No-Break">http://127.0.0.1:3000/ui/authentication</span></a><span class="No-Break">.</span></li>
<li>Enter the credentials<a id="_idIndexMarker824"/> you set in the file and <span class="No-Break">press </span><span class="No-Break"><strong class="bold">Login</strong></span><span class="No-Break">.</span></li>
</ol>
<p>Once there and you’re logged in, we recommend taking some time to familiarize yourself with the interface by selecting the different tabs and studying the social engineering, persistent hook, and control options. Don’t hesitate to go down a rabbit hole researching items that grab your attention. Take some time to practice creating and deploying hooks to target your own browsers and monitor their activity. Go ahead and load those browsers and do some random searching. Maybe even pick a unique topic for each browser, select something out of this book of interest that you want to learn more about, or select an item from the <em class="italic">Further reading</em> section from any chapter to research further. Do whatever you want but be active in the browser so you can return to your BeEF environment and see what it looks like. Perhaps consider using some custom modules, or, depending on your level of technical acumen, create some of your own. Do make sure, no matter what you do, that you operate ethically because this product possesses the ability<a id="_idIndexMarker825"/> to do legitimate damage to a <span class="No-Break">target system.</span></p>
<h1 id="_idParaDest-154"><a id="_idTextAnchor158"/>Maltego</h1>
<p>Maltego is a data mining tool<a id="_idIndexMarker826"/> that can also be used for link analysis and data visualization. Users have the ability to track connections between entities, identify patterns, and uncover hidden relationships <span class="No-Break">between entities.</span></p>
<p>Key features of Maltego<a id="_idIndexMarker827"/> include <span class="No-Break">the following:</span></p>
<ul>
<li><strong class="bold">Information gathering</strong>: This is the core feature of Maltego. Its purpose is to gather information. Then, as a bonus, the product was further refined to offer a plethora of helpful ways to work with that data as you will see in the following key features. Maltego facilitates the collection of OSINT data, social media platforms, websites, and other sources as seen in <span class="No-Break"><em class="italic">Figure 9</em></span><span class="No-Break"><em class="italic">.12</em></span><span class="No-Break">.</span><p class="list-inset">Maltego offers a free version, which may be used so long as it’s not used for <span class="No-Break">commercial use:</span></p></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer170">
<img alt="Figure 9.12 – Maltego sample dataset based on self-identifying entities" height="710" src="image/B21223_09_12.jpg" width="496"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.12 – Maltego sample dataset based on self-identifying entities</p>
<ul>
<li><strong class="bold">Entity recognition</strong>: Maltego can recognize different<a id="_idIndexMarker828"/> types of entities such as people, organizations, and locations, and it categorizes different types of data points in relation to them. This is a critical step for the application because it helps to discover deep and hidden relationships between entities. That, in turn, provides the necessary information Maltego needs to map out the connections, patterns, and any likely dependencies within <span class="No-Break">the datasets.</span></li>
<li><strong class="bold">Data correlation</strong>: As a result of entity recognition, Maltego can then correlate information from the various sources that it has mapped. Some of the ways it accomplishes this is by looking for common attributes and associations or any shared interactions between entities. That<a id="_idIndexMarker829"/> is sometimes referred to as <span class="No-Break"><strong class="bold">link analysis</strong></span><span class="No-Break">.</span></li>
<li><strong class="bold">Network mapping</strong>: You can see by the example presented in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.12</em> that Maltego helps in mapping out network structures and creating a visualization between the connections and between <span class="No-Break">different entities.</span></li>
<li><strong class="bold">Collaboration tools</strong>: Maltego is designed for collaborative teams to have the ability to function within the same project simultaneously. The users can share their results in real time, which gives an avenue for instant feedback. It also offers a collaborative workspace so team members can work on the same project concurrently. Administrators will have the permission to set different levels of permissions and access levels so that team members only have access to the data they need for their roles while higher-level supervisory or team lead users can have additional access to keep things running smoothly. Overall, Maltego was built with collaboration in mind, be it a team of one or a team of <span class="No-Break">one hundred.</span></li>
<li><strong class="bold">Integration with data sources</strong>: It integrates with various data sources, including online APIs such as WHOIS, geospatial and geolocation services, threat intelligence feeds, public records, law enforcement and other databases, financial data providers<a id="_idIndexMarker830"/> social media platforms to pull <span class="No-Break">relevant information.</span></li>
</ul>
<p>Unless something went awry<a id="_idIndexMarker831"/> with your initial Kali Purple installation, Maltego should already be installed and ready to run on your system. You can check by logging into a command line terminal within your Kali Purple instance, doing the usual <strong class="source-inline">sudo apt update</strong> and <strong class="source-inline">upgrade</strong>, and then trying to install a fresh copy by typing <strong class="source-inline">sudo apt install maltego</strong>. Odds are you’ll get some sort of statement that Maltego is already the newest version. If not, then at least now you’ll get <span class="No-Break">the application!</span></p>
<p>That said, if we assume that you have Maltego installed, you can start the software by selecting the Kali Linux dragon icon in the top left of your Kali Purple environment directly under <strong class="bold">File</strong>. Then, you can either type <strong class="source-inline">Maltego</strong> in the search bar and it should populate, or you can move your cursor down and hover over the <strong class="bold">Information Gathering</strong> field, and a new column will populate to the right showing all the applications involved with information gathering and that list should <span class="No-Break">include Maltego.</span></p>
<p>Select the Kali dragon logo and then <strong class="bold">01 – Information Gathering</strong> | <span class="No-Break"><strong class="bold">maltego</strong></span><span class="No-Break">:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer171">
<img alt="Figure 9.13 – Kali Purple menu of tools drill down to Maltego" height="855" src="image/B21223_09_13.jpg" width="750"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.13 – Kali Purple menu of tools drill down to Maltego</p>
<p>When Maltego first loads, it will ask<a id="_idIndexMarker832"/> for login credentials. If you don’t recall having any, that’s okay – just select the register here link near the top of the main windowpane to create an account and then log in with that account. After you create an account, you’ll be prompted to select which Maltego version you want, and you’ll be presented with a screen that shows five different Maltego versions. The first three presented are paying options. We recommend selecting the fourth one down on the list – Maltego CE – which stands for community edition. That will give you the most options to play around with and learn from and it is free. You’ll be given the option to load a sample dataset when you boot it and that’s what we did with the information you see in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.12</em>. That’s perfect <span class="No-Break">for training!</span></p>
<p>There you have it. As they say in late-night infomercials: <em class="italic">but wait… there’s more!</em> While you have Maltego<a id="_idIndexMarker833"/> loaded and running with sample data, load a web browser and point it to <a href="https://www.maltego.com/learning/#pricing-plans">https://www.maltego.com/learning/#pricing-plans</a>. You can ignore those scary words, <em class="italic">pricing</em> and <em class="italic">plans</em>, unless you’re far enough along in your setup, your personal situation calls for it, and you’re ready to take the dive to learn and master this product. Otherwise, you can see, in the left column of the page that loads, there is a free option that includes a Maltego foundations course, handbooks, articles, blogs, and <span class="No-Break">additional documentation.</span></p>
<p>In this section, you learned about social engineering<a id="_idIndexMarker834"/> and exploit development with respect to the hacking / pentesting process using three prominent Kali Purple utilities. You learned about reconnaissance and where to go if you want to create phishing campaigns or conduct other types of social engineering using SET. Then, you learned how to gain and maintain access using the persistent hook browser exploit with BeEF. Finally, you learned how Maltego can help you become a cyber-spy through gathering intelligence from OSINT sources. Put on your Fedora and shades. You’re a step closer to being selected from the Central Intelligence Agency’s monthly applicant pool of ten <span class="No-Break">thousand strong.</span></p>
<h1 id="_idParaDest-155"><a id="_idTextAnchor159"/>Summary</h1>
<p>In this chapter, we slipped a little into the dark side of cybersecurity but at the same time, we learned how it is necessary to understand how the bad actors do what they do. Police will often say, “If you want to learn how to catch a criminal then, you need to learn how to think like a criminal.” The same is true in the field of cybersecurity. If you want to learn how to catch a hacker, then you need to learn how to think like a hacker. That makes sense, right? We started down that path of cybersecurity when we took some time to begin learning how to use the same tools and develop the same skills the bad actors do. Now, we can use these resources to train the people in our respective organizations and then we can create mock campaigns to <span class="No-Break">test them!</span></p>
<p>We immediately examined five deep analysis tools that dealt with examining Microsoft Windows executables, file and file system analyzation, disassembly and reverse engineering, grabbing and analyzing volatile memory – memory in RAM, and deep analysis of <span class="No-Break">the DNS.</span></p>
<p>Concluding the chapter, we got to play with the very dangerous tools used by cybercriminals, which we previously mentioned. We looked at SET, which is used for social engineering to include building emails and other types of phishing campaigns. We saw how BeEF used persistent hooks to compromise web browsers and we enjoyed the subtle science of legal espionage by seeing how Maltego can be used to harness the full value of <span class="No-Break">OSINT resources.</span></p>
<p><span class="No-Break">Questions</span></p>
<ol>
<li>What happens if we use any of the utilities on a system not owned by us <span class="No-Break">without permission?</span><ol><li class="Alphabets">You are likely to receive a letter of commendation for your <span class="No-Break">innovative thinking</span></li><li class="Alphabets">You’ll jump ahead of other candidates being considered for the role due to showcasing your skills instead of just talking <span class="No-Break">about them</span></li><li class="Alphabets">You might learn a thing or two and <span class="No-Break">gain experience</span></li><li class="Alphabets">It’s a criminal action and you could face charges or be jailed depending on <span class="No-Break">the jurisdiction</span></li></ol></li>
<li>What <span class="No-Break">is BeEF?</span><ol><li class="Alphabets">BovinE <span class="No-Break">Exotic Foodstuff</span></li><li class="Alphabets">Browser <span class="No-Break">Exploitation Framework</span></li><li class="Alphabets">British Exploration and <span class="No-Break">Expeditionary Force</span></li><li class="Alphabets">Browser edition of <span class="No-Break">Educational Features</span></li></ol></li>
<li>As it relates to software, what is another term <span class="No-Break">for disassembly?</span><ol><li class="Alphabets"><span class="No-Break">Reverse engineer</span></li><li class="Alphabets"><span class="No-Break">Compile</span></li><li class="Alphabets"><span class="No-Break">Isolate</span></li><li class="Alphabets"><span class="No-Break">Distemper</span></li></ol></li>
<li>Information stored in RAM is considered to be stored in what kind <span class="No-Break">of memory?</span><ol><li class="Alphabets">Solid <span class="No-Break">state memory</span></li><li class="Alphabets">Liquid <span class="No-Break">state memory</span></li><li class="Alphabets"><span class="No-Break">Volatile memory</span></li><li class="Alphabets"><span class="No-Break">Stable memory</span></li><li class="Alphabets">I <span class="No-Break">can’t remember</span></li></ol></li>
<li>In the most literal use case, what <span class="No-Break">is Maltego?</span><ol><li class="Alphabets">A complex geospatial-oriented tool used for conducting <span class="No-Break">forensic analysis</span></li><li class="Alphabets">A data <span class="No-Break">mining tool</span></li><li class="Alphabets">An island in the Caribbean where social engineering <span class="No-Break">was invented</span></li><li class="Alphabets">An extremely <span class="No-Break">arrogant beverage</span></li></ol></li>
</ol>
<h1 id="_idParaDest-156"><a id="_idTextAnchor160"/>Further reading</h1>
<ul>
<li><strong class="bold">Tracee home </strong><span class="No-Break"><strong class="bold">page</strong></span><span class="No-Break">: </span><a href="https://aquasecurity.github.io/tracee/latest"><span class="No-Break">https://aquasecurity.github.io/tracee/latest</span></a></li>
<li><strong class="bold">IDA Pro creator Hex-Rays official </strong><span class="No-Break"><strong class="bold">website</strong></span><span class="No-Break">: </span><a href="https://hex-rays.com/ida-pro/"><span class="No-Break">https://hex-rays.com/ida-pro/</span></a></li>
<li><strong class="bold">The Volatility </strong><span class="No-Break"><strong class="bold">Foundation</strong></span><span class="No-Break">: </span><a href="https://volatilityfoundation.org/about-volatility/"><span class="No-Break">https://volatilityfoundation.org/about-volatility/</span></a></li>
<li><strong class="bold">Reconnaissance for Ethical </strong><span class="No-Break"><strong class="bold">Hackers</strong></span><span class="No-Break">: </span><a href="https://www.packtpub.com/product/reconnaissance-for-ethical-hackers/9781837630639"><span class="No-Break">https://www.packtpub.com/product/reconnaissance-for-ethical-hackers/9781837630639</span></a></li>
<li><strong class="bold">The Complete Ethical Hacking Bootcamp: Beginner to </strong><span class="No-Break"><strong class="bold">Advanced</strong></span><span class="No-Break">: </span><a href="https://www.packtpub.com/product/the-complete-ethical-hacking-bootcamp-beginner-to-advanced-video/9781801077989"><span class="No-Break">https://www.packtpub.com/product/the-complete-ethical-hacking-bootcamp-beginner-to-advanced-video/9781801077989</span></a></li>
<li><strong class="bold">Learn Ethical Hacking From A-Z: Beginner To Expert </strong><span class="No-Break"><strong class="bold">Course</strong></span><span class="No-Break">: </span><a href="https://www.packtpub.com/product/learn-ethical-hacking-from-a-z-beginner-to-expert-course-video/9781801072991"><span class="No-Break">https://www.packtpub.com/product/learn-ethical-hacking-from-a-z-beginner-to-expert-course-video/9781801072991</span></a></li>
<li><strong class="bold">Becoming the </strong><span class="No-Break"><strong class="bold">Hacker</strong></span><span class="No-Break">: </span><a href="https://www.packtpub.com/product/becoming-the-hacker/9781788627962"><span class="No-Break">https://www.packtpub.com/product/becoming-the-hacker/9781788627962</span></a></li>
</ul>
</div>
</div></body></html>