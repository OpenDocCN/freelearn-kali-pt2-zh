- en: Using Proxies, Crawlers, and Spiders
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover:'
  prefs: []
  type: TYPE_NORMAL
- en: Finding files and folders with Dirb
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding files and folders with ZAP
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Burp Suite to view and alter requests
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Burp Suite's intruder to find files and folders
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using the ZAP proxy to view and alter requests
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using ZAP spider
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Burp Suite to spider a website
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Repeating requests with Burp Suite's repeater
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using WebScarab
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying relevant files and directories from crawling results
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A penetration test may be performed using different approaches called black,
    grey, and white box. Black box is when the testing team doesn't have any previous
    information about the application to test except the URL of the server; white
    box is when the team has all information about the target, its infrastructure,
    software versions, test users, development information, and so on; and gray box
    is a point in between.
  prefs: []
  type: TYPE_NORMAL
- en: For both black and gray box approaches, a reconnaissance phase, as we saw in
    the previous chapter, is necessary for the testing team to discover the information
    that could be provided by the application's owner in a white box approach.
  prefs: []
  type: TYPE_NORMAL
- en: Continuing with the reconnaissance phase in a web penetration test, we will
    need to browse every link included in a web page and have a record of every file
    displayed by it. There are tools that help us to automate and accelerate this
    task; they are called web crawlers or web spiders. These tools browse a web page
    following all links and references to external files, sometimes filling in forms
    and sending them to servers, saving all requests and responses made and giving
    us the opportunity to analyze them offline.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will cover the use of some proxies, spiders, and crawlers
    included in Kali Linux and will also see what files and directories would be interesting
    to look for in a common web page.
  prefs: []
  type: TYPE_NORMAL
- en: Finding files and folders with DirBuster
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DirBuster is a tool created to discover, by brute force or by comparison with
    a wordlist, the existing files and directories in a web server. We will use it
    in this recipe to search for a specific list of files and directories.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will use a text file that contains the list of words that we will ask DirBuster
    to look for. Create a text file, `dir_dictionary.txt`, containing the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'DirBuster is an application made in Java; it can be called from Kali''s main
    menu or from a terminal using the `dirbuster` command. The following are the steps
    required to make such call:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to Applications | 03 - Web Application Analysis | Web Crawlers & Directory
    Bruteforcing | Dirbuster.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the DirBuster window, set the target URL to `http://192.168.56.11/`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Set the number of threads to 20 to have a decent testing speed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select List based brute force and click on Browse.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the browsing window, select the file we just created (`dir_dictionary.txt`).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Uncheck the Be Recursive option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'For this recipe, we will leave the rest of options at their defaults:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/8279f370-4fc1-4133-a036-94b5c7577e99.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on Start.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'If we go to the Results tab, we will see that DirBuster has found at least
    two of the files in our dictionary: `cgi-bin` and `phpmyadmin`. The response code
    200 means that the file or directory exists and can be read. `phpmyadmin` is a
    web-based MySQL database administrator; finding a directory with this name tells
    us that there is a **database management system** (**DBMS**) in the server and
    it may contain relevant information about the application and its users:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/0e2847d8-74a9-4507-9be4-8550702de7aa.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: DirBuster is a mixture of a crawler and brute forcer; it follows all links in
    the pages it finds but also tries different names for possible files. These names
    may be in a file similar to the one we used or may be automatically generated
    by DirBuster using the option of Pure Brute Force and setting the character set
    and minimum and maximum lengths for the generated words.
  prefs: []
  type: TYPE_NORMAL
- en: 'To determine if a file exists or not, DirBuster uses the response codes from
    the server. The most common responses are listed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '200 OK: The file exists and the user can read it'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '404 File not found: The file does not exist in the server'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '301 Moved permanently: This is a redirect to a given URL'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '401 Unauthorized: Authentication is required to access this file'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '403 Forbidden: Request was valid but the server refuses to respond'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`dirb` is a command-line tool included in Kali Linux that also takes a dictionary
    file to forcefully browse into a server to identify existing files and directories.
    To see its syntax and options, open a terminal and enter the `# dirb` command.'
  prefs: []
  type: TYPE_NORMAL
- en: Finding files and folders with ZAP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: OWASP **Zed Attack Proxy** (**ZAP**) is a very versatile tool for web security
    testing. It has a proxy, passive and active vulnerability scanners, fuzzer, spider,
    HTTP request sender, and some other interesting features. In this recipe, we will
    use the recently added **Forced Browse**, which is the implementation of DirBuster
    inside ZAP.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this recipe to work, we need to use ZAP as a proxy for our web browser:'
  prefs: []
  type: TYPE_NORMAL
- en: Start OWASP ZAP from Kali Linux menu and, from the application's menu, navigate
    to Applications | 03 - Web Application Analysis | owasp-zap.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, we''ll change ZAP''s proxy settings. By default, it uses port `8080`,
    but that may interfere with other proxies like Burp Suite if we have them running
    at the same time. In ZAP, go to Tools | Options | Local Proxies and change the
    port to `8088`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/b7bd2177-ba9e-490d-96bd-625631c5d713.png)'
  prefs: []
  type: TYPE_IMG
- en: Now, in Firefox, go to the main menu and navigate to Preferences | Advanced
    | Network; in Connection, click on Settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Choose a Manual proxy configuration and set `127.0.0.1` as the HTTP Proxy and
    `8088` as the Port. Check the option to use the same proxy for all protocols and
    then click on OK:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/f280dfe4-d64e-4950-826e-b31fcdc6d7b7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can also use the FoxyProxy plugin to set up multiple proxy settings and
    switch between them with just a click:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/6bccb89a-f271-4aff-ab2c-519b97c3a930.png)'
  prefs: []
  type: TYPE_IMG
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now that we have the browser and proxy configured, we are ready to scan a server
    for existing folders using the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Having configured the proxy properly, browse to `http://192.168.56.11/WackoPicko`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We will see ZAP reacting to this action by showing the tree structure of the
    host
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: we just visited.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Now, in ZAP''s upper-left panel (the Sites tab), right-click on the `WackoPicko`
    folder inside the `http://192.168.56.11` site. Then, in the context menu, navigate
    to Attack | Forced Browse directory (and children); this will do a recursive scan:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/a12cf8a7-bc71-4c33-85ce-2014873f86cb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In the bottom panel, we will see that the Forced Browse tab is displayed. Here
    we can see the progress of the scan and its results:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/ae09b5ab-4904-4918-910a-a36b5a3bc85a.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A proxy is an application that acts as an intermediary between a client and
    a server or a group of servers providing different services. The client requests
    a service from the proxy and this has the ability to forward the request to the
    appropriate server and get the response back from the client.
  prefs: []
  type: TYPE_NORMAL
- en: When we configure our browser to use ZAP as a proxy, it doesn't send the requests
    directly to the server that hosts the pages we want to see but rather to the address
    we defined. In this case the one where ZAP is listening. Then, ZAP forwards the
    request to the server but not without registering and analyzing the information
    we sent.
  prefs: []
  type: TYPE_NORMAL
- en: ZAP's Forced Browse works the same way that DirBuster does; it takes the dictionary
    we configured and sends requests to the server, as if it were trying to browse
    to the files in the list. If the files exist, the server will respond accordingly;
    if they don't exist or aren't accessible by our current user, the server will
    return an error.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Another very useful proxy included in Kali Linux is Burp Suite. It also has
    some very interesting features; one that can be used as an alternative for the
    Forced Browse we just used is Burp's Intruder. Although it is not specifically
    intended for that purpose, it is a versatile tool worth checking out.
  prefs: []
  type: TYPE_NORMAL
- en: Using Burp Suite to view and alter requests
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Burp Suite is more than a simple web proxy. It is a full-featured web application
    testing kit. It has a proxy, request repeater, fuzzer, request automation, string
    encoder and decoder, vulnerability scanners (in the Pro version), plugins to extend
    its functionality, and other useful features.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will use Burp Suite's proxy features to intercept a request
    between the browser and the server and alter its contents.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Start Burp Suite from the applications menu, Applications | 03 - Web Application
    Analysis | Burpsuite, or by typing the command from the terminal, and set up the
    browser to use it as proxy on port `8080`.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To make things a little more interesting, let''s use this interception/modification
    technique to bypass a basic protection mechanism. Perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Browse to OWASP Bricks and go to the exercise Upload 2 (`http://192.168.56.11/owaspbricks/upload-2`).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Request interception is enabled by default in Burp Suite; if the page won''t
    load, go to Burp Suite then to Proxy | Intercept and click on the pressed button, Intercept
    is on:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/20ca9e43-3e41-4bdc-b610-3ec58c225daa.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Here we have a file upload form that is supposed to upload only images. Let''s
    try to upload one. Click on Browse and select any image file (PNG, JPG, or BMP):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/fda352e1-668d-4c9a-8a93-6d3084600234.png)'
  prefs: []
  type: TYPE_IMG
- en: 'After clicking Open, click Upload and verify that the file was uploaded:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/f7aab7b5-7141-4430-8e32-7bcdf9c3d42b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now let''s try to see what happens if we upload a different type of file, let''s
    say, an HTML file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/e00b83b1-746b-4c14-b453-ae8adb97907c.png)'
  prefs: []
  type: TYPE_IMG
- en: Looks like, as mentioned in the exercise description, the server is validating
    the file type being uploaded. To bypass this restriction, we first enable the
    request interception in Burp Suite.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Browse for the HTML file and try to upload it again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Burp will capture the request:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/5b75346a-1c6d-4a1c-a3c7-b35bfc5d7bd0.png)'
  prefs: []
  type: TYPE_IMG
- en: Here we can see a `POST` request that is `multipart` (first `Content-Type` header)
    and the delimiter for each part is a long series of dashes (-) and a long number.
    Next, in the first part, we have the file we want to upload with its information
    and its own `Content-Type`.
  prefs: []
  type: TYPE_NORMAL
- en: 'We know the server only accepts images, so let''s change the header for one
    that says that the file we are uploading is an image:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/9f201db4-cfcf-4f99-b0da-1f55cb9bd5bd.png)'
  prefs: []
  type: TYPE_IMG
- en: Next, we submit the request by clicking Forward if we want to continue intercepting
    requests, or by disabling the interceptions if we don't.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'And the upload was successful. If we roll our mouse pointer over the here word
    we will see that it is a link to our file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/7d4cea11-997d-4ddb-b9a4-9370b5f3aa00.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this recipe, we used Burp Suite as a proxy to capture a request after it
    passed the validation mechanisms established client-side by the application, that
    is, in the browser, and then modified such request content by changing the `Content-Type`
    header and used that to bypass the file type restrictions in the application.
  prefs: []
  type: TYPE_NORMAL
- en: '`Content-Type` is a standard HTTP header set by the client, particularly in
    `POST` and `PUT` requests, to indicate to the server the type of data it is receiving.
    It''s not uncommon for web applications to use this field and the file''s extension
    to filter out dangerous or unauthorized types in applications that allow users
    to upload files. As we just saw, this sole protective measure is insufficient
    when it comes to preventing a user to upload malicious content to the server.'
  prefs: []
  type: TYPE_NORMAL
- en: Being able to intercept and modify requests is a highly important aspect of
    any web application penetration test, not only to bypass some client-side validation—as
    we did in this recipe—but to study what kind of information is sent and to try
    to understand the inner workings of the application. We also may need to add,
    remove, or replace some values for our convenience based on that understanding.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'It is very important for a penetration tester to understand how the HTTP protocol
    works. For a better understanding of the different HTTP methods refer to:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html](https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Burp Suite's Intruder to find files and folders
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Burp Intruder is a tool that allows us to replay a request automatically, altering
    parts of such request accordingly to lists of inputs that we can set or generate
    according to configurable rules.
  prefs: []
  type: TYPE_NORMAL
- en: Although it's not its main purpose, we can use Intruder to find existing yet
    nonreferenced files and folders as we can do with previously seen tools such as
    DirBuster and ZAP's Forced Browse.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will undertake our first exercise with Burp Suite's Intruder
    and will use it to browse directories in our vulnerable virtual machine forcefully
    by using a name list included in Kali Linux.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s assume we have already set Burp Suite as a proxy for our browser and
    have visited WackoPicko (`http://192.168.56.11/WackoPicko`). Refer to the following
    steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In the Target or Proxy tabs, find a request to the WackoPicko''s root URL,
    right-click on it, and select Send to Intruder:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/f5078678-4c85-4c3c-acbb-d251e99d8294.png)'
  prefs: []
  type: TYPE_IMG
- en: Then change to the Intruder tab and then to the Positions tab; you'll see some
    fields in the request highlighted and surrounded by § symbols. These are the inputs
    Intruder is going to change on every request. Click on the Clear button to remove
    all of them.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After the last `/` in the URL we add any character, say an `a` for example,
    select it, and click on Add. So this character becomes an insertion point for
    the list of inputs:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/631e34e1-baa1-41a0-9bfa-fdf168124b58.png)'
  prefs: []
  type: TYPE_IMG
- en: Now change to the Payloads tab. We have only one insertion point, so we will
    have only one Payload set to configure. The Payload type is kept as a Simple list
    and we are loading the payloads from a file.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now click on the Load button so we can load the payload list from a file and
    select the file `/usr/share/wordlists/dirb/small.txt`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/5af72c8b-981c-4dc1-8e43-b83e3ae45f8c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To start sending requests to the server, click on Start attack. If you are
    using the free version of Burp Suite, you will receive a warning about some limitations
    in Intruder; accept them and the attack will start:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/0b90c929-56a7-4161-8821-86ca94623f60.png)'
  prefs: []
  type: TYPE_IMG
- en: If we sort the results by status (by clicking on the column header), we can
    see the lowest number on top; remember that 200 is the response code for an existent
    and accessible file or directory, redirections are 300, and errors are in the
    range of 400 and 500.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'What Intruder does is it modifies a request in the specific positions we tell
    it to and replaces the values in those positions with the payloads defined in
    the Payloads section. Payloads may be, among other things:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Simple list: A list that can be taken from a file, pasted from the clipboard,
    or written down in the textbox'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Runtime file: Intruder can take the payload from a file being read at runtime,
    so if the file is very large, it won''t be loaded fully into memory'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Numbers: Generates a list of numbers that may be sequential or random and presented
    in hexadecimal or decimal form'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Username generator: Takes a list of email addresses and extracts possible usernames
    from it'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bruteforcer: Takes a character set and uses it to generate all permutations
    inside the length limits specified'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These payloads are sent by Intruder in different ways, which are specified
    by the attack type in the Positions tab. Attack types differ in the way the payloads
    are combined and permuted in the payload markers:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Sniper: With a single set of payloads, it places each payload value in every
    position marked one at a time.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Battering ram: Like Sniper, it uses one set of payloads; the difference is
    that it sets the same value to all positions on each request.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Pitchfork: Uses multiple payload sets and puts one item of each set in each
    marked positions. Useful when we have predefined sets of data that should not
    be mixed, for example testing username/password pairs already known.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Cluster bomb: Tests multiple payloads one against another so that every possible
    permutation is tested.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As for the results, we can see that there are a couple of existing files with
    names matching the ones in the list (`account` and `action`) and that there's
    a directory named `admin`, which probably contains the pages that perform administrative
    functions in the application, like adding users or content.
  prefs: []
  type: TYPE_NORMAL
- en: Using the ZAP proxy to view and alter requests
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: OWASP ZAP, similar to Burp Suite, is also more than a web proxy. It not only
    intercepts traffic; it also has lots of features like the crawler we used in previous
    chapters, a vulnerability scanner, a fuzzer, and a Brute Force. It also has a
    scripting engine that can be used to automate activities or to create new functionality.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will begin the use of OWASP ZAP as a web proxy, intercept
    a request, and send it to the server after changing some values.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Start ZAP and configure the browser to use it as a proxy. Further, carry out
    the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Go to OWASP Bricks in the `vm_1` and select content exercise number four (`http://192.168.56.11/owaspbricks/content-4/`):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/549072b7-a06b-4d9e-9f79-efc7d62d8659.png)'
  prefs: []
  type: TYPE_IMG
- en: We can see that the immediate response of the page is an error saying that the
    user does not exist. There is also SQL code displayed, showing that the application
    is comparing a field (`ua`) with a string that is the User-Agent header sent by
    the browser.
  prefs: []
  type: TYPE_NORMAL
- en: A User-Agent string is a piece of information sent by the browser in every request
    header to identify itself to the server. This usually contains the name and version
    of the browser, the base operating system, and the HTML rendering engine.
  prefs: []
  type: TYPE_NORMAL
- en: 'As the User-Agent is set by the browser when sending the request, we cannot
    do much to change it from within the application. We will use OWASP ZAP to capture
    the request and set whatever text we want it to contain as the User-Agent. First,
    enable the interception (called break) in the proxy by clicking on the green circle
    (turns red on mouse-over) in the toolbar. This will intercept all requests going
    through the proxy:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/16bcab57-a396-41bf-8e65-7359ba1ed690.png)'
  prefs: []
  type: TYPE_IMG
- en: After enabling the breaks, go to the browser and refresh the page. Go back to
    ZAP; a new Break tab will appear beside the Request and Response tabs.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the Break tab, we see the request the browser is making when we refresh
    the page. Here we can change any part of the request; for this exercise we will
    only change the User-Agent value, for example, changing it to `123456`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/52eeae19-c90f-4e59-8cf3-76e62cc252b0.png)'
  prefs: []
  type: TYPE_IMG
- en: Submit the request by clicking on the Play icon (blue triangle). This will pause
    again when a new request is made; if you don't want to continue breaking on every
    request, use the red circle button to disable interception.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now let''s go to the browser again and see the response:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/0abfdc11-b7e4-4fc0-869d-24b7753db78a.png)'
  prefs: []
  type: TYPE_IMG
- en: The error still says the user doesn't exist, but the value we introduced is
    now displayed in the clue code. In future chapters. we will learn how to take
    advantage of features like this and use them to extract information from the database.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this recipe, we used the ZAP proxy to intercept a valid request in which
    the server analyzed the header section. We modified the header and verified that
    the server actually took the value we would provide.
  prefs: []
  type: TYPE_NORMAL
- en: First, we made a test request and discovered that the User-Agent header was
    being used by the server. Knowing that, we made a valid request and intercepted
    it with the proxy; this allowed us to see the request once it left the browser.
    Then we changed the header so the User-Agent contained the information we wanted
    it to contain and submitted the request to the server, which took and displayed
    the value we provided.
  prefs: []
  type: TYPE_NORMAL
- en: Another option to change the User-Agent without the need to intercept and manually
    change requests is to use the User-Agent Switcher Firefox extension we installed
    in [Chapter 1](b5aed3bb-313a-47ca-bc62-af4d938f7a3f.xhtml), *Setting Up Kali Linux
    and the Testing Lab*. The problem with this is that we would need to set up a
    different user agent in the extension every time we wanted to test a different
    value, which is very impractical in a penetration test.
  prefs: []
  type: TYPE_NORMAL
- en: Using ZAP spider
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In web applications, a crawler or spider is a tool that automatically goes through
    a website following all links in it and sometimes filling in and sending forms;
    this allows us to get a complete map of all of the referenced pages within the
    site and record the requests made to get them and their responses.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will use ZAP's spider to crawl a directory in our vulnerable
    virtual machine `vm_1` and we will check on the information it captures.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We will use BodgeIt (`http://192.168.56.11/bodgeit/`) to illustrate how ZAP''s
    spider works. Refer to the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: In the Sites tab, open the folder corresponding to the test site (`http://192.168.56.11`
    in this book).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right-click on GET:bodgeit.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'From the drop-down menu select Attack | Spider:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/305e1f1e-7093-45d9-8d00-e03741a356b1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In the Spider dialog, we can tell if the crawling will be recursive (spider
    inside the directories found), set the starting point, and other options. For
    now, we leave all default options as they are and click Start Scan:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/b3117ada-7de6-4cda-83a5-9027994c6250.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Results will appear in the bottom panel in the Spider tab:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/50cf4f60-6865-4d45-be2f-17e1475d53e3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'If we want to analyze the requests and responses of individual files, we go
    to the Sites tab, open the site folder, and look at the files and folders inside
    it:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/cb016fbf-78c3-4716-8e18-392ef39266c7.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Like any other crawler, ZAP's spider follows every link it finds in every page
    included in the scope requested and the links inside it. Also, this spider follows
    the form responses, redirects, and URLs included in `robots.txt` and `sitemap.xml`
    files, then it stores all requests and responses for later analysis and use.
  prefs: []
  type: TYPE_NORMAL
- en: There's more
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After crawling a website or directory, we may want to use the stored requests
    to perform some tests. Using ZAP''s capabilities, we will be able to do the following,
    among other things:'
  prefs: []
  type: TYPE_NORMAL
- en: Repeat the requests modifying some data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform active and passive vulnerability scans
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Fuzz the input variables looking for possible attack vectors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Open the requests in the browser
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Burp Suite to spider a website
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With similar functionalities to ZAP, and with some distinctive features and
    a more easy-to-use interface, Burp Suite is the most used tool for application
    security testing. Burp Suite can do much more than just crawl a website, but for
    now, as a part of the reconnaissance phase, we will cover only its spidering features.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Start Burp Suite by going to Kali's Applications menu, then click on 03 - Web
    Application Analysis | Burpsuite.
  prefs: []
  type: TYPE_NORMAL
- en: Then, configure the browser to use it as proxy through the port `8080`.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Burp Suite''s proxy is configured by default to intercept all requests, this
    time we want to browse without interruptions so we need to disable it (Proxy |
    Intercept | Intercept is on). Then proceed with the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Once using Burp Suite's proxy, in your browser go to bWAPP (`http://192.168.56.11/bWAPP`);
    this will register the site and directory on Burp's Target and Proxy tabs.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Go to Target | Site map and right-click on the `bWAPP` folder inside `http://192.168.56.11`,
    then select Spider this branch from the context menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/dcb4cfbb-4704-4afb-b5e7-f0c30d1402aa.png)'
  prefs: []
  type: TYPE_IMG
- en: An alert will pop up asking if you want to scan an out-of-scope element (only
    if you haven't added it to the scope). Click Yes to add it and the spidering will
    start.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'At some point, the spider will find a registration or login form; when this
    happens Burp Suite will show you a dialog asking for information on how to fill
    the form''s fields. We can ignore it and spider will continue, or we can submit
    some test values and the spider will fill in those values:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/f4faf15a-48b8-4e74-84f9-b7655adb807b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can check the spider status in the Spider tab. We can also stop it by clicking
    on the Spider is running button. Let''s stop it now:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/d52d7be1-4791-42ab-87a2-96c65b0c4d8d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can also see how the branch in the Target tab is being populated as the
    spider finds new pages and directories:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/02abf294-303e-4660-aed6-8a65e3c04478.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Burp's Spider follows the same methodology as other spiders, but it operates
    in a slightly different way. We could have it running while we browse the site
    and it will add the links we follow that match the scope definition to the crawling
    queue.
  prefs: []
  type: TYPE_NORMAL
- en: Just like in ZAP, we can use Burp's crawling results to perform any operation
    we can perform on any request, like scanning (if we have the paid version), repeat,
    compare, fuzz, and view in browser, among others.
  prefs: []
  type: TYPE_NORMAL
- en: There's more
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Spidering is a mostly automated process where spiders do very little or no checking
    on the links they are following. In applications with flawed authorization controls
    or exposed sensitive links and forms, this could cause the spider to send a request
    to an action or page that performs a sensitive task that could damage the application
    or its data. Hence, it is very important that spidering is done with extreme care,
    taking advantage of all the exclusion/inclusion filtering features the tool of
    choice provides, ensuring that there is no sensitive information or high-risk
    tasks within the spider scope, and preferably as a last resort to browsing manually
    through the site.
  prefs: []
  type: TYPE_NORMAL
- en: Repeating requests with Burp Suite's repeater
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When analyzing spider's results and testing possible inputs to forms, it may
    be useful to send different versions of the same request, changing specific values.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will learn how to use Burp's Repeater to send requests multiple
    times with different values.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We begin this recipe from the point we left the previous one. It is necessary
    to have the `vm_1` virtual machine running, Burp Suite started in our Kali machine,
    and the browser properly configured to use it as a proxy.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this recipe, we will use OWASP Bricks. The following are the steps required:'
  prefs: []
  type: TYPE_NORMAL
- en: Go to the first of the content exercises (`http://192.168.56.11/owaspbricks/content-1/`).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In Burp Suite, go to Proxy | History, locate a `GET` request that has an `id=0`
    or `id=1` at the end of the URL, right-click on it, and from the menu select Send
    to Repeater:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/b3f9dfd4-569c-4c26-954e-b32ee4f38c98.png)'
  prefs: []
  type: TYPE_IMG
- en: Now we switch to the Repeater tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In Repeater, we can see the original request on the left side. Let''s click
    on Go to view the server''s response on the right side:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/1cf74ecb-4f5e-41f9-b26a-ee6311bc3280.png)'
  prefs: []
  type: TYPE_IMG
- en: Analyzing the request and response, we can see that the parameter we sent (`id=1`)
    was used by the server to look for a user with that same ID, and the information
    is displayed in the response's body.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, this page in the server expects a parameter called ID, with a numeric parameter
    that represents a user ID. Let''s see what happens if the application receives
    a letter instead of a number:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/6e976070-c6cf-49bc-bce4-e8c4c037d4ad.png)'
  prefs: []
  type: TYPE_IMG
- en: The response is an error showing information about the database (MySQL), the
    parameter types expected, the internal path of the file, and the line of code
    that caused the error. This displaying of detailed technical information by itself
    suggests a security risk.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, if the expected value is a number, let''s see what happens if we send an
    arithmetic operation. Change the `id` value to `2-1`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/e51ba563-ceb1-4d6d-bef8-79d760cb3aef.png)'
  prefs: []
  type: TYPE_IMG
- en: As can be seen, the operation was executed by the server and it returned the
    information corresponding to the user ID `1`, which is the result of our operation.
    This suggests that this application may be vulnerable to injection attacks. We'll
    dig more into them in [Chapter 6](680e9e0d-a892-4c37-b2ad-ce8d27d462b5.xhtml),
    *Exploiting Injection Vulnerabilities*.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Burp Suite's Repeater allows us to test different inputs and scenarios for the
    same HTTP request manually and to analyze the responses the server gives to each
    of them. This is a very useful feature when testing for vulnerabilities, as one
    can study how the application is reacting to the various inputs it is given and
    act accordingly to identify or exploit possible weaknesses in configuration, programming,
    or design.
  prefs: []
  type: TYPE_NORMAL
- en: Using WebScarab
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: WebScarab is another web proxy full of features that may be interesting to penetration
    testers. In this recipe, we will use it to spider a website.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In its default configuration, WebScarab uses port `8008` to capture HTTP requests,
    so we need to configure our browser to use that port in the localhost as a proxy.
    We follow steps similar to those of the OWASP ZAP and Burp Suite configurations
    in the browser; in this case the port must be `8008`.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'WebScarab can be found in Kali''s Applications menu; go to 03 - Web Application
    Analysis | webscarab. Alternatively, from the terminal, run the `webscarab` command.
    Proceed with the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Browse to the BodgeIt application of `vulnerable_vm` (`http://192.168.56.11/bodgeit/`).
    We will see that it appears in the Summary tab of WebScarab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now we right-click on the `bodgeit` folder and select Spider tree from the
    menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/ff8fbe5e-2b52-4a26-af74-80585ca76f06.png)'
  prefs: []
  type: TYPE_IMG
- en: 'All requests will appear in the bottom half of the Summary and the tree will
    be filled as the spider finds new files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/dae7de2f-d086-4d20-8d62-d68f5c618d1b.png)'
  prefs: []
  type: TYPE_IMG
- en: The Summary also shows some relevant information about each particular file,
    like if it has an injection or possible injection vulnerability, if it sets a
    cookie, if it contains a form, and if the form contains hidden fields. It also
    indicates the presence of comments in the code or file uploads.
  prefs: []
  type: TYPE_NORMAL
- en: 'If we right-click on any of the requests in the bottom half we will see the
    operations we can perform on them. We will analyze a request, find the path `/bodgeit/search.jsp`,
    right-click on it, and select Show conversation. A new window will pop up showing
    the response and request in various formats:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/a71c6a38-923b-4074-985e-fbc54b6c48d9.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now click on the Spider tab:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](assets/71897eef-fbd7-499b-9c37-bf090c426d1f.png)'
  prefs: []
  type: TYPE_IMG
- en: In this tab, we can adjust the regular expressions of what the spider fetches
    by using the Allowed Domains and Forbidden Paths textboxes. We can also refresh
    the results by using Fetch Tree. We can also stop the spider by clicking the Stop
    button.
  prefs: []
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: WebScarab's spider, as with those of ZAP and Burp Suite, is useful to discover
    all referenced files in a website or directory without having to browse all possible
    links manually and to analyze in depth the requests made to the server, as well
    as to use them to perform more sophisticated tests.
  prefs: []
  type: TYPE_NORMAL
- en: Identifying relevant files and directories from crawling results
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We already crawled a full application's directory and have the list of all referenced
    files and directories inside it. The natural next step is to identify which of
    those contains relevant information or represents an opportunity to have a greater
    chance of finding vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: More than a recipe, this will be a catalog of common names, suffixes, or prefixes
    used for files and directories that usually lead to information useful to the
    penetration tester or to the exploitation of vulnerabilities that may end in complete
    system compromise.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here are the steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The first thing we want to look for are the login and registration pages, the
    ones that could give us the chance to become legitimate users of the application
    or to impersonate one by guessing usernames and passwords. Some examples of names
    or partial names are:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Account
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Auth
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Login
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Logon
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Registration
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Register
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Signup
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Signin
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Other common sources of usernames, passwords, and design vulnerabilities related
    to this type of information, are password recovery pages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Forgot
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Lost-password
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Password
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Recover
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Reset
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Next, we need to identify if there is an administrative section of the application
    or some set of functions that may allow us to perform high-privileged tasks on
    it. For example, we may look for:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Admin
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Config
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Manager
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Root
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Other interesting directories are **Content Management Systems** (**CMS**)
    administration, databases, or application servers:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`admin-console`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`adminer`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`administrator`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`couch`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`manager`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Mylittleadmin`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`phpMyAdmin`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`SqlWebAdmin`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`wp-admin`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Testing and development versions of applications are usually less protected
    and more prone to vulnerabilities than final releases, so they are a good target
    in our search for weak points. These directories'' names may include:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Alpha
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Beta
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Dev
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Development
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: QA
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Test
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Web server information and configuration files can sometimes provide valuable
    information about the frameworks, software versions, and particular settings that
    may be exploitable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`config.xml`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`info`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`phpinfo`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`server-status`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '`web.config`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Also, all directories and files marked with disallow in `robots.txt` may be
    useful.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Some of the names listed previously and their variations in the language the
    target application was created in may allow us access to restricted sections of
    the site, which is a very important step in a penetration test; we cannot find
    vulnerabilities in places if we ignore they exist. Some of them will provide us
    with information about the server, its configuration, and the developing frameworks
    used. Some others, like the Tomcat manager and JBoss administration pages, if
    wrongfully configured, will let us (or a malicious user) take control of the web
    server.
  prefs: []
  type: TYPE_NORMAL
